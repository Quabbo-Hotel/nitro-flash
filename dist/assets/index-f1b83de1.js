import{i as WI,B as O_,n as rU,s as iU,F as cp,A as nU,a as um,C as aU,P as it,R as fi,S as bs,T as ys,b as oU,c as yn,d as C_,e as XR,M as Zr,f as Ru,g as ba,G as hm,h as lU,j as cU,E as uU,k as hU,I as dU,l as _U,m as gU,o as mU,p as fU,q as pU,r as dm,t as EU,u as IU,v as Dl,w as d,x as a,y as _,z as QR,D as $R,H as TU,J as yo,K as up,L as J,N as qa,O as Fo,Q as RU,U as SU,V as vs,W as OU,X as hp,Y as CU,Z as JR,_ as ts,$ as AU,a0 as NU,a1 as bU,a2 as Kn,a3 as qn,a4 as Lc,a5 as ZR,a6 as eS,a7 as tS,a8 as yU,a9 as sS,aa as vU,ab as MU,ac as rS,ad as A_,ae as N_,af as yd,ag as iS,ah as DU,ai as PU,aj as LU,ak as nS,al as aS,am as UU,an as xU,ao as wU,ap as FU,aq as kU,ar as GU,as as BU,at as VU,au as HU,av as jI,aw as WU,ax as jU,ay as YU}from"./vendor-b342d977.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerpolicy&&(n.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?n.credentials="include":i.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();class xe{static log(...e){this.LOG_DEBUG&&console.log(this.logPrefix(),...e)}static warn(...e){this.LOG_WARN&&console.warn(this.logPrefix(),...e)}static error(...e){this.LOG_ERROR&&console.error(this.logPrefix(),...e)}static events(...e){this.LOG_EVENTS&&console.log(this.logPrefix(),...e)}static packets(...e){this.LOG_PACKETS&&console.log(this.logPrefix(),...e)}static logPrefix(){return"[Nitro]"}static startAutoClear(e=6e4){try{this._autoClearHandle&&this.stopAutoClear(),this._autoClearHandle=globalThis.setInterval(()=>{try{console.clear()}catch{}},e)}catch{}}static stopAutoClear(){try{if(!this._autoClearHandle)return;globalThis.clearInterval(this._autoClearHandle),this._autoClearHandle=null}catch{}}}xe.LOG_DEBUG=!1;xe.LOG_WARN=!1;xe.LOG_ERROR=!1;xe.LOG_EVENTS=!1;xe.LOG_PACKETS=!1;xe._autoClearHandle=null;class As{constructor(e=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],e)for(const[t,r]of e.entries())this.add(t,r)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const e of this._dictionary.keys())this._dictionary.delete(e);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const e of this._dictionary.keys())this._dictionary.delete(e);this._length=0,this._array=[],this._keys=[]}unshift(e,t){return this._dictionary.get(e)!==null?!1:(this._dictionary.set(e,t),this._array.unshift(t),this._keys.unshift(e),this._length++,!0)}add(e,t){return this._dictionary.get(e)!==void 0?!1:(this._dictionary.set(e,t),this._array[this._length]=t,this._keys[this._length]=e,this._length++,!0)}remove(e){const t=this._dictionary.get(e);if(!t)return null;const r=this._array.indexOf(t);return r>=0&&(this._array.splice(r,1),this._keys.splice(r,1),this._length--),this._dictionary.delete(e),t}getWithIndex(e){return e<0||e>=this._length?null:this._array[e]}getKey(e){return e<0||e>=this._length?null:this._keys[e]}getKeys(){return this._keys.slice()}hasKey(e){return this._keys.indexOf(e)>-1}getValue(e){return this._dictionary.get(e)}getValues(){return this._array.slice()}hasValue(e){return this._array.indexOf(e)>-1}indexOf(e){return this._array.indexOf(e)}concatenate(e){for(const t of e._keys)this.add(t,e.getValue(t))}clone(){const e=new As;return e.concatenate(this),e}}const oS=s=>{let e="";const t=new Uint8Array(s),r=t.byteLength;for(let i=0;i<r;i++)e+=String.fromCharCode(t[i]);return window.btoa(e)};class b_{constructor(e){this._position=0,this._dataView=new DataView(e)}readBytes(e){const t=new b_(this._dataView.buffer.slice(this._position,this._position+e));return this._position+=e,t}readByte(){const e=this._dataView.getInt8(this._position);return this._position++,e}readShort(){const e=this._dataView.getInt16(this._position);return this._position+=2,e}readInt(){const e=this._dataView.getInt32(this._position);return this._position+=4,e}readFloat(){const e=this._dataView.getFloat32(this._position);return this._position+=4,e}readDouble(){const e=this._dataView.getFloat64(this._position);return this._position+=8,e}remaining(){return this._dataView.byteLength-this._position}toString(e){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class YI{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(e){const t=new Uint8Array(1);return t[0]=e,this.appendArray(t),this}writeBytes(e){const t=new Uint8Array(e);return this.appendArray(t),this}writeShort(e){const t=new Uint8Array(2);return t[0]=e>>8,t[1]=e&255,this.appendArray(t),this}writeInt(e){const t=new Uint8Array(4);return t[0]=e>>24,t[1]=e>>16,t[2]=e>>8,t[3]=e&255,this.appendArray(t),this}writeString(e,t=!0){const r=new TextEncoder().encode(e);return t?(this.writeShort(r.length),this.appendArray(r)):this.appendArray(r),this}appendArray(e){if(!e)return;const t=new Uint8Array(this.position+e.length>this._buffer.length?this.position+e.length:this._buffer.length);t.set(this._buffer),t.set(e,this.position),this._buffer=t,this.position+=e.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(e){this._position=e}toString(e){return new TextDecoder(e).decode(this._buffer)}}class Ke{static parseConfiguration(e,t=!1){if(!e)return!1;try{const r=new RegExp(/\${(.*?)}/g);for(const i in e){let n=e[i];typeof n=="string"&&(n=this.interpolate(n,r)),this._definitions.has(i)?t&&this.setValue(i,n):this.setValue(i,n)}return!0}catch(r){return xe.error(r.stack),!1}}static interpolate(e,t=null){t||(t=new RegExp(/\${(.*?)}/g));const r=e.match(t);if(r&&r.length)for(const i of r){const n=this._definitions.get(this.removeInterpolateKey(i));n&&(e=e.replace(i,n))}return e}static removeInterpolateKey(e){return e.replace("${","").replace("}","")}static getValue(e,t=null){let r=this._definitions.get(e);if(r===void 0){if(this._missingKeys.indexOf(e)>=0)return t;this._missingKeys.push(e),xe.warn(`Missing configuration key: ${e}`),r=t}return r}static setValue(e,t){const r=e.split(".");let i=this._config;for(let n=0;n<r.length;n++){const o=r[n].toString();if(n!==r.length-1){i[o]||(i[o]={}),i=i[o];continue}i[o]=t}this._definitions.set(e,t)}static get definitions(){return this._definitions}}Ke._definitions=new Map;Ke._config={};Ke._missingKeys=[];const fr=class{constructor(s){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this._protectionBlock=null,this._payloadBytes=null;const e=this.stripGuardHeader(s);this._payloadBytes=new Uint8Array(e),this.parse(e),this.enforceProtection()}parse(s){const e=new b_(s);let t=e.readShort();for(;t>0;){const r=e.readShort(),i=e.readBytes(r).toString(),n=e.readInt(),o=e.readBytes(n);if(i.endsWith(".json")){const l=WI(o.toArrayBuffer());this._jsonFile=JSON.parse(fr.TEXT_DECODER.decode(l))}else{const l=WI(o.toArrayBuffer()),c=oS(l);this._baseTexture=new O_("data:image/png;base64,"+c)}t--}this.tryParseProtection(e,s)}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}get protectionBlock(){return this._protectionBlock}tryParseProtection(s,e){if(!s||s.remaining()<fr.PROTECTION_HEADER_LENGTH||s.readBytes(4).toString()!==fr.PROTECTION_MAGIC)return;const r=s.readByte(),i=s.readInt();if(i<=0||i>s.remaining())return;const n=s.readBytes(i);try{const o=JSON.parse(n.toString());o.version=r,this._protectionBlock=o;const l=fr.PROTECTION_HEADER_LENGTH+i,c=e.byteLength-l;c>0&&(this._payloadBytes=new Uint8Array(e,0,c))}catch(o){xe.warn(`Failed to parse Nitro protection metadata: ${(o==null?void 0:o.message)??o}`)}}enforceProtection(){if(Ke.getValue("nitro.bundle.protection.enabled",!1)){if(!this._protectionBlock)throw new Error("Protected Nitro asset is missing metadata.");this.ensureIssuer(),this.ensureHostAllowance(),this.ensureHashIntegrity(),this.ensureSignature()}}ensureIssuer(){const s=Ke.getValue("nitro.bundle.protection.issuer",null);if(s&&this._protectionBlock.issuer!==s)throw new Error("Nitro bundle issuer mismatch.")}ensureHostAllowance(){const s=this.getCurrentHost(),e=Ke.getValue("nitro.bundle.protection.allowedHosts",[])||[];if(s&&e.length&&!fr.isHostAllowed(s,e))throw new Error("Current host blocked by client configuration.");if(s&&this._protectionBlock.allowedHosts&&this._protectionBlock.allowedHosts.length&&!fr.isHostAllowed(s,this._protectionBlock.allowedHosts))throw new Error("Current host not authorized by bundle metadata.")}ensureHashIntegrity(){if(!this._payloadBytes||!this._payloadBytes.length)throw new Error("Unable to validate Nitro bundle payload.");if(fr.computePayloadHash(this._payloadBytes)!==this._protectionBlock.hash)throw new Error("Nitro bundle payload hash mismatch.")}ensureSignature(){const s=Ke.getValue("nitro.bundle.protection.publicKey","");if(!s||!s.length)throw new Error("Nitro bundle protection public key missing.");if(!this._protectionBlock.signature||!this._protectionBlock.signature.length)throw new Error("Nitro bundle signature missing.");const e=fr.base64ToUint8Array(s),t=fr.base64ToUint8Array(this._protectionBlock.signature),r=fr.buildSignaturePayload(this._protectionBlock);if(!rU.sign.detached.verify(r,t,e))throw new Error("Nitro bundle signature validation failed.")}getCurrentHost(){var s;return typeof window>"u"?"":(((s=window.location)==null?void 0:s.hostname)||"").toLowerCase()}static isHostAllowed(s,e){if(!e||!e.length)return!0;const t=s.toLowerCase();return e.some(r=>{const i=r.toLowerCase();if(i==="*")return!0;if(i.startsWith("*.")){const n=i.substring(1);return t.endsWith(n)}return t===i})}static computePayloadHash(s){const e=iU.exports.sha256.arrayBuffer(s);return fr.uint8ArrayToBase64(new Uint8Array(e))}static buildSignaturePayload(s){const e={version:s.version,issuer:s.issuer,bundleId:s.bundleId,assetType:s.assetType,allowedHosts:s.allowedHosts,issuedAt:s.issuedAt,nonce:s.nonce,hash:s.hash,algorithm:s.algorithm};return fr.TEXT_ENCODER.encode(JSON.stringify(e))}static base64ToUint8Array(s){if(!s)return new Uint8Array(0);const e=s.replace(/\s+/g,""),t=atob(e),r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}static uint8ArrayToBase64(s){if(!s||!s.length)return"";let e="";for(let t=0;t<s.length;t++)e+=String.fromCharCode(s[t]);return btoa(e)}stripGuardHeader(s){if(!s||s.byteLength<=fr.GUARD_HEADER_LENGTH||fr.TEXT_DECODER.decode(new Uint8Array(s,0,4))!==fr.GUARD_MAGIC)return s;const t=new DataView(s),r=t.getUint8(4),i=t.getUint32(5);if(fr.GUARD_HEADER_LENGTH+i>s.byteLength)throw new Error("Invalid Nitro guard header payload length.");return xe.log(`Encountered guarded Nitro bundle (version ${r}).`),s.slice(fr.GUARD_HEADER_LENGTH)}};let vo=fr;vo.TEXT_DECODER=new TextDecoder("utf-8");vo.TEXT_ENCODER=new TextEncoder;vo.PROTECTION_MAGIC="NTRP";vo.PROTECTION_HEADER_LENGTH=9;vo.GUARD_MAGIC="NENC";vo.GUARD_HEADER_LENGTH=9;class lS extends cp{constructor(e){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;
            
            uniform mat3 projectionMatrix;
            
            varying vec2 vTextureCoord;
            
            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;
            
            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;
            
            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);
            
                if (c.a > 0.0) {
                    c.rgb /= c.a;
            
                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;
            
                    c.rgb *= c.a;
                }
            
                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,e)}apply(e,t,r,i){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,r,i)}}const zU=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,KU=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`;class y_ extends cp{constructor(e,t,r){super(zU,KU,{mask:e.castToBaseTexture(),fromChannel:t,toChannel:r})}}y_.CHANNEL_RED=0;y_.CHANNEL_GREEN=1;y_.CHANNEL_BLUE=2;y_.CHANNEL_ALPHA=3;const _m=class extends nU{constructor(s){super(s),_m.INSTANCE||(_m.INSTANCE=this)}static get instance(){return this.INSTANCE||null}};let sr=_m;sr.INSTANCE=null;const Rr=()=>{var s;return((s=sr.instance)==null?void 0:s.ticker)||null},qU=()=>{var s;return((s=Rr())==null?void 0:s.FPS)||0},tt=()=>{var s;return((s=Rr())==null?void 0:s.lastTime)||0};class XU extends um{}class QU extends O_{}class Qi extends aU{}class cS extends cp{}class vr extends it{}class uS extends fi{}class ds extends bs{}class dp extends ys{}class $U extends oU{}const JU=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ZU=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`,kl=class extends cS{constructor(s,e=kl.CHANNEL_RED){super(JU,ZU),this._channel=e;let t=[];t=this.getLutForPalette(s),this._lut=QU.fromBuffer(Uint8Array.from(t),t.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(s){const e=[];for(let t=0;t<s.length;t++)e[t*4+kl.CHANNEL_RED]=s[t]>>16&255,e[t*4+kl.CHANNEL_GREEN]=s[t]>>8&255,e[t*4+kl.CHANNEL_BLUE]=s[t]&255,e[t*4+kl.CHANNEL_ALPHA]=s[t]>>24&255;return e}get lut(){return this._lut}get channel(){return this._channel}};let fc=kl;fc.CHANNEL_RED=0;fc.CHANNEL_GREEN=1;fc.CHANNEL_BLUE=2;fc.CHANNEL_ALPHA=3;const hS=class{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(s=>s==null?void 0:s.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(s){return s?this.writeToRenderTexture(new bs(ys.EMPTY),s):null}getTextureIdentifier(s,e,t){return`${t??hS.DEFAULT_PLANE_ID}:${s}:${e}`}createRenderTexture(s,e,t=null){if(s<0||e<0)return null;if(!t){const i=yn.create({width:s,height:e});return this.RENDER_TEXTURE_CACHE.push(i),i}t=this.getTextureIdentifier(s,e,t);let r=this.RENDER_TEXTURE_POOL.get(t);return r||(r=yn.create({width:s,height:e}),this.RENDER_TEXTURE_CACHE.push(r),this.RENDER_TEXTURE_POOL.set(t,r)),r}createAndFillRenderTexture(s,e,t=null,r=16777215){if(s<0||e<0)return null;const i=this.createRenderTexture(s,e,t);return this.clearAndFillRenderTexture(i,r)}createAndWriteRenderTexture(s,e,t,r=null,i=null){if(s<0||e<0)return null;const n=this.createRenderTexture(s,e,r);return this.writeToRenderTexture(t,n,!0,i)}clearAndFillRenderTexture(s,e=16777215){if(!s)return null;const t=new bs(ys.WHITE);return t.tint=e,t.width=s.width,t.height=s.height,this.writeToRenderTexture(t,s)}writeToRenderTexture(s,e,t=!0,r=null){return!s||!e?null:(this.getRenderer().render(s,{renderTexture:e,clear:t,transform:r}),e)}getPixels(s,e=null){return this.getExtractor().pixels(s)}getRenderer(){return sr.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}};let dS=hS;dS.DEFAULT_PLANE_ID="DEFAULT";class Lt{static generateTexture(e,t=null,r=null,i=1){return e?(r===null&&(r=C_.SCALE_MODE),this.getRenderer().generateTexture(e,{scaleMode:r,resolution:i,region:t})):null}static generateTextureFromImage(e){return e?ys.from(e):null}static generateImage(e){return e?this.getExtractor().image(e):null}static generateImageUrl(e){return e?this.getExtractor().base64(e):null}static generateCanvas(e){return e?this.getExtractor().canvas(e):null}static clearRenderTexture(e){return e?this.writeToRenderTexture(new bs(ys.EMPTY),e):null}static createRenderTexture(e,t){return e<0||t<0?null:yn.create({width:e,height:t})}static createAndFillRenderTexture(e,t,r=16777215){if(e<0||t<0)return null;const i=this.createRenderTexture(e,t);return this.clearAndFillRenderTexture(i,r)}static createAndWriteRenderTexture(e,t,r,i=null){if(e<0||t<0)return null;const n=this.createRenderTexture(e,t);return this.writeToRenderTexture(r,n,!0,i)}static clearAndFillRenderTexture(e,t=16777215){if(!e)return null;const r=new bs(ys.WHITE);return r.tint=t,r.width=e.width,r.height=e.height,this.writeToRenderTexture(r,e)}static writeToRenderTexture(e,t,r=!0,i=null){return!e||!t?null:(this.getRenderer().render(e,{renderTexture:t,clear:r,transform:i}),t)}static getPixels(e,t=null){return this.getExtractor().pixels(e)}static getRenderer(){return sr.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}const nu=class{static createAsset(s,e,t,r,i,n=!1,o=!1,l=!1){const c=nu.GRAPHIC_POOL.length?nu.GRAPHIC_POOL.pop():new nu;return c._name=s,c._source=e||null,t?(c._texture=t,c._initialized=!1):(c._texture=null,c._initialized=!0),c._usesPalette=l,c._x=r,c._y=i,c._flipH=n,c._flipV=o,c._rectangle=null,c}recycle(){this._texture=null,nu.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return Lt.generateImageUrl(new bs(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new fi(0,0,this.width,this.height)),this._rectangle}};let _S=nu;_S.GRAPHIC_POOL=[];class ex{constructor(e,t,r){for(this._palette=e;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=t,this._secondaryColor=r}dispose(){}applyPalette(e){var o,l;const t=Lt.createAndWriteRenderTexture(e.width,e.height,new bs(e)),r=Lt.getPixels(t);for(let c=0;c<r.length;c+=4){let h=this._palette[r[c+1]];h===void 0&&(h=[0,0,0]),r[c]=h[0],r[c+1]=h[1],r[c+2]=h[2]}const i=(o=t.baseTexture._glTextures[1])==null?void 0:o.texture,n=(l=sr.instance.renderer)==null?void 0:l.gl;return n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,r),n.bindTexture(n.TEXTURE_2D,null),t}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const gm=class{constructor(s,e){if(!s)throw new Error("invalid_collection");this._name=s.name,this._baseTexture=e&&e.baseTexture||null,this._data=s,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(s)}static removeFileExtension(s){return s.substring(0,s.lastIndexOf("."))||s}dispose(){if(this._palettes){for(const s of this._palettes.values())s.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const s of this._assets.values())s.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=tt()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=tt(),this.disposePaletteAssets(!1))}define(s){const e=s.assets,t=s.palettes;e&&this.defineAssets(e),t&&this.definePalettes(t)}defineAssets(s){if(s)for(const e in s){const t=s[e];if(!t)continue;const r=-t.x||0,i=-t.y||0;let n=!1;const o=!1,l=t.usesPalette||!1;let c=t.source||"";t.flipH&&c.length&&(n=!0),c.length||(c=e);const h=this.getLibraryAsset(c);if(!h)continue;let u=this.createAsset(e,c,h,n,o,r,i,l);if(!u){const g=this.getAsset(e);g&&g.name!==g.source&&(u=this.replaceAsset(e,c,h,n,o,r,i,l))}}}definePalettes(s){if(s)for(const e in s){const t=s[e];if(!t)continue;const r=t.id.toString();if(this._palettes.get(r))continue;let i=16777215,n=16777215,o=t.color1;o&&o.length>0&&(i=parseInt(o,16)),o=t.color2,o&&o.length>0&&(n=parseInt(o,16)),this._palettes.set(r,new ex(t.rgb,i,n))}}createAsset(s,e,t,r,i,n,o,l){if(this._assets.get(s))return!1;const c=_S.createAsset(s,e,t,n,o,r,i,l);return this._assets.set(s,c),!0}replaceAsset(s,e,t,r,i,n,o,l){const c=this._assets.get(s);return c&&(this._assets.delete(s),c.recycle()),this.createAsset(s,e,t,r,i,n,o,l)}getAsset(s){if(!s)return null;const e=this._assets.get(s);return e||null}getAssetWithPalette(s,e){const t=s+"@"+e;let r=this.getAsset(t);if(!r){if(r=this.getAsset(s),!r||!r.usesPalette)return r;const i=this.getPalette(e);if(i){const n=i.applyPalette(r.texture);n&&(this._paletteAssetNames.push(t),this.createAsset(t,r.source+"@"+e,n,r.flipH,r.flipV,r.x,r.y,!1),r=this.getAsset(t))}}return r}getTexture(s){return this._textures.get(s)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(s){const e=this.getPalette(s);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(s){if(!s)return null;const e=this._palettes.get(s);return e||null}addAsset(s,e,t,r=0,i=0,n=!1,o=!1){if(!s||!e)return!1;const l=this.getLibraryAsset(s);return l?t?(l.baseTexture=e.baseTexture,l.frame=e.frame,l.trim=e.trim,l.updateUvs(),!0):!1:(this._textures.set(s,e),this.createAsset(s,s,e,n,o,r,i,!1))}disposeAsset(s){const e=this._assets.get(s);if(!e)return;this._assets.delete(s);const t=this.getLibraryAsset(e.source);t&&(this._textures.delete(e.source),t.destroy(!0)),e.recycle()}getLibraryAsset(s){if(!s)return null;s=this._name+"_"+s;const e=this._textures.get(s);return e||null}addLibraryAsset(s){if(s)for(const e in s){const t=s[e];t&&this._textures.set(gm.removeFileExtension(e),t)}}disposePaletteAssets(s=!0){if(this._paletteAssetNames&&(s||this._paletteAssetNames.length>gm.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const e of this._paletteAssetNames)this.disposeAsset(e);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};let _p=gm;_p.PALETTE_ASSET_DISPOSE_THRESHOLD=10;const gS=class{constructor(){this._textures=new Map,this._collections=new Map}getTexture(s){if(!s)return null;const e=this._textures.get(s);return e||null}setTexture(s,e){!s||!e||this._textures.set(s,e)}getAsset(s){if(!s)return null;for(const e of this._collections.values()){if(!e)continue;const t=e.getAsset(s);if(t)return t}return null}getCollection(s){if(!s)return null;const e=this._collections.get(s);return e||null}createCollection(s,e){if(!s)return null;const t=new _p(s,e);if(t){for(const[r,i]of t.textures.entries())this.setTexture(r,i);this._collections.set(t.name,t)}return t}async downloadAsset(s){return await this.downloadAssets([s])}async downloadAssets(s){if(!s||!s.length)return Promise.resolve(!0);try{for(const e of s){const t=await fetch(e);if(t.status!==200)continue;let r="application/octet-stream";switch(t.headers.has("Content-Type")&&(r=t.headers.get("Content-Type")),r){case"application/octet-stream":{const i=await t.arrayBuffer(),n=new vo(i);await this.processAsset(n.baseTexture,n.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const i=await t.arrayBuffer(),n=oS(i),o=O_.from(`data:${r};base64,${n}`),l=async()=>{const c=new ys(o);this.setTexture(e,c)};o.valid?await l():await new Promise((c,h)=>{o.once("update",async()=>(await l(),c()))});break}}}return Promise.resolve(!0)}catch(e){return xe.error(e),Promise.resolve(!1)}}async processAsset(s,e){const t=e.spritesheet;if(!s||!t||!Object.keys(t).length){this.createCollection(e,null);return}const r=async()=>{const i=new XR(s,t);await i.parse(),this.createCollection(e,i)};s.valid?await r():await new Promise((i,n)=>{s.once("update",async()=>(await r(),i()))})}get collections(){return this._collections}};let mS=gS;mS._INSTANCE=new gS;const di=()=>mS._INSTANCE;class tx{constructor(e,t,r){this.name=e,this.textures=t,this.durations=r}}class gp{}gp.UNKNOWN=0;gp.BROWSER=1;class v_{}v_.UNKNOWN=0;v_.FLASH=1;v_.HTML5=2;class zi{}zi.CONNECTION_OPENED="open";zi.CONNECTION_CLOSED="close";zi.CONNECTION_ERROR="error";zi.CONNECTION_MESSAGE="message";const Es=class{static getExpressionTimeout(s){switch(s=parseInt(s),s){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(s){return Es.EXPRESSION_MAP.indexOf(s)}static getExpression(s){return s>Es.EXPRESSION_MAP.length?null:Es.EXPRESSION_MAP[s]}static getGestureId(s){return Es.GESTURE_MAP.indexOf(s)}static getGesture(s){return s>Es.GESTURE_MAP.length?null:Es.GESTURE_MAP[s]}static idToAvatarActionState(s){return s==="Lay"?"lay":s==="Float"?"float":s==="Swim"?"swim":s==="Sit"?"sit":s==="Respect"?"respect":s==="Wave"?"wave":s==="Idle"?"idle":s==="Dance"?"dance":s==="UseItem"?"usei":s==="CarryItem"?"cri":s==="Talk"?"talk":s==="Sleep"?"Sleep":s==="Move"?"mv":"std"}};let he=Es;he.CARRY_OBJECT="cri";he.DANCE="dance";he.EFFECT="fx";he.EXPRESSION="expression";he.EXPRESSION_BLOW_A_KISS="blow";he.EXPRESSION_CRY="cry";he.EXPRESSION_IDLE="idle";he.EXPRESSION_LAUGH="laugh";he.EXPRESSION_RESPECT="respect";he.EXPRESSION_RIDE_JUMP="ridejump";he.EXPRESSION_SNOWBOARD_OLLIE="sbollie";he.EXPRESSION_SNOWBORD_360="sb360";he.EXPRESSION_WAVE="wave";he.GESTURE="gest";he.GESTURE_AGGRAVATED="agr";he.GESTURE_SAD="sad";he.GESTURE_SMILE="sml";he.GESTURE_SURPRISED="srp";he.GUIDE_STATUS="guide";he.MUTED="muted";he.PET_GESTURE_BLINK="eyb";he.PET_GESTURE_CRAZY="crz";he.PET_GESTURE_JOY="joy";he.PET_GESTURE_MISERABLE="mis";he.PET_GESTURE_PUZZLED="puz";he.PET_GESTURE_TONGUE="tng";he.PLAYING_GAME="playing_game";he.POSTURE="posture";he.POSTURE_FLOAT="float";he.POSTURE_LAY="lay";he.POSTURE_SIT="sit";he.POSTURE_STAND="std";he.POSTURE_SWIM="swim";he.POSTURE_WALK="mv";he.SIGN="sign";he.SLEEP="sleep";he.SNOWWAR_DIE_BACK="swdieback";he.SNOWWAR_DIE_FRONT="swdiefront";he.SNOWWAR_PICK="swpick";he.SNOWWAR_RUN="swrun";he.SNOWWAR_THROW="swthrow";he.TALK="talk";he.BLINK="blink";he.TYPING="typing";he.USE_OBJECT="usei";he.VOTE="vote";he.GESTURE_MAP=["",Es.GESTURE_SMILE,Es.GESTURE_AGGRAVATED,Es.GESTURE_SURPRISED,Es.GESTURE_SAD,Es.PET_GESTURE_JOY,Es.PET_GESTURE_CRAZY,Es.PET_GESTURE_TONGUE,Es.PET_GESTURE_BLINK,Es.PET_GESTURE_MISERABLE,Es.PET_GESTURE_PUZZLED];he.EXPRESSION_MAP=["",Es.EXPRESSION_WAVE,Es.EXPRESSION_BLOW_A_KISS,Es.EXPRESSION_LAUGH,Es.EXPRESSION_CRY,Es.EXPRESSION_IDLE,Es.DANCE,Es.EXPRESSION_RESPECT,Es.EXPRESSION_SNOWBOARD_OLLIE,Es.EXPRESSION_SNOWBORD_360,Es.EXPRESSION_RIDE_JUMP];class _i{}_i.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0];_i.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1];_i.MIN_DIRECTION=0;_i.MAX_DIRECTION=7;class Br{}Br.GENERIC="hd";Br.HEAD="head";Br.TORSO="torso";Br.LEGS="legs";Br.HOTLOOKS="hotlooks";Br.WARDROBE="wardrobe";Br.EFFECTS="effects";const ai=class{};let We=ai;We.BODY="bd";We.SHOES="sh";We.LEGS="lg";We.CHEST="ch";We.WAIST_ACCESSORY="wa";We.CHEST_ACCESSORY="ca";We.HEAD="hd";We.HAIR="hr";We.FACE_ACCESSORY="fa";We.EYE_ACCESSORY="ea";We.HEAD_ACCESSORY="ha";We.HEAD_ACCESSORY_EXTRA="he";We.COAT_CHEST="cc";We.CHEST_PRINT="cp";We.LEFT_HAND_ITEM="li";We.LEFT_HAND="lh";We.LEFT_SLEEVE="ls";We.RIGHT_HAND="rh";We.RIGHT_SLEEVE="rs";We.FACE="fc";We.EYES="ey";We.HAIR_BIG="hrb";We.RIGHT_HAND_ITEM="ri";We.LEFT_COAT_SLEEVE="lc";We.RIGHT_COAT_SLEEVE="rc";We.FIGURE_SETS=[ai.SHOES,ai.LEGS,ai.CHEST,ai.WAIST_ACCESSORY,ai.CHEST_ACCESSORY,ai.HEAD,ai.HAIR,ai.FACE_ACCESSORY,ai.EYE_ACCESSORY,ai.HEAD_ACCESSORY,ai.HEAD_ACCESSORY_EXTRA,ai.COAT_CHEST,ai.CHEST_PRINT];class Tn{}Tn.NONE=0;Tn.GUIDE=1;Tn.REQUESTER=2;class yi{}yi.LARGE="h";yi.SMALL="sh";class lr{}lr.FULL="full";lr.HEAD="head";lr.BODY="body";class Rn{}Rn.VERTICAL="vertical";Rn.SITTING="sitting";Rn.HORIZONTAL="horizontal";Rn.SWIM="swim";Rn.SNOWWARS_HORIZONTAL="swhorizontal";class ht{}ht.DOG=0;ht.CAT=1;ht.CROCODILE=2;ht.TERRIER=3;ht.BEAR=4;ht.PIG=5;ht.LION=6;ht.RHINO=7;ht.SPIDER=8;ht.TURTLE=9;ht.CHICKEN=10;ht.FROG=11;ht.DRAGON=12;ht.MONSTER=13;ht.MONKEY=14;ht.HORSE=15;ht.MONSTERPLANT=16;ht.BUNNY=17;ht.BUNNYEVIL=18;ht.BUNNYDEPRESSED=19;ht.BUNNYLOVE=20;ht.PIGEONGOOD=21;ht.PIGEONEVIL=22;ht.DEMONMONKEY=23;ht.BABYBEAR=24;ht.BABYTERRIER=25;ht.GNOME=26;ht.LEPRECHAUN=27;ht.KITTENBABY=28;ht.PUPPYBABY=29;ht.PIGLETNBABY=30;ht.HALOOMPA=31;ht.FOOLS=32;ht.PTEROSAUR=33;ht.VELOCIRAPTOR=34;class Jr{}Jr.NONE=0;Jr.HEART=1;Jr.SMILE=2;Jr.BOBBA=3;Jr.RELATIONSHIP_TYPES=[0,1,2,3];Jr.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];class xa{}xa.HOTEL_VIEW="hotel_view";xa.HOME_ROOM="home_room";xa.NAVIGATOR="navigator";xa.CATALOG="catalog";xa.INVENTORY="inventory";xa.ME_MENU="me_menu";xa.FRIEND_LIST="friendlist";class Tl{}Tl.LOVE_LOCK=0;Tl.CARVE_A_TREE=1;Tl.FRIENDS_PORTRAIT=2;Tl.WILD_WEST_WANTED=3;Tl.HABBOWEEN=4;class Co{}Co.CATALOG="catalog";Co.INVENTORY="inventory";class b{}b.OBJECT_ROOM_ID="object_room_id";b.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value";b.TILE_CURSOR_HEIGHT="tile_cursor_height";b.FIGURE="figure";b.GENDER="gender";b.OWN_USER="own_user";b.FIGURE_CAN_STAND_UP="figure_can_stand_up";b.FIGURE_VERTICAL_OFFSET="figure_vertical_offset";b.FIGURE_TALK="figure_talk";b.FIGURE_DANCE="figure_dance";b.FIGURE_SLEEP="figure_sleep";b.FIGURE_BLINK="figure_blink";b.FIGURE_EFFECT="figure_effect";b.FIGURE_CARRY_OBJECT="figure_carry_object";b.FIGURE_USE_OBJECT="figure_use_object";b.FIGURE_GESTURE="figure_gesture";b.FIGURE_POSTURE="figure_posture";b.FIGURE_POSTURE_PARAMETER="figure_posture_parameter";b.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable";b.FIGURE_HIGHLIGHT="figure_highlight";b.FIGURE_FOCUS_ALPHA="figure_focus_alpha";b.FURNITURE_PURCHASER_NAME="furniture_purchaser_name";b.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure";b.STD="std";b.FIGURE_SIGN="figure_sign";b.FIGURE_FLAT_CONTROL="figure_flat_control";b.FIGURE_IS_TYPING="figure_is_typing";b.FIGURE_IS_MUTED="figure_is_muted";b.FIGURE_GAINED_EXPERIENCE="figure_gained_experience";b.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp";b.FIGURE_NUMBER_VALUE="figure_number_value";b.FIGURE_IS_PLAYING_GAME="figure_is_playing_game";b.FIGURE_GUIDE_STATUS="figure_guide_status";b.FIGURE_EXPRESSION="figure_expression";b.HEAD_DIRECTION="head_direction";b.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables";b.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index";b.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable";b.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation";b.FURNITURE_DATA_FORMAT="furniture_data_format";b.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number";b.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size";b.FURNITURE_CRACKABLE_STATE="furniture_crackable_state";b.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits";b.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target";b.FURNITURE_CREDIT_VALUE="furniture_credit_value";b.FURNITURE_DATA="furniture_data";b.FURNITURE_ITEMDATA="furniture_itemdata";b.FURNITURE_COLOR="furniture_color";b.FURNITURE_LIFT_AMOUNT="furniure_lift_amount";b.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id";b.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name";b.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1";b.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2";b.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time";b.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled";b.FURNITURE_SIZE_X="furniture_size_x";b.FURNITURE_SIZE_Y="furniture_size_y";b.FURNITURE_SIZE_Z="furniture_size_z";b.FURNITURE_CENTER_X="furniture_center_x";b.FURNITURE_CENTER_Y="furniture_center_y";b.FURNITURE_CENTER_Z="furniture_center_z";b.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions";b.FURNITURE_AD_URL="furniture_ad_url";b.FURNITURE_TYPE_ID="furniture_type_id";b.FURNITURE_EXTRAS="furniture_extras";b.FURNITURE_EXPIRY_TIME="furniture_expiry_time";b.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp";b.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object";b.FURNITURE_IS_STICKIE="furniture_is_stickie";b.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status";b.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url";b.FURNITURE_BRANDING_URL="furniture_branding_url";b.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x";b.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y";b.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z";b.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated";b.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status";b.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name";b.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state";b.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier";b.FURNITURE_USAGE_POLICY="furniture_usage_policy";b.FURNITURE_OWNER_ID="furniture_owner_id";b.FURNITURE_OWNER_NAME="furniture_owner_name";b.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue";b.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation";b.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness";b.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask";b.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type";b.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height";b.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result";b.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count";b.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed";b.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name";b.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender";b.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure";b.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type";b.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type";b.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count";b.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_";b.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_";b.FURNITURE_INTERNAL_LINK="furniture_internal_link";b.FURNITURE_CLOTHING_BOY="furniture_clothing_boy";b.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl";b.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data";b.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data";b.PET_PALETTE_INDEX="pet_palette_index";b.PET_COLOR="pet_color";b.PET_HEAD_ONLY="pet_head_only";b.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids";b.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids";b.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids";b.PET_IS_RIDING="pet_is_riding";b.PET_TYPE="pet_type";b.PET_ALLOWED_DIRECTIONS="pet_allowed_directions";b.RACE="race";b.ROOM_MAP_DATA="room_map_data";b.ROOM_PLANE_MASK_XML="room_plane_mask_xml";b.ROOM_FLOOR_TYPE="room_floor_type";b.ROOM_WALL_TYPE="room_wall_type";b.ROOM_LANDSCAPE_TYPE="room_landscape_type";b.ROOM_WALL_THICKNESS="room_wall_thickness";b.ROOM_FLOOR_THICKNESS="room_floor_thickness";b.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time";b.ROOM_FLOOR_VISIBILITY="room_floor_visibility";b.ROOM_WALL_VISIBILITY="room_wall_visibility";b.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility";b.ROOM_DOOR_X="room_door_x";b.ROOM_DOOR_Y="room_door_y";b.ROOM_DOOR_Z="room_door_z";b.ROOM_DOOR_DIR="room_door_dir";b.ROOM_BACKGROUND_COLOR="room_background_color";b.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only";b.ROOM_RANDOM_SEED="room_random_seed";b.ROOM_WORLD_TYPE="room_world_type";b.ROOM_SELECTED_X="room_selected_x";b.ROOM_SELECTED_Y="room_selected_y";b.ROOM_SELECTED_Z="room_selected_z";b.ROOM_SELECTED_PLANE="room_selected_plane";b.IMAGE_QUERY_SCALE="image_query_scale";b.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type";b.SESSION_URL_PREFIX="session_url_prefix";b.SESSION_CURRENT_USER_ID="session_current_user_id";class fS{}fS.UNIQUE_SET=256;class Mo{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(e){(this._flags&fS.UNIQUE_SET)>0&&(this._uniqueNumber=e.readInt(),this._uniqueSeries=e.readInt())}initializeFromRoomObjectModel(e){this._uniqueNumber=e.getValue(b.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=e.getValue(b.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(e){e&&(e.setValue(b.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),e.setValue(b.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(e){return!1}get state(){const e=parseInt(this.getLegacyString());return isNaN(e)?0:e}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(e){this._uniqueNumber=e}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(e){this._uniqueSeries=e}get rarityLevel(){return-1}get flags(){return this._flags}set flags(e){this._flags=e}}class zr{}zr.LEGACY_KEY=0;zr.MAP_KEY=1;zr.STRING_KEY=2;zr.VOTE_KEY=3;zr.EMPTY_KEY=4;zr.NUMBER_KEY=5;zr.HIGHSCORE_KEY=6;zr.CRACKABLE_KEY=7;const pS=class extends Mo{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(s){s&&(this._state=s.readString(),this._hits=s.readInt(),this._target=s.readInt(),super.parseWrapper(s))}initializeFromRoomObjectModel(s){super.initializeFromRoomObjectModel(s),this._state=s.getValue(b.FURNITURE_CRACKABLE_STATE),this._hits=s.getValue(b.FURNITURE_CRACKABLE_HITS),this._target=s.getValue(b.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,pS.FORMAT_KEY),s.setValue(b.FURNITURE_CRACKABLE_STATE,this._state),s.setValue(b.FURNITURE_CRACKABLE_HITS,this._hits),s.setValue(b.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(s){return!0}get hits(){return this._hits}get target(){return this._target}};let mm=pS;mm.FORMAT_KEY=zr.CRACKABLE_KEY;const ES=class extends Mo{parseWrapper(s){s&&(this._state="",super.parseWrapper(s))}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,ES.FORMAT_KEY)}getLegacyString(){return this._state}compare(s){return super.compare(s)}};let fm=ES;fm.FORMAT_KEY=zr.EMPTY_KEY;class zI{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(e){this._score=e}get users(){return this._users}set users(e){this._users=e}addUsername(e){this._users.push(e)}}const IS=class extends Mo{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(s){if(!s)return;this._state=s.readString(),this._scoreType=s.readInt(),this._clearType=s.readInt();let e=s.readInt();for(;e>0;){const t=new zI;t.score=s.readInt();let r=s.readInt();for(;r>0;)t.addUsername(s.readString()),r--;this._entries.push(t),e--}super.parseWrapper(s)}initializeFromRoomObjectModel(s){this._scoreType=s.getValue(b.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=s.getValue(b.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=s.getValue(b.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let t=0;for(;t<e;){const r=new zI;r.score=s.getValue(b.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+t),r.users=s.getValue(b.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+t),this._entries.push(r),t++}super.initializeFromRoomObjectModel(s)}writeRoomObjectModel(s){if(super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,IS.FORMAT_KEY),s.setValue(b.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),s.setValue(b.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){s.setValue(b.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let e=0;for(;e<this._entries.length;){const t=this._entries[e];s.setValue(b.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+e,t.score),s.setValue(b.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+e,t.users),e++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};let pm=IS;pm.FORMAT_KEY=zr.HIGHSCORE_KEY;const TS=class extends Mo{constructor(){super(),this._data=""}parseWrapper(s){s&&(this._data=s.readString(),super.parseWrapper(s))}initializeFromRoomObjectModel(s){super.initializeFromRoomObjectModel(s),this._data=s.getValue(b.FURNITURE_DATA)}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,TS.FORMAT_KEY),s.setValue(b.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(s){return this._data===s.getLegacyString()}setString(s){this._data=s}};let ei=TS;ei.FORMAT_KEY=zr.LEGACY_KEY;const od=class extends Mo{constructor(){super(),this._data={}}parseWrapper(s){if(!s)return;this._data={};const e=s.readInt();if(e)for(let t=0;t<e;t++)this._data[s.readString()]=s.readString();super.parseWrapper(s)}initializeFromRoomObjectModel(s){super.initializeFromRoomObjectModel(s),this._data=s.getValue(b.FURNITURE_DATA)||{}}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,od.FORMAT_KEY),s.setValue(b.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const s=this._data[od.STATE];return s??""}compare(s){return!1}getValue(s){return this._data[s]}get rarityLevel(){if(!this._data)return-1;const s=this._data[od.RARITY];return s==null?-1:parseInt(s)}get data(){return this._data}};let Ao=od;Ao.FORMAT_KEY=zr.MAP_KEY;Ao.STATE="state";Ao.RARITY="rarity";const ld=class extends Mo{constructor(){super(),this._data=[]}parseWrapper(s){if(!s)return;this._data=[];const e=s.readInt();if(e)for(let t=0;t<e;t++)this._data.push(s.readInt());super.parseWrapper(s)}initializeFromRoomObjectModel(s){super.initializeFromRoomObjectModel(s),this._data=s.getValue(b.FURNITURE_DATA)}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,ld.FORMAT_KEY),s.setValue(b.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[ld.STATE].toString()}compare(s){if(!(s instanceof ld))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==s.getValue(e))return!1}e++}return!0}getValue(s){if(!this._data||!this._data.length)return-1;const e=this._data[s];return e??-1}};let Lu=ld;Lu.FORMAT_KEY=zr.NUMBER_KEY;Lu.STATE=0;const cd=class extends Mo{constructor(){super(),this._data=[]}parseWrapper(s){if(!s)return;this._data=[];const e=s.readInt();if(e)for(let t=0;t<e;t++)this._data.push(s.readString());super.parseWrapper(s)}initializeFromRoomObjectModel(s){super.initializeFromRoomObjectModel(s),this._data=s.getValue(b.FURNITURE_DATA)}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,cd.FORMAT_KEY),s.setValue(b.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[cd.STATE]}compare(s){if(!(s instanceof cd))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==s.getValue(e))return!1}e++}return!0}getValue(s){return this._data[s]||""}setValue(s){this._data=s}};let vn=cd;vn.FORMAT_KEY=zr.STRING_KEY;vn.STATE=0;const RS=class extends Mo{constructor(){super(),this._state="",this._result=0}parseWrapper(s){s&&(this._state=s.readString(),this._result=s.readInt(),super.parseWrapper(s))}writeRoomObjectModel(s){super.writeRoomObjectModel(s),s.setValue(b.FURNITURE_DATA_FORMAT,RS.FORMAT_KEY);const e={};e.S=this._state,e.R=this._result.toString(),s.setValue(b.FURNITURE_DATA,e)}getLegacyString(){return this._state}compare(s){return!0}setString(s){this._state=s}get result(){return this._result}};let vd=RS;vd.FORMAT_KEY=zr.VOTE_KEY;class $n{static getData(e){let t=null;switch(e&255){case mm.FORMAT_KEY:t=new mm;break;case fm.FORMAT_KEY:t=new fm;break;case pm.FORMAT_KEY:t=new pm;break;case ei.FORMAT_KEY:t=new ei;break;case Ao.FORMAT_KEY:t=new Ao;break;case Lu.FORMAT_KEY:t=new Lu;break;case vn.FORMAT_KEY:t=new vn;break;case vd.FORMAT_KEY:t=new vd;break}return t?(t.flags=e&65280,t):null}}class z{}z.MINIMUM=-2;z.ROOM=0;z.FLOOR=10;z.WALL=20;z.UNIT=100;z.CURSOR=200;class le{}le.FURNITURE_BASIC="furniture_basic";le.FURNITURE_MULTISTATE="furniture_multistate";le.FURNITURE_MULTIHEIGHT="furniture_multiheight";le.FURNITURE_RANDOMSTATE="furniture_randomstate";le.FURNITURE_PLACEHOLDER="furniture_placeholder";le.FURNITURE_CREDIT="furniture_credit";le.FURNITURE_STICKIE="furniture_stickie";le.FURNITURE_PRESENT="furniture_present";le.FURNITURE_TROPHY="furniture_trophy";le.FURNITURE_ECOTRON_BOX="furniture_ecotron_box";le.FURNITURE_DICE="furniture_dice";le.FURNITURE_HOCKEY_SCORE="furniture_hockey_score";le.FURNITURE_HABBOWHEEL="furniture_habbowheel";le.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door";le.FURNITURE_PLANET_SYSTEM="furniture_planet_system";le.FURNITURE_WINDOW="furniture_window";le.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem";le.FURNITURE_ROOMDIMMER="furniture_roomdimmer";le.FURNITURE_SOUND_MACHINE="furniture_sound_machine";le.FURNITURE_JUKEBOX="furniture_jukebox";le.FURNITURE_CRACKABLE="furniture_crackable";le.FURNITURE_PUSHABLE="furniture_pushable";le.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change";le.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";le.FURNITURE_SCORE="furniture_score";le.FURNITURE_ES="furniture_es";le.FURNITURE_FIREWORKS="furniture_fireworks";le.FURNITURE_SONG_DISK="furniture_song_disk";le.FURNITURE_BB="furniture_bb";le.FURNITURE_BG="furniture_bg";le.FURNITURE_WELCOME_GIFT="furniture_welcome_gift";le.FURNITURE_FLOOR_HOLE="furniture_floor_hole";le.FURNITURE_MANNEQUIN="furniture_mannequin";le.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";le.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal";le.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization";le.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock";le.FURNITURE_VOTE_COUNTER="furniture_vote_counter";le.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";le.FURNITURE_SOUNDBLOCK="furniture_soundblock";le.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport";le.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed";le.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing";le.FURNITURE_BACKGROUND_COLOR="furniture_background_color";le.FURNITURE_MYSTERYBOX="furniture_mysterybox";le.FURNITURE_EFFECTBOX="furniture_effectbox";le.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy";le.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution";le.FURNITURE_LOVELOCK="furniture_lovelock";le.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted";le.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock";le.FURNITURE_BADGE_DISPLAY="furniture_badge_display";le.FURNITURE_HIGH_SCORE="furniture_high_score";le.FURNITURE_INTERNAL_LINK="furniture_internal_link";le.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height";le.FURNITURE_YOUTUBE="furniture_youtube";le.FURNITURE_RENTABLE_SPACE="furniture_rentable_space";le.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on";le.FURNITURE_VIMEO="furniture_vimeo";le.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link";le.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link";le.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo";le.ROOM="room";le.USER="user";le.BOT="bot";le.RENTABLE_BOT="rentable_bot";le.PET="pet";le.TILE_CURSOR="tile_cursor";le.SELECTION_ARROW="selection_arrow";le.GAME_SNOWBALL="game_snowball";le.GAME_SNOWSPLASH="game_snowsplash";class Qe{}Qe.OBJECT_UNDEFINED="OBJECT_UNDEFINED";Qe.OBJECT_MOVE="OBJECT_MOVE";Qe.OBJECT_PLACE="OBJECT_PLACE";Qe.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE";Qe.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE";Qe.OBJECT_MOVE_TO="OBJECT_MOVE_TO";Qe.OBJECT_PLACE_TO="OBJECT_PLACE_TO";Qe.OBJECT_PICKUP="OBJECT_PICKUP";Qe.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT";Qe.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET";Qe.OBJECT_EJECT="OBJECT_EJECT";Qe.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";class jt{}jt.USER=1;jt.PET=2;jt.BOT=3;jt.RENTABLE_BOT=4;const zo=class{static getTypeNumber(s){return zo.AVATAR_TYPES[s]}static getTypeString(s){for(const e in zo.AVATAR_TYPES)if(e&&zo.AVATAR_TYPES[e]===s)return e;return null}static getRealType(s){switch(s){case zo.BOT:case zo.RENTABLE_BOT:return zo.USER;default:return s}}};let gt=zo;gt.USER="user";gt.PET="pet";gt.BOT="bot";gt.RENTABLE_BOT="rentable_bot";gt.MONSTER_PLANT="monsterplant";gt.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};class pe{}pe.FURNITURE_STATIC="furniture_static";pe.FURNITURE_ANIMATED="furniture_animated";pe.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated";pe.FURNITURE_POSTER="furniture_poster";pe.FURNITURE_EXTERNAL_IMAGE="furniture_external_image";pe.FURNITURE_HABBOWHEEL="furniture_habbowheel";pe.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer";pe.FURNITURE_BOTTLE="furniture_bottle";pe.FURNITURE_PLANET_SYSTEM="furniture_planet_system";pe.FURNITURE_QUEUE_TILE="furniture_queue_tile";pe.FURNITURE_PARTY_BEAMER="furniture_party_beamer";pe.FURNITURE_CUBOID="furniture_cuboid";pe.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped";pe.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks";pe.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";pe.FURNITURE_WATER_AREA="furniture_water_area";pe.FURNITURE_SCORE_BOARD="furniture_score_board";pe.FURNITURE_FIREWORKS="furniture_fireworks";pe.FURNITURE_BB="furniture_bb";pe.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb";pe.FURNITURE_BG="furniture_bg";pe.FURNITURE_STICKIE="furniture_stickie";pe.FURNITURE_MANNEQUIN="furniture_mannequin";pe.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";pe.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge";pe.FURNITURE_VOTE_COUNTER="furniture_vote_counter";pe.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";pe.FURNITURE_SOUNDBLOCK="furniture_soundblock";pe.FURNITURE_BADGE_DISPLAY="furniture_badge_display";pe.FURNITURE_YOUTUBE="furniture_youtube";pe.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder";pe.ROOM="room";pe.USER="user";pe.PET_ANIMATED="pet_animated";pe.BOT="bot";pe.RENTABLE_BOT="rentable_bot";pe.TILE_CURSOR="tile_cursor";class Oa{constructor(e,t,r,i=null){this._id=e,this._location=t,this._targetLocation=r,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}Oa.MOVE="mv";Oa.SLIDE="sld";class mp{}mp.KICKED_OUT_OF_ROOM=4008;mp.STRIP_LOCKED_FOR_TRADING=-13001;class hc{}hc.OLD_IDENTITY=0;hc.NEW_IDENTITY=1;hc.REAL_NOOB=2;class Rt{}Rt.NONE=0;Rt.GUEST=1;Rt.GUILD_MEMBER=2;Rt.GUILD_ADMIN=3;Rt.ROOM_OWNER=4;Rt.MODERATOR=5;const ud=class{static getLocalizationKey(s){switch(s){case ud.FREE_TRADING:return"${trading.mode.free}";case ud.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case ud.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};let cl=ud;cl.NO_TRADING=0;cl.ROOM_CONTROLLER_REQUIRED=1;cl.FREE_TRADING=2;class ii{}ii.SUPER_USER=9;ii.ADMINISTRATOR=8;ii.COMMUNITY=7;ii.PLAYER_SUPPORT=6;ii.MODERATOR=5;ii.EMPLOYEE=4;ii.BUS_PARTNER=3;ii.PARTNER=2;ii.CELEBRITY=1;ii.NONE=0;var sl=(s=>(s.FLOOR="S",s.WALL="I",s.EFFECT="E",s.BADGE="B",s.ROBOT="R",s.HABBO_CLUB="H",s.PET="P",s))(sl||{});class vi{}vi.MATCH_ALL_PIXELS=-1;vi.MATCH_OPAQUE_PIXELS=128;vi.MATCH_NOTHING=256;class $r{}$r.DEFAULT=1;$r.ROOM_PLANE=2;$r.AVATAR=3;$r.AVATAR_OWN=4;class SS{}class G{constructor(e=0,t=0,r=0){this._x=e,this._y=t,this._z=r,this._length=NaN}static sum(e,t){return!e||!t?null:new G(e.x+t.x,e.y+t.y,e.z+t.z)}static dif(e,t){return!e||!t?null:new G(e.x-t.x,e.y-t.y,e.z-t.z)}static product(e,t){return e?new G(e.x*t,e.y*t,e.z*t):null}static dotProduct(e,t){return!e||!t?0:e.x*t.x+e.y*t.y+e.z*t.z}static crossProduct(e,t){return!e||!t?null:new G(e.y*t.z-e.z*t.y,e.z*t.x-e.x*t.z,e.x*t.y-e.y*t.x)}static scalarProjection(e,t){if(!e||!t)return-1;const r=t.length;return r>0?(e.x*t.x+e.y*t.y+e.z*t.z)/r:-1}static cosAngle(e,t){if(!e||!t)return 0;const r=e.length*t.length;return r?G.dotProduct(e,t)/r:0}static isEqual(e,t){return!(!e||!t||e.x!==t.x||e.y!==t.y||e.z!==t.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(e){e&&(this._x+=e.x,this._y+=e.y,this._z+=e.z,this._length=NaN)}subtract(e){e&&(this._x-=e.x,this._y-=e.y,this._z-=e.z,this._length=NaN)}multiply(e){this._x*=e,this._y*=e,this._z*=e,this._length=NaN}divide(e){e&&(this._x/=e,this._y/=e,this._z/=e,this._length=NaN)}assign(e){e&&(this._x=e.x,this._y=e.y,this._z=e.z,this._length=NaN)}get x(){return this._x}set x(e){this._x=e,this._length=NaN}get y(){return this._y}set y(e){this._y=e,this._length=NaN}get z(){return this._z}set z(e){this._z=e,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}class fe{}fe.MOUSE_CLICK="click";fe.DOUBLE_CLICK="double_click";fe.MOUSE_MOVE="mousemove";fe.MOUSE_DOWN="mousedown";fe.MOUSE_DOWN_LONG="mousedown_long";fe.MOUSE_UP="mouseup";fe.ROLL_OVER="mouseover";fe.ROLL_OUT="mouseout";fe.RIGHT_CLICK="contextmenu";class Ir{}Ir.TOUCH_START="touchstart";Ir.TOUCH_MOVE="touchmove";Ir.TOUCH_CANCEL="touchcancel";Ir.TOUCH_END="touchend";Ir.TOUCH_LONG="touchlong";const Ba=class{constructor(s){this._ordinal=s}get ordinal(){return this._ordinal}equals(s){return s&&s._ordinal==this._ordinal}};let Tr=Ba;Tr.NONE=new Ba(0);Tr.WAVE=new Ba(1);Tr.BLOW=new Ba(2);Tr.LAUGH=new Ba(3);Tr.CRY=new Ba(4);Tr.IDLE=new Ba(5);Tr.JUMP=new Ba(6);Tr.RESPECT=new Ba(7);class Wt{}Wt.DUMMY="DUMMY";Wt.FRIEND_FURNITURE="FRIEND_FURNITURE";Wt.MONSTERPLANT_SEED="MONSTERPLANT_SEED";Wt.MYSTERY_BOX="MYSTERY_BOX";Wt.EFFECT_BOX="EFFECT_BOX";Wt.MYSTERY_TROPHY="MYSTERY_TROPHY";Wt.RANDOM_TELEPORT="RANDOM_TELEPORT";Wt.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING";Wt.GENERIC_USABLE="GENERIC_USABLE";class et{}et.CHAT_WIDGET="RWE_CHAT_WIDGET";et.INFOSTAND="RWE_INFOSTAND";et.ME_MENU="RWE_ME_MENU";et.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET";et.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER";et.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET";et.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET";et.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET";et.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET";et.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET";et.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET";et.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET";et.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET";et.DOORBELL="RWE_DOORBELL";et.LOADINGBAR="RWE_LOADINGBAR";et.ROOM_QUEUE="RWE_ROOM_QUEUE";et.ROOM_POLL="RWE_ROOM_POLL";et.ROOM_VOTE="RWE_ROOM_VOTE";et.USER_CHOOSER="RWE_USER_CHOOSER";et.FURNI_CHOOSER="RWE_FURNI_CHOOSER";et.ROOM_DIMMER="RWE_ROOM_DIMMER";et.FRIEND_REQUEST="RWE_FRIEND_REQUEST";et.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE";et.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING";et.USER_NOTIFICATION="RWE_USER_NOTIFICATION";et.FRIENDS_BAR="RWE_FRIENDS_BAR";et.PURSE_WIDGET="RWE_PURSE_WIDGET";et.AVATAR_INFO="RWE_AVATAR_INFO";et.WELCOME_GIFT="RWE_WELCOME_GIFT";et.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET";et.EFFECTS="RWE_EFFECTS";et.MANNEQUIN="RWE_MANNEQUIN";et.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU";et.LOCATION_WIDGET="RWE_LOCATION_WIDGET";et.CAMERA="RWE_CAMERA";et.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA";et.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR";et.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION";et.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING";et.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM";et.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING";et.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY";et.INTERNAL_LINK="RWE_INTERNAL_LINK";et.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT";et.YOUTUBE="RWE_YOUTUBE";et.RENTABLESPACE="RWE_RENTABLESPACE";et.VIMEO="RWE_VIMEO";et.ROOM_TOOLS="RWE_ROOM_TOOLS";et.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE";et.WORD_QUIZZ="RWE_WORD_QUIZZ";et.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE";et.ROOM_LINK="RWE_ROOM_LINK";et.CRAFTING="RWE_CRAFTING";et.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";class ms{}ms.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM";ms.JUKEBOX="RWEIEP_JUKEBOX";ms.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT";ms.SONGDISK="RWEIEP_SONGDISK";ms.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI";ms.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS";ms.USABLE="RWEIEP_USABLE";class Uu{}Uu.NOBODY=0;Uu.CONTROLLER=1;Uu.EVERYBODY=2;class Ca{}Ca.NORMAL=0;Ca.GENERIC=1;Ca.BOT=2;class Ti{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class Ri extends Ti{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(e,t){if(!e||!t)return;const r=this._listeners.get(e);if(!r){this._listeners.set(e,[t]);return}r.push(t)}removeEventListener(e,t){if(!e||!t)return;const r=this._listeners.get(e);if(!(!r||!r.length)){for(const[i,n]of r.entries())if(!(!n||n!==t)){r.splice(i,1),r.length||this._listeners.delete(e);return}}}dispatchEvent(e){return e?(xe.events("Dispatched Event",e.type),this.processEvent(e),!0):!1}processEvent(e){const t=this._listeners.get(e.type);if(!t||!t.length)return;const r=[];for(const i of t)i&&r.push(i);for(;r.length;){const i=r.shift();try{i(e)}catch(n){xe.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}class aa extends Ti{constructor(){super(),this._events=new Ri,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class sx{constructor(e){this._value=e}get value(){return this._value}}class rx{constructor(e,t){this._header=e,this._buffer=t}readBytes(e){return this._buffer?this._buffer.readBytes(e):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const e=this.readShort();return this._buffer.readBytes(e).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class ix{constructor(e){this._value=e}get value(){return this._value}}class nx{encode(e,t){const r=new YI;r.writeShort(e);for(const n of t){let o=typeof n;switch(o==="object"&&(n===null?o="null":n instanceof sx?o="byte":n instanceof ix?o="short":n instanceof ArrayBuffer&&(o="arraybuffer")),o){case"undefined":case"null":r.writeShort(0);break;case"byte":r.writeByte(n.value);break;case"short":r.writeShort(n.value);break;case"number":r.writeInt(n);break;case"boolean":r.writeByte(n?1:0);break;case"string":n?r.writeString(n,!0):r.writeShort(0);break;case"arraybuffer":r.writeBytes(n);break}}const i=r.getBuffer();return i?new YI().writeInt(i.byteLength).writeBytes(i):null}decode(e){if(!e||!e.dataBuffer||!e.dataBuffer.byteLength)return null;const t=[];for(;e.dataBuffer.byteLength&&!(e.dataBuffer.byteLength<4);){const r=new b_(e.dataBuffer),i=r.readInt();if(i>e.dataBuffer.byteLength-4)break;const n=r.readBytes(i);t.push(new rx(n.readShort(),n)),e.dataBuffer=e.dataBuffer.slice(i+4)}return t}}class U{constructor(e,t){this._callBack=e,this._parserClass=t,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(e){this._parser=e}get connection(){return this._connection}set connection(e){this._connection=e}}class ct{constructor(e){this._type=e}get type(){return this._type}}class cr extends ct{constructor(e,t,r){super(e),this._connection=t,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}cr.CONNECTION_OPENED="SCE_OPEN";cr.CONNECTION_CLOSED="SCE_CLOSED";cr.CONNECTION_ERROR="SCE_ERROR";cr.CONNECTION_MESSAGE="SCE_MESSAGE";class tc extends ct{constructor(e,t){super(e),this._library=t}get library(){return this._library}}tc.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";class M_{}M_.AVATAR_RENDER_READY="AVATAR_RENDER_READY";class sc extends ct{constructor(e,t){super(e),this._library=t}get library(){return this._library}}sc.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";class Md extends ct{constructor(e){super(e)}}Md.INITIALIZED="RCWM_INITIALIZED";class Is extends ct{constructor(e,t){super(e),this._connection=t}get connection(){return this._connection}}Is.CONNECTION_ESTABLISHED="NCE_ESTABLISHED";Is.CONNECTION_CLOSED="NCE_CLOSED";Is.CONNECTION_ERROR="NCE_ERROR";Is.CONNECTION_HANDSHAKING="NCE_HANDSHAKING";Is.CONNECTION_HANDSHAKED="NCE_HANDSHAKED";Is.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED";Is.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";class uo extends ct{constructor(e){super(e)}}uo.LOADED="NLE_LOADED";uo.FAILED="NLE_FAILED";const Em=class extends ct{constructor(){super(Em.SETTINGS_UPDATED)}clone(){const s=new Em;return s._volumeSystem=this._volumeSystem,s._volumeFurni=this._volumeFurni,s._volumeTrax=this._volumeTrax,s._oldChat=this._oldChat,s._oldRotations=this._oldRotations,s._roomInvites=this._roomInvites,s._cameraFollow=this._cameraFollow,s._wiredAnimations=this._wiredAnimations,s._flags=this._flags,s._chatType=this._chatType,s}get volumeSystem(){return this._volumeSystem}set volumeSystem(s){this._volumeSystem=s}get volumeFurni(){return this._volumeFurni}set volumeFurni(s){this._volumeFurni=s}get volumeTrax(){return this._volumeTrax}set volumeTrax(s){this._volumeTrax=s}get oldChat(){return this._oldChat}set oldChat(s){this._oldChat=s}get oldRotations(){return this._oldRotations}set oldRotations(s){this._oldRotations=s}get roomInvites(){return this._roomInvites}set roomInvites(s){this._roomInvites=s}get cameraFollow(){return this._cameraFollow}set cameraFollow(s){this._cameraFollow=s}get wiredAnimations(){return this._wiredAnimations}set wiredAnimations(s){this._wiredAnimations=s}get flags(){return this._flags}set flags(s){this._flags=s}get chatType(){return this._chatType}set chatType(s){this._chatType=s}};let ul=Em;ul.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";class dc extends ct{constructor(e,t){super(e),this._sampleCode=t}get sampleCode(){return this._sampleCode}}dc.PLAY_SOUND="NSOE_PLAY_SOUND";class fp extends ct{constructor(e){super(e)}get iconId(){return this._iconId}set iconId(e){this._iconId=e}get iconName(){return this._iconName}set iconName(e){this._iconName=e}}fp.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK";fp.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";const OS=class extends fp{constructor(s,e,t){super(OS.ANIMATE_ICON),this._image=s,this._x=e,this._y=t}get image(){return this._image}get x(){return this._x}get y(){return this._y}};let Dd=OS;Dd.ANIMATE_ICON="NTAIE_ANIMATE_ICON";class lt extends ct{constructor(e,t){super(e),this._roomId=t}get roomId(){return this._roomId}}lt.INITIALIZED="REE_INITIALIZED";lt.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED";lt.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED";lt.NORMAL_MODE="REE_NORMAL_MODE";lt.GAME_MODE="REE_GAME_MODE";lt.ROOM_ZOOMED="REE_ROOM_ZOOMED";lt.DISPOSED="REE_DISPOSED";const CS=class extends lt{constructor(s,e,t,r){super(CS.ROOM_COLOR,s),this._color=e,this._brightness=t,this._bgOnly=r}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};let pp=CS;pp.ROOM_COLOR="REE_ROOM_COLOR";class Jn extends ct{constructor(e,t){super(e),this._contentType=t}get contentType(){return this._contentType}}Jn.RCLE_SUCCESS="RCLE_SUCCESS";Jn.RCLE_FAILURE="RCLE_FAILURE";Jn.RCLE_CANCEL="RCLE_CANCEL";const AS=class extends lt{constructor(s,e,t){super(AS.ROOM_DRAG,s),this._offsetX=e,this._offsetY=t}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};let Ep=AS;Ep.ROOM_DRAG="RDE_ROOM_DRAG";const NS=class extends lt{constructor(s,e,t,r,i,n){super(NS.ROOM_COLOR,s),this._state=e,this._presetId=t,this._effectId=r,this._color=i,this._brightness=n}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};let Ip=NS;Ip.ROOM_COLOR="REDSE_ROOM_COLOR";class ye extends lt{constructor(e,t,r,i){super(e,t),this._objectId=r,this._category=i}get objectId(){return this._objectId}get category(){return this._category}}ye.SELECTED="REOE_SELECTED";ye.DESELECTED="REOE_DESELECTED";ye.ADDED="REOE_ADDED";ye.REMOVED="REOE_REMOVED";ye.PLACED="REOE_PLACED";ye.PLACED_ON_USER="REOE_PLACED_ON_USER";ye.CONTENT_UPDATED="REOE_CONTENT_UPDATED";ye.REQUEST_MOVE="REOE_REQUEST_MOVE";ye.REQUEST_ROTATE="REOE_REQUEST_ROTATE";ye.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION";ye.MOUSE_ENTER="REOE_MOUSE_ENTER";ye.MOUSE_LEAVE="REOE_MOUSE_LEAVE";ye.DOUBLE_CLICK="REOE_DOUBLE_CLICK";class Im extends ye{constructor(e,t,r,i,n,o,l,c,h,u,g,m,p){super(e,t,r,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=n,this._x=o,this._y=l,this._z=c,this._direction=h,this._placedInRoom=u,this._placedOnFloor=g,this._placedOnWall=m,this._instanceData=p}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class ax extends ye{constructor(e,t,r,i,n,o){super(e,t,r,i),this._droppedObjectId=n,this._droppedObjectCategory=o}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}class rc extends ye{constructor(e,t,r,i,n,o=1){super(e,t,r,i),this._soundId=n,this._pitch=o}get soundId(){return this._soundId}get pitch(){return this._pitch}}rc.PLAY_SOUND="REOPSE_PLAY_SOUND";rc.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";class Ji extends ye{}Ji.FURNI_CLICK="RERAE_FURNI_CLICK";Ji.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK";Ji.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW";Ji.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";class Qr extends ye{constructor(e,t,r,i,n,o=1){super(e,t,r,i),this._sampleId=n,this._pitch=o}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}Qr.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";Qr.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";Qr.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";Qr.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class ne extends ye{constructor(e,t,r,i,n=null){super(e,t,r,i),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}}ne.OPEN_WIDGET="RETWE_OPEN_WIDGET";ne.CLOSE_WIDGET="RETWE_CLOSE_WIDGET";ne.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU";ne.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU";ne.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER";ne.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI";ne.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT";ne.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE";ne.REQUEST_STICKIE="RETWE_REQUEST_STICKIE";ne.REQUEST_PRESENT="RETWE_REQUEST_PRESENT";ne.REQUEST_TROPHY="RETWE_REQUEST_TROPHY";ne.REQUEST_TEASER="RETWE_REQUEST_TEASER";ne.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX";ne.REQUEST_DIMMER="RETWE_REQUEST_DIMMER";ne.REMOVE_DIMMER="RETWE_REMOVE_DIMMER";ne.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE";ne.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR";ne.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN";ne.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";ne.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";ne.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR";ne.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG";ne.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG";ne.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG";ne.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING";ne.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED";ne.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM";ne.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING";ne.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING";ne.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY";ne.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY";ne.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK";ne.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK";ne.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";class pc extends ye{constructor(e,t,r,i,n=-1,o=-1){super(e,t,r,i),this._inventoryStripId=n,this._furnitureTypeId=o}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}}pc.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM";pc.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";class ln extends ct{constructor(e,t){super(e),this._object=t}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}class ea extends ln{constructor(e,t,r,i=!0){super(e,t),this._badgeId=r,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}ea.LOAD_BADGE="ROBAE_LOAD_BADGE";class Zi extends ln{constructor(e,t){super(e,t)}}Zi.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID";Zi.RODRE_URL_PREFIX="RODRE_URL_PREFIX";const bS=class extends ln{constructor(s,e,t,r,i,n){super(bS.DIMMER_STATE,s),this._state=e,this._presetId=t,this._effectId=r,this._color=i,this._brightness=n}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};let _c=bS;_c.DIMMER_STATE="RODSUE_DIMMER_STATE";class wr extends ln{constructor(e,t){super(e,t)}}wr.ADD_HOLE="ROFHO_ADD_HOLE";wr.REMOVE_HOLE="ROFHO_REMOVE_HOLE";class Re extends ln{}Re.DICE_OFF="ROFCAE_DICE_OFF";Re.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE";Re.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL";Re.STICKIE="ROFCAE_STICKIE";Re.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR";Re.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT";Re.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START";Re.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP";Re.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE";Re.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT";Re.JUKEBOX_START="ROFCAE_JUKEBOX_START";Re.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP";Re.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE";Re.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON";Re.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";class Pd extends lt{constructor(e,t,r,i,n,o){super(e,t),this._enable=r,this._hue=i,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Pd.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class oo extends ln{constructor(e,t,r,i,n,o){super(e,t),this._enable=r,this._hue=i,this._saturation=n,this._lightness=o}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}oo.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class $e extends ln{constructor(e,t,r,i=!1,n=!1,o=!1,l=!1){super(e,t),this._eventId="",this._eventId=r,this._altKey=i,this._ctrlKey=n,this._shiftKey=o,this._buttonDown=l}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(e){this._localX=e}get localY(){return this._localY}set localY(e){this._localY=e}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(e){this._spriteOffsetX=e}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(e){this._spriteOffsetY=e}}$e.CLICK="ROE_MOUSE_CLICK";$e.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK";$e.MOUSE_MOVE="ROE_MOUSE_MOVE";$e.MOUSE_DOWN="ROE_MOUSE_DOWN";$e.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG";$e.MOUSE_UP="ROE_MOUSE_UP";$e.MOUSE_ENTER="ROE_MOUSE_ENTER";$e.MOUSE_LEAVE="ROE_MOUSE_LEAVE";class Vr extends ln{constructor(e,t){super(e,t)}}Vr.POSITION_CHANGED="ROME_POSITION_CHANGED";Vr.OBJECT_REMOVED="ROME_OBJECT_REMOVED";class ya extends Re{constructor(e,t,r,i=1){super(e,t),this._soundId=r,this._pitch=i}get soundId(){return this._soundId}get pitch(){return this._pitch}}ya.PLAY_SOUND="ROPSIE_PLAY_SOUND";ya.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";class is extends ln{constructor(e,t,r="",i=""){super(e,t),this._imageUrl="",this._clickUrl="",this._imageUrl=r,this._clickUrl=i}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}}is.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE";is.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK";is.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK";is.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW";is.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";class Ds extends ln{constructor(e,t,r,i=1){super(e,t),this._sampleId=r,this._pitch=i}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}Ds.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";Ds.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";Ds.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";Ds.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class Jt extends ye{}Jt.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT";Jt.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON";Jt.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF";Jt.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE";Jt.JUKEBOX_INIT="ROSM_JUKEBOX_INIT";Jt.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON";Jt.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF";Jt.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";class vt extends ln{constructor(e,t,r=0){super(e,t),this._state=r}get state(){return this._state}}vt.STATE_CHANGE="ROSCE_STATE_CHANGE";vt.STATE_RANDOM="ROSCE_STATE_RANDOM";class Gn extends $e{constructor(e,t,r,i,n,o,l=!1,c=!1,h=!1,u=!1){super(e,t,r,l,c,h,u),this._tileX=i,this._tileY=n,this._tileZ=o}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class Gl extends $e{constructor(e,t,r,i,n,o,l,c,h,u=!1,g=!1,m=!1,p=!1){super(e,t,r,u,g,m,p),this._wallLocation=new G,this._wallWd=new G,this._wallHt=new G,this._wallLocation.assign(i),this._wallWd.assign(n),this._wallHt.assign(o),this._x=l,this._y=c,this._direction=h}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class Q extends ln{constructor(e,t){super(e,t)}}Q.OPEN_WIDGET="ROWRE_OPEN_WIDGET";Q.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET";Q.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU";Q.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU";Q.PLACEHOLDER="ROWRE_PLACEHOLDER";Q.CREDITFURNI="ROWRE_CREDITFURNI";Q.STACK_HEIGHT="ROWRE_STACK_HEIGHT";Q.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE";Q.STICKIE="ROWRE_STICKIE";Q.PRESENT="ROWRE_PRESENT";Q.TROPHY="ROWRE_TROPHY";Q.TEASER="ROWRE_TEASER";Q.ECOTRONBOX="ROWRE_ECOTRONBOX";Q.DIMMER="ROWRE_DIMMER";Q.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER";Q.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE";Q.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR";Q.MANNEQUIN="ROWRE_MANNEQUIN";Q.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU";Q.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU";Q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";Q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";Q.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR";Q.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG";Q.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG";Q.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG";Q.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN";Q.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING";Q.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED";Q.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM";Q.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING";Q.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING";Q.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY";Q.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY";Q.INERNAL_LINK="ROWRE_INTERNAL_LINK";Q.ROOM_LINK="ROWRE_ROOM_LINK";Q.YOUTUBE="ROWRE_YOUTUBE";class ox{constructor(e,t,r,i,n,o,l=0,c=0,h=!1,u=!1,g=!1,m=!1){this._type=e,this._eventId=t,this._canvasId=r,this._spriteTag=i,this._screenX=n,this._screenY=o,this._localX=l,this._localY=c,this._ctrlKey=h,this._altKey=u,this._shiftKey=g,this._buttonDown=m,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(e){this._spriteOffsetX=e}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(e){this._spriteOffsetY=e}}class lx extends ct{constructor(e){super(e)}}class xu extends lx{constructor(e,t){super(e),this._targetLocation=t}get targetLocation(){return this._targetLocation}}xu.ROAME_MOVE_TO="ROAME_MOVE_TO";const yS=class extends lt{constructor(s,e,t=!1,r=!1){super(yS.ROOM_ZOOM,s),this._level=e,this._forceFlip=t,this._asDelta=r}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};let Ld=yS;Ld.ROOM_ZOOM="REE_ROOM_ZOOM";const vS=class extends ct{constructor(s,e){super(vS.IMAGE_READY),this._badgeId=s,this._image=e}get badgeId(){return this._badgeId}get image(){return this._image}};let mo=vS;mo.IMAGE_READY="BIME_BADGE_IMAGE_READY";const MS=class extends ct{constructor(s,e){super(MS.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=s,this._keyColor=e}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};let Tp=MS;Tp.MYSTERY_BOX_KEYS_UPDATE="mbke_update";const DS=class extends ct{constructor(){super(DS.PERKS_UPDATED)}};let cx=DS;cx.PERKS_UPDATED="PUE_perks_updated";class Ve extends ct{constructor(e,t,r=!0){super(e),this._session=t,this._openLandingView=r}get session(){return this._session}get openLandingView(){return this._openLandingView}}Ve.CREATED="RSE_CREATED";Ve.STARTED="RSE_STARTED";Ve.ENDED="RSE_ENDED";Ve.ROOM_DATA="RSE_ROOM_DATA";class at extends Ve{constructor(e,t,r,i,n,o=0,l=null,c=-1){super(e,t),this._objectId=r,this._message=i,this._chatType=n,this._links=l,this._extraParam=c,this._style=o}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}at.CHAT_EVENT="RSCE_CHAT_EVENT";at.FLOOD_EVENT="RSCE_FLOOD_EVENT";at.CHAT_TYPE_SPEAK=0;at.CHAT_TYPE_WHISPER=1;at.CHAT_TYPE_SHOUT=2;at.CHAT_TYPE_RESPECT=3;at.CHAT_TYPE_PETRESPECT=4;at.CHAT_TYPE_HAND_ITEM_RECEIVED=5;at.CHAT_TYPE_PETTREAT=6;at.CHAT_TYPE_PETREVIVE=7;at.CHAT_TYPE_PET_REBREED_FERTILIZE=8;at.CHAT_TYPE_PET_SPEED_FERTILIZE=9;at.CHAT_TYPE_MUTE_REMAINING=10;const PS=class extends Ve{constructor(s,e,t,r,i,n){super(PS.CONFIRM_PET_BREEDING,s),this._nestId=e,this._pet1=t,this._pet2=r,this._rarityCategories=i,this._resultPetTypeId=n}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};let LS=PS;LS.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";const US=class extends Ve{constructor(s,e,t){super(US.RSPFUE_CONFIRM_PET_BREEDING_RESULT,s),this._breedingNestStuffId=e,this._result=t}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};let xS=US;xS.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";const wS=class extends Ve{constructor(s,e,t){super(wS.RSDE_DANCE,s),this._roomIndex=e,this._danceId=t}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};let Rp=wS;Rp.RSDE_DANCE="RSDE_DANCE";class ux{constructor(e,t,r,i){this._id=e,this._type=t,this._color=r,this._brightness=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}class Ud extends Ve{constructor(e,t){super(e,t),this._selectedPresetId=0,this._presets=[]}storePreset(e,t,r,i){this._presets[e-1]=new ux(e,t,r,i)}getPreset(e){return e<0||e>=this._presets.length?null:this._presets[e]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(e){this._selectedPresetId=e}}Ud.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";class en extends Ve{constructor(e,t,r){super(e,t),this._userName="",this._userName=r}get userName(){return this._userName}}en.DOORBELL="RSDE_DOORBELL";en.RSDE_REJECTED="RSDE_REJECTED";en.RSDE_ACCEPTED="RSDE_ACCEPTED";class ot extends Ve{constructor(e,t,r=null){super(e,t),this._message=r}get message(){return this._message}}ot.RSEME_KICKED="RSEME_KICKED";ot.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL";ot.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT";ot.RSEME_MAX_PETS="RSEME_MAX_PETS";ot.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS";ot.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET";ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET";ot.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL";ot.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT";ot.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED";ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT";ot.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";const FS=class extends Ve{constructor(s,e,t,r,i){super(FS.FAVOURITE_GROUP_UPDATE,s),this._roomIndex=e,this._habboGroupId=t,this._habboGroupName=i,this._status=r}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};let Sp=FS;Sp.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";const kS=class extends Ve{constructor(s,e,t,r){super(kS.RSFRE_FRIEND_REQUEST,s),this._requestId=0,this._userId=0,this._requestId=e,this._userId=t,this._userName=r}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};let GS=kS;GS.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";const BS=class extends Ve{constructor(s,e,t){super(BS.NEST_BREEDING_SUCCESS,s),this._petId=e,this._rarityCategory=t}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};let VS=BS;VS.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";const HS=class extends Ve{constructor(s,e,t,r){super(HS.PET_BREEDING,s),this._state=e,this._ownPetId=t,this._otherPetId=r}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};let WS=HS;WS.PET_BREEDING="RSPFUE_PET_BREEDING";const jS=class extends Ve{constructor(s,e,t){super(jS.PET_BREEDING_RESULT,s),this._resultData=e,this._otherResultData=t}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};let YS=jS;YS.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";const zS=class extends Ve{constructor(s,e,t,r){super(zS.PET_COMMANDS,s),this._petId=e,this._allCommandIds=t,this._enabledCommandIds=r}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};let hx=zS;hx.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";const KS=class extends Ve{constructor(s,e,t){super(KS.PET_FIGURE_UPDATE,s),this._petId=e,this._figure=t}get id(){return this._petId}get figure(){return this._figure}};let qS=KS;qS.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";const XS=class extends Ve{constructor(s,e){super(XS.PET_INFO,s),this._petInfo=e}get petInfo(){return this._petInfo}};let Op=XS;Op.PET_INFO="RSPIUE_PET_INFO";const QS=class extends Ve{constructor(s,e,t){super(QS.PET_LEVEL_UPDATE,s),this._petId=e,this._level=t}get petId(){return this._petId}get level(){return this._level}};let $S=QS;$S.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";class ho extends Ve{constructor(e,t,r,i,n,o){super(e,t),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=r,this._figureData=i,this._nameValidationStatus=n,this._nameValidationInfo=o}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}ho.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED";ho.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";const JS=class extends Ve{constructor(s,e,t,r,i,n){super(JS.PET_STATUS_UPDATE,s),this._petId=e,this._canBreed=t,this._canHarvest=r,this._canRevive=i,this._hasBreedingPermission=n}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};let Cp=JS;Cp.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";class qi extends Ve{constructor(e,t,r){super(e,t),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=r}get id(){return this._id}get headline(){return this._headline}set headline(e){this._headline=e}get summary(){return this._summary}set summary(e){this._summary=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}}qi.OFFER="RSPE_POLL_OFFER";qi.ERROR="RSPE_POLL_ERROR";qi.CONTENT="RSPE_POLL_CONTENT";class xd extends Ve{constructor(e,t,r,i,n,o,l,c,h){super(e,t),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=r,this._itemType=i,this._productCode=n,this._placedItemId=o,this._placedItemType=l,this._placedInRoom=c,this._petFigureString=h}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}}xd.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";class Tm extends Ve{constructor(e,t){super(e,t)}}Tm.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";const ZS=class extends Ve{constructor(s,e,t,r=!1){super(ZS.QUEUE_STATUS,s),this._name=e,this._target=t,this._queues=new Map,this._isActive=r}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(s){return this._queues.get(s)}addQueue(s,e){this._queues.set(s,e)}};let Xu=ZS;Xu.QUEUE_STATUS="RSQE_QUEUE_STATUS";Xu.QUEUE_TYPE_CLUB="c";Xu.QUEUE_TYPE_NORMAL="d";Xu.QUEUE_TARGET_VISITOR=2;Xu.QUEUE_TARGET_SPECTATOR=1;class Rm extends Ve{constructor(e,t){super(e,t)}}Rm.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";const eO=class extends Ve{constructor(s,e,t){super(eO.RSUBE_BADGES,s),this._userId=0,this._badges=[],this._userId=e,this._badges=t}get userId(){return this._userId}get badges(){return this._badges}};let Ap=eO;Ap.RSUBE_BADGES="RSUBE_BADGES";const tO=class extends Ve{constructor(s,e){super(tO.USER_DATA_UPDATED,s),this._addedUsers=e}get addedUsers(){return this._addedUsers}};let Np=tO;Np.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";const sO=class extends Ve{constructor(s,e,t,r,i,n){super(sO.USER_FIGURE,s),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=e,this._figure=t,this._gender=r,this._customInfo=i,this._achievementScore=n}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};let bp=sO;bp.USER_FIGURE="RSUBE_FIGURE";const rO=class extends ct{constructor(s,e){super(rO.UTRE_USER_TAGS_RECEIVED),this._userId=s,this._tags=e}get userId(){return this._userId}get tags(){return this._tags}};let dx=rO;dx.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";class ic extends Ve{constructor(e,t,r,i,n=null,o=0){super(e,t),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=r,this._choices=i,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=o}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}}ic.VOTE_QUESTION="RSPE_VOTE_QUESTION";ic.VOTE_RESULT="RSPE_VOTE_RESULT";class Xi extends Ve{constructor(e,t,r=-1){super(e,t),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=r}get id(){return this._id}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get pollId(){return this._pollId}set pollId(e){this._pollId=e}get questionId(){return this._questionId}set questionId(e){this._questionId=e}get duration(){return this._duration}set duration(e){this._duration=e}get question(){return this._question}set question(e){this._question=e}get userId(){return this._userId}set userId(e){this._userId=e}get value(){return this._value}set value(e){this._value=e}get answerCounts(){return this._answerCounts}set answerCounts(e){this._answerCounts=e}}Xi.QUESTION="RWPUW_NEW_QUESTION";Xi.FINISHED="RWPUW_QUESION_FINSIHED";Xi.ANSWERED="RWPUW_QUESTION_ANSWERED";const iO=class extends ct{constructor(s){super(iO.UPDATED),this._uiFlags=s}get uiFlags(){return this._uiFlags}};let nO=iO;nO.UPDATED="APUE_UPDATED";const aO=class extends ct{constructor(s){super(aO.UNUE_NAME_UPDATED),this._name=s}get name(){return this._name}};let Sm=aO;Sm.UNUE_NAME_UPDATED="unue_name_updated";class _x{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(e){for(const[t,r]of e.events)this.registerMessageEventClass(t,r);for(const[t,r]of e.composers)this.registerMessageComposerClass(t,r)}registerMessageEventClass(e,t){!e||!t||this._messageIdByEvent.set(t,e)}registerMessageComposerClass(e,t){!e||!t||this._messageIdByComposer.set(t,e)}registerMessageEvent(e){if(!e)return;const t=this.getEventId(e);if(!t)return;let r=this._messageInstancesById.get(t);(!r||!r.length)&&(r=[],this._messageInstancesById.set(t,r)),r.push(e)}removeMessageEvent(e){if(!e)return;const t=this.getEventId(e);if(!t)return;const r=this._messageInstancesById.get(t);if(r){for(const[i,n]of r.entries())if(n&&n===e){r.splice(i,1),r.length===0&&this._messageInstancesById.delete(t),n.dispose();return}}}getEvents(e){if(!e)return;const t=this._messageInstancesById.get(e);if(t)return t}getEventId(e){if(!e)return-1;const t=e instanceof U?e.constructor:e,r=this._messageIdByEvent.get(t);return r||-1}getComposerId(e){if(!e)return-1;const t=this._messageIdByComposer.get(e.constructor);return t||-1}}class gx extends Ri{constructor(e,t){super(),this._communicationManager=e,this._stateListener=t,this._socket=null,this._messages=new _x,this._codec=new nx,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(e){this._stateListener&&this._stateListener.connectionInit(e),this.createSocket(e)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(e){e&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(e),this._socket.addEventListener(zi.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(zi.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(zi.CONNECTION_ERROR,this.onError),this._socket.addEventListener(zi.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(zi.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(zi.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(zi.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(zi.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(e){this.dispatchConnectionEvent(cr.CONNECTION_OPENED,e)}onClose(e){this.dispatchConnectionEvent(cr.CONNECTION_CLOSED,e)}onError(e){this.dispatchConnectionEvent(cr.CONNECTION_ERROR,e)}onMessage(e){if(!e)return;const t=new FileReader;t.readAsArrayBuffer(e.data),t.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,t.result),this.processReceivedData()}}dispatchConnectionEvent(e,t){this.dispatchEvent(new cr(e,this,t))}authenticated(){this._isAuthenticated=!0}send(...e){if(this.disposed||!e)return!1;if(e=[...e],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...e),!1;for(const t of e){if(!t)continue;const r=this._messages.getComposerId(t);if(r===-1){xe.packets("Unknown Composer",t.constructor.name);continue}const i=t.getMessageArray(),n=this._codec.encode(r,i);if(!n){xe.packets("Encoding Failed",t.constructor.name);continue}xe.packets("OutgoingComposer",r,t.constructor.name,i),this.write(n.getBuffer())}return!0}write(e){this._socket.readyState===WebSocket.OPEN&&this._socket.send(e)}processReceivedData(){try{this.processData()}catch(e){xe.error(e)}}processData(){const e=this.splitReceivedMessages();if(!(!e||!e.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...e);return}this.processWrappers(...e)}}processWrappers(...e){if(!(!e||!e.length))for(const t of e){if(!t)continue;const r=this.getMessagesForWrapper(t);!r||!r.length||(xe.packets("IncomingMessage",t.header,r[0].constructor.name,r[0].parser),this.handleMessages(...r))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(e,t){const r=new Uint8Array(e.byteLength+t.byteLength);return r.set(new Uint8Array(e),0),r.set(new Uint8Array(t),e.byteLength),r.buffer}getMessagesForWrapper(e){if(!e)return null;const t=this._messages.getEvents(e.header);if(!t||!t.length){xe.packets("IncomingMessage",e.header,"UNREGISTERED",e);return}try{const r=new t[0].parserClass;if(!r||!r.flush()||!r.parse(e))return null;for(const i of t)i.parser=r}catch(r){return xe.error("Error parsing message",r,t[0].constructor.name),null}return t}handleMessages(...e){e=[...e];for(const t of e)t&&(t.connection=this,t.callBack&&t.callBack(t))}registerMessages(e){e&&this._messages.registerMessages(e)}addMessageEvent(e){!e||!this._messages||this._messages.registerMessageEvent(e)}removeMessageEvent(e){!e||!this._messages||this._messages.removeMessageEvent(e)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(e){this._dataBuffer=e}}class mx extends Ti{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const e of this._connections.values())e&&e.dispose()}createConnection(e=null){const t=new gx(this,e);if(t)return this._connections.push(t),t}update(e){let t=0;for(;t<this._connections.length;){const r=this._connections[t];if(r.processReceivedData(),this.disposed)return;r.disposed?this._connections.splice(t,1):t++}}}class $i extends ct{constructor(e){super(e)}}$i.LOADED="NCE_LOADED";$i.FAILED="NCE_FAILED";class fx extends aa{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){Ke.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=Ke.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent($i.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(e){if(!e||e===""){this.dispatchConfigurationEvent($i.FAILED);return}fetch(e).then(t=>t.json()).then(t=>this.onConfigurationLoaded(t,e)).catch(t=>this.onConfigurationFailed(t))}onConfigurationLoaded(e,t){if(e){if(Ke.parseConfiguration(e)){const r=this._pendingUrls.indexOf(t);r>=0&&this._pendingUrls.splice(r,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent($i.FAILED)}}onConfigurationFailed(e){this.dispatchConfigurationEvent($i.FAILED)}dispatchConfigurationEvent(e){this.events&&this.events.dispatchEvent(new $i(e))}getDefaultConfig(){return NitroConfig}}const au=class{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const s=[`
 %c %c %c Nitro ${au.UI_VERSION} - Renderer ${au.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...s)}else self.console&&self.console.log(`Nitro ${au.UI_VERSION} - Renderer ${au.RENDERER_VERSION} `)}};let Uc=au;Uc.RENDERER_VERSION="1.6.6";Uc.UI_VERSION="";class px extends Ti{constructor(){super(),Uc.sayHello(),this._configuration=new fx,this._communication=new mx}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}class Ex{constructor(e){this._id=parseInt(e.id),this._value=parseInt(e.id),this._prevents=e.prevents||[],this._preventHeadTurn=e.preventHeadTurn||!1,this._isAnimated=!0,e.animated!==void 0&&e.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class Ix{constructor(e){if(this._id=e.id,this._state=e.state,this._precedence=e.precedence,this._activePartSet=e.activePartSet,this._assetPartDefinition=e.assetPartDefinition,this._lay=e.lay,this._geometryType=e.geometryType,this._isMain=e.main||!1,this._isDefault=e.isDefault||!1,this._isAnimation=e.animation||!1,this._startFromFrameZero=e.startFromFrameZero||!1,this._prevents=e.prevents||[],this._preventHeadTurn=e.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,e.params&&e.params.length>0)for(const t of e.params)t&&(t.id==="default"?this._defaultParameterValue=t.value:this._params.set(t.id,t.value));if(e.types&&e.types.length>0)for(const t of e.types){if(!t)continue;const r=new Ex(t);this._types.set(r.id,r)}}setOffsets(e,t,r){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(e);i||(i=new Map,this._canvasOffsets.set(e,i)),i.set(t,r)}getOffsets(e,t){if(!this._canvasOffsets)return null;const r=this._canvasOffsets.get(e);return r?r.get(t):null}getType(e){if(!e)return null;const t=this._types.get(parseInt(e));return t||null}getParameterValue(e){if(!e)return"";const t=this._params.get(e);return t||this._defaultParameterValue}getPrevents(e){return this._prevents.concat(this.getTypePrevents(e))}getTypePrevents(e){if(!e)return[];const t=this._types.get(parseInt(e));return t?t.prevents:[]}getPreventHeadTurn(e){if(!e)return this._preventHeadTurn;const t=this.getType(e);return t?t.preventHeadTurn:this._preventHeadTurn}isAnimated(e){if(!e)return!0;const t=this.getType(e);return t?t.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class Om{constructor(e,t="",r=0){this._actionType=e||"",this._actionParameter=t||"",this._definition=null,this._startFrame=r||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(e){this._actionParameter=e}get definition(){return this._definition}set definition(e){this._definition=e}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(e){this._overridingAction=e}}class Tx{constructor(e,t){this._assets=e,this._actions=new Map,this._defaultAction=null,this.updateActions(t)}updateActions(e){if(e){for(const t of e.actions){if(!t||!t.state)continue;const r=new Ix(t);this._actions.set(r.state,r)}e.actionOffsets&&this.parseActionOffsets(e.actionOffsets)}}parseActionOffsets(e){if(!(!e||!e.length))for(const t of e){const r=this._actions.get(t.action);if(r)for(const i of t.offsets){const n=i.size||"",o=i.direction;if(n===""||o===void 0)continue;const l=i.x||0,c=i.y||0,h=i.z||0;r.setOffsets(n,o,[l,c,h])}}}getActionDefinition(e){if(!e)return null;for(const t of this._actions.values())if(!(!t||t.id!==e))return t;return null}getActionDefinitionWithState(e){const t=this._actions.get(e);return t||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const e of this._actions.values())if(!(!e||!e.isDefault))return this._defaultAction=e,e;return null}getCanvasOffsets(e,t,r){let i=[];for(const n of e){if(!n)continue;const o=this._actions.get(n.actionType),l=o&&o.getOffsets(t,r);l&&(i=l)}return i}sortActions(e){if(!e)return null;e=this.filterActions(e);const t=[];for(const r of e){if(!r)continue;const i=this._actions.get(r.actionType);i&&(r.definition=i,t.push(r))}return t.sort(this.sortByPrecedence),t}filterActions(e){let t=[];const r=[];for(const i of e){if(!i)continue;const n=this._actions.get(i.actionType);n&&(t=t.concat(n.getPrevents(i.actionParameter)))}for(const i of e){if(!i)continue;let n=i.actionType;i.actionType==="fx"&&(n=n+("."+i.actionParameter)),!(t.indexOf(n)>=0)&&r.push(i)}return r}sortByPrecedence(e,t){if(!e||!t)return 0;const r=e.definition.precedence,i=t.definition.precedence;return r<i?1:r>i?-1:0}}class Rx{constructor(e,t){this._name=e,this._link=t.link,this._flipH=t.flipH,this._flipV=t.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class Sx{constructor(e,t){this._avatarRenderManager=e,this._aliases=new Map,this._assets=t,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const e of this._assets.collections.values()){if(!e)continue;const t=e.data&&e.data.aliases;if(t)for(const r in t){const i=t[r];i&&this._aliases.set(r,new Rx(r,i))}}}hasAlias(e){return!!this._aliases.get(e)}getAssetName(e){let t=e,r=5;for(;this.hasAlias(t)&&r>=0;)t=this._aliases.get(t).link,r--;return t}getAsset(e){if(!this._assets)return null;e=this.getAssetName(e);const t=this._assets.getAsset(e);return t||null}}class Ox{constructor(e){this._id=e.id||"",this._align=e.align||"",this._base=e.base||"",this._ink=e.ink||0,this._blend=0;const t=e.blend;t&&t.length>0&&(this._blend=parseInt(t),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}class In{constructor(e,t,r){if(this._id=e.id,this._animationFrame=e.frame||0,this._dx=e.dx||0,this._dy=e.dy||0,this._dz=e.dz||0,this._directionOffset=e.dd||0,this._type=t,this._base=e.base||"",this._items=new Map,e.items)for(const i of e.items)this._items.set(i.id,i.base);this._base!==""&&this.baseAsInt().toString(),r&&(this._action=new Om(r.state,this.base),this._action.definition=r)}get items(){return this._items}baseAsInt(){let e=0,t=0;for(;t<this._base.length;)e=e+this._base.charCodeAt(t),t++;return e}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}In.BODYPART="bodypart";In.FX="fx";class Cx{constructor(e){this._ink=e.ink;let t=e.foreground,r=e.background;t=t.replace("#",""),r=r.replace("#",""),this._foreGround=parseInt(t,16),this._backGround=parseInt(r,16),this._colorTransform=null,this._rgb=parseInt(t,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new lS({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(e,t){const r=e>>24&255,i=e>>16&255,n=e>>8&255,o=e>>0&255,l=t>>24&255,c=t>>16&255,h=t>>8&255,u=t>>0&255,g=(l-r)/255,m=(c-i)/255,p=(h-n)/255,f=(u-o)/255,T=new Map,I=[],O=[],A=[];let N=r,P=i,y=n,D=o;for(let x=0;x<256;x++)P==i&&y==n&&D==o&&(N=0),N=N+g,P=P+m,y=y+p,D=D+f,I.push(N<<24|P<<16|y<<8|D),O.push(N<<24|P<<16|y<<8|D),A.push(N<<24|P<<16|y<<8|D);return T.set("alphas",I),T.set("reds",I),T.set("greens",O),T.set("blues",A),T}}class Ax{constructor(e){this._offset=e.offset}get offset(){return this._offset}}class Nx{constructor(e,t){this._animation=e,this._id=t.id,this._ink=t.ink,this._member=t.member,this._hasStaticY=!!t.staticY,this._hasDirections=!!t.directions,this._dx=[],this._dy=[],this._dz=[];const r=t.directionList;if(r&&r.length)for(const i of r){const n=i.id;n!==void 0&&(this._dx[n]=i.dx||0,this._dy[n]=i.dy||0,this._dz[n]=i.dz||0)}}getDirectionOffsetX(e){return e<this._dx.length?this._dx[e]:0}getDirectionOffsetY(e){return e<this._dy.length?this._dy[e]:0}getDirectionOffsetZ(e){return e<this._dz.length?this._dz[e]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const hd=class{constructor(s,e){if(this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const t of e.sprites)this._spriteData.push(new Nx(this,t))}if(e.avatars&&e.avatars.length&&(this._avatarData=new Cx(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new Ax(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const t of e.removes)this._removeData.push(t.id)}if(e.adds&&e.adds.length){this._addData=[];for(const t of e.adds)this._addData.push(new Ox(t))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const t of e.overrides){const r=t.name,i=t.override;this._overriddenActions.set(i,r);const n=[];this.parseFrames(n,t.frames,s),this._overrideFrames.set(r,n)}}this.parseFrames(this._frames,e.frames,s)}parseFrames(s,e,t){if(!(!e||!e.length))for(const r of e){let i=1;r.repeats&&r.repeats>1&&(i=r.repeats);let n=0;for(;n<i;){const o=[];if(r.bodyparts&&r.bodyparts.length)for(const l of r.bodyparts){const c=t.getActionDefinition(l.action),h=new In(l,In.BODYPART,c);o.push(h)}if(r.fxs&&r.fxs.length)for(const l of r.fxs){const c=t.getActionDefinition(l.action),h=new In(l,In.FX,c);o.push(h)}s.push(o),n++}}}frameCount(s=null){if(!s)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(s);if(e)return e.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const s=[];for(const e of this._overriddenActions.keys())s.push(e);return s}overridingAction(s){return this._overriddenActions?this._overriddenActions.get(s):null}getFrame(s,e=null){s<0&&(s=0);let t=[];if(!e)this._frames.length>0&&(t=this._frames[s%this._frames.length]);else{const r=this._overrideFrames.get(e);r&&r.length>0&&(t=r[s%r.length])}return t}getAnimatedBodyPartIds(s,e=null){const t=[];for(const r of this.getFrame(s,e))if(r.type===In.BODYPART)t.push(r.id);else if(r.type===In.FX&&this._addData&&this._addData.length)for(const i of this._addData)i.id===r.id&&t.push(i.align);return t}getLayerData(s,e,t=null){for(const r of this.getFrame(s,t)){if(r.id===e)return r;if(r.type===In.FX&&this._addData&&this._addData.length){for(const i of this._addData)if(i.align===e&&i.id===r.id)return r}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(s){if(this._addData){for(const e of this._addData)if(e.id===s)return e}return null}get id(){return this._id}get spriteData(){return this._spriteData||hd.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||hd.EMPTY_ARRAY}get addData(){return this._addData||hd.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};let oO=hd;oO.EMPTY_ARRAY=[];class bx{constructor(){this._animations=new Map}registerAnimation(e,t){if(!t)return!1;const r=t[Object.keys(t)[0]],i=new oO(e,r);return this._animations.set(r.name,i),!0}getAnimation(e){const t=this._animations.get(e);return t||null}getLayerData(e,t,r){const i=this.getAnimation(e);return i?i.getLayerData(t,r):null}get animations(){return this._animations}}const Bn=class extends Ri{constructor(s,e,t,r){super(),this._state=Bn.NOT_LOADED,this._libraryName=s,this._revision=e,this._assets=t,this._downloadUrls=[];const i=(r&&r.length?r:[]).filter(o=>!!o);for(const o of i)this._downloadUrls.push(o.replace(/%libname%/gi,this._libraryName).replace(/%revision%/gi,this._revision));this._downloadUrls.length||this._downloadUrls.push(""),this._assets.getCollection(this._libraryName)&&(this._state=Bn.LOADED)}async downloadAsset(){if(!this._assets||this._state===Bn.LOADING||this._state===Bn.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=Bn.LOADED,this.dispatchEvent(new sc(sc.DOWNLOAD_COMPLETE,this));return}this._state=Bn.LOADING;let e=!1;for(const t of this._downloadUrls)if(!(!t||!await this._assets.downloadAsset(t))&&this._assets.getCollection(this._libraryName)){e=!0;break}if(!e){this._state=Bn.NOT_LOADED;return}this._state=Bn.LOADED,this.dispatchEvent(new sc(sc.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===Bn.LOADED}};let Qu=Bn;Qu.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE";Qu.NOT_LOADED=0;Qu.LOADING=1;Qu.LOADED=2;const Cm=class extends Ri{constructor(s,e){super(),this._assets=s,this._structure=e,this._missingMandatoryLibs=Ke.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(M_.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const s=new XMLHttpRequest;try{s.open("GET",Ke.getValue("avatar.figuremap.url")),s.send(),s.onloadend=e=>{if(s.responseText){const t=JSON.parse(s.responseText);this.processFigureMap(t.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new ct(Cm.DOWNLOADER_READY))}},s.onerror=e=>{throw new Error("invalid_avatar_figure_map")}}catch(e){xe.error(e)}}processFigureMap(s){if(s)for(const e of s){if(!e)continue;const t=e.id,r=e.revision||"";if(this._libraryNames.indexOf(t)>=0)continue;this._libraryNames.push(t);const i=[Ke.getValue("avatar.asset.url"),Ke.getValue("alternative.avatar.asset.url")].filter(o=>!!o),n=new Qu(t,r,this._assets,i);n.addEventListener(sc.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const o of e.parts){const l=o.id,h=o.type+":"+l;let u=this._figureMap.get(h);u||(u=[]),u.push(n),this._figureMap.set(h,u)}}}onAvatarRenderReady(s){if(s){for(const[e,t]of this._pendingContainers)this.downloadAvatarFigure(e,t);this._pendingContainers=[]}}onLibraryLoaded(s){if(!s||!s.library)return;const e=[];for(const[r,i]of this._incompleteFigures.entries()){let n=!0;for(const o of i)if(!(!o||o.isLoaded)){n=!1;break}if(n){e.push(r);const o=this._figureListeners.get(r);if(o)for(const l of o)!l||l.disposed||l.resetFigure(r);this._figureListeners.delete(r),this.dispatchEvent(new ct(Cm.LIBRARY_LOADED))}}for(const r of e)r&&this._incompleteFigures.delete(r);let t=0;for(;t<this._currentDownloads.length;){const r=this._currentDownloads[t];r&&r.libraryName===s.library.libraryName&&this._currentDownloads.splice(t,1),t++}}processMissingLibraries(){const s=this._missingMandatoryLibs.slice();for(const e of s){if(!e)continue;const t=this._figureMap.get(e);if(t)for(const r of t)r&&this.downloadLibrary(r)}}isAvatarFigureContainerReady(s){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(s).length}getAvatarFigurePendingLibraries(s){const e=[];if(!s||!this._structure)return e;const t=this._structure.figureData;if(!t)return e;const r=s.getPartTypeIds();for(const i of r){const n=t.getSetType(i);if(!n)continue;const o=n.getPartSet(s.getPartSetId(i));if(o)for(const l of o.parts){if(!l)continue;const c=l.type+":"+l.id,h=this._figureMap.get(c);if(h!==void 0)for(const u of h)!u||u.isLoaded||e.indexOf(u)>=0||e.push(u)}}return e}downloadAvatarFigure(s,e){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([s,e]);return}const t=s.getFigureString(),r=this.getAvatarFigurePendingLibraries(s);if(r&&r.length){if(e&&!e.disposed){let i=this._figureListeners.get(t);i||(i=[],this._figureListeners.set(t,i)),i.push(e)}this._incompleteFigures.set(t,r);for(const i of r)i&&this.downloadLibrary(i)}else e&&!e.disposed&&e.resetFigure(t)}downloadLibrary(s){!s||s.isLoaded||this._pendingDownloadQueue.indexOf(s)>=0||this._currentDownloads.indexOf(s)>=0||(this._pendingDownloadQueue.push(s),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};let lo=Cm;lo.DOWNLOADER_READY="AADM_DOWNLOADER_READY";lo.LIBRARY_LOADED="AADM_LIBRARY_LOADED";lo.MAX_DOWNLOADS=2;class Su{constructor(e){this._parts=new Map,this.parseFigure(e)}getPartTypeIds(){return this.partSets().keys()}hasPartType(e){return!!this.partSets().get(e)}getPartSetId(e){const t=this.partSets().get(e);return t?t.get("setid"):0}getPartColorIds(e){const t=this.partSets().get(e);return t?t.get("colorids"):null}updatePart(e,t,r){const i=new Map;i.set("type",e),i.set("setid",t),i.set("colorids",r);const n=this.partSets();n.delete(e),n.set(e,i)}removePart(e){this.partSets().delete(e)}getFigureString(){const e=[];for(const t of this.partSets().keys()){if(!t)continue;let r=[];r.push(t),r.push(this.getPartSetId(t)),r=r.concat(this.getPartColorIds(t)),e.push(r.join("-"))}return e.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(e){e||(e="");for(const t of e.split(".")){const r=t.split("-");if(r.length>=2){const i=r[0],n=parseInt(r[1]),o=[];let l=2;for(;l<r.length;)o.push(parseInt(r[l])),l++;this.updatePart(i,n,o)}}}}class yx{constructor(){this._cache=new Map,this.setLastAccessTime(tt())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const e of this._cache.values())e&&e.dispose();this._cache.clear()}}getDirectionCache(e){const t=this._cache.get(e.toString());return t||null}updateDirectionCache(e,t){this._cache.set(e.toString(),t)}setLastAccessTime(e){this._lastAccessTime=e}getLastAccessTime(){return this._lastAccessTime}debugInfo(e){}}class KI{constructor(){this._cache=new Map}setAction(e,t){this._currentAction||(this._currentAction=e);const r=this.getActionCache(this._currentAction);r&&r.setLastAccessTime(t),this._currentAction=e}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(e,t){if(!(!this._cache||this._disposed))for(const[r,i]of this._cache.entries()){if(!i)continue;const n=i.getLastAccessTime();t-n>=e&&(i.dispose(),this._cache.delete(r))}}getAction(){return this._currentAction}setDirection(e){this._currentDirection=e}getDirection(){return this._currentDirection}getActionCache(e=null){return this._currentAction?(e||(e=this._currentAction),e.overridingAction?this._cache.get(e.overridingAction):this._cache.get(e.id)):null}updateActionCache(e,t){e.overridingAction?this._cache.set(e.overridingAction,t):this._cache.set(e.id,t)}debugInfo(e){}}class vx{constructor(e,t,r){this._image=e,this._regPoint=t,this._offset=new it(0,0),this._regPoint=t,this._isCacheable=r,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(e){this._regPoint=e,this.cleanPoints()}get image(){return this._image}set image(e){this._image&&this._image!==e&&this._image.destroy({children:!0}),this._image=e}get regPoint(){const e=this._regPoint.clone();return e.x+=this._offset.x,e.y+=this._offset.y,e}set offset(e){this._offset=e,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class Mx{constructor(e){this._partList=e,this._images=new Map}dispose(){for(const e of this._images.values())e&&e.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(e){const t=this._images.get(this.getCacheKey(e));return t||null}updateImageContainer(e,t){const r=this.getCacheKey(t),i=this._images.get(r);i&&i.dispose(),this._images.set(r,e)}getCacheKey(e){let t="";for(const r of this._partList)t+=r.getCacheableKey(e)+"/";return t}debugInfo(e){}}class qI{constructor(e,t,r,i,n,o=null){this._texture=e,this._container=o,this._rect=t,this._regPoint=r,this._flipH=i,this._colorTransform=n,i&&(this._regPoint.x=-this._regPoint.x+t.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new fi(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}class lO{constructor(e,t,r,i){this._structure=e,this._avatar=t,this._assets=r,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new Zr,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const e of this._cache.values())e&&e.dispose();this._cache=null}if(this._unionImages){for(const e of this._unionImages)e&&e.dispose();this._unionImages=[]}}}disposeInactiveActions(e=6e4){const t=tt();if(this._cache)for(const r of this._cache.values())r&&r.disposeActions(e,t)}resetBodyPartCache(e){if(this._cache)for(const t of this._cache.values())t&&t.setAction(e,0)}setDirection(e,t){const r=this._structure.getBodyPartsUnordered(e);if(r)for(const i of r){const n=this.getBodyPartCache(i);n&&n.setDirection(t)}}setAction(e,t){const r=this._structure.getActiveBodyPartIds(e,this._avatar);for(const i of r){const n=this.getBodyPartCache(i);n&&n.setAction(e,t)}}setGeometryType(e){if(this._geometryType!==e){if(this._geometryType===Rn.SITTING&&e===Rn.VERTICAL||this._geometryType===Rn.VERTICAL&&e===Rn.SITTING||this._geometryType===Rn.SNOWWARS_HORIZONTAL&&(e=Rn.SNOWWARS_HORIZONTAL)){this._geometryType=e,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=e,this._canvas=null}}getImageContainer(e,t,r=!1){let i=this.getBodyPartCache(e);i||(i=new KI,this._cache.set(e,i));let n=i.getDirection(),o=i.getAction(),l=t;o.definition.startFromFrameZero&&(l-=o.startFrame);let c=o,h=[],u=new Map;const g=new it;if(!(!o||!o.definition)&&o.definition.isAnimation){let I=n;const O=this._structure.getAnimation(o.definition.state+"."+o.actionParameter),A=t-o.startFrame;if(O){const N=O.getLayerData(A,e,o.overridingAction);N&&(I=n+N.dd,N.dd<0?I<0?I=8+I:I>7&&(I=8-I):I<0?I=I+8:I>7&&(I=I-8),this._scale===yi.LARGE?(g.x=N.dx,g.y=N.dy):(g.x=N.dx/2,g.y=N.dy/2),l=N.animationFrame,N.action&&(o=N.action),N.type===In.BODYPART?(N.action!=null&&(c=N.action),n=I):N.type===In.FX&&(n=I),u=N.items),h=O.removeData}}let m=i.getActionCache(c);(!m||r)&&(m=new yx,i.updateActionCache(c,m));let p=m.getDirectionCache(n);if(!p||r){const I=this._structure.getParts(e,this._avatar.getFigure(),c,this._geometryType,n,h,this._avatar,u);p=new Mx(I),m.updateDirectionCache(n,p)}let f=p.getImageContainer(l);if(!f||r){const I=p.getPartList();if(f=this.renderBodyPart(n,I,l,o,r),f&&!r)f.isCacheable&&p.updateImageContainer(f,l);else return null}const T=this._structure.getFrameBodyPartOffset(c,n,l,e);return g.x+=T.x,g.y+=T.y,f.offset=g,f}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(e){let t=this._cache.get(e);return t||(t=new KI,this._cache.set(e,t)),t}renderBodyPart(e,t,r,i,n=!1){if(!t||!t.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const o=_i.DIRECTION_IS_FLIPPED[e]||!1;let l=i.definition.assetPartDefinition,c=!0,h=t.length-1;for(;h>=0;){const f=t[h];let T=16777215;if(!(e==7&&(f.partType==="fc"||f.partType==="ey"))&&!(f.partType==="ri"&&!f.partId)){const I=f.partId,O=f.getFrameDefinition(r);let A=f.partType,N=0;O?(N=O.number,O.assetPartDefinition&&O.assetPartDefinition!==""&&(l=O.assetPartDefinition)):N=f.getFrameIndex(r);let P=e,y=!1;o&&(l==="wav"&&(A===We.LEFT_HAND||A===We.LEFT_SLEEVE||A===We.LEFT_COAT_SLEEVE)||l==="drk"&&(A===We.RIGHT_HAND||A===We.RIGHT_SLEEVE||A===We.RIGHT_COAT_SLEEVE)||l==="blw"&&A===We.RIGHT_HAND||l==="sig"&&A===We.LEFT_HAND||l==="respect"&&A===We.LEFT_HAND||A===We.RIGHT_HAND_ITEM||A===We.LEFT_HAND_ITEM||A===We.CHEST_PRINT?y=!0:(e===4?P=2:e===5?P=1:e===6&&(P=0),f.flippedPartType!==A&&(A=f.flippedPartType)));let D=this._scale+"_"+l+"_"+A+"_"+I+"_"+P+"_"+N,x=this._assets.getAsset(D);if(x||(D=this._scale+"_std_"+A+"_"+I+"_"+P+"_0",x=this._assets.getAsset(D)),x){const w=x.texture;if(!w||!w.valid||!w.baseTexture)c=!1;else{f.isColorable&&f.color&&(T=f.color.rgb);const k=new it(-x.x,-x.y);if(y&&(k.x=k.x+(this._scale===yi.LARGE?65:31)),n){const F=new SS;F.name=this._assets.getAssetName(D),F.x=-k.x-33,F.y=-k.y,F.z=this._serverRenderData.length*-1e-4,F.width=x.rectangle.width,F.height=x.rectangle.height,F.flipH=y,l==="lay"&&(F.x=F.x+53),o&&(F.flipH=!F.flipH,F.flipH?F.x=-F.x-w.width:F.x=F.x+65),f.isColorable&&(F.color=`${T}`),this._serverRenderData.push(F)}this._unionImages.push(new qI(w,x.rectangle,k,y,T))}}}h--}if(!this._unionImages.length)return null;const u=this.createUnionImage(this._unionImages,o),g=this._scale===yi.LARGE?this._canvas.height-16:this._canvas.height-8,m=new it(-u.regPoint.x,g-u.regPoint.y);o&&l!=="lay"&&(m.x=m.x+(this._scale===yi.LARGE?67:31));let p=this._unionImages.length-1;for(;p>=0;){const f=this._unionImages.pop();f&&f.dispose(),p--}return new vx(u.container,m,c)}convertColorToHex(e){let t=(e*255).toString(16);return t.length<2&&(t="0"+t),t}createUnionImage(e,t){const r=new fi;for(const l of e)l&&r.enlarge(l.offsetRect);const i=new it(-r.x,-r.y),n=new Qi,o=new ds(ys.EMPTY);o.width=r.width,o.height=r.height,n.addChild(o);for(const l of e){if(!l)continue;const c=l.texture,h=l.colorTransform,u=!(t&&l.flipH)&&(t||l.flipH),g=i.clone();g.x-=l.regPoint.x,g.y-=l.regPoint.y,t&&(g.x=n.width-(g.x+l.rect.width)),u?(this._matrix.a=-1,this._matrix.tx=l.rect.x+l.rect.width+g.x,this._matrix.ty=g.y-l.rect.y):(this._matrix.a=1,this._matrix.tx=g.x-l.rect.x,this._matrix.ty=g.y-l.rect.y);const m=new ds(c);m.tint=h,m.transform.setFromMatrix(this._matrix),n.addChild(m)}return new qI(null,n.getLocalBounds(),i,t,null,n)}}lO.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;const _a=class{constructor(s,e,t,r,i,n=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=i,this._structure=s,this._assets=e,this._scale=r,this._effectListener=n,this._scale==null&&(this._scale=yi.LARGE),t==null&&(t=new Su("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=t,this._cache=new lO(this._structure,this,this._assets,this._scale),this.setDirection(_a.DEFAULT_AVATAR_SET,_a.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new Om(he.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(_a.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new As,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(lr.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const s of this._fullImageCache.getValues())s&&s.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(s){return this._structure.getPartColor(this._figure,s)}setDirection(s,e){e=e+this._directionOffset,e<_i.MIN_DIRECTION&&(e=_i.MAX_DIRECTION+(e+1)),e>_i.MAX_DIRECTION&&(e=e-(_i.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(s)&&(this._mainDirection=e),(s===lr.HEAD||s===lr.FULL)&&(s===lr.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(s,e),this._changes=!0}setDirectionAngle(s,e){this.setDirection(s,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(s){return this._structure.getBodyPartData(s.animation.id,this._frameCounter,s.id)}updateAnimationByFrames(s=1){this._frameCounter+=s,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const s of this._sortedActions){if(s.actionType=="fx"&&(s.actionParameter=="33"||s.actionParameter=="34"||s.actionParameter=="35"||s.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(s.actionType=="fx"&&(s.actionParameter=="38"||s.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(s.actionType==="dance"&&(s.actionParameter==="1"||s.actionParameter==="2"||s.actionParameter==="3"||s.actionParameter==="4")){let e=this._frameCounter%8;return s.actionParameter==="3"&&(e=this._frameCounter%10),s.actionParameter==="4"&&(e=this._frameCounter%16),this._mainDirection+s.actionType+s.actionParameter+e}}return null}getBodyParts(s,e,t){return(t!=this._cachedBodyPartsDirection||e!=this._cachedBodyPartsGeometryType||s!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=t,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=s,this._cachedBodyParts=this._structure.getBodyParts(s,e,t)),this._cachedBodyParts}getAvatarPartsForCamera(s){let e;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const r=this.getBodyParts(s,this._mainAction.definition.geometryType,this._mainDirection);let i=r.length-1;for(;i>=0;)e=r[i],this._cache.getImageContainer(e,this._frameCounter,!0),i--}getImage(s,e,t=1,r=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const i=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!i)return null;this._image&&(this._image.width!==i.width||this._image.height!==i.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const n=this.getBodyParts(s,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const o=new Qi;let l=!0,c=n.length-1;for(;c>=0;){const h=n[c],u=this._cache.getImageContainer(h,this._frameCounter);if(u){const g=u.image;if(!g)return o.destroy({children:!0}),null;l=l&&u.isCacheable;const m=u.regPoint.clone();if(m){m.x+=i.offset.x,m.y+=i.offset.y,m.x+=i.regPoint.x,m.y+=i.regPoint.y;const p=new Qi;p.addChild(g),p&&(p.position.set(m.x,m.y),o.addChild(p))}}c--}return this._avatarSpriteData&&(o.filters||(o.filters=[]),this._avatarSpriteData.colorTransform&&o.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(o),o.filters.push(new fc(this._avatarSpriteData.reds,fc.CHANNEL_RED)))),r?(this._reusableTexture?(sr.instance.renderer.render(o,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=Lt.generateTexture(o,new fi(0,0,i.width,i.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):Lt.generateTexture(o,new fi(0,0,i.width,i.height))}applyPalette(s,e=[],t=[],r=[]){const i=Lt.generateCanvas(s),n=i.getContext("2d"),o=n.getImageData(0,0,i.width,i.height),l=o.data;for(let h=0;h<l.length;h+=4){if(e.length==256){let u=e[l[h]];u===void 0&&(u=0),l[h]=u>>16&255,l[h+1]=u>>8&255,l[h+2]=u&255}if(t.length==256){let u=t[l[h+1]];u===void 0&&(u=0),l[h]=u>>16&255,l[h+1]=u>>8&255,l[h+2]=u&255}if(r.length==256){let u=t[l[h+2]];u===void 0&&(u=0),l[h]=u>>16&255,l[h+1]=u>>8&255,l[h+2]=u&255}}n.putImageData(o,0,0);const c=new bs(ys.from(i));return sr.instance.renderer.render(c,{renderTexture:s,clear:!0}),s}getImageAsSprite(s,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const t=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!t)return null;const r=this.getBodyParts(s,this._mainAction.definition.geometryType,this._mainDirection),i=new ds,n=new ds(ys.EMPTY);n.width=t.width,n.height=t.height,i.addChild(n);let o=r.length-1;for(;o>=0;){const l=r[o],c=this._cache.getImageContainer(l,this._frameCounter);if(c){const h=c.image;if(!h)return i.destroy({children:!0}),null;const u=c.regPoint.clone();if(u){u.x+=t.offset.x,u.y+=t.offset.y,u.x+=t.regPoint.x,u.y+=t.regPoint.y;const g=new Qi;g.addChild(h),g.position.set(u.x,u.y),i.addChild(g)}}o--}return i}getCroppedImage(s,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const t=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!t)return null;const r=this.getBodyParts(s,this._mainAction.definition.geometryType,this._mainDirection),i=new Qi;let n=r.length-1;for(;n>=0;){const c=r[n],h=this._cache.getImageContainer(c,this._frameCounter);if(h){const u=h.image;if(!u)return i.destroy({children:!0}),null;const g=h.regPoint.clone();if(g){g.x+=t.offset.x,g.y+=t.offset.y,g.x+=t.regPoint.x,g.y+=t.regPoint.y;const m=new Qi;m.addChild(u),m&&(m.position.set(g.x,g.y),i.addChild(m))}}n--}const o=Lt.generateTexture(i,new fi(0,0,t.width,t.height)),l=Lt.generateImage(o);return l||null}getFullImage(s){const e=this._fullImageCache.getValue(s);return e?(e.valid||(this._fullImageCache.remove(s),e.destroy(!0)),e):null}cacheFullImage(s,e){const t=this._fullImageCache.getValue(s);if(t&&(this._fullImageCache.remove(s),t.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const r=this._fullImageCache.getKey(0);r&&this._fullImageCache.remove(r).destroy(!0)}this._fullImageCache.add(s,e)}getAsset(s){return this._assets.getAsset(s)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const s of this._sortedActions)s.actionType===he.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(s.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(s.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(s,...e){let t="";switch(this._actionsSorted=!1,e&&e.length>0&&(t=e[0]),t!=null&&(t=t.toString()),s){case he.POSTURE:switch(t){case he.POSTURE_LAY:case he.POSTURE_WALK:case he.POSTURE_STAND:case he.POSTURE_SWIM:case he.POSTURE_FLOAT:case he.POSTURE_SIT:case he.SNOWWAR_RUN:case he.SNOWWAR_DIE_FRONT:case he.SNOWWAR_DIE_BACK:case he.SNOWWAR_PICK:case he.SNOWWAR_THROW:(t===he.POSTURE_LAY||t===he.POSTURE_LAY||t===he.POSTURE_LAY)&&(t===he.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(lr.FULL,4):this.setDirection(lr.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(t);break}break;case he.GESTURE:switch(t){case he.GESTURE_AGGRAVATED:case he.GESTURE_SAD:case he.GESTURE_SMILE:case he.GESTURE_SURPRISED:this.addActionData(t);break}break;case he.EFFECT:case he.DANCE:case he.TALK:case he.EXPRESSION_WAVE:case he.SLEEP:case he.SIGN:case he.EXPRESSION_RESPECT:case he.EXPRESSION_BLOW_A_KISS:case he.EXPRESSION_LAUGH:case he.EXPRESSION_CRY:case he.EXPRESSION_IDLE:case he.EXPRESSION_SNOWBOARD_OLLIE:case he.EXPRESSION_SNOWBORD_360:case he.EXPRESSION_RIDE_JUMP:t===he.EFFECT&&(t==="33"||t==="34"||t==="35"||t==="36"||t==="38"||t==="39")&&(this._useFullImageCache=!0),this.addActionData(s,t);break;case he.CARRY_OBJECT:case he.USE_OBJECT:{const r=this._structure.getActionDefinitionWithState(s);r&&(t=r.getParameterValue(t)),this.addActionData(s,t);break}}return!0}addActionData(s,e=""){let t;this._actions||(this._actions=[]);let r=0;for(;r<this._actions.length;){if(t=this._actions[r],t.actionType==s&&t.actionParameter==e)return;r++}this._actions.push(new Om(s,e,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let s,e;if(this._sortedActions==null)return!1;for(const t of this._sortedActions)s=this._structure.getActionDefinitionWithState(t.actionType),s!=null&&s.getPreventHeadTurn(t.actionParameter)&&(e=!0);return e}sortActions(){let s,e,t;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(t=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const r of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(r.actionType+r.actionParameter),r.actionType===he.EFFECT){const i=parseInt(r.actionParameter);this._effectIdInUse!==i&&(s=!0),this._effectIdInUse=i,e=!0}e||(this._effectIdInUse>-1&&(s=!0),this._effectIdInUse=-1),s&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(t=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,t}setActionsToParts(){if(!this._sortedActions==null)return;const s=tt(),e=[];for(const t of this._sortedActions)e.push(t.actionType);for(const t of this._sortedActions)if(t&&t.definition&&t.definition.isAnimation){const r=this._structure.getAnimation(t.definition.state+"."+t.actionParameter);if(r&&r.hasOverriddenActions()){const i=r.overriddenActionNames();if(i)for(const n of i)e.indexOf(n)>=0&&(t.overridingAction=r.overridingAction(n))}r&&r.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const t of this._sortedActions)if(!(!t||!t.definition)&&(t.definition.isAnimation&&t.actionParameter===""&&(t.actionParameter="1"),this.setActionToParts(t,s),t.definition.isAnimation)){this._isAnimating=t.definition.isAnimated(t.actionParameter);const r=this._structure.getAnimation(t.definition.state+"."+t.actionParameter);r&&(this._sprites=this._sprites.concat(r.spriteData),r.hasDirectionData()&&(this._directionOffset=r.directionData.offset),r.hasAvatarData()&&(this._avatarSpriteData=r.avatarData))}}setActionToParts(s,e){s==null||s.definition==null||s.definition.assetPartDefinition!=""&&(s.definition.isMain&&(this._mainAction=s,this._cache.setGeometryType(s.definition.geometryType)),this._cache.setAction(s,e),this._changes=!0)}resetBodyPartCache(s){s&&s.definition.assetPartDefinition!==""&&(s.definition.isMain&&(this._mainAction=s,this._cache.setGeometryType(s.definition.geometryType)),this._cache.resetBodyPartCache(s),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(s,e="CHANNELS_EQUAL"){let t=.33,r=.33,i=.33;switch(e){case _a.CHANNELS_UNIQUE:t=.3,r=.59,i=.11;break;case _a.CHANNELS_RED:t=1,r=0,i=0;break;case _a.CHANNELS_GREEN:t=0,r=1,i=0;break;case _a.CHANNELS_BLUE:t=0,r=0,i=1;break;case _a.CHANNELS_DESATURATED:t=.3086,r=.6094,i=.082;break}const n=new Ru;return n.matrix=[t,r,i,0,0,t,r,i,0,0,t,r,i,0,0,0,0,0,1,0],s.filters.push(n),s}errorThis(s){}logThis(s){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(s){s===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(s))}};let Pn=_a;Pn.CHANNELS_EQUAL="CHANNELS_EQUAL";Pn.CHANNELS_UNIQUE="CHANNELS_UNIQUE";Pn.CHANNELS_RED="CHANNELS_RED";Pn.CHANNELS_GREEN="CHANNELS_GREEN";Pn.CHANNELS_BLUE="CHANNELS_BLUE";Pn.CHANNELS_DESATURATED="CHANNELS_DESATURATED";Pn.DEFAULT_ACTION="Default";Pn.DEFAULT_DIRECTION=2;Pn.DEFAULT_AVATAR_SET=lr.FULL;class dd{constructor(e){this._number=e.number,this._assetPartDefinition=e.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class Dx{constructor(e){if(this._frames=[],e.frames&&e.frames.length>0)for(const t of e.frames){if(!t)continue;this._frames.push(new dd(t));let r=t.repeats||0;if(r>1)for(;--r>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const _d=class{constructor(s){if(this._id=s.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],s.parts&&s.parts.length>0)for(const e of s.parts){if(!e)continue;const t=new Dx(e);this._actionParts.set(e.setType,t),this._frameCount=Math.max(this._frameCount,t.frames.length)}if(s.offsets&&s.offsets.frames&&s.offsets.frames.length>0)for(const e of s.offsets.frames){if(!e)continue;const t=e.id;this._frameCount=Math.max(this._frameCount,t);const r=new Map;if(this._bodyPartOffsets.set(t,r),e.directions&&e.directions.length>0)for(const i of e.directions){if(!i)continue;const n=i.id,o=new Map;if(r.set(n,o),i.bodyParts&&i.bodyParts.length>0)for(const l of i.bodyParts){if(!l)continue;const c=l.id;let h=0,u=0;l.dx!==void 0&&(h=l.dx),l.dy!==void 0&&(u=l.dy),o.set(c,new it(h,u))}}if(this._frameIndexes.push(t),e.repeats!==void 0){let i=e.repeats||0;if(i>1)for(;--i>0;)this._frameIndexes.push(t)}}}getPart(s){if(!s)return null;const e=this._actionParts.get(s);return e||null}getFrameBodyPartOffset(s,e,t){const r=e%this._frameIndexes.length,i=this._frameIndexes[r],n=this._bodyPartOffsets.get(i);if(!n)return _d.DEFAULT_OFFSET;const o=n.get(s);if(!o)return _d.DEFAULT_OFFSET;const l=o.get(t);return l||_d.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};let wd=_d;wd.DEFAULT_OFFSET=new it(0,0);class Px{constructor(){this._actions=new Map}parse(e){if(e&&e.length>0)for(const t of e){if(!t)continue;const r=new wd(t);this._actions.set(r.id,r)}return!0}appendJSON(e){for(const t of e.action)this._actions.set(t.id,new wd(t));return!0}getAction(e){const t=this._actions.get(e.id);return t||null}getFrameCount(e){const t=this.getAction(e);return t?t.frameCount:0}}class Lx{constructor(e,t){this._id=e.id,this._width=e.width,this._height=e.height,this._offset=new it(e.dx,e.dy),t==yi.LARGE?this._regPoint=new it((this._width-64)/2,0):this._regPoint=new it((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}const cO=class extends Ri{constructor(s,e){super(),this._dataReceiver=e,this.download(s)}download(s){const e=new XMLHttpRequest;try{e.open("GET",s),e.send(),e.onloadend=t=>{const r=e.responseText;if(!r||!r.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(r)),this.dispatchEvent(new ct(cO.AVATAR_STRUCTURE_DONE))},e.onerror=t=>{throw new Error("invalid_avatar_figure_data")}}catch(t){xe.error(t)}}};let Am=cO;Am.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";class Ux{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._type=e.type,this._index=e.index,this._colorLayerIndex=e.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class xx{constructor(e,t){if(!e||!t)throw new Error("invalid_data");this._id=t.id,this._type=e,this._gender=t.gender,this._clubLevel=t.club,this._isColorable=t.colorable,this._isSelectable=t.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=t.preselectable,this._isSellable=t.sellable;for(const r of t.parts){const i=new Ux(r),n=this.getPartIndex(i);n!==-1?this._parts.splice(n,0,i):this._parts.push(i)}if(t.hiddenLayers)for(const r of t.hiddenLayers)this._hiddenLayers.push(r.partType)}dispose(){for(const e of this._parts)e.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(e){const t=this._parts.length;if(!t)return-1;for(let r=0;r<t;r++){const i=this._parts[r];if(i&&!(i.type!==e.type||i.index>e.index))return r}return-1}getPart(e,t){for(const r of this._parts)if(!(r.type!==e||r.id!==t))return r;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class wx{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._index=e.index,this._clubLevel=e.club||0,this._isSelectable=e.selectable,this._rgb=parseInt("0x"+e.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class XI{constructor(e){if(!e)throw new Error("invalid_data");this._id=e.id,this._colors=new As,this.append(e)}append(e){for(const t of e.colors){const r=new wx(t);this._colors.add(t.id.toString(),r)}}getColor(e){return e===void 0||e<0?null:this._colors.getValue(e.toString())||null}get id(){return this._id}get colors(){return this._colors}}class vg{constructor(e){if(!e)throw new Error("invalid_data");this._type=e.type,this._paletteId=e.paletteId,this._isMandatory={},this._isMandatory.F=[e.mandatory_f_0,e.mandatory_f_1],this._isMandatory.M=[e.mandatory_m_0,e.mandatory_m_1],this._partSets=new As,this.append(e)}dispose(){for(const e of this._partSets.getValues())e.dispose();this._partSets=null}cleanUp(e){for(const t of e.sets){const r=t.id.toString(),i=this._partSets.getValue(r);i&&(i.dispose(),this._partSets.remove(r))}}append(e){if(!(!e||!e.sets))for(const t of e.sets)this._partSets.add(t.id.toString(),new xx(this._type,t))}getDefaultPartSet(e){for(const t of this._partSets.getValues())if(t&&t.clubLevel===0&&(t.gender===e||t.gender==="U"))return t;return null}getPartSet(e){return this._partSets.getValue(e.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(e,t){return this._isMandatory[e.toUpperCase()][Math.min(t,1)]}optionalFromClubLevel(e){return this._isMandatory[e.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class Fx{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(e){if(!e)return!1;for(const t of e.palettes){const r=new XI(t);r&&this._palettes.set(r.id.toString(),r)}for(const t of e.setTypes){const r=new vg(t);r&&this._setTypes.set(r.type,r)}return!0}injectJSON(e){for(const t of e.setTypes){const r=this._setTypes.get(t.type);r?r.cleanUp(t):this._setTypes.set(t.type,new vg(t))}this.appendJSON(e)}appendJSON(e){if(!e)return!1;for(const t of e.palettes){const r=t.id.toString(),i=this._palettes.get(r);i?i.append(t):this._palettes.set(r,new XI(t))}for(const t of e.setTypes){const r=t.type,i=this._setTypes.get(r);i?i.append(t):this._setTypes.set(r,new vg(t))}return!1}getMandatorySetTypeIds(e,t){const r=[];for(const i of this._setTypes.values())!i||!i.isMandatory(e,t)||r.push(i.type);return r}getDefaultPartSet(e,t){const r=this._setTypes.get(e);return r?r.getDefaultPartSet(t):null}getSetType(e){return this._setTypes.get(e)||null}getPalette(e){return this._palettes.get(e.toString())||null}getFigurePartSet(e){for(const t of this._setTypes.values()){const r=t.getPartSet(e);if(r)return r}return null}}class QI{constructor(e){if(this._id=e.id,this._parts=[],e.activeParts&&e.activeParts.length>0)for(const t of e.activeParts)t&&this._parts.push(t.setType)}get parts(){return this._parts}}class Mg{constructor(e){if(!e)throw new Error("invalid_data");this._setType=e.setType,this._flippedSetType=e.flippedSetType||null,this._removeSetType=e.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(e){this._staticId=e}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(e){this._flippedSetType=e}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(e){this._appendToFigure=e}}class kx{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(e){if(e.partSet&&e.partSet.length>0)for(const t of e.partSet)t&&this._parts.set(t.setType,new Mg(t));if(e.activePartSets&&e.activePartSets.length>0)for(const t of e.activePartSets)t&&this._activePartSets.set(t.id,new QI(t));return!0}appendJSON(e){if(e.partSet&&e.partSet.length>0)for(const t of e.partSet)t&&this._parts.set(t.setType,new Mg(t));if(e.activePartSets&&e.activePartSets.length>0)for(const t of e.activePartSets)t&&this._activePartSets.set(t.id,new QI(t));return!1}getActiveParts(e){const t=this._activePartSets.get(e.activePartSet);return t?t.parts:[]}getPartDefinition(e){const t=this._parts.get(e);return t||null}addPartDefinition(e){const t=e.setType;let r=this._parts.get(t);return r||(r=new Mg(e),this._parts.set(t,r)),r}getActivePartSet(e){const t=this._activePartSets.get(e.activePartSet);return t||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class Dg{constructor(e,t,r,i,n,o,l,c,h="",u=!1,g=1){this._bodyPartId=e,this._partType=t,this._partId=r,this._color=i,this._frames=n,this._action=o,this._isColorable=l,this._paletteMapId=c,this._flippedPartType=h,this._isBlendable=u,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(e){if(!this._frames||!this._frames.length)return 0;const t=e%this._frames.length;return this._frames[t]instanceof dd?this._frames[t].number:t}getFrameDefinition(e){const t=e%this._frames.length;return this._frames&&this._frames.length>t&&this._frames[t]instanceof dd?this._frames[t]:null}getCacheableKey(e){const t=e%this._frames.length;if(this._frames&&this._frames.length>t&&this._frames[t]instanceof dd){const r=this._frames[t];return this.partId+":"+r.assetPartDefinition+":"+r.number}return this.partId+":"+t}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(e){this._isColorable=e}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}const hs=class{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(s,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(s)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(s){if(s)for(const e of s.split(".")){const t=e.split("-");if(t.length>0){const r=t[0],i=parseInt(t[1]),n=[];let o=2;for(;o<t.length;)n.push(parseInt(t[o])),o++;n.length||n.push(0),this.savePartSetId(r,i,!1),this.savePartSetColourId(r,n,!1)}}}hasSetType(s){return!!this._data.get(s)}getPartSetId(s){return this.hasSetType(s)?this._data.get(s):-1}getColourIds(s){return this._colors.get(s)?this._colors.get(s):[]}getFigureString(){let s="";const e=[];for(const[r,i]of this._data.entries()){let n=r+"-"+i;const o=this._colors.get(r);if(o)for(const l of o)n=n+("-"+l);e.push(n)}let t=0;for(;t<e.length;)s=s+e[t],t<e.length-1&&(s=s+"."),t++;return s}savePartData(s,e,t,r=!1){this.savePartSetId(s,e,r),this.savePartSetColourId(s,t,r)}savePartSetId(s,e,t=!0){switch(s){case hs.HD:case hs.HAIR:case hs.HAT:case hs.HEAD_ACCESSORIES:case hs.EYE_ACCESSORIES:case hs.FACE_ACCESSORIES:case hs.SHIRT:case hs.JACKET:case hs.CHEST_ACCESSORIES:case hs.CHEST_PRINTS:case hs.TROUSERS:case hs.SHOES:case hs.TROUSER_ACCESSORIES:e>=0?this._data.set(s,e):this._data.delete(s)}}savePartSetColourId(s,e,t=!0){switch(s){case hs.HD:case hs.HAIR:case hs.HAT:case hs.HEAD_ACCESSORIES:case hs.EYE_ACCESSORIES:case hs.FACE_ACCESSORIES:case hs.SHIRT:case hs.JACKET:case hs.CHEST_ACCESSORIES:case hs.CHEST_PRINTS:case hs.TROUSERS:case hs.SHOES:case hs.TROUSER_ACCESSORIES:this._colors.set(s,e);return}}getFigureStringWithFace(s){const e=[hs.HD];let t="";const r=[];for(const n of e){const o=this._colors.get(n);if(o){let l=this._data.get(n);n===hs.HD&&(l=s);let c=n+"-"+l;if(l>=0){let h=0;for(;h<o.length;)c=c+("-"+o[h]),h++}r.push(c)}}let i=0;for(;i<r.length;)t=t+r[i],i<r.length-1&&(t=t+"."),i++;return t}get gender(){return this._gender}};let ir=hs;ir.MALE="M";ir.FEMALE="F";ir.UNISEX="U";ir.SCALE="h";ir.STD="std";ir.DEFAULT_FRAME="0";ir.HD="hd";ir.HAIR="hr";ir.HAT="ha";ir.HEAD_ACCESSORIES="he";ir.EYE_ACCESSORIES="ea";ir.FACE_ACCESSORIES="fa";ir.JACKET="cc";ir.SHIRT="ch";ir.CHEST_ACCESSORIES="ca";ir.CHEST_PRINTS="cp";ir.TROUSERS="lg";ir.SHOES="sh";ir.TROUSER_ACCESSORIES="wa";ir.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];class Gx{constructor(e){this._data=[],this._maxSize=e,this._index=0}reset(){this._data=[],this._index=0}addValue(e){this._data.length<this._maxSize?this._data.push(e):this._data[this._index]=e,this._index=(this._index+1)%this._maxSize}getMax(){let e=Number.MIN_VALUE,t=0;for(;t<this._maxSize;)this._data[t]>e&&(e=this._data[t]),t++;return e}getMin(){let e=Number.MAX_VALUE,t=0;for(;t<this._maxSize;)this._data[t]<e&&(e=this._data[t]),t++;return e}}class rr{constructor(e,t){this._location=e,this._direction=t}get location(){return this._location}get direction(){return this._direction}}class D_ extends Ti{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(e){}onDispose(){this._object=null}update(e){this._time=e}processUpdateMessage(e){!e||!this._object||(this._object.setLocation(e.location),this._object.setDirection(e.direction))}getEventTypes(){return[]}mergeTypes(e,t){const r=e.concat();for(const i of t)!i||r.indexOf(i)>=0||r.push(i);return r}mouseEvent(e,t){}useObject(){}setObject(e){if(this._object!==e){if(this._object&&this._object.setLogic(null),!e){this.dispose(),this._object=null;return}this._object=e,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(e){this._events=e}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class uO{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(e){return this._map.get(e)}setValue(e,t){this._map.has(e)&&this._map.get(e)===t||(this._map.set(e,t),this._updateCounter++)}removeKey(e){e&&(this._map.delete(e),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const hO=class extends Ti{constructor(s,e,t){super(),this._id=s,this._instanceId=hO.OBJECT_COUNTER++,this._type=t,this._model=new uO,this._location=new G,this._direction=new G,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let r=e-1;for(;r>=0;)this._states[r]=0,r--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(s){s&&(s.x===this._location.x&&s.y===this._location.y&&s.z===this._location.z||(this._location.x=s.x,this._location.y=s.y,this._location.z=s.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(s){s&&(s.x===this._direction.x&&s.y===this._direction.y&&s.z===this._direction.z||(this._direction.x=(s.x%360+360)%360,this._direction.y=(s.y%360+360)%360,this._direction.z=(s.z%360+360)%360,this._updateCounter++))}getState(s=0){return s>=0&&s<this._states.length?this._states[s]:-1}setState(s,e=0){return e>=0&&e<this._states.length?(this._states[e]!==s&&(this._states[e]=s,this._updateCounter++),!0):!1}setVisualization(s){this._visualization!==s&&(this._visualization&&this._visualization.dispose(),this._visualization=s,this._visualization&&(this._visualization.object=this))}setLogic(s){if(this._logic===s)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=s,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const t=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(t)}}processUpdateMessage(s){if(this._logic)return this._logic.processUpdateMessage(s);this._pendingLogicMessages.push(s)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(s){this._updateCounter=s}get isReady(){return this._isReady}set isReady(s){this._isReady=s}};let dO=hO;dO.OBJECT_COUNTER=0;const _O=class{constructor(){this._id=_O.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=$r.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=ba.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._skipMouseHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=vi.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(s){this._id=s}get name(){return this._name}set name(s){this._name!==s&&(this._name=s,this._updateCounter++)}get type(){return this._type}set type(s){this._type=s}get spriteType(){return this._spriteType}set spriteType(s){this._spriteType=s}get texture(){return this._texture}set texture(s){this._texture!==s&&(s&&(this._width=s.width,this._height=s.height),this._texture=s,this._updateCounter++)}get container(){return this._container}set container(s){this._container!==s&&(this.texture=ys.EMPTY,s&&(this._width=s.width,this._height=s.height),this._container=s,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(s){this._offsetX!==s&&(this._offsetX=s,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(s){this._offsetY!==s&&(this._offsetY=s,this._updateCounter++)}get flipH(){return this._flipH}set flipH(s){this._flipH!==s&&(this._flipH=s,this._updateCounter++)}get flipV(){return this._flipV}set flipV(s){this._flipV!==s&&(this._flipV=s,this._updateCounter++)}get direction(){return this._direction}set direction(s){this._direction=s}get alpha(){return this._alpha}set alpha(s){s=s&255,this._alpha!==s&&(this._alpha=s,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(s){this._blendMode!==s&&(this._blendMode=s,this._updateCounter++)}get color(){return this._color}set color(s){s=s&16777215,this._color!==s&&(this._color=s,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(s){this._relativeDepth!==s&&(this._relativeDepth=s,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(s){s!==this._varyingDepth&&(this._varyingDepth=s,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(s){this._libraryAssetName=s}get clickHandling(){return this._clickHandling}set clickHandling(s){this._clickHandling!==s&&(this._clickHandling=s,this._updateCounter++)}get visible(){return this._visible}get skipMouseHandling(){return this._skipMouseHandling}set skipMouseHandling(s){this._skipMouseHandling!==s&&(this._skipMouseHandling=s,this._updateCounter++)}set visible(s){this._visible!==s&&(this._visible=s,this._updateCounter++)}get tag(){return this._tag}set tag(s){this._tag!==s&&(this._tag=s,this._updateCounter++)}get posture(){return this._posture}set posture(s){this._posture!==s&&(this._posture=s,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(s){this._alphaTolerance!==s&&(this._alphaTolerance=s,this._updateCounter++)}get filters(){return this._filters}set filters(s){this._filters=s,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(s){this._updateContainer=s}};let Nm=_O;Nm.SPRITE_COUNTER=0;const gO=class{constructor(){this._id=gO.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(s){return!1}update(s,e,t,r){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const s=this._sprites[0];s&&s.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(s){return s>=0&&s<this._sprites.length?this._sprites[s]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(s){const e=new Nm;return s>=this._sprites.length?this._sprites.push(e):this._sprites.splice(s,0,e),e}createSprites(s){for(;this._sprites.length>s;){const e=this._sprites[this._sprites.length-1];e&&e.dispose(),this._sprites.pop()}for(;this._sprites.length<s;)this._sprites.push(new Nm)}get image(){return this.getImage(0,-1)}getImage(s,e){const t=this.getBoundingRectangle();if(t.width*t.height===0)return null;const r=this.totalSprites,i=[];let n=0;for(;n<r;){const c=this.getSprite(n);c&&c.visible&&c.texture&&i.push(c),n++}i.sort((c,h)=>h.relativeDepth-c.relativeDepth);const o=new Qi;for(n=0;n<i.length;){const c=i[n],h=c.texture;if(h){const u=new ds(h);u.alpha=c.alpha/255,u.tint=c.color,u.x=c.offsetX,u.y=c.offsetY,u.blendMode=c.blendMode,u.filters=c.filters,c.flipH&&(u.scale.x=-1),c.flipV&&(u.scale.y=-1),o.addChild(u)}n++}const l=Lt.generateTexture(o);return l||null}getBoundingRectangle(){const s=this.totalSprites,e=new fi;let t=0;for(;t<s;){const r=this.getSprite(t);if(r&&r.texture&&r.visible){const i=r.flipH?-r.width+r.offsetX:r.offsetX,n=r.flipV?-r.height+r.offsetY:r.offsetY,o=new it(i,n);t===0?(e.x=o.x,e.y=o.y,e.width=r.width,e.height=r.height):(o.x<e.x&&(e.x=o.x),o.y<e.y&&(e.y=o.y),o.x+r.width>e.right&&(e.width=o.x+r.width-e.x),o.y+r.height>e.bottom&&(e.height=o.y+r.height-e.y))}t++}return e}get instanceId(){return this._id}get object(){return this._object}set object(s){this._object=s}get asset(){return this._asset}set asset(s){this._asset&&this._asset.removeReference(),this._asset=s,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(s){this._updateObjectCounter=s}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(s){this._updateModelCounter=s}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(s){this._updateSpriteCounter=s}get spriteCount(){return this._sprites.length}};let $u=gO;$u.VISUALIZATION_COUNTER=0;class Bx{constructor(e){this._roomObjectVariableAccurateZ=e||"",this._location=new G,this._screenLocation=new G,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(e,t){if(!e||!t)return null;let r=!1;const i=e.getLocation();if((t.updateId!==this._geometryUpdateId||e.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=e.updateCounter,(t.updateId!==this._geometryUpdateId||i.x!==this._location.x||i.y!==this._location.y||i.z!==this._location.z)&&(this._geometryUpdateId=t.updateId,this._location.assign(i),r=!0)),this._locationChanged=r,this._locationChanged){const n=t.getScreenPosition(i);if(!n)return null;const o=e.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(o)||o===0){const l=new G(Math.round(i.x),Math.round(i.y),i.z);if(l.x!==i.x||l.y!==i.y){const c=t.getScreenPosition(l);this._screenLocation.assign(n),c&&(this._screenLocation.z=c.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class Vx{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(e){this._sprites.push(e)}getSprite(e){return this._sprites[e]}get sprites(){return this._sprites}needsUpdate(e,t){return e===this._updateId1&&t===this._updateId2?!1:(this._updateId1=e,this._updateId2=t,!0)}setSpriteCount(e){if(e<this._sprites.length){let t=e;for(;t<this._sprites.length;){const r=this._sprites[t];r&&r.dispose(),t++}this._sprites.splice(e,this._sprites.length-e)}this._isEmpty=!this._sprites.length}}class Hx{constructor(e){this._location=new Bx(e),this._sprites=new Vx}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(e){this._objectId=e}}const bm=class{constructor(s){this._data=new Map,this._roomObjectVariableAccurateZ=s}dispose(){if(this._data){for(const[s,e]of this._data.entries())e&&(this._data.delete(s),e.dispose());this._data=null}}getObjectCache(s){let e=this._data.get(s);return e||(e=new Hx(this._roomObjectVariableAccurateZ),this._data.set(s,e)),e}removeObjectCache(s){const e=this._data.get(s);e&&(this._data.delete(s),e.dispose())}getSortableSpriteList(){const s=[];for(const e of this._data.values()){if(!e)continue;const t=e.sprites&&e.sprites.sprites;if(!(!t||!t.length)){for(const r of t)if(r&&r.sprite.spriteType!==$r.ROOM_PLANE&&r.sprite.name!==""){const i=new SS;i.objectId=e.objectId,i.x=r.x,i.y=r.y,i.z=r.z,i.name=r.sprite.name||"",i.flipH=r.sprite.flipH,i.alpha=r.sprite.alpha,i.color=r.sprite.color.toString(),i.blendMode=r.sprite.blendMode.toString(),i.width=r.sprite.width,i.height=r.sprite.height,i.type=r.sprite.type,i.posture=r.sprite.posture;const n=this.isSkewedSprite(r.sprite);n&&(i.skew=r.sprite.direction%4===0?-.5:.5),(n||r.name.indexOf("%image.library.url%")>=0||r.name.indexOf("%group.badge.url%")>=0)&&i.width<=bm.MAX_SIZE_FOR_AVG_COLOR&&i.height<=bm.MAX_SIZE_FOR_AVG_COLOR&&r.sprite.name.indexOf("external_image_wallitem")===0&&(i.frame=!0),s.push(i)}}}return!s||!s.length?null:s}isSkewedSprite(s){return s.type?s.type.indexOf("external_image_wallitem")===0&&s.tag==="THUMBNAIL"||s.type.indexOf("guild_forum")===0&&s.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const s=[];for(const e of this._data.values())for(const t of e.sprites.sprites)t.sprite.spriteType===$r.ROOM_PLANE&&s.push(t);return s}};let mO=bm;mO.MAX_SIZE_FOR_AVG_COLOR=200;const Ja=class{static hex2rgb(s,e=[]){return e[0]=(s>>16&255)/255,e[1]=(s>>8&255)/255,e[2]=(s&255)/255,e}static hex2rgba(s,e=[]){return e[0]=(s>>16&255)/255,e[1]=(s>>8&255)/255,e[2]=(s&255)/255,e[3]=s&255,e}static rgb2hex(s){return(s[0]*255<<16)+(s[1]*255<<8)+(s[2]*255|0)}static rgba2hex(s){return(s[0]*255<<16)+(s[1]*255<<8)+(s[2]*255|0)+(s[3]|0)}static rgbStringToHex(s){const e=s.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+Ja.getHex(e[1])+Ja.getHex(e[2])+Ja.getHex(e[3])}static getHex(s){return isNaN(s)?"00":Ja.HEX_DIGITS[(s-s%16)/16]+Ja.HEX_DIGITS[s%16]}static int2rgb(s){s>>>=0;const e=s&255,t=(s&65280)>>>8;return"rgba("+[(s&16711680)>>>16,t,e,1].join(",")+")"}static rgbToHSL(s){const e=(s>>16&255)/255,t=(s>>8&255)/255,r=(s&255)/255,i=Math.max(e,t,r),n=Math.min(e,t,r),o=i-n;let l=0,c=0,h=0;o==0?l=0:i==e?t>r?l=60*(t-r)/o:l=60*(t-r)/o+360:i==t?l=60*(r-e)/o+120:i==r&&(l=60*(e-t)/o+240),c=.5*(i+n),o==0?h=0:c<=.5?h=o/c*.5:h=o/(1-c)*.5;const u=Math.round(l/360*255),g=Math.round(h*255),m=Math.round(c*255);return(u<<16)+(g<<8)+m}static hslToRGB(s){let e,t,r,i,n;const o=(s>>16&255)/255,l=(s>>8&255)/255,c=(s&255)/255;let h=0,u=0,g=0;l>0?(e=0,t=0,c<.5?e=c*(1+l):e=c+l-c*l,t=2*c-e,r=o+1/3,i=o,n=o-1/3,r<0?r=r+1:r>1&&r--,i<0?i=i+1:i>1&&i--,n<0?n=n+1:n>1&&n--,r*6<1?h=t+(e-t)*6*r:r*2<1?h=e:r*3<2?h=t+(e-t)*6*(2/3-r):h=t,i*6<1?u=t+(e-t)*6*i:i*2<1?u=e:i*3<2?u=t+(e-t)*6*(2/3-i):u=t,n*6<1?g=t+(e-t)*6*n:n*2<1?g=e:n*3<2?g=t+(e-t)*6*(2/3-n):g=t):(h=c,u=c,g=c);const m=Math.round(h*255),p=Math.round(u*255),f=Math.round(g*255);return(m<<16)+(p<<8)+f}static rgb2xyz(s){let e=(s>>16&255)/255,t=(s>>8&255)/255,r=(s>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e=e/12.92,t>.04045?t=Math.pow((t+.055)/1.055,2.4):t=t/12.92,r>.04045?r=Math.pow((r+.055)/1.055,2.4):r=r/12.92,e=e*100,t=t*100,r=r*100,new G(e*.4124+t*.3576+r*.1805,e*.2126+t*.7152+r*.0722,e*.0193+t*.1192+r*.9505)}static xyz2CieLab(s){let e=s.x/95.047,t=s.y/100,r=s.z/108.883;return e>.008856?e=Math.pow(e,1/3):e=7.787*e+16/116,t>.008856?t=Math.pow(t,1/3):t=7.787*t+16/116,r>.008856?r=Math.pow(r,1/3):r=7.787*r+16/116,new G(116*t-16,500*(e-t),200*(t-r))}static rgb2CieLab(s){return Ja.xyz2CieLab(Ja.rgb2xyz(s))}static colorize(s,e){if(e===4294967295)return s;let t=e>>16&255,r=e>>8&255,i=e&255;return t=(s>>16&255)*t/255,r=(s>>8&255)*r/255,i=(s&255)*i/255,(s&&4278190080)|t<<16|r<<8|i}};let Sr=Ja;Sr.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];class $I{constructor(e){e<0&&(e=0),this._reservedNumbers=[],this._freeNumbers=[];let t=0;for(;t<e;)this._freeNumbers.push(t),t++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const e=this._freeNumbers.pop();return this._reservedNumbers.push(e),e}return-1}freeNumber(e){const t=this._reservedNumbers.indexOf(e);t>=0&&(this._reservedNumbers.splice(t,1),this._freeNumbers.push(e))}}class Wx{static getFlipHBitmapData(e){if(!e)return null;const t=Lt.createRenderTexture(e.width,e.height),r=new Zr;return r.scale(-1,1),r.translate(e.width,0),sr.instance.renderer.render(new bs(e),{renderTexture:t,clear:!0,transform:r}),t}static getFlipVBitmapData(e){if(!e)return null;const t=new Zr;t.scale(1,-1),t.translate(0,e.height);const r=new hm;return r.beginTextureFill({texture:e,matrix:t}).drawRect(0,0,e.width,e.height).endFill(),Lt.generateTexture(r)}static getFlipHVBitmapData(e){if(!e)return null;const t=new Zr;t.scale(-1,-1),t.translate(e.width,e.height);const r=new hm;return r.beginTextureFill({texture:e,matrix:t}).drawRect(0,0,e.width,e.height).endFill(),Lt.generateTexture(r)}}const kt=class{static init(s,e){kt._currentDelta=0,kt._startDelayMs=s,kt._effectDurationMs=e,kt._initializationTimeMs=tt(),kt._state=kt.STATE_START_DELAY}static turnVisualizationOn(){if(kt._state===kt.STATE_NOT_INITIALIZED||kt._state===kt.STATE_OVER)return;const s=tt()-kt._initializationTimeMs;if(s>kt._startDelayMs+kt._effectDurationMs){kt._state=kt.STATE_OVER;return}if(kt._visualizationOn=!0,s<kt._startDelayMs){kt._state=kt.STATE_START_DELAY;return}kt._state=kt.STATE_RUNNING,kt._currentDelta=(s-kt._startDelayMs)/kt._effectDurationMs}static turnVisualizationOff(){kt._visualizationOn=!1}static isVisualizationOn(){return kt._visualizationOn&&kt.isRunning()}static isRunning(){return kt._state===kt.STATE_START_DELAY||kt._state===kt.STATE_RUNNING}static getDelta(s=0,e=1){return Math.min(Math.max(kt._currentDelta,s),e)}static get totalRunningTime(){return kt._startDelayMs+kt._effectDurationMs}};let tr=kt;tr.STATE_NOT_INITIALIZED=0;tr.STATE_START_DELAY=1;tr.STATE_RUNNING=2;tr.STATE_OVER=3;tr._state=kt.STATE_NOT_INITIALIZED;tr._visualizationOn=!1;tr._currentDelta=0;tr._initializationTimeMs=0;tr._startDelayMs=20*1e3;tr._effectDurationMs=2e3;const Ko=class{constructor(s,e,t,r=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=s,this._x=new G,this._y=new G,this._z=new G,this._directionAxis=new G,this._location=new G,this._direction=new G,this._depth=new G,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new G(t.x,t.y,t.z),this.direction=new G(e.x,e.y,e.z),r!=null?this.setDepthVector(r):this.setDepthVector(e),this._displacements=new Map}static getIntersectionVector(s,e,t,r){const i=G.dotProduct(e,r);if(Math.abs(i)<1e-5)return null;const n=G.dif(s,t),o=-G.dotProduct(r,n)/i;return G.sum(s,G.product(e,o))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(s){s<=1&&(s=1),s=s*Math.sqrt(.5),s!=this._scale&&(this._scale=s,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(s){if(s==null)return;this._loc==null&&(this._loc=new G);const e=this._loc.x,t=this._loc.y,r=this._loc.z;this._loc.assign(s),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=e||this._loc.y!=t||this._loc.z!=r)&&this._updateId++}get direction(){return this._direction}set direction(s){let e,t,r,i,n;if(s==null)return;this._dir==null&&(this._dir=new G);const o=this._dir.x,l=this._dir.y,c=this._dir.z;this._dir.assign(s),this._direction.assign(s),(this._dir.x!=o||this._dir.y!=l||this._dir.z!=c)&&this._updateId++;const h=new G(0,1,0),u=new G(0,0,1),g=new G(1,0,0),m=s.x/180*Math.PI,p=s.y/180*Math.PI,f=s.z/180*Math.PI,T=Math.cos(m),I=Math.sin(m),O=G.sum(G.product(h,T),G.product(g,-I)),A=new G(u.x,u.y,u.z),N=G.sum(G.product(h,I),G.product(g,T)),P=Math.cos(p),y=Math.sin(p),D=new G(O.x,O.y,O.z),x=G.sum(G.product(A,P),G.product(N,y)),w=G.sum(G.product(A,-y),G.product(N,P));f!=0?(e=Math.cos(f),t=Math.sin(f),r=G.sum(G.product(D,e),G.product(x,t)),i=G.sum(G.product(D,-t),G.product(x,e)),n=new G(w.x,w.y,w.z),this._x.assign(r),this._y.assign(i),this._z.assign(n),this._directionAxis.assign(this._z)):(this._x.assign(D),this._y.assign(x),this._z.assign(w),this._directionAxis.assign(this._z))}set x_scale(s){this._x_scale!=s*this._x_scale_internal&&(this._x_scale=s*this._x_scale_internal,this._updateId++)}set y_scale(s){this._y_scale!=s*this._y_scale_internal&&(this._y_scale=s*this._y_scale_internal,this._updateId++)}set z_scale(s){this._z_scale!=s*this._z_scale_internal&&(this._z_scale=s*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(s,e){let t,r;s==null||e==null||this._displacements!=null&&(t=Math.trunc(Math.round(s.x))+"_"+Math.trunc(Math.round(s.y))+"_"+Math.trunc(Math.round(s.z)),this._displacements.delete(t),r=new G,r.assign(e),this._displacements.set(t,r),this._updateId++)}getDisplacenent(s){let e;return this._displacements!=null?(e=Math.trunc(Math.round(s.x))+"_"+Math.trunc(Math.round(s.y))+"_"+Math.trunc(Math.round(s.z)),this._displacements.get(e)):null}setDepthVector(s){let e,t,r;const i=new G(0,1,0),n=new G(0,0,1),o=new G(1,0,0),l=s.x/180*Math.PI,c=s.y/180*Math.PI,h=s.z/180*Math.PI,u=Math.cos(l),g=Math.sin(l),m=G.sum(G.product(i,u),G.product(o,-g)),p=new G(n.x,n.y,n.z),f=G.sum(G.product(i,g),G.product(o,u)),T=Math.cos(c),I=Math.sin(c),O=new G(m.x,m.y,m.z),A=G.sum(G.product(p,T),G.product(f,I)),N=G.sum(G.product(p,-I),G.product(f,T));h!=0?(e=Math.cos(h),t=Math.sin(h),G.sum(G.product(O,e),G.product(A,t)),G.sum(G.product(O,-t),G.product(A,e)),r=new G(N.x,N.y,N.z),this._depth.assign(r)):this._depth.assign(N),this._updateId++}adjustLocation(s,e){if(s==null||this._z==null)return;const t=G.product(this._z,-e),r=new G(s.x+t.x,s.y+t.y,s.z+t.z);this.location=r}getCoordinatePosition(s){if(s==null)return null;const e=G.scalarProjection(s,this._x),t=G.scalarProjection(s,this._y),r=G.scalarProjection(s,this._z);return new G(e,t,r)}getScreenPosition(s){let e=G.dif(s,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let t=G.scalarProjection(e,this._depth);if(t<this._clipNear||t>this._clipFar)return null;let r=G.scalarProjection(e,this._x),i=-G.scalarProjection(e,this._y);r=r*this._scale,i=i*this._scale;const n=this.getDisplacenent(s);return n!=null&&(e=G.dif(s,this._loc),e.add(n),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,t=G.scalarProjection(e,this._depth)),e.x=r,e.y=i,e.z=t,e}getScreenPoint(s){const e=this.getScreenPosition(s);return e==null?null:new it(e.x,e.y)}getPlanePosition(s,e,t,r){let i,n;const o=s.x/this._scale,l=-s.y/this._scale,c=G.product(this._x,o);c.add(G.product(this._y,l));const h=new G(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);h.add(c);const u=this._z,g=new G(e.x*this._x_scale,e.y*this._y_scale,e.z*this._z_scale),m=new G(t.x*this._x_scale,t.y*this._y_scale,t.z*this._z_scale),p=new G(r.x*this._x_scale,r.y*this._y_scale,r.z*this._z_scale),f=G.crossProduct(m,p),T=new G;return T.assign(Ko.getIntersectionVector(h,u,g,f)),T!=null?(T.subtract(g),i=G.scalarProjection(T,t)/m.length*t.length,n=G.scalarProjection(T,r)/p.length*r.length,new it(i,n)):null}performZoom(){this.isZoomedIn()?this.scale=Ko.SCALE_ZOOMED_OUT:this.scale=Ko.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==Ko.SCALE_ZOOMED_IN}performZoomOut(){this.scale=Ko.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=Ko.SCALE_ZOOMED_IN}};let No=Ko;No.SCALE_ZOOMED_IN=64;No.SCALE_ZOOMED_OUT=32;const ym=class{static makeRoomPreviewerId(s){return(s&65535)+ym.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(s){return s>=ym.PREVIEW_ROOM_ID_BASE}};let Zn=ym;Zn.PREVIEW_ROOM_ID_BASE=2147418112;class Ui{static init(e,t){this._SafeStr_4513=0,this._SafeStr_4515=e,this._SafeStr_4516=t,this._SafeStr_4514=tt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const e=tt()-this._SafeStr_4514;if(e>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,e<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(e-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}Ui.STATE_NOT_INITIALIZED=0;Ui.STATE_START_DELAY=1;Ui.STATE_RUNNING=2;Ui.STATE_OVER=3;Ui._SafeStr_448=0;Ui._SafeStr_4512=!1;Ui._SafeStr_4513=0;Ui._SafeStr_4514=0;Ui._SafeStr_4515=2e4;Ui._SafeStr_4516=5e3;class xi{static init(e,t){this._SafeStr_4513=0,this._SafeStr_4515=e,this._SafeStr_4516=t,this._SafeStr_4514=tt(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const e=tt()-this._SafeStr_4514;if(e>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,e<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(e-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}xi.STATE_NOT_INITIALIZED=0;xi.STATE_START_DELAY=1;xi.STATE_RUNNING=2;xi.STATE_OVER=3;xi._SafeStr_448=0;xi._SafeStr_4512=!1;xi._SafeStr_4514=0;xi._SafeStr_4515=2e4;xi._SafeStr_4516=5e3;class jx{static hex2int(e){return parseInt(e,16)}static inkToBlendMode(e){return e=="ADD"||e==33?ba.ADD:e=="SUBTRACT"?ba.SUBTRACT:e=="DARKEN"?ba.DARKEN:ba.NORMAL}}class Fd extends bs{constructor(e=null){super(e),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(e,t){return this._pairedSpriteId===e&&this._pairedSpriteUpdateCounter===t?!1:(this._pairedSpriteId=e,this._pairedSpriteUpdateCounter=t,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(e){e||(e=ys.EMPTY),e!==this.texture&&(e===ys.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=e)}containsPoint(e){return Fd.containsPoint(this,e)}static containsPoint(e,t){if(!e||!t||e.alphaTolerance>255||!(e instanceof bs))return!1;if(e.texture===ys.EMPTY||e.blendMode!==ba.NORMAL)return;const r=e.texture,i=r.baseTexture;if(!r||!i||!i.valid)return!1;const n=t.x*e.scale.x,o=t.y*e.scale.y;if(!e.getLocalBounds().contains(n,o)||!i.hitMap&&!Fd.generateHitMap(i))return!1;const l=i.hitMap;let c=n+r.frame.x,h=o+r.frame.y;r.trim&&(c-=r.trim.x,h-=r.trim.y),c=Math.round(c)*i.resolution,h=Math.round(h)*i.resolution;const u=c+h*i.realWidth,g=u%32,m=u/32|0;return(l[m]&1<<g)!==0}static generateHitMap(e){if(!e)return!1;const t=new ys(e),r=new bs(t),i=Lt.getPixels(r),n=e.width,o=e.height,l=new Uint32Array(Math.ceil(n*o/32)),c=vi.MATCH_OPAQUE_PIXELS;for(let h=0;h<n*o;h++){const u=h%32,g=h/32|0;i[h*4+3]>=c&&(l[g]=l[g]|1<<u)}return e.hitMap=l,r.destroy(),t.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(e){this._offsetX=e}get offsetY(){return this._offsetY}set offsetY(e){this._offsetY=e}get tag(){return this._tag}set tag(e){this._tag=e}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(e){this._alphaTolerance=e}get varyingDepth(){return this._varyingDepth}set varyingDepth(e){this._varyingDepth=e}get clickHandling(){return this._clickHandling}set clickHandling(e){this._clickHandling=e}}class Yx{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(e){this._objectId=e}get spriteTag(){return this._spriteTag}set spriteTag(e){this._spriteTag=e}}const fO=class{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-fO.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(s){this._name=s}get sprite(){return this._sprite}set sprite(s){this._sprite=s}get x(){return this._x}set x(s){this._x=s}get y(){return this._y}set y(s){this._y=s}get z(){return this._z}set z(s){this._z=s}};let pO=fO;pO.Z_INFINITY=1e8;class zx{constructor(e,t,r,i,n){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=t,this._container=e,this._geometry=new No(n,new G(-135,30,0),new G(11,11,5),new G(-135,.5,0)),this._animationFPS=ke.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new it,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new mO(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(r,i)}setupCanvas(){if(this._master||(this._master=new ds,this._master.interactiveChildren=!1),!this._display){const e=new Qi;this._master.addChild(e),this._display=e}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const e of this._spritePool)this.cleanSprite(e,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(e,t){if(e=e<1?1:e,t=t<1?1:t,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,e,t).endFill():(this._mask=new hm().beginFill(16711680).drawRect(0,0,e,t).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const r=this._master.hitArea;r.width=e,r.height=t}else this._master.hitArea=new fi(0,0,e,t);if(this._master.filterArea){const r=this._master.filterArea;r.width=e,r.height=t}else this._master.filterArea=new fi(0,0,e,t)}this._width=e,this._height=t}setMask(e){e&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!e&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(e,t=null,r=null,i=!1,n=!1){!this._master||!this._display||this._restrictsScaling&&!i||(t||(t=new it(this._width/2,this._height/2)),r||(r=t),t=this._display.toLocal(t),n?this._scale*=e:this._scale=e,this.screenOffsetX=r.x-t.x*this._scale,this.screenOffsetY=r.y-t.y*this._scale)}render(e,t=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Rr().deltaTime,this._totalTimeRunning===this._renderTimestamp||(e===-1&&(e=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(t=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),t=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),t=!0),this.doMagic();const r=Math.round(this._totalTimeRunning/(60/this._animationFPS));let i=!1;r!==this._lastFrame&&(this._lastFrame=r,i=!0);let n=0;const o=this._container.objects;if(o.size)for(const c of o.values())c&&(n=n+this.renderObject(c,c.instanceId.toString(),e,t,i,n));this._sortableSprites.sort((c,h)=>h.z-c.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let l=0;for(;l<n;){const c=this._sortableSprites[l];c&&c.sprite&&this.renderSprite(l,c),l++}this.cleanSprites(n),(t||i)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(e){this._objectCache.removeObjectCache(e)}renderObject(e,t,r,i,n,o){if(!e)return 0;const l=e.visualization;if(!l)return this.removeFromCache(t),0;const c=this.getCacheItem(t);c.objectId=e.instanceId;const h=c.location,u=c.sprites,g=h.updateLocation(e,this._geometry);if(!g)return this.removeFromCache(t),0;if(n&&l.update(this._geometry,r,!u.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),h.locationChanged&&(i=!0),!u.needsUpdate(l.instanceId,l.updateSpriteCounter)&&!i)return u.spriteCount;let m=g.x,p=g.y,f=g.z;m>0?f=f+m*12e-8:f=f+-m*12e-8,m=m+Math.trunc(this._width/2),p=p+Math.trunc(this._height/2);let T=0;for(const I of l.sprites.values()){if(!I||!I.visible)continue;const O=I.texture,A=O&&O.baseTexture;if(!O||!A)continue;const N=m+I.offsetX+this._screenOffsetX,P=p+I.offsetY+this._screenOffsetY;if(I.flipH){const D=m+-(O.width+-I.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(D,P,O.width,O.height))continue}else if(I.flipV){const D=p+-(O.height+-I.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(N,D,O.width,O.height))continue}else if(!this.isSpriteVisible(N,P,O.width,O.height))continue;let y=u.getSprite(T);y||(y=new pO,u.addSprite(y),this._sortableSprites.push(y),y.name=t),y.sprite=I,(I.spriteType===$r.AVATAR||I.spriteType===$r.AVATAR_OWN)&&(y.sprite.libraryAssetName="avatar_"+e.id),y.x=N-this._screenOffsetX,y.y=P-this._screenOffsetY,y.z=f+I.relativeDepth+37e-12*o,T++,o++}return u.setSpriteCount(T),this._canvasUpdated=!0,T}getExtendedSprite(e){if(e<0||e>=this._spriteCount)return null;const t=this._display.getChildAt(e);return t||null}getExtendedSpriteIdentifier(e){return e?e.name:""}renderSprite(e,t){if(e>=this._spriteCount)return this.createAndAddSprite(t),!0;if(!t)return!1;const r=t.sprite,i=this.getExtendedSprite(e);if(!r||!i)return!1;if(i.varyingDepth!==r.varyingDepth)return i.varyingDepth&&!r.varyingDepth?(this._display.removeChildAt(e),this._spritePool.push(i),this.renderSprite(e,t)):(this.createAndAddSprite(t,e),!0);if(i.needsUpdate(r.id,r.updateCounter)||tr.isVisualizationOn()){i.tag=r.tag,i.alphaTolerance=r.alphaTolerance,i.name=t.name,i.varyingDepth=r.varyingDepth,i.clickHandling=r.clickHandling,i.filters=r.filters;const n=r.alpha/255;i.alpha!==n&&(i.alpha=n),i.tint!==r.color&&(i.tint=r.color),i.blendMode!==r.blendMode&&(i.blendMode=r.blendMode),i.texture!==r.texture&&i.setTexture(r.texture),r.updateContainer&&(i.children.length===1&&i.removeChildAt(0),i.addChild(r.container),r.updateContainer=!1),r.flipH?i.scale.x!==-1&&(i.scale.x=-1):i.scale.x!==1&&(i.scale.x=1),r.flipV?i.scale.y!==-1&&(i.scale.y=-1):i.scale.y!==1&&(i.scale.y=1),this.updateEnterRoomEffect(i,r)}return i.x!==t.x&&(i.x=t.x),i.y!==t.y&&(i.y=t.y),i.offsetX=r.offsetX,i.offsetY=r.offsetY,!0}createAndAddSprite(e,t=-1){const r=e.sprite;if(!r)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new Fd),i.children.length&&i.removeChildren(),i.tag=r.tag,i.alphaTolerance=r.alphaTolerance,i.alpha=r.alpha/255,i.tint=r.color,i.x=e.x,i.y=e.y,i.offsetX=r.offsetX,i.offsetY=r.offsetY,i.name=r.name,i.varyingDepth=r.varyingDepth,i.clickHandling=r.clickHandling,i.blendMode=r.blendMode,i.filters=r.filters,i.setTexture(r.texture),r.updateContainer&&(i.addChild(r.container),r.updateContainer=!1),r.flipH&&(i.scale.x=-1),r.flipV&&(i.scale.y=-1),this.updateEnterRoomEffect(i,r),t<0||t>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,t),this._activeSpriteCount++}cleanSprites(e,t=!1){if(this._display){if(e<0&&(e=0),e<this._activeSpriteCount||!this._activeSpriteCount){let r=this._spriteCount-1;for(;r>=e;)this.cleanSprite(this.getExtendedSprite(r),t),r--}this._activeSpriteCount=e}}updateEnterRoomEffect(e,t){if(!(!tr.isVisualizationOn()||!t))switch(t.spriteType){case $r.AVATAR_OWN:return;case $r.ROOM_PLANE:e.alpha=tr.getDelta(.9);return;case $r.AVATAR:e.alpha=tr.getDelta(.5);return;default:e.alpha=tr.getDelta(.1)}}cleanSprite(e,t){e&&(t?(e.parent&&e.parent.removeChild(e),e.destroy({children:!0})):e.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(e){this._mouseListener=e}getCacheItem(e){return this._objectCache.getObjectCache(e)}isSpriteVisible(e,t,r,i){return!!(this._noSpriteVisibilityChecking||(e=(e-this._screenOffsetX)*this._scale+this._screenOffsetX,t=(t-this._screenOffsetY)*this._scale+this._screenOffsetY,r=r*this._scale,i=i*this._scale,e<this._width&&e+r>=0&&t<this._height&&t+i>=0&&!this._usesExclusionRectangles))}handleMouseEvent(e,t,r,i,n,o,l){return e=e-this._screenOffsetX,t=t-this._screenOffsetY,this._mouseLocation.x=e/this._scale,this._mouseLocation.y=t/this._scale,this._mouseCheckCount>0&&r==fe.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(e/this._scale),Math.trunc(t/this._scale),r,i,n,o,l),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(e,t,r,i=!1,n=!1,o=!1,l=!1){const c=[];let h=!1,u=null,g=this._activeSpriteCount-1;for(;g>=0;){const f=this.getExtendedSprite(g);if(f&&f.containsPoint(new it(e-f.x,t-f.y))&&!(f.clickHandling&&(r===fe.MOUSE_CLICK||r===fe.DOUBLE_CLICK))){const T=this.getExtendedSpriteIdentifier(f);if(c.indexOf(T)===-1){const I=f.tag;let O=this._mouseActiveObjects.get(T);O&&O.spriteTag!==I&&(u=this.createMouseEvent(0,0,0,0,fe.ROLL_OUT,O.spriteTag,i,n,o,l),this.bufferMouseEvent(u,T)),r===fe.MOUSE_MOVE&&(!O||O.spriteTag!==I)?u=this.createMouseEvent(e,t,e-f.x,t-f.y,fe.ROLL_OVER,I,i,n,o,l):(u=this.createMouseEvent(e,t,e-f.x,t-f.y,r,I,i,n,o,l),u.spriteOffsetX=f.offsetX,u.spriteOffsetY=f.offsetY),O||(O=new Yx,O.objectId=T,this._mouseActiveObjects.set(T,O)),O.spriteTag=I,(r!==fe.MOUSE_MOVE||e!==this._mouseOldX||t!==this._mouseOldY)&&this.bufferMouseEvent(u,T),c.push(T)}h=!0}g--}const m=[];for(const f of this._mouseActiveObjects.keys())f&&m.push(f);let p=0;for(;p<m.length;){const f=m[p];c.indexOf(f)>=0&&(m[p]=null),p++}for(p=0;p<m.length;){const f=m[p];if(f!==null){const T=this._mouseActiveObjects.get(f);T&&this._mouseActiveObjects.delete(f);const I=this.createMouseEvent(0,0,0,0,fe.ROLL_OUT,T.spriteTag,i,n,o,l);this.bufferMouseEvent(I,f)}p++}return this.processMouseEvents(),this._mouseOldX=e,this._mouseOldY=t,h}createMouseEvent(e,t,r,i,n,o,l,c,h,u){const g=e-this._width/2,m=t-this._height/2,p=`canvas_${this._id}`;return new ox(n,p+"_"+this._eventId,p,o,g,m,r,i,c,l,h,u)}bufferMouseEvent(e,t){!e||!this._eventCache||(this._eventCache.delete(t),this._eventCache.set(t,e))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[e,t]of this._eventCache.entries()){if(!this._eventCache)return;if(!t)continue;const r=this._container.getRoomObject(parseInt(e));if(r)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(t,r,this._geometry);else{const i=r.mouseHandler;i&&i.mouseEvent(t,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const e=this._scale,t=this._screenOffsetX,r=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const i=this._display.getBounds(),n=yn.create({width:this._display.width,height:this._display.height});return sr.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new Zr(1,0,0,1,-i.x,-i.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(e,null,null,!0),this._screenOffsetX=t,this._screenOffsetY=r,n}doMagic(){const e=this.geometry;if(this._rotation!==0){let t=this._effectDirection;e.direction=new G(t.x+this._rotation,t.y,t.z),t=e.direction,e.setDepthVector(new G(t.x,t.y,5));const r=new G;r.assign(this._rotationOrigin),r.x=r.x+this._rotationRodLength*Math.cos((t.x+180)/180*3.14159265358979)*Math.cos(t.y/180*3.14159265358979),r.y=r.y+this._rotationRodLength*Math.sin((t.x+180)/180*3.14159265358979)*Math.cos(t.y/180*3.14159265358979),r.z=r.z+this._rotationRodLength*Math.sin(t.y/180*3.14159265358979),e.location=r,this._effectLocation=new G,this._effectLocation.assign(r),this._effectDirection=new G,this._effectDirection.assign(e.direction)}if(xi.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!xi.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),Ui.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const t=this._effectDirection,r=G.sum(t,new G(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));e.direction=r}else this._SafeStr_795=0,e.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const e=this.geometry.direction;this._effectDirection=new G(e.x,e.y,e.z)}}changeRotation(){if(this._SafeStr_4507)return;const e=this.geometry;if(e){if(this._rotation===0){const t=e.location,r=e.directionAxis;this._effectLocation=new G,this._effectLocation.assign(t),this._effectDirection=new G,this._effectDirection.assign(e.direction);const i=No.getIntersectionVector(t,r,new G(0,0,0),new G(0,0,1));i!==null&&(this._rotationOrigin=new G(i.x,i.y,i.z),this._rotationRodLength=G.dif(i,t).length,this._rotation=1);return}this._rotation=0,e.location=this._effectLocation,e.direction=this._effectDirection,e.setDepthVector(new G(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const e=this.geometry,t=(e.direction.x-90)/180*3.14159265358979;e.location=G.sum(e.location,new G(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const e=this.geometry,t=(e.direction.x+90)/180*3.14159265358979;e.location=G.sum(e.location,new G(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const e=this.geometry,t=e.direction.x/180*3.14159265358979;e.location=G.sum(e.location,new G(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const e=this.geometry,t=(e.direction.x+180)/180*3.14159265358979;e.location=G.sum(e.location,new G(Math.cos(t)*Math.sqrt(2),Math.sin(t)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(e){e=Math.trunc(e),this._mouseLocation.x=this._mouseLocation.x-(e-this._screenOffsetX),this._screenOffsetX=e}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(e){e=Math.trunc(e),this._mouseLocation.y=this._mouseLocation.y-(e-this._screenOffsetY),this._screenOffsetY=e}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(e){this._canvasUpdated=e}}class Kx{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[e,t]of this._canvases.entries())this._canvases.delete(e),t&&t.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(e){return e?e.instanceId:-1}getRoomObject(e){return this._objects.get(e)}addObject(e){e&&this._objects.set(this.getInstanceId(e),e)}removeObject(e){const t=this.getInstanceId(e);this._objects.delete(t);for(const r of this._canvases.values()){if(!r)continue;r.removeFromCache(t.toString())}}render(e,t=!1){if(!(!this._canvases||!this._canvases.size))for(const r of this._canvases.values())r&&r.render(e,t)}update(e,t=!1){if(!(!this._canvases||!this._canvases.size)){this.render(e,t);for(const r of this._canvases.values())r&&r.update()}}getCanvas(e){const t=this._canvases.get(e);return t||null}createCanvas(e,t,r,i){const n=this._canvases.get(e);if(n)return n.initialize(t,r),n.geometry&&(n.geometry.scale=i),n;const o=this.createSpriteCanvas(e,t,r,i);if(o)return this._canvases.set(e,o),o}createSpriteCanvas(e,t,r,i){return new zx(this,e,t,r,i)}removeCanvas(e){const t=this._canvases.get(e);t&&(this._canvases.delete(e),t.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(e){this._roomObjectVariableAccurateZ=e}}class qx{createRenderer(){return new Kx}}class Xx extends Ti{constructor(e,t){super(),this._id=e,this._container=t,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new uO}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(e){if(e!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=e,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const t of this._managers.values()){if(!t)continue;const r=t.objects;if(r.length)for(const i of r.getValues())i&&this._renderer.addObject(i)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(e){const t=this._managers.get(e);return t||null}getManagerOrCreate(e){let t=this.getManager(e);return t||(t=this._container.createRoomObjectManager(e),t?(this._managers.set(e,t),t):null)}getTotalObjectsForManager(e){const t=this.getManager(e);return t?t.totalObjects:0}getRoomObject(e,t){const r=this.getManager(t);if(!r)return null;const i=r.getObject(e);return i||null}getRoomObjectsForCategory(e){const t=this.getManager(e);return t?t.objects.getValues():[]}getRoomObjectByIndex(e,t){const r=this.getManager(t);if(!r)return null;const i=r.getObjectByIndex(e);return i||null}createRoomObject(e,t,r,i){const n=this.getManagerOrCreate(i);if(!n)return null;const o=n.createObject(e,t,r);return o?(this._renderer&&this._renderer.addObject(o),o):null}createRoomObjectAndInitalize(e,t,r){return this._container?this._container.createRoomObjectAndInitalize(this._id,e,t,r):null}removeRoomObject(e,t){const r=this.getManager(t);if(!r)return;const i=r.getObject(e);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),r.removeObject(e))}removeAllManagers(){for(const e of this._managers.values())if(e){if(this._renderer){const t=e.objects;if(t.length)for(const r of t.getValues())r&&this._renderer.removeObject(r)}e.dispose()}this._managers.clear()}addUpdateCategory(e){this._updateCategories.indexOf(e)>=0||this._updateCategories.push(e)}removeUpdateCategory(e){const t=this._updateCategories.indexOf(e);t!==-1&&this._updateCategories.splice(t,1)}update(e,t=!1){for(const r of this._updateCategories){const i=this.getManager(r);if(!i)continue;const n=i.objects;if(n.length)for(const o of n.getValues()){if(!o)continue;const l=o.logic;l&&l.update(e)}}this._renderer&&this._renderer.update(e,t)}hasUninitializedObjects(){for(const e of this._managers.values())if(e){for(const t of e.objects.getValues())if(t&&!t.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}const vm=class{constructor(s,e,t,r,i,n,o){this._layerTags=[],this._primaryColor=s&16777215,this._secondaryColor=e&16777215,this._breed=t,this._tag=r>-1&&r<vm.COLOR_TAGS.length?vm.COLOR_TAGS[r]:"",this._id=i,this._isMaster=n,this._layerTags=o}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};let EO=vm;EO.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];const Ss=class{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(s){this._stateEvents=s,this.setFurnitureData();for(const[e,t]of Ke.getValue("pet.types").entries())this._pets[t]=e}dispose(){}setSessionDataManager(s){this._sessionDataManager=s,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const s=this._sessionDataManager.getAllFurnitureData(this);s&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(s),this._stateEvents.dispatchEvent(new ct(Ss.LOADER_READY)))}processFurnitureData(s){if(s)for(const e of s){if(!e)continue;const t=e.id;let r=e.className;e.hasIndexedColor&&(r=r+"*"+e.colorIndex);const i=e.revision,n=e.adUrl;n&&n.length>0&&this._objectTypeAdUrls.set(r,n);let o=e.className;e.type===sl.FLOOR?(this._activeObjectTypes.set(t,r),this._activeObjectTypeIds.set(r,t),this._activeObjects[o]||(this._activeObjects[o]=1)):e.type===sl.WALL&&(o==="post.it"&&(r="post_it",o="post_it"),o==="post.it.vd"&&(r="post_it_vd",o="post_id_vd"),this._wallItemTypes.set(t,r),this._wallItemTypeIds.set(r,t),this._wallItems[o]||(this._wallItems[o]=1));const l=this._furniRevisions.get(o);i>l&&(this._furniRevisions.delete(o),this._furniRevisions.set(o,i))}}getFurnitureFloorNameForTypeId(s){const e=this._activeObjectTypes.get(s);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(s,e=null){let t=this._wallItemTypes.get(s);return t==="poster"&&e!==null&&(t=t+e),this.removeColorIndex(t)}getFurnitureFloorColorIndex(s){const e=this._activeObjectTypes.get(s);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(s){const e=this._wallItemTypes.get(s);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(s){if(!s)return-1;const e=s.indexOf("*");return e===-1?0:parseInt(s.substr(e+1))}removeColorIndex(s){if(!s)return null;const e=s.indexOf("*");return e===-1?s:s.substr(0,e)}getRoomObjectAdUrl(s){const e=this._objectTypeAdUrls.get(s);return e||""}getPetColorResult(s,e){const t=this._petColors.get(s);return t?t.get(e):null}getPetColorResultsForTag(s,e){const t=this._petColors.get(s),r=[];if(t)for(const i of t.values())i.tag===e&&r.push(i);return r}getCollection(s){if(!s)return null;const e=this._collections.get(s);if(!e){const t=di().getCollection(s);return t?(this._collections.set(s,t),t):null}return e}getGifCollection(s){return s&&this._gifCollections.get(s)||null}getImage(s){if(!s)return null;const e=this._images.get(s);if(!e)return null;const t=new Image;return t.src=e.src,t}addAssetToCollection(s,e,t,r=!0){const i=this.getCollection(s);return i?i.addAsset(e,t,r,0,0,!1,!1):!1}createGifCollection(s,e,t){if(!s||!e||!t)return null;const r=new tx(s,e,t);return this._gifCollections.set(s,r),r}createCollection(s,e){if(!s||!e)return null;const t=new _p(s,e);this._collections.set(t.name,t);const r=this._pets[t.name];if(r!==void 0){const i=t.getPaletteNames(),n=new Map;for(const o of i){const l=t.getPalette(o),c=s.palettes[o],h=l.primaryColor,u=l.secondaryColor,g=c.breed!==void 0?c.breed:0,m=c.colorTag!==void 0?c.colorTag:-1,p=c.master!==void 0?c.master:!1,f=c.tags!==void 0?c.tags:[];n.set(parseInt(o),new EO(h,u,g,m,o,p,f))}this._petColors.set(r,n)}}getPlaceholderName(s){switch(this.getCategoryForType(s)){case z.FLOOR:return Ss.PLACE_HOLDER;case z.WALL:return Ss.PLACE_HOLDER_WALL;default:return this._pets[s]!==void 0?Ss.PLACE_HOLDER_PET:Ss.PLACE_HOLDER_DEFAULT}}getCategoryForType(s){return s?this._activeObjects[s]!==void 0?z.FLOOR:this._wallItems[s]!==void 0?z.WALL:this._pets[s]!==void 0?z.UNIT:s.indexOf("poster")===0?z.WALL:s==="room"?z.ROOM:s===gt.USER||s===gt.PET||s===gt.BOT||s===gt.RENTABLE_BOT?z.UNIT:s===Ss.TILE_CURSOR||s===Ss.SELECTION_ARROW?z.CURSOR:z.MINIMUM:z.MINIMUM}getPetNameForType(s){return Ke.getValue("pet.types")[s]||null}isLoaderType(s){return s=gt.getRealType(s),s!==pe.USER}downloadImage(s,e,t,r=null){let i=null,n=[];if(e&&e.indexOf(",")>=0&&(i=e,e=i.split(",")[0]),i?n=this.getAssetUrls(i,t,!0):n=this.getAssetUrls(e,t,!0),n&&n.length){const o=n[0],l=new Image;return l.src=o,l.onload=()=>{l.onerror=null,this._images.set([e,t].join("_"),l),this._iconListener.onRoomContentLoaded(s,[e,t].join("_"),!0)},l.onerror=()=>{l.onload=null,xe.error("Failed to download asset",o),this._iconListener.onRoomContentLoaded(s,[e,t].join("_"),!1)},!0}return!1}async downloadAsset(s,e){const t=this.getAssetUrls(s);if(!(!t||!t.length)&&!(this._pendingContentTypes.indexOf(s)>=0||this.getOrRemoveEventDispatcher(s))){this._pendingContentTypes.push(s),this._events.set(s,e);for(const r of t)if(!(!r||!r.length))try{const i=await fetch(r);let n="application/octet-stream";if(!i.ok){xe.warn(`Failed to fetch furni asset from ${r} (status ${i.status})`);continue}switch(i.headers.has("Content-Type")&&(n=i.headers.get("Content-Type")),n){case"application/octet-stream":{const o=new vo(await i.arrayBuffer());await this.processAsset(o.baseTexture,o.jsonFile);const l=this._events.get(s);if(!l)return;l.dispatchEvent(new Jn(Jn.RCLE_SUCCESS,s));return}default:throw new Error}}catch(i){xe.error("Failed to download furni asset",i)}e.dispatchEvent(new Jn(Jn.RCLE_FAILURE,s))}}async processAsset(s,e){const t=e.spritesheet;if(!s||!t||!Object.keys(t).length){this.createCollection(e,null);return}const r=async()=>{const i=new XR(s,t);await i.parse(),this.createCollection(e,i)};s.valid?await r():await new Promise((i,n)=>{s.once("update",async()=>(await r(),i()))})}setAssetAliasName(s,e){this._objectAliases.set(s,e),this._objectOriginalNames.set(e,s)}getAssetAliasName(s){const e=this._objectAliases.get(s);return e||s}getAssetOriginalName(s){const e=this._objectOriginalNames.get(s);return e||s}getAssetUrls(s,e=null,t=!1){switch(s){case Ss.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(Ss.PLACE_HOLDER)];case Ss.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(Ss.PLACE_HOLDER_WALL)];case Ss.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(Ss.PLACE_HOLDER_PET)];case Ss.ROOM:return[this.getAssetUrlWithGenericBase("room")];case Ss.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(Ss.TILE_CURSOR)];case Ss.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(Ss.SELECTION_ARROW)];default:{const r=this.getCategoryForType(s);if(r===z.FLOOR||r===z.WALL){const i=this.getAssetAliasName(s),n=[];let o=t?this.getAssetUrlWithFurniIconBase(i):this.getAssetUrlWithFurniBase(s);if(t){const c=e&&e!==""&&this._activeObjectTypeIds.has(i+"*"+e);return o=o.replace(/%param%/gi,c?"_"+e:""),n.push(o),n}n.push(o);const l=this.getAlternativeFurniAssetUrl(s);return l&&n.push(l),n}return r===z.UNIT?[this.getAssetUrlWithPetBase(s)]:null}}}getAssetIconUrl(s,e){let t=null,r=[];return s&&s.indexOf(",")>=0&&(t=s,s=t.split(",")[0]),t?r=this.getAssetUrls(t,e,!0):r=this.getAssetUrls(s,e,!0),r&&r.length?r[0]:null}getAssetUrlWithGenericBase(s){return Ke.getValue("generic.asset.url").replace(/%libname%/gi,s)}getAssetUrlWithFurniBase(s){return Ke.getValue("furni.asset.url").replace(/%libname%/gi,s)}getAlternativeFurniAssetUrl(s){const e=Ke.getValue("alternative.furni.asset.url");return e?e.replace(/%libname%/gi,s):null}getAssetUrlWithFurniIconBase(s){return Ke.getValue("furni.asset.icon.url").replace(/%libname%/gi,s)}getAssetUrlWithPetBase(s){return Ke.getValue("pet.asset.url").replace(/%libname%/gi,s)}setRoomObjectRoomId(s,e){const t=s&&s.model;t&&t.setValue(b.OBJECT_ROOM_ID,e)}getOrRemoveEventDispatcher(s,e=!1){const t=this._events.get(s);return e&&this._events.delete(s),t}setIconListener(s){this._iconListener=s}};let Mi=Ss;Mi.PLACE_HOLDER="place_holder";Mi.PLACE_HOLDER_WALL="place_holder_wall";Mi.PLACE_HOLDER_PET="place_holder_pet";Mi.PLACE_HOLDER_DEFAULT=Ss.PLACE_HOLDER;Mi.ROOM="room";Mi.TILE_CURSOR="tile_cursor";Mi.SELECTION_ARROW="selection_arrow";Mi.LOADER_READY="RCL_LOADER_READY";Mi.MANDATORY_LIBRARIES=[Ss.PLACE_HOLDER,Ss.PLACE_HOLDER_WALL,Ss.PLACE_HOLDER_PET,Ss.ROOM,Ss.TILE_CURSOR,Ss.SELECTION_ARROW];class Qx{constructor(){this._objects=new As,this._objectsPerType=new As}dispose(){this.removeAllObjects()}getObject(e){const t=this._objects.getValue(e);return t||null}getObjectByIndex(e){const t=this._objects.getWithIndex(e);return t||null}createObject(e,t,r){const i=new dO(e,t,r);return this.addObject(e,r,i)}addObject(e,t,r){if(this._objects.getValue(e))return r.dispose(),null;this._objects.add(e,r);const i=this.getTypeMap(t);return i&&i.add(e,r),r}removeObject(e){const t=this._objects.remove(e);if(t){const r=this.getTypeMap(t.type);r&&r.remove(t.id),t.dispose()}}removeAllObjects(){let e=0;for(;e<this._objects.length;){const t=this._objects.getWithIndex(e);t&&t.dispose(),e++}for(this._objects.reset(),e=0;e<this._objectsPerType.length;){const t=this._objectsPerType.getWithIndex(e);t&&t.dispose(),e++}this._objectsPerType.reset()}getTypeMap(e,t=!0){let r=this._objectsPerType.getValue(e);return!r&&t&&(r=new As,this._objectsPerType.add(e,r)),r}get objects(){return this._objects}get totalObjects(){return this._objects.length}}const Za=class extends aa{constructor(s,e,t){super(),this._state=Za.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=s,this._visualizationFactory=e,this._logicFactory=t,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(Jn.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(Jn.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(Jn.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=Za.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const s=Mi.MANDATORY_LIBRARIES;for(const e of s)e&&this._initialLoadList.indexOf(e)===-1&&(this._contentLoader.downloadAsset(e,this.events),this._initialLoadList.push(e));this._state=Za.ROOM_MANAGER_INITIALIZING}getRoomInstance(s){const e=this._rooms.get(s);return e||null}createRoomInstance(s){if(this._rooms.get(s))return null;const e=new Xx(s,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const t of this._updateCategories)e.addUpdateCategory(t);return e}removeRoomInstance(s){const e=this._rooms.get(s);return e?(this._rooms.delete(s),e.dispose(),!0):!1}createRoomObjectAndInitalize(s,e,t,r){const i=this.getRoomInstance(s);if(!i)return null;let n=t,o=t,l=t,c=null,h=!1;if(this._contentLoader.isLoaderType(t)){if(c=this._contentLoader.getCollection(t),!c&&(h=!0,this._contentLoader.downloadAsset(t,this.events),l=this._contentLoader.getPlaceholderName(t),c=this._contentLoader.getCollection(l),!c))return null;n=c.data.visualizationType,o=c.data.logicType}const u=i.createRoomObject(e,1,t,r);if(!u)return null;if(this._visualizationFactory){const g=this._visualizationFactory.getVisualization(n);if(!g)return i.removeRoomObject(e,r),null;g.asset=c;const m=this._visualizationFactory.getVisualizationData(l,n,c&&c.data||null);if(!m||!g.initialize(m))return i.removeRoomObject(e,r),null;u.setVisualization(g)}if(this._logicFactory){const g=this._logicFactory.getLogic(o);u.setLogic(g),g&&g.initialize(c&&c.data||null)}return h||(u.isReady=!0),this._contentLoader.setRoomObjectRoomId(u,s),u}reinitializeRoomObjectsByType(s){if(!s||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const e=this._contentLoader.getCollection(s);if(!e)return;const t=e.data.visualizationType,r=e.data.logicType,i=this._visualizationFactory.getVisualizationData(s,t,e.data);for(const n of this._rooms.values())if(n){for(const[o,l]of n.managers.entries())if(l)for(const c of l.objects.getValues()){if(!c||c.type!==s)continue;const h=this._visualizationFactory.getVisualization(t);if(h)if(h.asset=e,!i||!h.initialize(i))l.removeObject(c.id);else{c.setVisualization(h);const u=this._logicFactory.getLogic(r);c.setLogic(u),u&&u.initialize(e.data),c.isReady=!0,this._listener&&this._listener.objectInitialized(n.id,c.id,o)}else l.removeObject(c.id)}}}addUpdateCategory(s){if(!(this._updateCategories.indexOf(s)>=0)&&(this._updateCategories.push(s),!!this._rooms.size))for(const t of this._rooms.values())t&&t.addUpdateCategory(s)}removeUpdateCategory(s){const e=this._updateCategories.indexOf(s);if(e!==-1&&(this._updateCategories.splice(e,1),!!this._rooms.size))for(const t of this._rooms.values())t&&t.removeUpdateCategory(s)}setContentLoader(s){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=s}processPendingContentTypes(s){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const e=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(e)){this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!1),xe.log("Invalid Collection",e);continue}this.reinitializeRoomObjectsByType(e),this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(e)}}removeFromInitialLoad(s){if(!(!s||this._state===Za.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=Za.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(s)){const e=this._initialLoadList.indexOf(s);e>=0&&this._initialLoadList.splice(e,1),this._initialLoadList.length||(this._state=Za.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=Za.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(s){if(!this._contentLoader)return;const e=s.contentType;this._pendingContentTypes.indexOf(e)>=0||this._pendingContentTypes.push(e)}update(s,e=!1){if(this.processPendingContentTypes(s),!!this._rooms.size)for(const t of this._rooms.values())t&&t.update(s,e)}createRoomObjectManager(s){return new Qx}get rooms(){return this._rooms}get disposed(){return this._disposed}};let Rl=Za;Rl.ROOM_MANAGER_ERROR=-1;Rl.ROOM_MANAGER_LOADING=0;Rl.ROOM_MANAGER_LOADED=1;Rl.ROOM_MANAGER_INITIALIZING=2;Rl.ROOM_MANAGER_INITIALIZED=3;Rl.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;class $x{constructor(e,t=-1,r=null,i=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=e,this._minLevel=t,this._texture=r,this._colorMatrix=i,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(e){this._texture=e}get colorMatrix(){return this._colorMatrix}set colorMatrix(e){this._colorMatrix=e}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e}get minLevel(){return this._minLevel}}class Jx{constructor(){this._effects=new Map,this._events=new Ri,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const e=Ke.getValue("image.library.url")+"Habbo-Stories/",t=Ke.getValue("camera.available.effects");for(const r of t){if(!r.enabled)continue;const i=new $x(r.name,r.minLevel);r.colorMatrix.length?i.colorMatrix=r.colorMatrix:(i.texture=ys.from(e+r.name+".png"),i.blendMode=r.blendMode),this._effects.set(i.name,i)}this.events.dispatchEvent(new Md(Md.INITIALIZED))}applyEffects(e,t,r){const i=new Qi,n=new ds(e);i.addChild(n),r&&n.scale.set(2);for(const o of t){const l=o.effect;if(l)if(l.colorMatrix){const c=new Ru;c.matrix=l.colorMatrix,c.alpha=o.alpha,n.filters||(n.filters=[]),n.filters.push(c)}else{const c=new ds(l.texture);c.alpha=o.alpha,c.blendMode=l.blendMode,i.addChild(c)}}return Lt.generateImage(i)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class Pg{constructor(e,t){this._effect=e,this._alpha=t}get effect(){return this._effect}get alpha(){return this._alpha}}class Zx{flush(){return this._canShowInterstitial=!1,!0}parse(e){return e?(this._canShowInterstitial=e.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class e1{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(e){return e?(this._errorCode=e.readInt(),this._filteredText=e.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class t1{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(e){return e?(this._isOpen=e.readBoolean(),this._onShutdown=e.readBoolean(),e.bytesAvailable&&(this._isAuthenticUser=e.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class s1{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(e){return e?(this._isOpen=e.readInt()>0,this._minutesUntilChange=e.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class r1{flush(){return this._openHour=0,this._openMinute=0,!0}parse(e){return e?(this._openHour=e.readInt(),this._openMinute=e.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class i1{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(e){return e?(this._openHour=e.readInt(),this._openMinute=e.readInt(),this._userThrownOutAtClose=e.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class n1{flush(){return this._minutes=0,!0}parse(e){return e?(this._minutes=e.readInt(),!0):!1}get openMinute(){return this._minutes}}class a1{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(e){return e?(this._isInMaintenance=e.readBoolean(),this._minutesUntilMaintenance=e.readInt(),e.bytesAvailable&&(this._duration=e.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class o1{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(e){if(!e)return!1;this._resultCode=e.readInt(),this._name=e.readString();let t=e.readInt();for(;t>0;)this._nameSuggestions.push(e.readString()),t--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class l1{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(e){if(!e)return!1;this._resultCode=e.readInt(),this._name=e.readString();let t=e.readInt();for(;t>0;)this._nameSuggestions.push(e.readString()),t--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class c1{flush(){return this._figure="",this._gender="",!0}parse(e){return e?(this._figure=e.readString(),this._gender=e.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class u1{constructor(e){this._slotId=e.readInt(),this._figureString=e.readString(),this._gender=e.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class h1{flush(){return this._state=0,this._outfits=[],!0}parse(e){if(!e)return!1;this._state=e.readInt();let t=e.readInt();for(;t>0;)this._outfits.push(new u1(e)),t--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class yp{constructor(e){if(!e)throw new Error("invalid_parser");this._id=e.readInt(),this._name=e.readString(),this._motto=e.readString(),this._gender=e.readString(),this._figure=e.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class d1{flush(){return this._item=null,this._openInventory=!1,!0}parse(e){return e?(this._item=new yp(e),this._openInventory=e.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class _1{flush(){return this._items=null,!0}parse(e){this._items=new Map;let t=e.readInt();for(;t>0;){const r=new yp(e);this._items.set(r.id,r),t--}return!0}get items(){return this._items}}class g1{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(e){return e?(this._boughtAsGift=e.readBoolean(),this._item=new yp(e),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class m1{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class f1{constructor(e){this._name=e.readString(),this._id=e.readInt(),this._consequence=e.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class p1{constructor(e){this._topics=[],this._name=e.readString();let t=e.readInt();for(;t>0;)this._topics.push(new f1(e)),t--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class E1{constructor(e){this._tradeLockInfo="",this._machineBanInfo="",this._name=e.readString(),this._sanctionLengthInHours=e.readInt(),this._probationDays=e.readInt(),this._avatarOnly=e.readBoolean(),e.bytesAvailable&&(this._tradeLockInfo=e.readString()),e.bytesAvailable&&(this._machineBanInfo=e.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class I1{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(e){return e?(this._issueId=e.readInt(),this._accountId=e.readInt(),this._sanctionType=new E1(e),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class T1{flush(){return this._callForHelpCategories=null,!0}parse(e){if(!e)return!1;this._callForHelpCategories=[];let t=e.readInt();for(;t>0;)this._callForHelpCategories.push(new p1(e)),t--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class R1{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(e){return e?(this._isSanctionNew=e.readBoolean(),this._isSanctionActive=e.readBoolean(),this._sanctionName=e.readString(),this._sanctionLengthHours=e.readInt(),e.readInt(),this._sanctionReason=e.readString(),this._sanctionCreationTime=e.readString(),this._probationHoursLeft=e.readInt(),this._nextSanctionName=e.readString(),this._nextSanctionLengthHours=e.readInt(),e.readInt(),this._hasCustomMute=e.readBoolean(),e.bytesAvailable&&(this._tradeLockExpiryTime=e.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class S1{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(e){return e?(this._ok=e.readBoolean(),this._secondsToWait=e.readInt(),this._ok&&e.bytesAvailable&&(this._extraDataId=e.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class O1{flush(){return!0}parse(e){return!!e}}class C1{flush(){return this._roomType=null,this._roomId=-1,!0}parse(e){return e?(this._roomType=e.readString(),this._roomId=e.readInt(),!0):!1}get roomType(){return this._roomType}get roomId(){return this._roomId}}class A1{flush(){return this._url="",!0}parse(e){return e?(this._url=e.readString(),!0):!1}get url(){return this._url}}class N1{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(e){return e?(this._ok=e.readBoolean(),this._errorReason=e.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class b1{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(e){return e?(this._creditPrice=e.readInt(),this._ducketPrice=e.readInt(),e.bytesAvailable&&(this._publishDucketPrice=e.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class y1{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(e){return e?(e.bytesAvailable&&(this._ok=e.readBoolean(),this._renderLimitHit=e.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class vp{parse(e){if(!e)return!1;this._campaignName=e.readString(),this._campaignImage=e.readString(),this._currentDay=e.readInt(),this._campaignDays=e.readInt(),this._openedDays=[];let t=e.readInt();for(let r=0;r<t;r++)this._openedDays.push(e.readInt());this._missedDays=[],t=e.readInt();for(let r=0;r<t;r++)this._missedDays.push(e.readInt());return!0}clone(){const e=new vp;return e.campaignDays=this._campaignDays,e.campaignImage=this._campaignImage,e.campaignName=this._campaignName,e.currentDay=this._currentDay,e.missedDays=this._missedDays,e.openedDays=this._openedDays,e}get campaignName(){return this._campaignName}set campaignName(e){this._campaignName=e}get campaignImage(){return this._campaignImage}set campaignImage(e){this._campaignImage=e}get currentDay(){return this._currentDay}set currentDay(e){this._currentDay=e}get campaignDays(){return this._campaignDays}set campaignDays(e){this._campaignDays=e}get openedDays(){return this._openedDays}set openedDays(e){this._openedDays=e}get missedDays(){return this._missedDays}set missedDays(e){this._missedDays=e}}class v1{flush(){return this._calendarData=null,!0}parse(e){return e?(this._calendarData=new vp,this._calendarData.parse(e),!0):!1}get calendarData(){return this._calendarData}}class M1{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(e){return e?(this._doorOpened=e.readBoolean(),this._productName=e.readString(),this._customImage=e.readString(),this._furnitureClassName=e.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class D1{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(e){return e?(this._productType=e.readString(),this._productClassId=e.readInt(),this._totalCoinsForBonus=e.readInt(),this._coinsStillRequiredToBuy=e.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class P1{flush(){return this._furniCount=0,!0}parse(e){return e?(this._furniCount=e.readInt(),!0):!1}get furniCount(){return this._furniCount}}class L1{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(e){return e?(this._secondsLeft=e.readInt(),this._furniLimit=e.readInt(),this._maxFurniLimit=e.readInt(),e.bytesAvailable?this._secondsLeftWithGrace=e.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class U1{constructor(e){this._maxPurchaseSize=e.readInt(),this._bundleSize=e.readInt(),this._bundleDiscountSize=e.readInt(),this._bonusThreshold=e.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let t=e.readInt();for(;t>0;)this._additionalBonusDiscountThresholdQuantities.push(e.readInt()),t--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class x1{flush(){return this._bundleDiscountRuleset=null,!0}parse(e){return e?(this._bundleDiscountRuleset=new U1(e),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class Mp{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(e){if(!e)return!1;this._visible=e.readBoolean(),this._icon=e.readInt(),this._pageId=e.readInt(),this._pageName=e.readString(),this._localization=e.readString();let t=e.readInt();for(;t>0;)this._offerIds.push(e.readInt()),t--;let r=e.readInt();for(;r>0;)this._children.push(new Mp(e)),r--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class w1{flush(){return this._root=null,!0}parse(e){return e?(this._root=new Mp(e),this._newAdditionsAvailable=e.readBoolean(),this._catalogType=e.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class F1{constructor(e){this._images=[],this._texts=[];let t=e.readInt();for(;t>0;)this._images.push(e.readString()),t--;let r=e.readInt();for(;r>0;)this._texts.push(e.readString()),r--}get images(){return this._images}get texts(){return this._texts}}const IO=class{constructor(s){if(!s)throw new Error("invalid_wrapper");this.flush(),this.parse(s)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(s){switch(this._productType=s.readString(),this._productType){case IO.B:return this._extraParam=s.readString(),this._productCount=1,!0;default:return this._furniClassId=s.readInt(),this._extraParam=s.readString(),this._productCount=s.readInt(),this._uniqueLimitedItem=s.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=s.readInt(),this._uniqueLimitedItemsLeft=s.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}};let bi=IO;bi.I="i";bi.S="s";bi.E="e";bi.B="b";class P_{constructor(e){this._offerId=e.readInt(),this._localizationId=e.readString(),this._rent=e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._giftable=e.readBoolean(),this._products=[];let t=e.readInt();for(;t>0;)this._products.push(new bi(e)),t--;this._clubLevel=e.readInt(),this._bundlePurchaseAllowed=e.readBoolean(),this._isPet=e.readBoolean(),this._previewImage=e.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const gd=class{constructor(s){if(!s)throw new Error("invalid_wrapper");this.flush(),this.parse(s)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(s){if(!s)return!1;switch(this._position=s.readInt(),this._itemName=s.readString(),this._itemPromoImage=s.readString(),this._type=s.readInt(),this._type){case gd.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=s.readString();break;case gd.ITEM_PRODUCT_OFFER:this._productOfferId=s.readInt();break;case gd.ITEM_IAP:this._productCode=s.readString();break}const e=s.readInt();return this._expirationTime=e>0?e*1e3+tt():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};let Ec=gd;Ec.ITEM_CATALOGUE_PAGE=0;Ec.ITEM_PRODUCT_OFFER=1;Ec.ITEM_IAP=2;class k1{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(e){if(!e)return!1;this._pageId=e.readInt(),this._catalogType=e.readString(),this._layoutCode=e.readString(),this._localization=new F1(e);let t=e.readInt();for(;t>0;)this._offers.push(new P_(e)),t--;if(this._offerId=e.readInt(),this._acceptSeasonCurrencyAsCredits=e.readBoolean(),e.bytesAvailable){let r=e.readInt();for(;r>0;)this._frontPageItems.push(new Ec(e)),r--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class G1{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(e){return e?(this._pageName=e.readString(),this._secondsToExpiry=e.readInt(),this._image=e.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class B1{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(e){return e?(this._instantlyRefreshCatalogue=e.readBoolean(),e.bytesAvailable&&(this._newFurniDataHash=e.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class V1{constructor(e){this._offerId=e.readInt(),this._isVip=e.readBoolean(),this._daysRequired=e.readInt(),this._isSelectable=e.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class H1{flush(){return!0}parse(e){if(!e)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=e.readInt(),this._giftsAvailable=e.readInt();const t=e.readInt();for(let i=0;i<t;i++)this._offers.push(new P_(e));const r=e.readInt();for(let i=0;i<r;i++){const n=new V1(e);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(e){this._giftsAvailable=e}getOfferExtraData(e){return e?this._giftData.get(e):null}get giftData(){return this._giftData}}class W1{flush(){return this._productCode=null,this._products=[],!0}parse(e){if(!e)return!1;this._productCode=e.readString();let t=e.readInt();for(;t>0;)this._products.push(new bi(e)),t--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class TO{constructor(e){if(!e)throw new Error("invalid_wrapper");this._offerId=e.readInt(),this._productCode=e.readString(),e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._vip=e.readBoolean(),this._months=e.readInt(),this._extraDays=e.readInt(),this._giftable=e.readBoolean(),this._daysLeftAfterPurchase=e.readInt(),this._year=e.readInt(),this._month=e.readInt(),this._day=e.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class j1 extends TO{constructor(e){super(e),this._originalPrice=e.readInt(),this._originalActivityPointPrice=e.readInt(),this._originalActivityPointType=e.readInt(),this._subscriptionDaysLeft=e.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class Y1{constructor(e){this._stuffId=e.readInt(),this._charges=e.readInt(),this._SafeStr_6935=e.readInt(),this._SafeStr_6936=e.readInt(),this._SafeStr_6518=e.readInt(),this._SafeStr_7875=e.readInt()}get stuffId(){return this._stuffId}get charges(){return this._charges}get _SafeStr_5946(){return this._SafeStr_6935}get _SafeStr_5944(){return this._SafeStr_6936}get _SafeStr_7876(){return this._SafeStr_7875}get _SafeStr_5945(){return this._SafeStr_6518}}class z1{flush(){return this._fireworkChargeData=null,!0}parse(e){return e?(this._fireworkChargeData=new Y1(e),!0):!1}get fireworkChargeData(){return this._fireworkChargeData}}class K1{flush(){return!0}parse(e){return!!e}}class q1{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(e){if(!e)return!1;const t=[],r=[],i=[],n=[];this._isEnabled=e.readBoolean(),this._price=e.readInt();let o=e.readInt(),l=0;for(;l<o;)t.push(e.readInt()),l++;for(o=e.readInt(),l=0;l<o;)r.push(e.readInt()),l++;for(o=e.readInt(),l=0;l<o;)i.push(e.readInt()),l++;for(o=e.readInt(),l=0;l<o;)n.push(e.readInt()),l++;return this._giftWrappers=t,this._ribbonTypes=i,this._giftFurnis=n,this._boxTypes=r,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class X1{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new j1(e),!0):!1}get offer(){return this._offer}}class Q1{flush(){return this._offers=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._offers.push(new TO(e)),t--;return!0}get offers(){return this._offers}}class $1{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(e){return e?(this._offerId=e.readInt(),this._isGiftable=e.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class J1{flush(){return!0}parse(e){return!!e}}class Z1{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(e){return e?(this._appearsInSeconds=e.readInt(),this._pageId=e.readInt(),this._offerId=e.readInt(),this._productType=e.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class ew{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(e){return e?(this._notEnoughCredits=e.readBoolean(),this._notEnoughActivityPoints=e.readBoolean(),e.bytesAvailable&&(this._activityPointType=e.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class tw{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new P_(e),!0):!1}get offer(){return this._offer}}class sw{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get code(){return this._code}}class rw{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get code(){return this._code}}class iw{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(e){if(!e)return!1;this._offerId=e.readInt(),this._localizationId=e.readString(),this._rent=e.readBoolean(),this._priceCredits=e.readInt(),this._priceActivityPoints=e.readInt(),this._priceActivityPointsType=e.readInt(),this._giftable=e.readBoolean();let t=e.readInt();for(;t>0;)this._products.push(new bi(e)),t--;return this._clubLevel=e.readInt(),this._bundlePurchaseAllowed=e.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class nw{flush(){return this._offer=null,!0}parse(e){return e?(this._offer=new iw(e),!0):!1}get offer(){return this._offer}}class aw{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(e){return e?(this._clubLevel=e.readInt(),this._securityLevel=e.readInt(),this._isAmbassador=e.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class L_{flush(){return!0}parse(e){return e?(this._status=e.readInt(),!0):!1}get status(){return this._status}}L_.SAFETY_LOCK_STATUS_LOCKED=0;L_.SAFETY_LOCK_STATUS_UNLOCKED=1;class ow{flush(){return this._result=-1,this._validationInfo="",!0}parse(e){return e?(this._result=e.readInt(),this._validationInfo=e.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}class RO{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}RO.EMAIL_STATUS_OK=0;class lw{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._relationshipStatusType=Jr.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendIsVip=!1,this._randomFriendName=null,!0}parse(e){return e?(this._relationshipStatusType=e.readInt(),this._friendCount=e.readInt(),this._randomFriendId=e.readInt(),this._randomFriendName=e.readString(),this._randomFriendFigure=e.readString(),this._randomFriendIsVip=e.readBoolean(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}get randomFriendIsVip(){return this._randomFriendIsVip}}class cw{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(e){if(!e)return!1;this._userId=e.readInt(),this._relationshipStatusMap=new As;const t=e.readInt();for(let r=0;r<t;r++){const i=new lw(e);this._relationshipStatusMap.add(i.relationshipStatusType,i)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class uw{flush(){return this._userId=null,this._badges=[],!0}parse(e){if(!e)return!1;this._userId=e.readInt();let t=e.readInt();for(;t>0;){e.readInt();const r=e.readString();this._badges.push(r),t--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class hw{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(e){return e?(this._userId=e.readInt(),this._username=e.readString(),this._figure=e.readString(),this._gender=e.readString(),this._motto=e.readString(),this._realName=e.readString(),this._directMail=e.readBoolean(),this._respectsReceived=e.readInt(),this._respectsRemaining=e.readInt(),this._respectsPetRemaining=e.readInt(),this._streamPublishingAllowed=e.readBoolean(),this._lastAccessDate=e.readString(),this._canChangeName=e.readBoolean(),this._safetyLocked=e.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class dw{flush(){return this._userInfo=null,!0}parse(e){return!(!e||(this._userInfo=new hw(e),!this._userInfo))}get userInfo(){return this._userInfo}}class _w{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(e){return e?(this._webId=e.readInt(),this._id=e.readInt(),this._newName=e.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class SO{constructor(e){this._groupId=e.readInt(),this._groupName=e.readString(),this._badgeCode=e.readString(),this._colorA=e.readString(),this._colorB=e.readString(),this._favourite=e.readBoolean(),this._ownerId=e.readInt(),this._hasForum=e.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class gw{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._timePlayedSeconds=0,this._openProfileWindow=!1,this._isVip=!1,!0}parse(e){if(!e)return!1;this._id=e.readInt(),this._username=e.readString(),this._figure=e.readString(),this._motto=e.readString(),this._registration=e.readString(),this._achievementPoints=e.readInt(),this._friendsCount=e.readInt(),this._isMyFriend=e.readBoolean(),this._requestSent=e.readBoolean(),this._isOnline=e.readBoolean();const t=e.readInt();for(let r=0;r<t;r++)this._groups.push(new SO(e));this._secondsSinceLastVisit=e.readInt(),this._timePlayedSeconds=e.readInt(),this._openProfileWindow=e.readBoolean();try{this._isVip=e.readBoolean()}catch{this._isVip=!1}return!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get timePlayedSeconds(){return this._timePlayedSeconds}get openProfileWindow(){return this._openProfileWindow}get isVip(){return this._isVip}}class mw{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._oldRotations=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,this._wiredAnimations=!0,!0}parse(e){return e?(this._volumeSystem=e.readInt(),this._volumeFurni=e.readInt(),this._volumeTrax=e.readInt(),this._oldChat=e.readBoolean(),this._roomInvites=e.readBoolean(),this._cameraFollow=e.readBoolean(),this._oldRotations=e.readBoolean(),this._flags=e.readInt(),this._chatType=e.readInt(),this._wiredAnimations=e.readBoolean(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get oldRotations(){return this._oldRotations}get wiredAnimations(){return this._wiredAnimations}get flags(){return this._flags}get chatType(){return this._chatType}}class fw{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(e){if(!e)return!1;this._roomUnitId=e.readInt();let t=e.readInt();for(;t>0;)this._tags.push(e.readString()),t--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class pw{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(e){return e?(this._email=e.readString(),this._isVerified=e.readBoolean(),this._allowChange=e.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class Ew{flush(){return this._userId=-1,!0}parse(e){return e?(this._userId=e.readInt(),!0):!1}get userId(){return this._userId}}class Iw{flush(){return this._groupId=-1,!0}parse(e){return e?(this._groupId=e.readInt(),!0):!1}get groupId(){return this._groupId}}class Tw{flush(){return this._groupId=-1,this._requester=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._requester=new Gc(e),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}class OO{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}OO.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;class Rw{flush(){return this._guildId=-1,this._reason=-1,!0}parse(e){return e?(this._guildId=e.readInt(),this._reason=e.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class Sw{flush(){return this._groups=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._groups.push(new SO(e)),t--;return!0}get groups(){return this._groups}}class Ow{flush(){return this._badges=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const r=e.readInt(),i=e.readString();this._badges.set(r,i),t--}return!0}get badges(){return this._badges}}class CO{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}CO.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;class Cw{flush(){return this._ignoredUsers=[],!0}parse(e){if(!e)return!1;this._ignoredUsers=[];let t=e.readInt();for(;t>0;)this._ignoredUsers.push(e.readString()),t--;return!0}get ignoredUsers(){return this._ignoredUsers}}class Aw{flush(){return this._result=-1,this._name=null,!0}parse(e){return e?(this._result=e.readInt(),this._name=e.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class Nw{flush(){return this._link=null,!0}parse(e){return e?(this._link=e.readString(),!0):!1}get link(){return this._link}}class bw{flush(){return this._credits=null,!0}parse(e){return e?(this._credits=e.readString(),!0):!1}get credits(){return this._credits}}class yw{flush(){return this._currencies=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._currencies.set(e.readInt(),e.readInt()),t--;return!0}get currencies(){return this._currencies}}class xc{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(e){return e?(this._productName=e.readString(),this._daysToPeriodEnd=e.readInt(),this._memberPeriods=e.readInt(),this._periodsSubscribedAhead=e.readInt(),this._responseType=e.readInt(),this._hasEverBeenMember=e.readBoolean(),this._isVip=e.readBoolean(),this._pastClubDays=e.readInt(),this._pastVipDays=e.readInt(),this._minutesUntilExpiration=e.readInt(),e.bytesAvailable&&(this._minutesSinceLastModified=e.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}}xc.RESPONSE_TYPE_LOGIN=1;xc.RESPONSE_TYPE_PURCHASE=2;xc.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3;xc.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;class wc{constructor(e){if(this._unseen=0,!e)throw new Error("invalid_parser");this._achievementId=e.readInt(),this._level=e.readInt(),this._badgeId=e.readString(),this._scoreAtStartOfLevel=e.readInt(),this._scoreLimit=Math.max(1,e.readInt()),this._levelRewardPoints=e.readInt(),this._levelRewardPointType=e.readInt(),this._currentPoints=e.readInt(),this._finalLevel=e.readBoolean(),this._category=e.readString(),this._subCategory=e.readString(),this._levelCount=e.readInt(),this._displayMethod=e.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(e){this._unseen=e}get unseen(){return this._unseen}reset(e){this._achievementId=e._achievementId,this._level=e._level,this._badgeId=e._badgeId,this._scoreAtStartOfLevel=e._scoreAtStartOfLevel,this._scoreLimit=e._scoreLimit,this._levelRewardPoints=e._levelRewardPoints,this._levelRewardPointType=e._levelRewardPointType,this._currentPoints=e._currentPoints,this._finalLevel=e._finalLevel,this._category=e.category,this._subCategory=e._subCategory,this._levelCount=e._levelCount,this._displayMethod=e._displayMethod}}wc.DISPLAY_METHOD_OBSOLETE=-1;wc.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0;wc.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1;wc.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;class vw{flush(){return this._achievement=null,!0}parse(e){return e?(this._achievement=new wc(e),!0):!1}get achievement(){return this._achievement}}const AO=class{constructor(s){this._achievementId=s.readInt(),this._level=s.readInt(),this._badgeId=s.readString(),this._requiredLevel=s.readInt(),this._state=s.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===AO.STATE_SELECTABLE}get state(){return this._state}};let NO=AO;NO.STATE_SELECTABLE=0;class Mw{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(e){if(!e)return!1;this._achievements=[];let t=e.readInt();for(;t>0;)this._achievements.push(new wc(e)),t--;return this._defaultCategory=e.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class Dw{flush(){return this._score=0,!0}parse(e){return e?(this._score=e.readInt(),!0):!1}get score(){return this._score}}class Pw{get type(){return this._type}set type(e){this._type=e}get subType(){return this._subType}set subType(e){this._subType=e}get duration(){return this._duration}set duration(e){this._duration=e}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(e){this._inactiveEffectsInInventory=e}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(e){this._secondsLeftIfActive=e}get isPermanent(){return this._permanent}set isPermanent(e){this._permanent=e}}class Lw{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(e){return e?(this._type=e.readInt(),this._duration=e.readInt(),this._isPermanent=e.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class Uw{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(e){return e?(this._type=e.readInt(),this._subType=e.readInt(),this._duration=e.readInt(),this._permanent=e.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class xw{flush(){return this._type=0,!0}parse(e){return e?(this._type=e.readInt(),!0):!1}get type(){return this._type}}class ww{flush(){return this._type=0,!0}parse(e){return e?(this._type=e.readInt(),!0):!1}get type(){return this._type}}class Fw{flush(){return this._effects=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const r=new Pw;r.type=e.readInt(),r.subType=e.readInt(),r.duration=e.readInt(),r.inactiveEffectsInInventory=e.readInt(),r.secondsLeftIfActive=e.readInt(),r.isPermanent=e.readBoolean(),this._effects.push(r),t--}return!0}get effects(){return this._effects}}class kw{constructor(e,t){if(!t)throw new Error("invalid_parser");this._badgeId="ACH_"+e+t.readInt(),this._limit=t.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class Gw{flush(){return this._data=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const r=e.readString(),i=e.readInt();let n=0;for(;n<i;)this._data.push(new kw(r,e)),n++;t--}return!0}get data(){return this._data}}class Bw{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(e){return e?(this._badgeId=e.readInt(),this._badgeCode=e.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class Vw{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(e){if(!e)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new As;let t=e.readInt();for(;t>0;){const r=e.readInt(),i=e.readString();this._badgeIds.add(i,r),this._allBadgeCodes.push(i),t--}for(t=e.readInt();t>0;){e.readInt();const r=e.readString();this._activeBadgeCodes.push(r),t--}return!0}getBadgeId(e){return this._badgeIds.getValue(e)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class Hw{flush(){return!0}parse(e){return e?(this._requestCode=e.readString(),this._fulfilled=e.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class Ww{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._figureSetIds.push(e.readInt()),t--;let r=e.readInt();for(;r>0;)this._boundFurnitureNames.push(e.readString()),r--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class fo{flush(){return this._reason=0,this._parameter="",!0}parse(e){return e?(this._reason=e.readInt(),this._parameter=e.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}}fo.REASON_FULL=1;fo.REASON_CLOSED=2;fo.REASON_QUEUE_ERROR=3;fo.REASON_BANNED=4;class jw{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class Yw{flush(){return!0}parse(e){return!!e}}class zw{flush(){return!0}parse(e){return!!e}}class Kw{flush(){return this._controllerLevel=Rt.NONE,!0}parse(e){return e?(this._controllerLevel=e.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class qw{flush(){return!0}parse(e){return!!e}}class Xw{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class Qw{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(e){return e?(this._botId=e.readInt(),this._commandId=e.readInt(),this._data=e.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class $w{flush(){return this._botId=-1,!0}parse(e){return e?(this._botId=e.readInt(),!0):!1}get botId(){return this._botId}}class Jw{constructor(e){this._id=e.readInt(),this._data=e.readString()}get id(){return this._id}get data(){return this._data}}class Zw{flush(){return this._botId=-1,this._skillList=[],!0}parse(e){if(!e)return!1;this._botId=e.readInt();let t=e.readInt();for(;t>0;)this._skillList.push(new Jw(e)),t--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class eF{constructor(e){this._userId=e.readInt(),this._userName=e.readString()}get userId(){return this._userId}get userName(){return this._userName}}class tF{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(e){if(!e)return!1;this._roomId=e.readInt();let t=e.readInt();for(;t>0;)this._bannedUsers.push(new eF(e)),t--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class sF{constructor(e){this._userId=e.readInt(),this._userName=e.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(e){this._selected=e}}class rF{flush(){return this._roomId=0,this._data=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._data=new sF(e),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class iF{flush(){return this._roomId=0,this._userId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._userId=e.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class nF{flush(){return this._roomId=0,this._users=new Map,!0}parse(e){if(!e)return!1;this._roomId=e.readInt();let t=e.readInt();for(;t>0;){const r=e.readInt(),i=e.readString();this._users.set(r,i),t--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class aF{flush(){return!0}parse(e){return e?(this._isMuted=e.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class oF{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class xt{constructor(e){if(!e)throw new Error("invalid_wrapper");this._mode=e.readInt(),this._weight=e.readInt(),this._speed=e.readInt(),this._distance=e.readInt(),this._protection=e.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}xt.CHAT_MODE_FREE_FLOW=0;xt.CHAT_MODE_LINE_BY_LINE=1;xt.CHAT_BUBBLE_WIDTH_WIDE=0;xt.CHAT_BUBBLE_WIDTH_NORMAL=1;xt.CHAT_BUBBLE_WIDTH_THIN=2;xt.CHAT_SCROLL_SPEED_FAST=0;xt.CHAT_SCROLL_SPEED_NORMAL=1;xt.CHAT_SCROLL_SPEED_SLOW=2;xt.FLOOD_FILTER_STRICT=0;xt.FLOOD_FILTER_NORMAL=1;xt.FLOOD_FILTER_LOOSE=2;class kr{constructor(e){this._allowMute=e.readInt(),this._allowKick=e.readInt(),this._allowBan=e.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}kr.MODERATION_LEVEL_NONE=0;kr.MODERATION_LEVEL_USER_WITH_RIGHTS=1;kr.MODERATION_LEVEL_ALL=2;const ga=class{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=ga.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=ga.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(s){const e=new ga;return e._roomId=s._roomId,e._name=s._name,e._description=s._description,e._doorMode=s._doorMode,e._categoryId=s._categoryId,e._maximumVisitors=s._maximumVisitors,e._maximumVisitorsLimit=s._maximumVisitorsLimit,e._tags=s._tags,e._tradeMode=s._tradeMode,e._allowPets=s._allowPets,e._allowFoodConsume=s._allowFoodConsume,e._allowWalkThrough=s._allowWalkThrough,e._hideWalls=s._hideWalls,e._wallThickness=s._wallThickness,e._floorThickness=s._floorThickness,e._controllersById=s._controllersById,e._controllerList=s._controllerList,e._highlightedUserId=s._highlightedUserId,e._bannedUsersById=s._bannedUsersById,e._bannedUsersList=s._bannedUsersList,e._roomModerationSettings=s._roomModerationSettings,e._chatSettings=s._chatSettings,e._allowNavigatorDynamicCats=s._allowNavigatorDynamicCats,e}static getDoorModeLocalizationKey(s){switch(s){case ga.DOORMODE_OPEN:return"${navigator.door.mode.open}";case ga.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case ga.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case ga.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case ga.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(s){this._tradeMode=s}get allowPets(){return this._allowPets}set allowPets(s){this._allowPets=s}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(s){this._allowFoodConsume=s}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(s){this._allowWalkThrough=s}get hideWalls(){return this._hideWalls}set hideWalls(s){this._hideWalls=s}get wallThickness(){return this._wallThickness}set wallThickness(s){this._wallThickness=s}get floorThickness(){return this._floorThickness}set floorThickness(s){this._floorThickness=s}get roomId(){return this._roomId}set roomId(s){this._roomId=s}get name(){return this._name}set name(s){this._name=s}get description(){return this._description}set description(s){this._description=s}get doorMode(){return this._doorMode}set doorMode(s){this._doorMode=s}get categoryId(){return this._categoryId}set categoryId(s){this._categoryId=s}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(s){this._maximumVisitors=s}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(s){this._maximumVisitorsLimit=s}get tags(){return this._tags}set tags(s){this._tags=s}setFlatController(s,e){this._controllersById.set(s,e),this._controllerList=null,this._highlightedUserId=s}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(s){this._roomModerationSettings=s}get controllersById(){return this._controllersById}set controllersById(s){this._controllersById=s}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const s of this._controllersById.values())this._controllerList.push(s);this._controllerList.sort((s,e)=>s.userName.localeCompare(e.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(s,e){this._bannedUsersById.set(s,e),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const s of this._bannedUsersById.values())this._bannedUsersList.push(s);this._bannedUsersList.sort((s,e)=>s.userName.localeCompare(e.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(s){this._chatSettings=s}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(s){this._allowNavigatorDynamicCats=s}};let Va=ga;Va.DOORMODE_OPEN=0;Va.DOORMODE_CLOSED=1;Va.DOORMODE_PASSWORD=2;Va.DOORMODE_INVISIBLE=3;Va.DOORMODE_NOOBS_ONLY=4;Va.TRADEMODE_NOT_ALLOWED=0;Va.TRADEMODE_WITH_CONTROLLER=1;Va.TRADEMODE_ALLOWED=2;class lF{flush(){return this._roomSettingsData=null,!0}parse(e){if(!e)return!1;this._roomSettingsData=new Va,this._roomSettingsData.roomId=e.readInt(),this._roomSettingsData.name=e.readString(),this._roomSettingsData.description=e.readString(),this._roomSettingsData.doorMode=e.readInt(),this._roomSettingsData.categoryId=e.readInt(),this._roomSettingsData.maximumVisitors=e.readInt(),this._roomSettingsData.maximumVisitorsLimit=e.readInt(),this._roomSettingsData.tags=[];let t=e.readInt();for(;t>0;)this._roomSettingsData.tags.push(e.readString()),t--;return this._roomSettingsData.tradeMode=e.readInt(),this._roomSettingsData.allowPets=e.readInt()===1,this._roomSettingsData.allowFoodConsume=e.readInt()===1,this._roomSettingsData.allowWalkThrough=e.readInt()===1,this._roomSettingsData.hideWalls=e.readInt()===1,this._roomSettingsData.wallThickness=e.readInt(),this._roomSettingsData.floorThickness=e.readInt(),this._roomSettingsData.chatSettings=new xt(e),this._roomSettingsData.allowNavigatorDynamicCats=e.readBoolean(),this._roomSettingsData.roomModerationSettings=new kr(e),!0}get data(){return this._roomSettingsData}}class cF{flush(){return this._roomId=0,this._code=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._code=e.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class uF{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class jr{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._code=e.readInt(),this._message=e.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}jr.ERROR_ROOM_NOT_FOUND=1;jr.ERROR_NOT_OWNER=2;jr.ERROR_INVALID_DOOR_MODE=3;jr.ERROR_INVALID_USER_LIMIT=4;jr.ERROR_INVALID_PASSWORD=5;jr.ERROR_INVALID_CATEGORY=6;jr.ERROR_INVALID_NAME=7;jr.ERROR_UNACCEPTABLE_NAME=8;jr.ERROR_INVALID_DESCRIPTION=9;jr.ERROR_UNACCEPTABLE_DESCRIPTION=10;jr.ERROR_INVALID_TAG=11;jr.ERROR_NON_USER_CHOOSABLE_TAG=12;jr.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;class hF{flush(){return this._selectionType=0,!0}parse(e){return e?(this._selectionType=e.readInt(),!0):!1}get selectionType(){return this._selectionType}}class dF{flush(){return this._roomId=0,this._userId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._userId=e.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class _F{flush(){return this._chat=null,!0}parse(e){return e?(this._chat=new xt(e),!0):!1}get chat(){return this._chat}}const qo=class{constructor(s){if(!s)throw new Error("invalid_wrapper");this.flush(),this.parse(s)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(s){return s?(this._roomId=s.readInt(),this._roomName=s.readString(),this._ownerId=s.readInt(),this._ownerName=s.readString(),this._doorMode=s.readInt(),this._userCount=s.readInt(),this._maxUserCount=s.readInt(),this._description=s.readString(),this._tradeMode=s.readInt(),this._score=s.readInt(),this._ranking=s.readInt(),this._categoryId=s.readInt(),this.parseTags(s),this.parseBitMask(s),!0):!1}parseTags(s){if(!s)return!1;this._tags=[];let e=s.readInt();for(;e>0;)this._tags.push(s.readString()),e--;return!0}parseBitMask(s){return s?(this._bitMask=s.readInt(),this._bitMask&qo.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=s.readString()),this._bitMask&qo.GROUPDATA_BITMASK&&(this._groupId=s.readInt(),this._groupName=s.readString(),this._groupBadge=s.readString()),this._bitMask&qo.ROOMAD_BITMASK&&(this._adName=s.readString(),this._adDescription=s.readString(),this._adExpiresIn=s.readInt()),this._showOwner=(this._bitMask&qo.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&qo.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&qo.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(s){this._roomName=s}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(s){this._canMute=s}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(s){this._allInRoomMuted=s}};let Ot=qo;Ot.THUMBNAIL_BITMASK=1;Ot.GROUPDATA_BITMASK=2;Ot.ROOMAD_BITMASK=4;Ot.SHOWOWNER_BITMASK=8;Ot.ALLOW_PETS_BITMASK=16;Ot.DISPLAY_ROOMAD_BITMASK=32;Ot.OPEN_STATE=0;Ot.DOORBELL_STATE=1;Ot.PASSWORD_STATE=2;Ot.INVISIBLE_STATE=3;Ot.NOOB_STATE=4;class gF{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(e){return e?(this._roomId=e.readInt(),this._isOwner=e.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class mF{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(e){return e?(this._totalLikes=e.readInt(),this._canLike=e.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class fF{constructor(){this._animationTime=0,this._itemSlides=[]}flush(){return this._animationTime=0,this._itemSlides=[],!0}parse(e){if(!e)return!1;const t=e.readInt();this._animationTime=e.readInt(),this._itemSlides=[];for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),o=e.readInt(),l=e.readString(),c=e.readInt(),h=e.readInt(),u=e.readString(),g=e.readInt(),m=e.readInt();this._itemSlides.push({virtualId:i,fromX:n,fromY:o,fromZ:l,toX:c,toY:h,toZ:u,fromRotation:g,toRotation:m})}return!0}get animationTime(){return this._animationTime}get itemSlides(){return this._itemSlides}}class pF{constructor(){this._animationTime=0,this._itemSlides=[],this._userSlides=[]}flush(){return this._animationTime=0,this._itemSlides=[],this._userSlides=[],!0}parse(e){if(!e)return!1;const t=e.readInt(),r=e.readInt();this._animationTime=e.readInt(),this._itemSlides=[];for(let i=0;i<t;i++){const n=e.readInt(),o=e.readInt(),l=e.readInt(),c=e.readString(),h=e.readInt(),u=e.readInt(),g=e.readString(),m=e.readInt(),p=e.readInt();this._itemSlides.push({virtualId:n,fromX:o,fromY:l,fromZ:c,toX:h,toY:u,toZ:g,fromRotation:m,toRotation:p})}this._userSlides=[];for(let i=0;i<r;i++){const n=e.readInt(),o=e.readInt(),l=e.readInt(),c=e.readString(),h=e.readInt(),u=e.readInt(),g=e.readString();this._userSlides.push({roomIndex:n,fromX:o,fromY:l,fromZ:c,toX:h,toY:u,toZ:g})}return!0}get animationTime(){return this._animationTime}get itemSlides(){return this._itemSlides}get userSlides(){return this._userSlides}}class EF{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._groupId=e.readInt(),this._status=e.readInt(),this._groupName=e.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class IF{constructor(e,t,r){this._id=0,this._state=0,this._id=e,this._state=t,this._data=r}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class TF{flush(){return this._code=0,!0}parse(e){return e?(this._code=e.readInt(),!0):!1}get count(){return this._code}}class RF{flush(){return this._itemId=0,this._value=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._value=e.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class Do{flush(){return this._itemId=0,this._data=null,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._data=Do.parseObjectData(e),!0):!1}static parseObjectData(e){if(!e)return null;const t=$n.getData(e.readInt());return t?(t.parseWrapper(e),t):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class U_{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(e){return e?(this._itemId=e.readInt(),this._spriteId=e.readInt(),this._x=e.readInt(),this._y=e.readInt(),this._direction=e.readInt()%8*45,this._z=parseFloat(e.readString()),this._stackHeight=parseFloat(e.readString()),this._extra=e.readInt(),this._data=Do.parseObjectData(e),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=e.readInt(),this._usagePolicy=e.readInt(),this._userId=e.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=e.readString()),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(e){this._username=e}get spriteName(){return this._spriteName}set spriteName(e){this._spriteName=e}}class SF{constructor(){this._items=[]}flush(){return this._items=[],!0}parse(e){if(!e)return!1;try{const t=e.readInt();for(let r=0;r<t;r++){const i=new U_(e);this._items.push(i)}return!0}catch(t){return console.error("Error parsing BulkUpdateFloorItemsParser:",t),console.error("Items processed so far:",this._items.length),!1}}get items(){return this._items}}class OF{flush(){return this._item=null,!0}parse(e){return e?(this._item=new U_(e),this._item.username=e.readString(),!0):!1}get item(){return this._item}}class CF{flush(){return this._owners=new Map,this._items=[],!0}parse(e){if(!e||!this.parseOwners(e))return!1;let t=e.readInt();for(;t>0;){const r=new U_(e);if(!r)continue;const i=this._owners.get(r.userId);i&&(r.username=i),this._items.push(r),t--}return!0}parseOwners(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._owners.set(e.readInt(),e.readString()),t--;return!0}get owners(){return this._owners}get items(){return this._items}}class AF{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._isExpired=e.readBoolean(),this._userId=e.readInt(),this._delay=e.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class NF{flush(){return this._item=null,!0}parse(e){return e?(this._item=new U_(e),!0):!1}get item(){return this._item}}class bF{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(e){return e?(this._isWallItem=e.readBoolean(),this._furniTypeName=e.readString(),this._buyout=e.readBoolean(),this._priceInCredits=e.readInt(),this._priceInActivityPoints=e.readInt(),this._activityPointType=e.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class yF{flush(){return this._aliases=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._aliases.set(e.readString(),e.readString()),t--;return!0}get aliases(){return this._aliases}}class vF{flush(){return this._furniId=-1,this._height=0,!0}parse(e){return e?(this._furniId=e.readInt(),this._height=e.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class MF{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(e){return e?(this._objectId=e.readInt(),this._guildId=e.readInt(),this._guildName=e.readString(),this._guildHomeRoomId=e.readInt(),this._userIsMember=e.readBoolean(),this._guildHasReadableForum=e.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class DF{flush(){return this._itemId=0,this._data="",!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._data=e.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class PF{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(e){return this._furniId=e.readInt(),!0}}class LF{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(e){return this._furniId=e.readInt(),!0}}class UF{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(e){return this._furniId=e.readInt(),this._start=e.readBoolean(),!0}}class xF{flush(){return this._itemId=0,this._state=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._state=e.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class wF{flush(){return!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}class FF{flush(){return!0}parse(e){return e?(this._expiryTime=e.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}class Ln{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(e){return e?(this._rented=e.readBoolean(),this._canRentErrorCode=e.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=e.readInt(),this._renterName=e.readString(),this._timeRemaining=e.readInt(),this._price=e.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}}Ln.SPACE_ALREADY_RENTED=100;Ln.SPACE_EXTEND_NOT_RENTED=101;Ln.SPACE_EXTEND_NOT_RENTED_BY_YOU=102;Ln.CAN_RENT_ONLY_ONE_SPACE=103;Ln.NOT_ENOUGH_CREDITS=200;Ln.NOT_ENOUGH_PIXELS=201;Ln.CANT_RENT_NO_PERMISSION=202;Ln.CANT_RENT_NO_HABBO_CLUB=203;Ln.CANT_RENT=300;Ln.CANT_RENT_GENERIC=400;class kF{flush(){return this._itemId=-1,this._location="",!0}parse(e){return e?(this._itemId=e.readInt(),this._location=e.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class GF{constructor(e,t,r,i){this.id=e,this.type=t,this.color=r,this.brightness=i}}class BF{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(e){const t=e.readInt();this._selectedPresetId=e.readInt();for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),o=parseInt(e.readString().substr(1),16),l=e.readInt();this._presets.push(new GF(i,n,o,l))}return!0}getPreset(e){return e<0||e>=this.presetCount?null:this._presets[e]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class VF{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),this._messageCount=e.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class Dp{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(e){if(!e)return!1;this._itemId=parseInt(e.readString()),this._spriteId=e.readInt(),this._location=e.readString(),this._stuffData=e.readString(),this._secondsToExpiration=e.readInt(),this._usagePolicy=e.readInt(),this._userId=e.readInt(),this._username=null;const t=parseFloat(this._stuffData);if(isNaN(t)||(this._state=Math.trunc(t)),this._location.indexOf(":")===0){this._isOldFormat=!1;let r=this._location.split(" ");if(r.length>=3){let i=r[0],n=r[1];const o=r[2];if(i.length>3&&n.length>2&&(i=i.substr(3),n=n.substr(2),r=i.split(","),r.length>=2)){const l=parseInt(r[0]),c=parseInt(r[1]);if(r=n.split(","),r.length>=2){const h=parseInt(r[0]),u=parseInt(r[1]);this._width=l,this._height=c,this._localX=h,this._localY=u,this._direction=o}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(e){this._username=e}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class HF{flush(){return this._item=null,!0}parse(e){return e?(this._item=new Dp(e),this._item.username=e.readString(),!0):!1}get item(){return this._item}}class WF{flush(){return this._owners=new Map,this._items=[],!0}parse(e){if(!e||!this.parseOwners(e))return!1;let t=e.readInt();for(;t>0;){const r=new Dp(e);if(!r)continue;const i=this._owners.get(r.userId);i&&(r.username=i),this._items.push(r),t--}return!0}parseOwners(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._owners.set(e.readInt(),e.readString()),t--;return!0}get owners(){return this._owners}get items(){return this._items}}class jF{flush(){return this._itemId=0,this._userId=0,!0}parse(e){return e?(this._itemId=parseInt(e.readString()),this._userId=e.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class YF{flush(){return this._item=null,!0}parse(e){return e?(this._item=new Dp(e),!0):!1}get item(){return this._item}}class zF{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(e){return e?(this._email=e.readString(),this._isVerified=e.readBoolean(),this._allowChange=e.readBoolean(),this._furniId=e.readInt(),this._requestedByUser=e.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class KF{parse(e){return this._furniId=e.readInt(),this._commandId=e.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class qF{constructor(e,t,r){this._video=e,this._title=t,this._description=r}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class XF{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(e){this._furniId=e.readInt();const t=e.readInt();this._playlists=[];for(let r=0;r<t;r++)this._playlists.push(new qF(e.readString(),e.readString(),e.readString()));return this._selectedPlaylistId=e.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class QF{flush(){return!0}parse(e){return this._furniId=e.readInt(),this._videoId=e.readString(),this._startAtSeconds=e.readInt(),this._endAtSeconds=e.readInt(),this._state=e.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class $F{flush(){return this._objects=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const r=e.readInt(),i=Do.parseObjectData(e),n=parseFloat(i.getLegacyString());this._objects.push(new IF(r,n,i)),t--}return!0}get objects(){return this._objects}}class JF{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,this._animationTime=500,!0}parse(e){if(!e)return!1;const t=e.readInt(),r=e.readInt(),i=e.readInt(),n=e.readInt(),o=e.readInt();this._itemsRolling=[];for(let g=0;g<o;g++){const m=e.readInt(),p=parseFloat(e.readString()),f=parseFloat(e.readString());this._itemsRolling.push(new Oa(m,new G(t,r,p),new G(i,n,f)))}if(this._rollerId=e.readInt(),this._animationTime=e.readInt(),!e.bytesAvailable)return!0;const l=e.readInt(),c=e.readInt(),h=parseFloat(e.readString()),u=parseFloat(e.readString());switch(l){case 0:break;case 1:this._unitRolling=new Oa(c,new G(t,r,h),new G(i,n,u),Oa.MOVE);break;case 2:this._unitRolling=new Oa(c,new G(t,r,h),new G(i,n,u),Oa.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}get animationTime(){return this._animationTime}}const Mm=class{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(s){if(!s)return!1;const e=s.readBoolean(),t=s.readInt(),r=s.readString();return this.parseExplicitly(r,t,e)}parseModel(s,e,t=!0){return this.parseExplicitly(s,e,t)}parseExplicitly(s,e,t=!0){this._scale=t?32:64,this._wallHeight=e,this._model=s;const r=this._model.split("\r"),i=r.length;let n=0,o=0;for(;o<i;){const l=r[o];l.length>n&&(n=l.length),o++}for(this._heightMap=[],o=0;o<i;){const l=[];let c=0;for(;c<n;)l.push(Mm.TILE_BLOCKED),c++;this._heightMap.push(l),o++}for(this._width=n,this._height=i,o=0;o<i;){const l=this._heightMap[o],c=r[o];if(c.length>0){let h=0;for(;h<c.length;){const u=c.charAt(h);let g=Mm.TILE_BLOCKED;u!=="x"&&u!=="X"&&(g=parseInt(u,36)),l[h]=g,h++}}o++}return!0}getHeight(s,e){if(s<0||s>=this._width||e<0||e>=this._height)return-110;const t=this._heightMap[e];if(t===void 0)return-110;const r=t[s];return r===void 0?-110:r}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}};let Pp=Mm;Pp.TILE_BLOCKED=-110;class ZF{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(e){return e?(this._x=e.readInt(),this._y=e.readInt(),this._direction=e.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class po{static decodeTileHeight(e){return e<0?-1:(e&16383)/256}static decodeIsStackingBlocked(e){return!!(e&16384)}static decodeIsRoomTile(e){return e>=0}getTileHeight(e,t){return e<0||e>=this._width||t<0||t>=this._height?-1:po.decodeTileHeight(this._heights[t*this._width+e])}getStackingBlocked(e,t){return e<0||e>=this._width||t<0||t>=this._height?!0:po.decodeIsStackingBlocked(this._heights[t*this._width+e])}isRoomTile(e,t){return e<0||e>=this._width||t<0||t>=this._height?!1:po.decodeIsRoomTile(this._heights[t*this._width+e])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(e){if(!e)return!1;this._width=e.readInt();const t=e.readInt();this._height=t/this._width;let r=0;for(;r<t;)this._heights[r]=e.readShort(),r++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class ek{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return po.decodeTileHeight(this._value)}isStackingBlocked(){return po.decodeIsStackingBlocked(this._value)}isRoomTile(){return po.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(e){return e?(this._wrapper=e,this._count=e.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class tk{flush(){return this._blockedTilesMap=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const r=e.readInt(),i=e.readInt();this._blockedTilesMap[i]||(this._blockedTilesMap[i]=[]),this._blockedTilesMap[i][r]=!0,t--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class sk{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(e){if(!e)return!1;const t=e.readString(),r=e.readString();switch(t){case"floor":this._floorType=r;break;case"wallpaper":this._wallType=r;break;case"landscape":this._landscapeType=r;break;case"landscapeanim":this._landscapeAnimation=r;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class rk{flush(){return this._name=null,this._roomId=0,!0}parse(e){return e?(this._name=e.readString(),this._roomId=e.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class ik{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(e){if(!e)return!1;this._hideWalls=e.readBoolean();let t=e.readInt(),r=e.readInt();return t=t<-2?-2:t>1?1:t,r=r<-2?-2:r>1?1:r,this._thicknessWall=Math.pow(2,t),this._thicknessFloor=Math.pow(2,r),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class nk{constructor(){this._items=[]}flush(){return this._items=[],!0}parse(e){this._items=[];const t=e.readByte();for(let r=0;r<t;r++){const i=e.readByte(),n=e.readByte(),o=e.readShort()/256;this._items.push({x:i,y:n,height:o})}return!0}get items(){return this._items}}class JI{constructor(e){if(!e)throw new Error("invalid_wrapper");this._webId=e.readInt(),this._name=e.readString(),this._level=e.readInt(),this._figure=e.readString(),this._owner=e.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class ZI{constructor(e){this._stuffId=e.readInt(),this._classId=e.readInt(),this._productCode=e.readString(),this._userId=e.readInt(),this._userName=e.readString(),this._rarityLevel=e.readInt(),this._hasMutation=e.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class ak{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(e){return e?(this._resultData=new ZI(e),this._otherResultData=new ZI(e),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class ok{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(e){return e?(this._petId=e.readInt(),this._roomIndex=e.readInt(),this._gainedExperience=e.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class lk{flush(){return!0}parse(e){return e?(this._roomIndex=e.readInt(),this._petId=e.readInt(),this._figureData=new Up(e),this._hasSaddle=e.readBoolean(),this._isRiding=e.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class ck{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(e){if(!e)return!1;this._id=e.readInt(),this._name=e.readString(),this._level=e.readInt(),this._maximumLevel=e.readInt(),this._experience=e.readInt(),this._levelExperienceGoal=e.readInt(),this._energy=e.readInt(),this._maximumEnergy=e.readInt(),this._happyness=e.readInt(),this._maximumHappyness=e.readInt(),this._respect=e.readInt(),this._ownerId=e.readInt(),this._age=e.readInt(),this._ownerName=e.readString(),this._rarityLevel=e.readInt(),this._saddle=e.readBoolean(),this._rider=e.readBoolean();let t=e.readInt();for(;t>0;)this._skillThresholds.push(e.readInt()),t--;return this._skillThresholds.sort(),this._publiclyRideable=e.readInt(),this._breedable=e.readBoolean(),this._fullyGrown=e.readBoolean(),this._dead=e.readBoolean(),this._unknownRarity=e.readInt(),this._maximumTimeToLive=e.readInt(),this._remainingTimeToLive=e.readInt(),this._remainingGrowTime=e.readInt(),this._publiclyBreedable=e.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class uk{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._petId=e.readInt(),this._canBreed=e.readBoolean(),this._canHarvest=e.readBoolean(),this._canRevive=e.readBoolean(),this._hasBreedingPermission=e.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class hk{constructor(e){if(!e)throw new Error("invalid_wrapper");this._chance=e.readInt(),this._breeds=[];let t=e.readInt();for(;t>0;)this._breeds.push(e.readInt()),t--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class dk{flush(){return this._isPlaying=!1,!0}parse(e){return e?(this._isPlaying=e.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class _k{constructor(){this._isEnabled=!1}flush(){return this._isEnabled=!1,!0}parse(e){return e?(this._isEnabled=e.readBoolean(),!0):!1}get isEnabled(){return this._isEnabled}}class gk{constructor(){this._isEnabled=!1}flush(){return this._isEnabled=!1,!0}parse(e){return e?(this._isEnabled=e.readBoolean(),!0):!1}get isEnabled(){return this._isEnabled}}class mk{flush(){return this._isPlaying=!1,!0}parse(e){return e?(this._isPlaying=e.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class fk{flush(){return!0}parse(e){return!0}}class pk{flush(){return this._seconds=0,!0}parse(e){return e?(this._seconds=e.readInt(),!0):!1}get seconds(){return this._seconds}}class Ek{flush(){return this._seconds=0,!0}parse(e){return e?(this._seconds=e.readInt(),!0):!1}get seconds(){return this._seconds}}class Lp{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(e){return e?(this._roomIndex=e.readInt(),this._message=e.readString(),this._gesture=e.readInt(),this._bubble=e.readInt(),this.parseUrls(e),this._messageLength=e.readInt(),!0):!1}parseUrls(e){if(!e)return!1;this._urls=[];let t=e.readInt();for(;t>0;)this._urls.push(e.readString()),t--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class Ik{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(e){return e?(this._unitId=e.readInt(),this._isTyping=e.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class Tk{flush(){return this._unitId=null,this._danceId=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._danceId=e.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class Rk{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._effectId=e.readInt(),this._delay=e.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class Sk{flush(){return this._unitId=null,this._expression=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._expression=e.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class Ok{flush(){return this._unitId=null,this._handId=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._handId=e.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class Ck{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(e){return e?(this._giverUserId=e.readInt(),this._handItemType=e.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class Ak{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(e){return e?(this._unitId=e.readInt(),this._isIdle=e.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class Nk{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._figure=e.readString(),this._gender=e.readString().toLocaleUpperCase(),this._motto=e.readString(),this._achievementScore=e.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class bk{flush(){return this._unitId=null,this._alpha=255,!0}parse(e){return e?(this._unitId=e.readInt(),this._alpha=e.readInt(),!0):!1}get unitId(){return this._unitId}get alpha(){return this._alpha}}class yk{flush(){return this._unitId=null,this._value=0,!0}parse(e){return e?(this._unitId=e.readInt(),this._value=e.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}class nc{constructor(e){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=e}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(e){this._isReadOnly||(this._x=e)}get y(){return this._y}set y(e){this._isReadOnly||(this._y=e)}get z(){return this._z}set z(e){this._isReadOnly||(this._z=e)}get dir(){return this._dir}set dir(e){this._isReadOnly||(this._dir=e)}get name(){return this._name}set name(e){this._isReadOnly||(this._name=e)}get userType(){return this._userType}set userType(e){this._isReadOnly||(this._userType=e)}get sex(){return this._sex}set sex(e){this._isReadOnly||(this._sex=e)}get figure(){return this._figure}set figure(e){this._isReadOnly||(this._figure=e)}get custom(){return this._custom}set custom(e){this._isReadOnly||(this._custom=e)}get activityPoints(){return this._activityPoints}set activityPoints(e){this._isReadOnly||(this._activityPoints=e)}get webID(){return this._webID}set webID(e){this._isReadOnly||(this._webID=e)}get groupID(){return this._groupID}set groupID(e){this._isReadOnly||(this._groupID=e)}get groupName(){return this._groupName}set groupName(e){this._isReadOnly||(this._groupName=e)}get groupStatus(){return this._groupStatus}set groupStatus(e){this._isReadOnly||(this._groupStatus=e)}get subType(){return this._subType}set subType(e){this._isReadOnly||(this._subType=e)}get ownerId(){return this._ownerId}set ownerId(e){this._isReadOnly||(this._ownerId=e)}get ownerName(){return this._ownerName}set ownerName(e){this._isReadOnly||(this._ownerName=e)}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._isReadOnly||(this._rarityLevel=e)}get hasSaddle(){return this._hasSaddle}set hasSaddle(e){this._isReadOnly||(this._hasSaddle=e)}get isRiding(){return this._isRiding}set isRiding(e){this._isReadOnly||(this._isRiding=e)}get canBreed(){return this._canBreed}set canBreed(e){this._isReadOnly||(this._canBreed=e)}get canHarvest(){return this._canHarvest}set canHarvest(e){this._isReadOnly||(this._canHarvest=e)}get canRevive(){return this._canRevive}set canRevive(e){this._isReadOnly||(this._canRevive=e)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(e){this._isReadOnly||(this._hasBreedingPermission=e)}get petLevel(){return this._petLevel}set petLevel(e){this._isReadOnly||(this._petLevel=e)}get petPosture(){return this._petPosture}set petPosture(e){this._isReadOnly||(this._petPosture=e)}get botSkills(){return this._botSkills}set botSkills(e){this._botSkills=e}get isModerator(){return this._isModerator}set isModerator(e){this._isReadOnly||(this._isModerator=e)}}nc.M="M";nc.F="F";class vk{flush(){return this._users=[],!0}parse(e){if(!e)return!1;this._users=[];const t=e.readInt();let r=0;for(;r<t;){const i=e.readInt(),n=e.readString(),o=e.readString();let l=e.readString();const c=e.readInt(),h=e.readInt(),u=e.readInt(),g=parseFloat(e.readString()),m=e.readInt(),p=e.readInt(),f=new nc(c);if(f.dir=m,f.name=n,f.custom=o,f.x=h,f.y=u,f.z=g,this._users.push(f),p===1){f.webID=i,f.userType=jt.USER,f.sex=this.resolveSex(e.readString()),f.groupID=e.readInt(),f.groupStatus=e.readInt(),f.groupName=e.readString();const T=e.readString();T!==""&&(l=this.convertSwimFigure(T,l,f.sex)),f.figure=l,f.activityPoints=e.readInt(),f.isModerator=e.readBoolean()}else if(p===2)f.userType=jt.PET,f.figure=l,f.webID=i,f.subType=e.readInt().toString(),f.ownerId=e.readInt(),f.ownerName=e.readString(),f.rarityLevel=e.readInt(),f.hasSaddle=e.readBoolean(),f.isRiding=e.readBoolean(),f.canBreed=e.readBoolean(),f.canHarvest=e.readBoolean(),f.canRevive=e.readBoolean(),f.hasBreedingPermission=e.readBoolean(),f.petLevel=e.readInt(),f.petPosture=e.readString();else if(p===3)f.userType=jt.BOT,f.webID=c*-1,l.indexOf("/")===-1?f.figure=l:f.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",f.sex=nc.M;else if(p===4){f.userType=jt.RENTABLE_BOT,f.webID=i,f.sex=this.resolveSex(e.readString()),f.figure=l,f.ownerId=e.readInt(),f.ownerName=e.readString();const T=e.readInt();if(T){const I=[];let O=0;for(;O<T;)I.push(e.readShort()),O++;f.botSkills=I}}r++}return!0}resolveSex(e){return e.substr(0,1).toLowerCase()==="f"?nc.F:nc.M}convertSwimFigure(e,t,r){const i=t.split(".");let n=1,o=1,l=1;const c=1e4;let h=0;for(;h<i.length;){const p=i[h].split("-");p.length>2&&p[0]==="hd"&&(n=parseInt(p[2])),h++}const u=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],g=e.split("=");if(g.length>1){const m=g[1].split("/");m[0];const p=m[1];r==="F"?l=10010:l=10011;const f=u.indexOf(p);o=c+f+1}return t+(".bds-10001-"+n+".ss-"+l+"-"+o)}get users(){return this._users}}class Mk{flush(){return this._unitId=null,!0}parse(e){return e?(this._unitId=parseInt(e.readString()),!0):!1}get unitId(){return this._unitId}}class Dk{constructor(e,t){this._action=e,this._value=t}get action(){return this._action}get value(){return this._value}}class Pk{constructor(e,t,r,i,n,o,l,c=0,h=0,u=0,g,m,p,f){this._id=e,this._x=t,this._y=r,this._z=i,this._height=n,this._headDirection=o,this._direction=l,this._targetX=c,this._targetY=h,this._targetZ=u,this._didMove=g,this._canStandUp=m,this._animationTime=p,this._actions=f||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}get animationTime(){return this._animationTime}}class Lk{flush(){return this._statuses=[],!0}parse(e){if(!e)return!1;const t=e.readInt();this._statuses=[];for(let r=0;r<t;r++){const i=this.parseStatus(e);i&&this._statuses.push(i)}return!0}parseStatus(e){if(!e)return null;const t=e.readInt(),r=e.readInt(),i=e.readInt(),n=parseFloat(e.readString()),o=e.readInt()%8*45,l=e.readInt()%8*45,c=e.readString(),h=e.readInt();let u=0,g=0,m=0,p=0,f=!1,T=!1;const I=[];if(c){const O=c.split("/");for(const A of O){const N=A.split(" ");if(N[0]!==""&&N.length>=2){switch(N[0]){case"mv":{const P=N[1].split(",");P.length>=3&&(u=parseInt(P[0]),g=parseInt(P[1]),m=parseFloat(P[2]),T=!0);break}case"sit":{const P=parseFloat(N[1]);N.length>=3&&(f=N[2]==="1"),p=P;break}case"lay":{const P=parseFloat(N[1]);p=Math.abs(P);break}}I.push(new Dk(N[0],N[1]))}}}return new Pk(t,r,i,n,p,o,l,u,g,m,T,f,h,I)}get statuses(){return this._statuses}}const Dm=class{constructor(s){if(!s)throw new Error("invalid_wrapper");this.flush(),this.parse(s)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(s){return s?(this._itemId=s.readInt(),this._furniType=s.readString(),this._ref=s.readInt(),this._spriteId=s.readInt(),this._category=s.readInt(),this._stuffData=Do.parseObjectData(s),this._isRecyclable=s.readBoolean(),this._tradable=s.readBoolean(),this._isGroupable=s.readBoolean(),this._sellable=s.readBoolean(),this._secondsToExpiration=s.readInt(),this._expirationTimeStamp=tt(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=s.readBoolean(),this._flatId=s.readInt(),this._isWallItem=this._furniType===Dm.WALL_ITEM,this._furniType===Dm.FLOOR_ITEM&&(this._slotId=s.readString(),this._extra=s.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};let x_=Dm;x_.WALL_ITEM="I";x_.FLOOR_ITEM="S";class Uk{flush(){return this._items=[],!0}parse(e){return e?(this._items.push(new x_(e)),!0):!1}get items(){return this._items}}class xk{flush(){return!0}parse(e){return!!e}}class wk{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(e){if(!e)return!1;this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(;t>0;){const r=new x_(e);r&&this._fragment.set(r.itemId,r),t--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Fk{flush(){return this._itemId=0,!0}parse(e){return e?(this._itemId=e.readInt(),!0):!1}get itemId(){return this._itemId}}class kk{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(e){return e?(this._itemId=e.readInt(),this._itemsLeft=e.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class Gk{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(e){return e?(this._itemType=e.readString(),this._classId=e.readInt(),this._productCode=e.readString(),this._placedItemId=e.readInt(),this._placedItemType=e.readString(),this._placedInRoom=e.readBoolean(),this._petFigureString=e.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class Bk{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const e of this._rarityCategories)e&&e.dispose();return this._rarityCategories=[],!0}parse(e){if(!e)return!1;this._nestId=e.readInt(),this._pet1=new JI(e),this._pet2=new JI(e);let t=e.readInt();for(;t>0;)this._rarityCategories.push(new hk(e)),t--;return this._resultPetType=e.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class Vk{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(e){return e?(this._breedingNestStuffId=e.readInt(),this._result=e.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class Hk{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(e){return this._petId=e.readInt(),this._rarityCategory=e.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class Up{constructor(e){this._typeId=e.readInt(),this._paletteId=e.readInt(),this._color=e.readString(),this._breedId=e.readInt(),this._customParts=[],this._customPartCount=e.readInt();let t=0;for(;t<this._customPartCount;)this._customParts.push(e.readInt()),this._customParts.push(e.readInt()),this._customParts.push(e.readInt()),t++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let e=this.typeId+" "+this.paletteId+" "+this.color;e=e+(" "+this.custompartCount);for(const t of this.customParts)e=e+(" "+t);return e}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class w_{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString(),this._figureData=new Up(e),this._level=e.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class Wk{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(e){return this._pet=new w_(e),this._boughtAsGift=e.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}class F_{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(e){return e?(this._state=e.readInt(),this._ownPetId=e.readInt(),this._otherPetId=e.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}F_.STATE_CANCEL=1;F_.STATE_ACCEPT=2;F_.STATE_REQUEST=3;class jk{flush(){return this._fragment=null,!0}parse(e){this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(this._fragment=new Map;t>0;){const r=new w_(e);this._fragment.set(r.id,r),t--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class Yk{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(e){return this._boughtAsGift=e.readBoolean(),this._pet=new w_(e),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class zk{flush(){return!0}parse(e){return e?(this._petId=e.readInt(),!0):!1}get petId(){return this._petId}}class Kk{constructor(e){this._itemId=e.readInt(),this._furniType=e.readString().toUpperCase(),this._ref=e.readInt(),this._spriteId=e.readInt(),this._category=e.readInt(),this._isGroupable=e.readBoolean(),this._stuffData=Do.parseObjectData(e),this._secondsToExpiration=-1,this._expirationTimeStamp=tt(),this._hasRentPeriodStarted=!1,this._creationDay=e.readInt(),this._creationMonth=e.readInt(),this._creationYear=e.readInt(),this._extra=this.furniType==="S"?e.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class qk{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(e){return e?(this._userID=e.readInt(),this._userAccepts=e.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}class xp{flush(){return!0}parse(e){return e?(this._userId=e.readInt(),this._reason=e.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}}xp.ERROR_WHILE_COMMIT=1;class Xk{flush(){return!0}parse(e){return!!e}}class Qk{flush(){return!0}parse(e){return!!e}}class $k{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(e){return!e||(this._firstUserID=e.readInt(),this._firstUserItemArray=[],!this.parseItems(e,this._firstUserItemArray))||(this._firstUserNumItems=e.readInt(),this._firstUserNumCredits=e.readInt(),this._secondUserID=e.readInt(),this._secondUserItemArray=[],!this.parseItems(e,this._secondUserItemArray))?!1:(this._secondUserNumItems=e.readInt(),this._secondUserNumCredits=e.readInt(),!0)}parseItems(e,t){let r=e.readInt();for(;r>0;)t.push(new Kk(e)),r--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class Jk{flush(){return!0}parse(e){return!!e}}class Zk{flush(){return!0}parse(e){return!!e}}class wp{flush(){return!0}parse(e){return e?(this._reason=e.readInt(),this._otherUserName=e.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}}wp.REASON_YOU_ARE_ALREADY_TRADING=7;wp.REASON_OTHER_USER_ALREADY_TRADING=8;class eG{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(e){return e?(this._userId=e.readInt(),this._userCanTrade=e.readInt()===1,this._otherUserId=e.readInt(),this._otherUserCanTrade=e.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class tG{flush(){return!0}parse(e){return!!e}}class sG{flush(){return!0}parse(e){return!!e}}class rG{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(e){return e?(this._respect=e.readInt(),this._petOwnerId=e.readInt(),this._petData=new w_(e),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===ht.MONSTERPLANT}}class iG{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(e){return e?(this._petId=e.readInt(),this._userId=e.readInt(),this._supplementType=e.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}class Eo{}Eo.WATER=0;Eo.LIGHT=1;Eo.REVIVE=2;Eo.REBREED_FERTILIZER=3;Eo.SPEED_FERTILIZER=4;class nG{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(e){return e?(this._userId=e.readInt(),this._respectsReceived=e.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class aG{constructor(e,t,r){this._hasControllers=!1,this._roomId=e,this._roomName=t,this._hasControllers=r}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class oG{constructor(e){this._currentHcStreak=e.readInt(),this._firstSubscriptionDate=e.readString(),this._kickbackPercentage=e.readDouble(),this._totalCreditsMissed=e.readInt(),this._totalCreditsRewarded=e.readInt(),this._totalCreditsSpent=e.readInt(),this._creditRewardForStreakBonus=e.readInt(),this._creditRewardForMonthlySpent=e.readInt(),this._timeUntilPayday=e.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class lG{flush(){return this._data=null,!0}parse(e){return this._data=new oG(e),!0}get data(){return this._data}}class cG{flush(){return this._looks=new Map,!0}parse(e){if(!e)return!1;e.readInt();let t=e.readInt();for(;t>0;){const r=e.readInt(),i=e.readString(),n=e.readString();this._looks.set(r,[i,n]),t--}return!0}get looks(){return this._looks}}class uG{flush(){return this._result=-1,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class hG{flush(){return this._isVip=!1,this._rooms=[],!0}parse(e){if(!e)return!1;this._isVip=e.readBoolean();let t=e.readInt();for(;t>0;)this._rooms.push(new aG(e.readInt(),e.readString(),e.readBoolean())),t--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class dG{flush(){return this._pageId=-1,this._data=null,!0}parse(e){return e?(this._pageId=e.readInt(),this._data=new P_(e),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class _G{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(e){return e?(this._type=e.readInt(),this._breedId=e.readInt(),this._paletteId=e.readInt(),this._sellable=e.readBoolean(),this._rare=e.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class gG{flush(){return this._productCode="",this._palettes=[],!0}parse(e){if(!e)return!1;this._productCode=e.readString();let t=e.readInt();for(;t>0;)this._palettes.push(new _G(e)),t--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class mG{constructor(e){this._trackingState=e.readInt(),this._id=e.readInt(),this._identifier=e.readString(),this._productCode=e.readString(),this._priceInCredits=e.readInt(),this._priceInActivityPoints=e.readInt(),this._activityPointType=e.readInt(),this._purchaseLimit=e.readInt();const t=e.readInt();this._expirationTime=t>0?t*1e3+Date.now():0,this._title=e.readString(),this._description=e.readString(),this._imageUrl=e.readString(),this._iconImageUrl=e.readString(),this._type=e.readInt(),this._subProductCodes=[];let r=e.readInt();for(;r>0;)this._subProductCodes.push(e.readString()),r--;return this}populate(e){e&&(this._id=e.id,this._identifier=e.identifier,this._type=e.type,this._title=e.title,this._description=e.description,this._imageUrl=e.imageUrl,this._iconImageUrl=e.iconImageUrl,this._productCode=e.productCode,this._purchaseLimit=e.purchaseLimit,this._expirationTime=e.expirationTime,this._priceInCredits=e.priceInCredits,this._priceInActivityPoints=e.priceInActivityPoints,this._activityPointType=e.activityPointType,this._subProductCodes=e.subProductCodes,this._trackingState=e.trackingState)}purchase(e){this._purchaseLimit=this._purchaseLimit-e}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class fG{flush(){return!0}parse(e){return!!e}}class pG{flush(){return this._data=null,!0}parse(e){return e?(this._data=new mG(e),!0):!1}get data(){return this._data}}class EG{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(e){return e?(this._errorCode=e.readString(),!0):!1}get errorCode(){return this._errorCode}}class IG{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(e){return e?(this._productDescription=e.readString(),this._productName=e.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class TG{flush(){return!0}parse(e){return!!e}}class Po{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(e){this._goalId=e.readInt(),this._goalCode=e.readString(),this._result=e.readInt(),this._requiredFurnis=[];let t=e.readInt();for(;t>0;)this._requiredFurnis.push(e.readString()),t--;for(t=e.readInt();t>0;)this._missingFurnis[e.readString()]="",t--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(e){return!!this._missingFurnis[e]}}Po.SUBMITTED=0;Po.ASK_FOR_SUBMIT=1;Po.ASK_FOR_CONFIRM=2;Po.PREREQUISITES_NOT_MET=3;Po.ROOM_DOOR_NOT_OPEN=4;Po.ROOM_TOO_OLD=5;Po.ASK_FOR_ACCEPT_RULES=6;class k_{}k_.ALLOWED=0;k_.REQUIRED_PERK_MISSING=1;k_.REQUIRED_BADGE_MISSING=2;class RG{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(e){return this._goalId=e.readInt(),this._goalCode=e.readString(),this._resultCode=e.readInt(),this._votesRemaining=e.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===k_.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class SG{flush(){return this._schedulingStr=null,this._code=null,!0}parse(e){return this._schedulingStr=e.readString(),this._code=e.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class OG{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(e){return this._isPartOf=e.readBoolean(),this._targetId=e.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class CG{flush(){return!0}parse(e){return!0}}class AG{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(e){return this._timeStr=e.readString(),this._secondsUntil=e.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class bO{constructor(e){this._recipeName=e.readString(),this._itemName=e.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class NG{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let i=0;i<t;i++)this._recipes.push(new bO(e));const r=e.readInt();for(let i=0;i<r;i++)this._ingredients.push(e.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class bG{constructor(e){this._count=e.readInt(),this._itemName=e.readString()}get count(){return this._count}get itemName(){return this._itemName}}class yG{constructor(){this._ingredients=[]}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++)this._ingredients.push(new bG(e));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class vG{parse(e){return e?(this._count=e.readInt(),this._hasRecipes=e.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class MG{parse(e){return e?(this._success=e.readBoolean(),this._success&&(this._result=new bO(e)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class DG{flush(){return!0}parse(e){return!!e}}class PG{constructor(e){if(!e)throw new Error("invalid_wrapper");this._senderId=e.readInt(),this._errorCode=e.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class LG{flush(){return this._failuers=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._failuers.push(new PG(e)),t--;return!0}get failures(){return this._failuers}}class UG{flush(){return this._success=!1,!0}parse(e){return e?(this._success=e.readBoolean(),!0):!1}get success(){return this._success}}class xG{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class yO{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString()}get id(){return this._id}get name(){return this._name}}class Pm{constructor(e){if(!e)throw new Error("invalid_wrapper");this._id=e.readInt(),this._name=e.readString(),this._gender=e.readInt(),this._online=e.readBoolean(),this._followingAllowed=e.readBoolean(),this._figure=e.readString(),this._categoryId=e.readInt(),this._motto=e.readString(),this._realName=e.readString(),this._lastAccess=e.readString(),this._persistedMessageUser=e.readBoolean(),this._vipMember=e.readBoolean(),this._pocketHabboUser=e.readBoolean(),this._relationshipStatus=e.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class wG{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(e){if(!e)return!1;this._totalFragments=e.readInt(),this._fragmentNumber=e.readInt();let t=e.readInt();for(;t>0;)this._fragment.push(new Pm(e)),t--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class FG{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new yO(e)),t--;let r=e.readInt();for(;r>0;){const i=e.readInt();i===-1?this._removedFriendIds.push(e.readInt()):i===0?this._updatedFriends.push(new Pm(e)):i===1&&this._addedFriends.push(new Pm(e)),r--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class kG{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(e){return e?(this._typeCode=e.readInt(),this._avatarId=e.readInt(),this._message=e.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class vO{constructor(e){if(!e)throw new Error("invalid_wrapper");this._requestId=e.readInt(),this._requesterName=e.readString(),this._figureString=e.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class GG{flush(){return this._totalRequests=0,this._requests=[],!0}parse(e){if(!e)return!1;this._totalRequests=e.readInt();let t=e.readInt();for(;t>0;)this._requests.push(new vO(e)),t--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class eT{constructor(e){if(!e)throw new Error("invalid_wrapper");this._avatarId=e.readInt(),this._avatarName=e.readString(),this._avatarMotto=e.readString(),this._isAvatarOnline=e.readBoolean(),this._canFollow=e.readBoolean(),this._lastOnlineData=e.readString(),this._avatarGender=e.readInt(),this._avatarFigure=e.readString(),this._realName=e.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class BG{flush(){return this._friends=[],this._others=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._friends.push(new eT(e)),t--;let r=e.readInt();for(;r>0;)this._others.push(new eT(e)),r--;return!0}get friends(){return this._friends}get others(){return this._others}}class VG{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(e){return e?(this._errorCode=e.readInt(),this._userId=e.readInt(),this._message=e.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class HG{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(e){return e?(this._clientMessageId=e.readInt(),this._errorCode=e.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class WG{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(e){if(!e)return!1;this._userFriendLimit=e.readInt(),this._normalFriendLimit=e.readInt(),this._extendedFriendLimit=e.readInt();let t=e.readInt();for(;t>0;)this._categories.push(new yO(e)),t--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class jG{flush(){return!0}parse(e){return!!e}}class YG{flush(){return this._count=0,!0}parse(e){return e?(this._count=e.readInt(),!0):!1}get count(){return this._count}}class zG{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(e){return e?(this._senderId=e.readInt(),this._messageText=e.readString(),this._secondsSinceSent=e.readInt(),e.bytesAvailable&&(this._extraData=e.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class KG{flush(){return this._request=null,!0}parse(e){return e?(this._request=new vO(e),!0):!1}get request(){return this._request}}class qG{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(e){if(!e)return!1;this._errorCode=e.readInt();let t=e.readInt();for(;t>0;)this._failedRecipients.push(e.readInt()),t--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class XG{flush(){return this._senderId=0,this._messageText=null,!0}parse(e){return e?(this._senderId=e.readInt(),this._messageText=e.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class QG{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._freeGamesLeft=e.readInt(),this._gamesPlayedTotal=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}class Ju{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(e){return e?(this._status=e.readInt(),this._blockLength=e.readInt(),this._gamesPlayed=e.readInt(),this._freeGamesLeft=e.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}Ju.STATUS_OK=0;Ju.STATUS_FAILED_REASON_UNKNOWN=1;Ju.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2;Ju.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;class $G{flush(){return this._position=-1,!0}parse(e){return e?(this._position=e.readInt(),!0):!1}get position(){return this._position}}class Ha{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}Ha.KICKED=1;Ha.DUPLICATE_MACHINEID=2;Ha.INVITATION_REQUIRED=3;Ha.NO_SPACE_IN_TEAM=4;Ha.TEAM_NOT_FOUND=5;Ha.USER_HAS_ACTIVE_INSTANCE=6;Ha.USER_HAS_PENDING_INSTANCE_REQUEST=7;Ha.USER_HAS_NO_FREE_GAMES_LEFT=8;class Fp{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}Fp.NOT_ENOUGH_PLAYERS=1;Fp.GAME_HAS_NO_OWNER=2;class JG{flush(){return!0}parse(e){return!!e}}class ZG{flush(){return this._userId=-1,!0}parse(e){return e?(this._userId=e.readInt(),!0):!1}get userId(){return this._userId}}class eB{flush(){return!0}parse(e){return e?(this._stuffCode=e.readString(),this._badgeCode=e.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class tB{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(e){return e?(this._stuffId=e.readInt(),this._achievementId=e.readInt(),this._requiredLevelBadgeCode=e.readString(),this._userProgress=e.readInt(),this._totalProgress=e.readInt(),this._endTime=e.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class sB{flush(){return!0}parse(e){if(!e)return!1;this._stuffId=e.readInt();const t=e.readInt();let r=0;for(;r<t;)this._achievements.push(new NO(e)),r++;return this._endTime=e.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class rB{constructor(e,t,r,i){this._gameTypeId=e,this._achievementId=t,this._achievementName=r,this._levels=i}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class iB{flush(){return!0}parse(e){if(!e)return!1;this._achievements=[];const t=e.readInt();let r=0;for(;r<t;){const i=e.readInt(),n=e.readInt();let o=0;for(;o<n;){const l=e.readInt(),c=e.readString(),h=e.readInt();this._achievements.push(new rB(i,l,c,h)),o++}r++}return!0}get achievements(){return this._achievements}}class nB{constructor(e,t,r,i,n,o){this._gameId=e,this._gameNameId=t,this._bgColor=r,this._textColor=i,this._assetUrl=n,this._supportUrl=o}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class aB{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._inviterId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class oB{flush(){return!0}parse(e){if(!e)return!1;this._games=[];const t=e.readInt();for(let r=0;r<t;r++){const i=e.readInt(),n=e.readString(),o=e.readString();let l=parseInt(o,16);l=l|4278190080;const c=e.readString();let h=parseInt(c,16);h=h|4278190080;const u=e.readString(),g=e.readString();this._games.push(new nB(i,n,l,h,u,g))}return!0}get games(){return this._games}}const Lm=class{flush(){return!0}parse(s){return s?(this._gameTypeId=s.readInt(),this._status=s.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==Lm.OK}get isInMaintenance(){return this._status==Lm.MAINTENANCE}};let kp=Lm;kp.OK=0;kp.MAINTENANCE=1;class lB{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class MO{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._reason=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}}MO.DUPLICATE_MACHINEID=1;class cB{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class uB{flush(){return!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),this._url=e.readString(),this._quality=e.readString(),this._scaleMode=e.readString(),this._frameRate=e.readInt(),this._minMajorVersion=e.readInt(),this._minMinorVersion=e.readInt(),this._params=new Map;const t=e.readInt();let r=0;for(;r<t;)this._params.set(e.readString(),e.readString()),r++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class hB{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),this._url=e.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class dB{flush(){return!0}parse(e){return e?(this._gameTypeId=e.readInt(),this._gameClientId=e.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class _B{flush(){return!0}parse(e){return!!e}}class G_{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(e){return e?(this._year=e.readInt(),this._week=e.readInt(),this._maxOffset=e.readInt(),this._currentOffset=e.readInt(),this._minutesUntilReset=e.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class gB{constructor(e){this._name=e.readString(),this._figure=e.readString(),this._gender=e.readString(),this._rank=e.readInt(),this._score=e.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class mB{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt();let t=e.readInt();for(;t>0;)this._products.push(new bi(e)),t--;return this._minutesUntilNextWeek=e.readInt(),this._rewardingOn=e.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class fB{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(e){if(!e)return!1;this._gameTypeId=e.readInt();let t=e.readInt();for(;t>0;)this._winners.push(new gB(e)),t--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class pB{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class EB{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(e){return e?(this._phoneStatusCode=e.readInt(),this._collectionStatusCode=e.readInt(),this._millisecondsToAllowProcessReset=e.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class IB{flush(){return this._resultCode=-1,!0}parse(e){return e?(this._resultCode=e.readInt(),this._millisToAllowProcessReset=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class TB{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(e){return e?(this._resultCode=e.readInt(),this._millisecondsToAllowProcessReset=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class RB{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const l=e.readInt(),c=e.readString(),h=e.readString();this._bases.set(l,[c,h]),t--}let r=e.readInt();for(;r>0;){const l=e.readInt(),c=e.readString(),h=e.readString();this._symbols.set(l,[c,h]),r--}let i=e.readInt();for(;i>0;){const l=e.readInt(),c=e.readString();this._partColors.set(l,c),i--}let n=e.readInt();for(;n>0;){const l=e.readInt(),c=e.readString();this._colorsA.set(l,c),n--}let o=e.readInt();for(;o>0;){const l=e.readInt(),c=e.readString();this._colorsB.set(l,c),o--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class SB{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(e){if(!e)return!1;this._groupCost=e.readInt();let t=e.readInt();for(;t>0;){const r=e.readInt(),i=e.readString();e.readBoolean(),this._availableRooms.set(r,i),t--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class OB{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(e){return e?(this._userId=e.readInt(),this._furnitureCount=e.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class CB{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(e){return e?(this._id=e.readInt(),e.readBoolean(),this._type=e.readInt(),this._title=e.readString(),this._description=e.readString(),this._badge=e.readString(),this._roomId=e.readInt(),this._roomName=e.readString(),this._membershipType=e.readInt(),this._membersCount=e.readInt(),this._isFavorite=e.readBoolean(),this._createdAt=e.readString(),this._isOwner=e.readBoolean(),this._isAdmin=e.readBoolean(),this._ownerName=e.readString(),this._flag=e.readBoolean(),this._canMembersDecorate=e.readBoolean(),this._pendingRequestsCount=e.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class AB{constructor(e){this.isBase=e,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}class or{}or.OWNER=0;or.ADMIN=1;or.MEMBER=2;or.REQUESTED=3;or.DELETED=4;class NB{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(e){return e?(this._rank=e.readInt(),this._id=e.readInt(),this._name=e.readString(),this._figure=e.readString(),this._joinedAt=e.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class bB{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._groupTitle=e.readString(),this._roomId=e.readInt(),this._badge=e.readString(),this._totalMembersCount=e.readInt();let t=e.readInt();for(;t>0;)this._result.push(new NB(e)),t--;return this._admin=e.readBoolean(),this._pageSize=e.readInt(),this._pageIndex=e.readInt(),this._level=e.readInt(),this._query=e.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class yB{flush(){return this._roomId=0,this._groupId=0,!0}parse(e){return e?(this._roomId=e.readInt(),this._groupId=e.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class vB{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(e){if(!e)return!1;e.readInt()===1&&(this._roomId=e.readInt(),this._roomName=e.readString(),e.readBoolean()),e.readBoolean(),this._id=e.readInt(),this._title=e.readString(),this._description=e.readString(),e.readInt(),this._colorA=e.readInt(),this._colorB=e.readInt(),this._state=e.readInt(),this._canMembersDecorate=e.readInt()===0,e.readBoolean(),e.readString();const r=e.readInt();for(let i=0;i<r;i++){const n=new AB(i===0);n.key=e.readInt(),n.color=e.readInt(),n.position=e.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(i,n)}return this._badgeCode=e.readString(),this._membersCount=e.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class MB{flush(){return!0}parse(e){return this._groupId=e.readInt(),!0}get groupId(){return this._groupId}}class wu{static parse(e){return this.fillFromMessage(new wu,e)}static fillFromMessage(e,t){return e._groupId=t.readInt(),e._name=t.readString(),e._description=t.readString(),e._icon=t.readString(),e._totalThreads=t.readInt(),e._leaderboardScore=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessages=t.readInt(),e._lastMessageId=t.readInt(),e._lastMessageAuthorId=t.readInt(),e._lastMessageAuthorName=t.readString(),e._lastMessageTimeAsSecondsAgo=t.readInt(),e}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(e){this._totalThreads=e._totalThreads,this._totalMessages=e._totalMessages,this._unreadMessages=e._unreadMessages,this._lastMessageAuthorId=e._lastMessageAuthorId,this._lastMessageAuthorName=e._lastMessageAuthorName,this._lastMessageId=e._lastMessageId,this._lastMessageTimeAsSecondsAgo=e._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(e){this._unreadMessages=this._totalMessages-e,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(e){this._lastMessageAuthorId=e.lastUserId,this._lastMessageAuthorName=e.lastUserName,this._lastMessageId=e.lastMessageId,this._lastMessageTimeAsSecondsAgo=e.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class Gp extends wu{static parse(e){const t=new Gp;return wu.fillFromMessage(t,e),t._readPermissions=e.readInt(),t._postMessagePermissions=e.readInt(),t._postThreadPermissions=e.readInt(),t._moderatePermissions=e.readInt(),t._readPermissionError=e.readString(),t._postMessagePermissionError=e.readString(),t._postThreadPermissionError=e.readString(),t._moderatePermissionError=e.readString(),t._reportPermissionError=e.readString(),t._canChangeSettings=e.readBoolean(),t._isStaff=e.readBoolean(),t}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class DB{flush(){return this._extendedForumData=null,!0}parse(e){return e?(this._extendedForumData=Gp.parse(e),!0):!1}get extendedForumData(){return this._extendedForumData}}class PB{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(e){if(!e)return!1;this._listCode=e.readInt(),this._totalAmount=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._forums=[];let t=0;for(;t<this._amount;)this._forums.push(wu.parse(e)),t++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class Zu{static parse(e){const t=new Zu;return t._threadId=e.readInt(),t._authorId=e.readInt(),t._authorName=e.readString(),t._header=e.readString(),t._isPinned=e.readBoolean(),t._isLocked=e.readBoolean(),t._creationTimeAsSecondsAgo=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessagesCount=e.readInt(),t._lastMessageId=e.readInt(),t._lastUserId=e.readInt(),t._lastUserName=e.readString(),t._lastCommentTime=e.readInt(),t._state=e.readByte(),t._adminId=e.readInt(),t._adminName=e.readString(),t._adminOperationTimeAsSecondsAgo=e.readInt(),t}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(e){this._adminOperationTimeAsSecondsAgo=e}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(e){this._lastCommentTime=e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}get authorId(){return this._authorId}set authorId(e){this._authorId=e}get authorName(){return this._authorName}set authorName(e){this._authorName=e}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(e){this._creationTimeAsSecondsAgo=e}get header(){return this._header}set header(e){this._header=e}get lastMessageId(){return this._lastMessageId}set lastMessageId(e){this._lastMessageId=e}get lastUserId(){return this._lastUserId}set lastUserId(e){this._lastUserId=e}get lastUserName(){return this._lastUserName}set lastUserName(e){this._lastUserName=e}get totalMessages(){return this._totalMessages}set totalMessages(e){this._totalMessages=e}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(e){this._unreadMessagesCount=e}get state(){return this._state}set state(e){this._state=e}get adminId(){return this._adminId}set adminId(e){this._adminId=e}get adminName(){return this._adminName}set adminName(e){this._adminName=e}get isPinned(){return this._isPinned}set isPinned(e){this._isPinned=e}get isLocked(){return this._isLocked}set isLocked(e){this._isLocked=e}}class LB{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._threads=[];let t=0;for(;t<this._amount;)this._threads.push(Zu.parse(e)),t++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class eh{static parse(e){const t=new eh;return t._messageId=e.readInt(),t._messageIndex=e.readInt(),t._authorId=e.readInt(),t._authorName=e.readString(),t._authorFigure=e.readString(),t._creationTime=e.readInt(),t._messageText=e.readString(),t._state=e.readByte(),t._adminId=e.readInt(),t._adminName=e.readString(),t._adminOperationTimeAsSeccondsAgo=e.readInt(),t._authorPostCount=e.readInt(),t}get state(){return this._state}set state(e){this._state=e}get adminId(){return this._adminId}set adminId(e){this._adminId=e}get adminName(){return this._adminName}set adminName(e){this._adminName=e}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(e){this._adminOperationTimeAsSeccondsAgo=e}get messageId(){return this._messageId}set messageId(e){this._messageId=e}get creationTime(){return this._creationTime}set creationTime(e){this._creationTime=e}get authorName(){return this._authorName}set authorName(e){this._authorName=e}get authorFigure(){return this._authorFigure}set authorFigure(e){this._authorFigure=e}get threadId(){return this._threadId}set threadId(e){this._threadId=e}get messageIndex(){return this._messageIndex}set messageIndex(e){this._messageIndex=e}set groupID(e){this._groupId=e}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(e){this._authorId=e}get messageText(){return this._messageText}set messageText(e){this._messageText=e}get authorPostCount(){return this._authorPostCount}set authorPostCount(e){this._authorPostCount=e}}class UB{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._threadId=e.readInt(),this._message=eh.parse(e),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class xB{flush(){return this._groupId=-1,this._thread=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._thread=Zu.parse(e),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class wB{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(e){if(!e)return!1;this._groupId=e.readInt(),this._threadId=e.readInt(),this._startIndex=e.readInt(),this._amount=e.readInt(),this._messages=[];let t=0;for(;t<this._amount;){const r=eh.parse(e);r.groupID=this._groupId,r.threadId=this._threadId,this._messages.push(r),t++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class FB{flush(){return this._count=0,!0}parse(e){return e?(this._count=e.readInt(),!0):!1}get count(){return this._count}}class kB{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._threadId=e.readInt(),this._message=eh.parse(e),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class GB{flush(){return this._groupId=-1,this._thread=null,!0}parse(e){return e?(this._groupId=e.readInt(),this._thread=Zu.parse(e),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class BB{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(e){return e?(this._encryptedPublicKey=e.readString(),e.bytesAvailable&&(this._serverClientEncryption=e.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class VB{flush(){return this._reason=-1,!0}parse(e){return e?(this._reason=0,e.bytesAvailable&&(this._reason=e.readInt()),!0):!1}get reason(){return this._reason}}class HB{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(e){if(!e)return!1;this._accounts=new Map;let t=e.readInt();for(;t>0;)this._accounts.set(e.readInt(),e.readString()),t--;return!0}get accounts(){return this._accounts}}class WB{flush(){return!0}parse(e){return e?(this._encryptedPrime=e.readString(),this._encryptedGenerator=e.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class jB{flush(){return this._noobnessLevel=0,!0}parse(e){return e?(this._noobnessLevel=e.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class YB{flush(){return!0}parse(e){return e?(this._infoUrl=e.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class zB{flush(){return!0}parse(e){return!0}}class KB{flush(){return this._calls=[],!0}parse(e){this._calls=[];const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readString();this._calls.push({callId:i,timeStamp:n,message:o})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class qB{flush(){return this._message=null,!0}parse(e){return this._message=e.readString(),!0}get message(){return this._message}}class XB{flush(){return this._resultType=0,this._messageText=null,!0}parse(e){return e?(this._resultType=e.readInt(),this._messageText=e.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class QB{flush(){return!0}parse(e){return!0}}class $B{flush(){return this._acceptanceTimeout=-1,!0}parse(e){return this._acceptanceTimeout=e.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class JB{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(e){this._finalStatus=[],this._winningVoteCode=e.readInt(),this._ownVoteCode=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._finalStatus.push(e.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class ZB{flush(){return!0}parse(e){return this._votingTimeout=e.readInt(),this._chatRecord=e.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}class Sl{flush(){return this._status=null,!0}parse(e){this._status=[];const t=e.readInt();for(let r=0;r<t;r++)this._status.push(e.readInt());return!0}get status(){return this._status}}Sl.AWAITING_VOTE=0;Sl.VOTED_OK=1;Sl.VOTED_BAD=2;Sl.VOTED_VERY_BAD=3;Sl.NO_VOTE=4;Sl.FINDING_NEW_VOTER=5;class eV{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(e){return e?(this._onDuty=e.readBoolean(),this._guidesOnDuty=e.readInt(),this._helpersOnDuty=e.readInt(),this._guardiansOnDuty=e.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class tV{constructor(e,t,r,i,n,o,l){this._type=e,this._secondsAgo=t,this._isGuide=r,this._otherPartyName=i,this._otherPartyFigure=n,this._description=o,this._roomName=l}get type(){return this._type}set type(e){this._type=e}get secondsAgo(){return this._secondsAgo}set secondsAgo(e){this._secondsAgo=e}get isGuide(){return this._isGuide}set isGuide(e){this._isGuide=e}get otherPartyName(){return this._otherPartyName}set otherPartyName(e){this._otherPartyName=e}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(e){this._otherPartyFigure=e}get description(){return this._description}set description(e){this._description=e}get roomName(){return this._roomName}set roomName(e){this._roomName=e}}class th{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(e){return e?(this._statusCode=e.readInt(),this._pendingTicket=new tV(e.readInt(),e.readInt(),e.readBoolean(),e.readString(),e.readString(),e.readString(),e.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}}th.GUIDE_REPORTING_STATUS_OK=0;th.GUIDE_REPORTING_STATUS_PENDING_TICKET=1;th.GUIDE_REPORTING_STATUS_ABUSIVE=2;th.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;class sV{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(e){return e?(this._asGuide=e.readBoolean(),this._helpRequestType=e.readInt(),this._helpRequestDescription=e.readString(),this._roleSpecificWaitTime=e.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class rV{flush(){return!0}parse(e){return!!e}}class iV{flush(){return this._endReason=0,!0}parse(e){return e?(this._endReason=e.readInt(),!0):!1}get endReason(){return this._endReason}}class Fc{flush(){return this._errorCode=0,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}Fc.ERROR_GENERIC=0;Fc.ERROR_GUIDES_REJECT=1;Fc.ERROR_NOT_ENOUGH_GUIDES=2;Fc.ERROR_NOT_ENOUGH_VOTES=3;Fc.ERROR_NO_CHATLOG_FOUND=4;class nV{flush(){return this._roomId=0,this._roomName=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class aV{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(e){return e?(this._chatMessage=e.readString(),this._senderId=e.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class oV{flush(){return this._isTyping=!1,!0}parse(e){return e?(this._isTyping=e.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class lV{flush(){return this._requesterRoomId=0,!0}parse(e){return e?(this._requesterRoomId=e.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class cV{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(e){return e?(this._requesterUserId=e.readInt(),this._requesterName=e.readString(),this._requesterFigure=e.readString(),this._guideUserId=e.readInt(),this._guideName=e.readString(),this._guideFigure=e.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}class sh{flush(){return this._result=0,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}sh.CREATION_RESULT_OK=0;sh.CREATION_RESULT_UNABLE_TO_REPORT=1;sh.CREATION_RESULT_NO_CHATLOG_FOUND=2;sh.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;class B_{flush(){return this._resolution=0,!0}parse(e){return e?(this._resolution=e.readInt(),!0):!1}get resolution(){return this._resolution}}B_.RESOLUTION_GUARDIANS_TOOK_ACTION=0;B_.RESOLUTION_FORWARDED_TO_MODERATORS=1;B_.RESOLUTION_REPORTER_IS_ABUSIVE=2;class uV{flush(){return!0}parse(e){return!!e}}class hV{flush(){return this._closeReason=0,this._messageText="",!0}parse(e){return e?(this._closeReason=e.readInt(),this._messageText=e.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class dV{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(e){if(!e)return!1;this._quizCode=e.readString();const t=e.readInt();this._questionIds=[];for(let r=0;r<t;r++)this._questionIds.push(e.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class _V{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(e){if(!e)return!1;this._quizCode=e.readString();const t=e.readInt();this._questionIdsForWrongAnswers=[];for(let r=0;r<t;r++)this._questionIdsForWrongAnswers.push(e.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class V_{constructor(e){this._id=e.readInt(),this._title=e.readString(),this._bodyText=e.readString(),this._buttonText=e.readString(),this._linkType=e.readInt(),this._linkContent=e.readString(),this._imageUrl=e.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}}V_.LINK_TYPE_URL=0;V_.LINK_TYPE_INTERNAL=1;V_.LINK_TYPE_NO_LINK=2;class gV{flush(){return this._articles=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++)this._articles.push(new V_(e));return!0}get articles(){return this._articles}}class mV{flush(){return!0}parse(e){return e?(this._acknowledged=e.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class fV{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(e){return e?(this._result=e.readInt(),this._newOfferId=e.readInt(),this._newPrice=e.readInt(),this._requestedOfferId=e.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class pV{flush(){return this._offerId=0,this._success=!1,!0}parse(e){return e?(this._offerId=e.readInt(),this._success=e.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class EV{flush(){return this._tokenCount=0,this._result=0,!0}parse(e){return e?(this._result=e.readInt(),this._tokenCount=e.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class IV{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(e){return e?(this._enabled=e.readBoolean(),this._commission=e.readInt(),this._credits=e.readInt(),this._advertisements=e.readInt(),this._minimumPrice=e.readInt(),this._maximumPrice=e.readInt(),this._offerTime=e.readInt(),this._displayTime=e.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class TV{flush(){return this._result=0,!0}parse(e){return e?(this._result=e.readInt(),!0):!1}get result(){return this._result}}class RV{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(e){if(!e)return!1;this._averagePrice=e.readInt(),this._currentOfferCount=e.readInt(),this._historyLength=e.readInt();let t=e.readInt();for(;t>0;)this._dayOffsets.push(e.readInt()),this._averagePrices.push(e.readInt()),this._soldAmounts.push(e.readInt()),t--;return this._furniCategoryId=e.readInt(),this._furniTypeId=e.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class DO{constructor(e,t,r,i,n,o,l,c,h,u=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=r,this._extraData=i,this._stuffData=n,this._price=o,this._status=l,this._timeLeftMinutes=c,this._averagePrice=h,this._offerCount=u}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}const ou=class{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(s){if(!s)return!1;const e=s.readInt();let t=0;for(;t<e;){const r=s.readInt(),i=s.readInt();let n=s.readInt(),o=-1,l="",c=null;n===ou.FURNITYPE_STUFF?(o=s.readInt(),c=Do.parseObjectData(s)):n===ou.FURNITYPE_WALL?(o=s.readInt(),l=s.readString()):n==ou.FAKE_FURNITYPE_UNIQUE&&(o=s.readInt(),c=$n.getData(ei.FORMAT_KEY),c.uniqueNumber=s.readInt(),c.uniqueSeries=s.readInt(),n=ou.FURNITYPE_STUFF);const h=s.readInt(),u=s.readInt(),g=s.readInt(),m=s.readInt(),p=new DO(r,o,n,l,c,h,i,u,g,m);t<this.MAX_LIST_LENGTH&&this._offers.push(p),t++}return this._totalItemsFound=s.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};let H_=ou;H_.FURNITYPE_STUFF=1;H_.FURNITYPE_WALL=2;H_.FAKE_FURNITYPE_UNIQUE=3;const PO=class{flush(){return this._offers=[],!0}parse(s){if(!s)return!1;this._offers=[],this._creditsWaiting=s.readInt();const e=s.readInt();for(let t=0;t<e;t++){const r=s.readInt(),i=s.readInt();let n=s.readInt(),o,l,c;n==1?(o=s.readInt(),c=this.getStuffData(s)):n==2?(o=s.readInt(),l=s.readString()):n==3&&(o=s.readInt(),c=$n.getData(ei.FORMAT_KEY),c.uniqueNumber=s.readInt(),c.uniqueSeries=s.readInt(),n=1);const h=s.readInt(),u=s.readInt(),g=s.readInt(),m=new DO(r,o,n,l,c,h,i,u,g);t<PO.MAX_LIST_LENGTH&&this._offers.push(m)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(s){const e=s.readInt(),t=$n.getData(e);return t.parseWrapper(s),t}};let LO=PO;LO.MAX_LIST_LENGTH=500;class SV{constructor(e,t,r,i,n){this._timestamp=e,this._habboId=t,this._username=r,this._message=i,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}class oa{constructor(e){this._context=new Map,this._chatlog=[],this._recordType=e.readByte();const t=e.readShort();for(let i=0;i<t;i++){const n=e.readString(),o=e.readByte();switch(o){case 0:this._context.set(n,e.readBoolean());break;case 1:this._context.set(n,e.readInt());break;case 2:this._context.set(n,e.readString());break;default:throw new Error("Unknown data type "+o)}}const r=e.readShort();for(let i=0;i<r;i++){const n=e.readString(),o=e.readInt(),l=e.readString(),c=e.readString(),h=e.readBoolean();this._chatlog.push(new SV(n,o,l,c,h))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(e){const t=this._context.get(e);return t||0}}oa.TYPE_SIMPLE=0;oa.TYPE_ROOM_CHAT=1;oa.TYPE_IM_SESSION=2;oa.TYPE_DISCUSSION_THREAD=3;oa.TYPE_DISCUSSION_MESSAGE=4;oa.TYPE_SELFIE=5;oa.TYPE_PHOTO=6;class OV{constructor(e){this._issueId=e.readInt(),this._callerUserId=e.readInt(),this._reportedUserId=e.readInt(),this._chatRecordId=e.readInt(),this._chatRecord=new oa(e)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class CV{flush(){return this._data=null,!0}parse(e){return e?(this._data=new OV(e),!0):!1}get data(){return this._data}}class AV{flush(){return!0}parse(e){return this._issueId=parseInt(e.readString()),!0}get issueId(){return this._issueId}}class Io{constructor(e,t,r,i,n,o,l,c,h,u,g,m,p,f,T,I){this._disposed=!1,this._issueId=e,this._state=t,this._categoryId=r,this._reportedCategoryId=i,this._issueAgeInMilliseconds=n,this._priority=o,this._groupingId=l,this._reporterUserId=c,this._reporterUserName=h,this._reportedUserId=u,this._reportedUserName=g,this._pickerUserId=m,this._pickerUserName=p,this._message=f,this._chatRecordId=T,this._patterns=I,this._creationTimeInMilliseconds=tt()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const e of this._patterns)e.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(e){const r=(this._issueAgeInMilliseconds+e-this._creationTimeInMilliseconds)/1e3/60,i=r%60,n=r/60,o=(i<10?"0":"")+i;return(n<10?"0":"")+n+":"+o}}Io.STATE_OPEN=1;Io.STATE_PICKED=2;Io.STATE_CLOSED=3;class NV{constructor(e){this._disposed=!1,this._pattern=e.readString(),this._startIndex=e.readInt(),this._endIndex=e.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class UO{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(e){const t=e.readInt(),r=e.readInt(),i=e.readInt(),n=e.readInt(),o=e.readInt(),l=e.readInt(),c=e.readInt(),h=e.readInt(),u=e.readString(),g=e.readInt(),m=e.readString(),p=e.readInt(),f=e.readString(),T=e.readString(),I=e.readInt(),O=e.readInt(),A=[];for(let N=0;N<O;N++)A.push(new NV(e));return this._issueData=new Io(t,r,i,n,o,l,c,h,u,g,m,p,f,T,I,A),!0}}class bV{flush(){return this._issues=null,!0}parse(e){this._issues=[];const t=e.readInt();for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),o=e.readString(),l=new Io(i,0,0,0,0,0,0,0,null,0,null,n,o,null,0,[]);this._issues.push(l)}return this._retryEnabled=e.readBoolean(),this._retryCount=e.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class yV{flush(){return this._message="",this._url=null,!0}parse(e){return e?(this._message=e.readString(),this._url=e.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class vV{flush(){return this._userId=-1,this._success=!1,!0}parse(e){return this._userId=e.readInt(),this._success=e.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class MV{constructor(e){this._disposed=!1;const t=new UO;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let r=e.readInt(),i=0;for(;i<r;)t.parse(e)&&this._issues.push(t.issueData),i++;for(r=e.readInt(),i=0;i<r;)this._messageTemplates.push(e.readString()),i++;for(r=e.readInt(),i=0;i<r;)e.readString(),i++;for(this._cfhPermission=e.readBoolean(),this._chatlogsPermission=e.readBoolean(),this._alertPermission=e.readBoolean(),this._kickPermission=e.readBoolean(),this._banPermission=e.readBoolean(),this._roomAlertPermission=e.readBoolean(),this._roomKickPermission=e.readBoolean(),r=e.readInt(),i=0;i<r;)this._roomMessageTemplates.push(e.readString()),i++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class DV{constructor(){this._data=null}flush(){return this._data=null,!0}parse(e){return this._data=new MV(e),!0}get data(){return this._data}}class PV{flush(){return this._message="",this._url="",!0}parse(e){return e?(this._message=e.readString(),this._url=e.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class LV{constructor(e){if(this._tags=[],this._exists=e.readBoolean(),!this.exists)return;this._name=e.readString(),this._desc=e.readString();const t=e.readInt();for(let r=0;r<t;r++)this._tags.push(e.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class UV{constructor(e){this._flatId=e.readInt(),this._userCount=e.readInt(),this._ownerInRoom=e.readBoolean(),this._ownerId=e.readInt(),this._ownerName=e.readString(),this._room=new LV(e)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class xV{flush(){return this._data=null,!0}parse(e){return e?(this._data=new UV(e),!0):!1}get data(){return this._data}}class wV{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(e){return this._windowX=e.readInt(),this._windowY=e.readInt(),this._windowWidth=e.readInt(),this._windowHeight=e.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class FV{constructor(e){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._registrationAgeInMinutes=e.readInt(),this._minutesSinceLastLogin=e.readInt(),this._online=e.readBoolean(),this._cfhCount=e.readInt(),this._abusiveCfhCount=e.readInt(),this._cautionCount=e.readInt(),this._banCount=e.readInt(),this._tradingLockCount=e.readInt(),this._tradingExpiryDate=e.readString(),this._lastPurchaseDate=e.readString(),this._identityId=e.readInt(),this._identityRelatedBanCount=e.readInt(),this._primaryEmailAddress=e.readString(),this._userClassification=e.readString(),e.bytesAvailable&&(this._lastSanctionTime=e.readString(),this._sanctionAgeHours=e.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class kV{flush(){return this._data=null,!0}parse(e){return e?(this._data=new FV(e),!0):!1}get data(){return this._data}}class GV{flush(){return this._data=null,!0}parse(e){return e?(this._data=new oa(e),!0):!1}get data(){return this._data}}class BV{constructor(e){this._roomId=e.readInt(),this._roomName=e.readString(),this._enterHour=e.readInt(),this._enterMinute=e.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class VV{constructor(e){this._rooms=[],this._userId=e.readInt(),this._userName=e.readString();const t=e.readInt();let r=0;for(;r<t;)this._rooms.push(new BV(e)),r++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class HV{flush(){return!0}parse(e){return this._data=new VV(e),!0}get data(){return this._data}}class WV{flush(){return this._message="",!0}parse(e){return e?(this._message=e.readString(),!0):!1}get message(){return this._message}}class jV{constructor(e){this._roomChatlogs=[],this._userId=e.readInt(),this._username=e.readString();const t=e.readInt();for(let r=0;r<t;r++)this._roomChatlogs.push(new oa(e))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class YV{flush(){return this._data=null,!0}parse(e){return e?(this._data=new jV(e),!0):!1}get data(){return this._data}}class zV{flush(){return!0}parse(e){return!!e}}class KV{flush(){return!0}parse(e){return e?(this._contentType=e.readString(),this._classId=e.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class qV{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(e){return e?(this._boxColor=e.readString(),this._keyColor=e.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class XV{flush(){return!0}parse(e){return!!e}}class QV{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(e){return e?(this._canCreate=e.readBoolean(),this._errorCode=e.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}class Bp{flush(){return!0}parse(e){return e?(this._resultCode=e.readInt(),this._roomLimit=e.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}}Bp.CREATION_ALLOWED=0;Bp.ROOM_LIMIT_REACHED=1;class $V{constructor(e){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),o=e.readInt();this._categoryToCurrentUserCountMap.set(i,n),this._categoryToMaxUserCountMap.set(i,o)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class JV{constructor(e,t=0,r=0){this._goalId=t,this._pageIndex=r,e&&(this._goalId=e.readInt(),this._pageIndex=e.readInt(),this._pageCount=e.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const lu=class{constructor(s){this._index=s.readInt(),this._popupCaption=s.readString(),this._popupDesc=s.readString(),this._showDetails=s.readInt()==1,this._picText=s.readString(),this._picRef=s.readString(),this._folderId=s.readInt(),this._userCount=s.readInt(),this._type=s.readInt(),this._type==lu.TYPE_TAG?this._tag=s.readString():this._type==lu.TYPE_GUEST_ROOM?this._guestRoomData=new Ot(s):this._open=s.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==lu.TYPE_TAG?0:this.type==lu.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};let W_=lu;W_.TYPE_TAG=1;W_.TYPE_GUEST_ROOM=2;W_.TYPE_FOLDER=4;class ZV{constructor(e){this._rooms=[],this._searchType=e.readInt(),this._searchParam=e.readString();const t=e.readInt();for(let i=0;i<t;i++)this._rooms.push(new Ot(e));e.readBoolean()&&(this._ad=new W_(e))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const e of this._rooms)e.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class xO{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(e){return e?(this._id=e.readInt(),this._code=e.readString(),this._filter=e.readString(),this._localization=e.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class eH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(e){if(!e)return!1;this._code=e.readString(),this._data=e.readString(),this._action=e.readInt(),this._closed=e.readBoolean(),this._mode=e.readInt();let t=e.readInt();for(;t>0;)this._rooms.push(new Ot(e)),t--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class tH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(e){if(!e)return!1;this._code=e.readString(),this._data=e.readString();let t=e.readInt();for(;t>0;)this._results.push(new eH(e)),t--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class sH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._code=null,this._savedSearches=[],!0}parse(e){if(!e)return!1;this._code=e.readString();let t=e.readInt();for(;t>0;)this._savedSearches.push(new xO(e)),t--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class rH{constructor(e){this._adId=e.readInt(),this._ownerAvatarId=e.readInt(),this._ownerAvatarName=e.readString(),this._flatId=e.readInt(),this._eventType=e.readInt(),this._eventName=e.readString(),this._eventDescription=e.readString();const t=e.readInt(),r=e.readInt(),i=new Date;let n=i.getTime();const o=t*60*1e3;n=n-o;const l=new Date(n);this._creationTime=l.getDate()+"-"+l.getMonth()+"-"+l.getFullYear()+" "+l.getHours()+":"+l.getMinutes();let c=i.getTime();const h=r*60*1e3;c=c+h,this._expirationDate=new Date(c),this._categoryId=e.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class iH{flush(){return!0}parse(e){return e?(this._data=new $V(e),!0):!1}get data(){return this._data}}class nH{flush(){return!0}parse(e){return e?(this._data=new JV(e),!0):!1}get data(){return this._data}}class aH{flush(){return!0}parse(e){return e?(this._globalId=e.readString(),this._convertedId=e.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class oH{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class lH{flush(){return!0}parse(e){return e?(this._flatId=e.readInt(),this._added=e.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class cH{flush(){return!0}parse(e){if(!e)return!1;this._favouriteRoomIds=[],this._limit=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._favouriteRoomIds.push(e.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class uH{flush(){return this._userName=null,!0}parse(e){return e?(this._userName=e.readString(),!0):!1}get userName(){return this._userName}}class hH{flush(){return this._roomId=-1,this._roomName=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._roomName=e.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class dH{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(e){return e?(this._roomEnter=e.readBoolean(),this._data=new Ot(e),this._roomForward=e.readBoolean(),this._staffPick=e.readBoolean(),this._isGroupMember=e.readBoolean(),this.data.allInRoomMuted=e.readBoolean(),this._moderation=new kr(e),this.data.canMute=e.readBoolean(),this._chat=new xt(e),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class _H{flush(){return!0}parse(e){return e?(this._data=new ZV(e),!0):!1}get data(){return this._data}}class gH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(e){return e?(this._id=e.readInt(),this._name=e.readString(),this._visible=e.readBoolean(),this._automatic=e.readBoolean(),this._automaticCategoryKey=e.readString(),this._globalCategoryKey=e.readString(),this._staffOnly=e.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class mH{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(e.readString()),t--;return!0}get categories(){return this._categories}}class fH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(e){return e?(this._id=e.readInt(),this._name=e.readString(),this._visible=e.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class pH{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(e){return e?(this._homeRoomId=e.readInt(),this._roomIdToEnter=e.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class EH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(e){return e?(this._roomId=e.readInt(),this._areaId=e.readInt(),this._image=e.readString(),this._caption=e.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class IH{flush(){return this._rooms=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._rooms.push(new EH(e)),t--;return!0}get rooms(){return this._rooms}}class TH{flush(){return this._topLevelContexts=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._topLevelContexts.push(new sH(e)),t--;return!0}get topLevelContexts(){return this._topLevelContexts}}class RH{flush(){return!0}parse(e){return!!e}}class SH{flush(){return this._searches=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._searches.push(new xO(e)),t--;return!0}get searches(){return this._searches}}class OH{flush(){return this._result=null,!0}parse(e){return e?(this._result=new tH(e),!0):!1}get result(){return this._result}}class CH{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(e){return e?(this._windowX=e.readInt(),this._windowY=e.readInt(),this._windowWidth=e.readInt(),this._windowHeight=e.readInt(),this._leftPanelHidden=e.readBoolean(),this._resultsMode=e.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class AH{constructor(e){this._tagName=e.readString(),this._userCount=e.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class NH{constructor(e){if(!e)throw new Error("invalid_wrapper");this.flush(),this.parse(e)}flush(){return this._tags=[],!0}parse(e){if(!e)return!1;this._tags=[];const t=e.readInt();let r=0;for(;r<t;)this._tags.push(new AH(e)),r++;return!0}get tags(){return this._tags}}class bH{flush(){return this._data=null,!0}parse(e){return e?(this._data=new NH(e),!0):!1}get data(){return this._data}}class yH{flush(){return!0}parse(e){return!0}}class vH{flush(){return!0}parse(e){return this._data=new rH(e),!0}get data(){return this._data}}class MH{flush(){return this._words=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._words.push(e.readString()),t--;return!0}get words(){return this._words}}class DH{flush(){return this._roomId=0,!0}parse(e){return e?(this._roomId=e.readInt(),!0):!1}get roomId(){return this._roomId}}class PH{flush(){return!0}parse(e){return this._flatId=e.readInt(),this._resultCode=e.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class LH{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new fH(e)),t--;return!0}get categories(){return this._categories}}class UH{flush(){return this._categories=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._categories.push(new gH(e)),t--;return!0}get categories(){return this._categories}}class xH{constructor(e){this._badgeCode="",this._removedBadgeCode="",this._type=e.readInt(),this._level=e.readInt(),this._badgeId=e.readInt(),this._badgeCode=e.readString(),this._points=e.readInt(),this._levelRewardPoints=e.readInt(),this._levelRewardPointType=e.readInt(),this._bonusPoints=e.readInt(),this._achievementID=e.readInt(),this._removedBadgeCode=e.readString(),this._category=e.readString(),this._showDialogToUser=e.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class wH{flush(){return this._data=null,!0}parse(e){return e?(this._data=new xH(e),!0):!1}get data(){return this._data}}class FH{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(e){return e?(this._amount=e.readInt(),this._amountChanged=e.readInt(),this._type=e.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class kH{flush(){return this._errorCode=-1,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class GH{flush(){return this._numGifts=0,!0}parse(e){return e?(this._numGifts=e.readInt(),!0):!1}get numGifts(){return this._numGifts}}class BH{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(e){return e?(this._messageId=e.readInt(),this._errorCode=e.readInt(),this._timestamp=e.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class VH{flush(){return this._key=null,!0}parse(e){return e?(this._key=e.readString(),!0):!1}get key(){return this._key}}class HH{flush(){return this._message=null,!0}parse(e){return e?(this._message=e.readString(),!0):!1}get message(){return this._message}}class WH{flush(){return this._enabled=!1,!0}parse(e){return e?(this._enabled=e.readBoolean(),!0):!1}get enabled(){return this._enabled}}class jH{flush(){return this._messages=[],!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;)this._messages.push(e.readString()),t--;return!0}get messages(){return this._messages}}class YH{flush(){return this._type=null,this._parameters=new Map,!0}parse(e){if(!e)return!1;this._type=e.readString();let t=e.readInt();for(;t>0;)this._parameters.set(e.readString(),e.readString()),t--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class zH{flush(){return this._contentType=null,this._classId=0,this._name=null,this._description=null,!0}parse(e){return e?(this._contentType=e.readString(),this._classId=e.readInt(),this._name=e.readString(),this._description=e.readString(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}get name(){return this._name}get description(){return this._description}}class KH{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(e){return e?(this._petId=e.readInt(),this._petName=e.readString(),this._level=e.readInt(),this._figureData=new Up(e),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class qH{flush(){return this._errorCode=-1,!0}parse(e){return e?(this._errorCode=e.readInt(),!0):!1}get errorCode(){return this._errorCode}}class XH{flush(){return!0}parse(e){return!0}}class QH{flush(){return this._alertMessage=null,!0}parse(e){return e?(this._alertMessage=e.readString(),e.bytesAvailable&&(this._titleMessage=e.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class $H{flush(){return this._items=new As,!0}parse(e){if(!e)return!1;let t=e.readInt();for(;t>0;){const r=e.readInt();let i=e.readInt();const n=[];for(;i>0;)n.push(e.readInt()),i--;this._items.add(r,n),t--}return!0}getItemsByCategory(e){return this._items.getValue(e)}get categories(){return this._items.getKeys()}}class JH{constructor(e,t,r){this._code=e,this._errorMessage=t,this._isAllowed=r}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}class Si{}Si.USE_GUIDE_TOOL="USE_GUIDE_TOOL";Si.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR";Si.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS";Si.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS";Si.CALL_ON_HELPERS="CALL_ON_HELPERS";Si.CITIZEN="CITIZEN";Si.TRADE="TRADE";Si.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA";Si.BUILDER_AT_WORK="BUILDER_AT_WORK";Si.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA";Si.CAMERA="CAMERA";Si.MOUSE_ZOOM="MOUSE_ZOOM";class ZH{flush(){return this._perks=[],!0}parse(e){if(!e)return!1;this._perks=[];const t=e.readInt();for(let r=0;r<t;r++)this._perks.push(new JH(e.readString(),e.readString(),e.readBoolean()));return!0}isAllowed(e){let t=!1;for(const r of this._perks)if(r.code===e){t=r.isAllowed;break}return t}get perks(){return this._perks}}class e2{flush(){return this._objectId=-1,this._figureData=null,!0}parse(e){return this._objectId=e.readInt(),e.bytesAvailable&&(this._figureData=new ra(e.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class t2{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(e){return this._objectId=e.readInt(),this._nameValidationStatus=e.readInt(),this._nameValidationInfo=e.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class s2{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(e){return this._roomIndex=e.readInt(),this._petId=e.readInt(),this._level=e.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class r2{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(e){return this._currentAge=e.readInt(),this._requiredAge=e.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class i2{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(e){this._petId=e.readInt();let t=e.readInt();for(;t>0;)this._commands.push(e.readInt()),t--;let r=e.readInt();for(;r>0;)this._enabledCommands.push(e.readInt()),r--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class n2{constructor(e,t,r){this._value=e,this._choiceText=t,this._choiceType=r}get value(){return this._value}set value(e){this._value=e}get choiceText(){return this._choiceText}set choiceText(e){this._choiceText=e}get choiceType(){return this._choiceType}set choiceType(e){this._choiceType=e}}class a2{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(e){this._questionId=e}get questionType(){return this._questionType}set questionType(e){this._questionType=e}get sortOrder(){return this._sortOrder}set sortOrder(e){this._sortOrder=e}get questionText(){return this._questionText}set questionText(e){this._questionText=e}get questionCategory(){return this._questionCategory}set questionCategory(e){this._questionCategory=e}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(e){this._questionAnswerType=e}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(e){this._questionAnswerCount=e}get children(){return this._children}set children(e){this._children=e}get questionChoices(){return this._questionChoices}set questionChoices(e){this._questionChoices=e}}class o2{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(e){this._id=e.readInt(),this._startMessage=e.readString(),this._endMessage=e.readString(),this._numQuestions=e.readInt();for(let t=0;t<this._numQuestions;t++){const r=this.parsePollQuestion(e),i=e.readInt();for(let n=0;n<i;n++)r.children.push(this.parsePollQuestion(e));this._questionArray.push(r)}return this._npsPoll=e.readBoolean(),!0}parsePollQuestion(e){const t=new a2;if(t.questionId=e.readInt(),t.sortOrder=e.readInt(),t.questionType=e.readInt(),t.questionText=e.readString(),t.questionCategory=e.readInt(),t.questionAnswerType=e.readInt(),t.questionAnswerCount=e.readInt(),t.questionType==1||t.questionType==2)for(let r=0;r<t.questionAnswerCount;r++)t.questionChoices.push(new n2(e.readString(),e.readString(),e.readInt()));return t}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class l2{flush(){throw!0}parse(e){return!0}}class c2{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(e){return this._id=e.readInt(),this._type=e.readString(),this._headline=e.readString(),this._summary=e.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class u2{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(e){this._userId=e.readInt(),this._value=e.readString(),this._answerCounts=new Map;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readInt();this._answerCounts.set(i,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class h2{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(e){this._questionId=e.readInt(),this._answerCounts=new Map;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readInt();this._answerCounts.set(i,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class d2{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(e){this._pollType=e.readString(),this._pollId=e.readInt(),this._questionId=e.readInt(),this._duration=e.readInt();const t=e.readInt(),r=e.readInt(),i=e.readInt(),n=e.readString();if(this._question={id:t,number:r,type:i,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=e.readInt();const o=e.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=o,this._question.selection_max=o;for(let l=0;l<o;l++)this._question.selection_values.push(e.readString()),this._question.selections.push(e.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class _2{flush(){return this._question=null,this._choices=[],this._SafeStr_7651=[],this._SafeStr_7654=-1,!0}parse(e){this._question=e.readString(),this._choices=[],this._SafeStr_7651=[];let t=e.readInt();for(;t>0;)this._choices.push(e.readString()),this._SafeStr_7651.push(e.readInt()),t--;return this._SafeStr_7654=e.readInt(),!0}get question(){return this._question}get choices(){return this._choices}get SafeStr_7651(){return this._SafeStr_7651}get SafeStr_7654(){return this._SafeStr_7654}}class g2{flush(){return this._question=null,this._choices=[],!0}parse(e){this._question=e.readString(),this._choices=[];const t=e.readInt();let r=0;for(;r<t;)this._choices.push(e.readString()),r++;return!0}get question(){return this._question}get choices(){return this._choices.slice()}}class m2{constructor(e){this._rewardUserLimits=[],this._hasGoalExpired=e.readBoolean(),this._personalContributionScore=e.readInt(),this._personalContributionRank=e.readInt(),this._communityTotalScore=e.readInt(),this._communityHighestAchievedLevel=e.readInt(),this._scoreRemainingUntilNextLevel=e.readInt(),this._percentCompletionTowardsNextLevel=e.readInt(),this._goalCode=e.readString(),this._timeRemainingInSeconds=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._rewardUserLimits.push(e.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class f2{constructor(e){this._communityGoalId=e.readInt(),this._communityGoalCode=e.readString(),this._userRank=e.readInt(),this._rewardCode=e.readString(),this._badge=e.readBoolean(),this._localizedName=e.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class p2{flush(){return this._prizes=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++)this._prizes.push(new f2(e));return!0}get prizes(){return this._prizes}}class E2{constructor(e){this._userId=e.readInt(),this._userName=e.readString(),this._figure=e.readString(),this._rank=e.readInt(),this._currentScore=e.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class I2{constructor(e){this._hof=[],this._goalCode=e.readString();const t=e.readInt();for(let r=0;r<t;r++)this._hof.push(new E2(e))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class T2{flush(){return this._data=null,!0}parse(e){return e?(this._data=new I2(e),!0):!1}get data(){return this._data}}class R2{flush(){return this._data=null,!0}parse(e){return e?(this._data=new m2(e),!0):!1}get data(){return this._data}}class S2{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(e){return e?(this._state=e.readInt(),this._userCount=e.readInt(),this._userCountGoal=e.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class O2{flush(){return this._imageUri="",!0}parse(e){return e?(this._imageUri=e.readString(),!0):!1}get imageUri(){return this._imageUri}}class C2{flush(){return!0}parse(e){return e?(this._expired=e.readBoolean(),!0):!1}get expired(){return this._expired}}class Ol{constructor(e){this._receiveTime=new Date,this._campaignCode=e.readString(),this._completedQuestsInCampaign=e.readInt(),this._questCountInCampaign=e.readInt(),this._activityPointType=e.readInt(),this._id=e.readInt(),this._accepted=e.readBoolean(),this._type=e.readString(),this._imageVersion=e.readString(),this._rewardCurrencyAmount=e.readInt(),this._localizationCode=e.readString(),this._completedSteps=e.readInt(),this._totalSteps=e.readInt(),this._sortOrder=e.readInt(),this._catalogPageName=e.readString(),this._chainCode=e.readString(),this._easy=e.readBoolean()}static getCampaignLocalizationKeyForCode(e){return"quests."+e}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(e){this._accepted=e}get accepted(){return this._accepted}set id(e){this._id=e}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(e){this._waitPeriodSeconds=e}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const t=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(t/1e3))}getCampaignLocalizationKey(){return Ol.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class A2{flush(){return this._questData=null,!0}parse(e){return e?(this._questData=new Ol(e),this._showDialog=e.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class N2{flush(){return this._quest=null,!0}parse(e){return e?(e.readBoolean()&&(this._quest=new Ol(e),this._easyQuestCount=e.readInt(),this._hardQuestCount=e.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class b2{flush(){return this._quest=null,!0}parse(e){return e?(this._quest=new Ol(e),!0):!1}get quest(){return this._quest}}class y2{flush(){return this._quests=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++)this._quests.push(new Ol(e));return this._openWindow=e.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class v2{flush(){return this._quests=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++)this._quests.push(new Ol(e));return!0}get quests(){return this._quests}}class M2{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(e){return e?(this._recyclerFinishedStatus=e.readInt(),this._prizeId=e.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class D2{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(e){return e?(this._recyclerStatus=e.readInt(),this._recyclerTimeoutSeconds=e.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class rh{constructor(e){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=e.readBoolean(),this._furniLimit=e.readInt();let t=e.readInt();for(;t>0;)this._stuffIds.push(e.readInt()),t--;for(this._stuffTypeId=e.readInt(),this._id=e.readInt(),this._stringParam=e.readString(),t=e.readInt();t>0;)this._intParams.push(e.readInt()),t--;this._stuffTypeSelectionCode=e.readInt()}getBoolean(e){return this._intParams[e]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(e){this._stuffTypeSelectionCode=e}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class Vp extends rh{constructor(e){super(e),this._type=e.readInt(),this._furniOptions=e.readInt(),this._furniType=e.readInt(),this._userOptions=e.readInt(),this._userType=e.readInt(),this._allOrOneOptions=e.readInt(),this._allOrOneType=e.readInt()}get type(){return this._type}get code(){return this._type}get furniOptions(){return this._furniOptions}get furniType(){return this._furniType}get userOptions(){return this._userOptions}get userType(){return this._userType}get allOrOneOptions(){return this._allOrOneOptions}get allOrOneType(){return this._allOrOneType}}class Hp extends rh{constructor(e){super(e),this._conflictingActions=[],this._triggerConf=e.readInt();let t=e.readInt();for(;t>0;)this._conflictingActions.push(e.readInt()),t--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class Wp extends rh{constructor(e){super(e),this._conflictingTriggers=[],this._type=e.readInt(),this._delayInPulses=e.readInt(),this._furniOptions=e.readInt(),this._furniType=e.readInt(),this._userOptions=e.readInt(),this._userType=e.readInt();let t=e.readInt();for(;t>0;)this._conflictingTriggers.push(e.readInt()),t--;try{let r=e.readInt();if(r>=0&&r<=50)for(;r>0;)this._destinationSelectedItems=this._destinationSelectedItems||[],this._destinationSelectedItems.push(e.readInt()),r--}catch{}}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get furniOptions(){return this._furniOptions}get furniType(){return this._furniType}get userOptions(){return this._userOptions}get userType(){return this._userType}get conflictingTriggers(){return this._conflictingTriggers}get destinationSelectedItems(){return this._destinationSelectedItems||[]}}class jp extends rh{constructor(e){super(e),this._type=e.readInt()}get type(){return this._type}get code(){return this._type}}class P2{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Wp(e),!0):!1}get definition(){return this._definition}}class L2{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new jp(e),!0):!1}get definition(){return this._definition}}class U2{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Vp(e),!0):!1}get definition(){return this._definition}}class Yp extends rh{constructor(e){super(e),this._type=e.readInt(),this._isFiltered=e.readInt(),this._isInverted=e.readInt()}get type(){return this._type}get code(){return this._type}get delayInPulses(){return 0}get isFiltered(){return this._isFiltered}get isInverted(){return this._isInverted}get conflictingTriggers(){return[]}}class x2{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Yp(e),!0):!1}get definition(){return this._definition}}class w2{flush(){return this._definition=null,!0}parse(e){return e?(this._definition=new Hp(e),!0):!1}get definition(){return this._definition}}class F2{flush(){return this._stuffId=0,!0}parse(e){return e?(this._stuffId=e.readInt(),!0):!1}get stuffId(){return this._stuffId}}class k2{flush(){return this._reason=0,!0}parse(e){return e?(this._reason=e.readInt(),!0):!1}get reason(){return this._reason}}class G2{flush(){return!0}parse(e){return!!e}}class B2{flush(){return this._info=null,!0}parse(e){return e?(this._info=e.readString(),!0):!1}get info(){return this._info}}class V2{flush(){return!0}parse(e){return!!e}}class H2{flush(){return!0}parse(e){return!0}}class W2{constructor(){this._songDisks=new As}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(e){this._maxLength=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._songDisks.add(e.readInt(),e.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class j2{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(e){return this._currentSongId=e.readInt(),this._currentPosition=e.readInt(),this._nextSongId=e.readInt(),this._nextPosition=e.readInt(),this._syncCount=e.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class Y2{flush(){return this._songId=0,this._officialSongId="",!0}parse(e){return this._officialSongId=e.readString(),this._songId=e.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class j_{constructor(e,t,r,i){this._startPlayHead=0,this._id=e,this._length=t,this._name=r,this._creator=i}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(e){this._startPlayHead=e}}class z2{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(e){this._synchronizationCount=e.readInt();const t=e.readInt();for(let r=0;r<t;r++)this._playlist.push(new j_(e.readInt(),e.readInt(),e.readString(),e.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class K2{flush(){return this._entry=null,!0}parse(e){return this._entry=new j_(e.readInt(),e.readInt(),e.readString(),e.readString()),!0}get entry(){return this._entry}}class q2 extends j_{constructor(e,t,r,i,n){super(e,t,r,i),this._data="",this._data=n}get data(){return this._data}}class X2{flush(){return this._songs=[],!0}parse(e){const t=e.readInt();for(let r=0;r<t;r++){const i=e.readInt();e.readString();const n=e.readString(),o=e.readString(),l=e.readInt(),c=e.readString(),h=new q2(i,l,n,c,o);this._songs.push(h)}return!0}get songs(){return this._songs}}class Q2{constructor(){this._songDiskInventory=new As}flush(){return this._songDiskInventory.reset(),!0}parse(e){const t=e.readInt();for(let r=0;r<t;r++)this._songDiskInventory.add(e.readInt(),e.readInt());return!0}getDiskId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getKey(e):-1}getSongId(e){return e>=0&&e<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(e):-1}get songDiskCount(){return this._songDiskInventory.length}}class $2{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(e){if(!e)return!1;let t=0;this._talentTrackName=e.readString(),this._level=e.readInt();const r=e.readInt();for(;t<r;)this._rewardPerks.push(new sW(e)),t++;const i=e.readInt();if(t<i)for(let n=0;n<i;n++){const o=e.readString(),l=e.readInt();this._rewardProducts.push(new wO(o,l)),t++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class J2{constructor(e,t,r,i,n){this._level=e,this._state=t,this._tasks=r,this._rewardPerks=i,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class Z2{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(e){return e?(this._talentTrackName=e.readString(),this._level=e.readInt(),this._maxLevel=e.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class wO{constructor(e,t){this._productCode=e,this._vipDays=t}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class eW{constructor(e,t,r,i,n,o){this._id=e,this._requiredLevel=t,this._badgeCode=r,this._state=i,this._currentScore=n,this._totalScore=o}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class tW{flush(){return this._type=null,this._levels=null,!0}parse(e){if(!e)return!1;this._type=e.readString(),this._levels=[];const t=e.readInt();for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),o=[],l=e.readInt();for(let m=0;m<l;m++){const p=e.readInt(),f=e.readInt(),T=e.readString(),I=e.readInt(),O=e.readInt(),A=e.readInt();o.push(new eW(p,f,T,I,O,A))}const c=[],h=e.readInt();for(let m=0;m<h;m++)c.push(e.readString());const u=[],g=e.readInt();for(let m=0;m<g;m++){const p=e.readString(),f=e.readInt();u.push(new wO(p,f))}this._levels.push(new J2(i,n,o,c,u))}return!0}get type(){return this._type}get levels(){return this._levels}}class sW{constructor(e){this._perkId=e.readInt()}get perkId(){return this._perkId}}class rW{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(e){if(!e)return!1;let t,r,i,n=e.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)t=e.readInt(),r=e.readString(),i=e.readString(),this._classifiedUsersNames.set(t,r),this._classifiedUsersClass.set(t,i),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class iW{flush(){return this._sessionId=-1,this._botId=-1,this._data="",!0}parse(e){return e?(this._sessionId=e.readInt(),this._botId=e.readInt(),this._data=e.readString(),!0):!1}get sessionId(){return this._sessionId}get botId(){return this._botId}get data(){return this._data}}class nW{flush(){return this._sessionId=-1,!0}parse(e){return e?(this._sessionId=e.readInt(),!0):!1}get sessionId(){return this._sessionId}}class aW extends U{constructor(e){super(e,Zx)}getParser(){return this.parser}}class oW extends U{constructor(e){super(e,e1)}getParser(){return this.parser}}class FO extends U{constructor(e){super(e,t1)}getParser(){return this.parser}}class lW extends U{constructor(e){super(e,s1)}getParser(){return this.parser}}class kO extends U{constructor(e){super(e,r1)}getParser(){return this.parser}}class GO extends U{constructor(e){super(e,i1)}getParser(){return this.parser}}class BO extends U{constructor(e){super(e,n1)}getParser(){return this.parser}}class VO extends U{constructor(e){super(e,a1)}getParser(){return this.parser}}class Mn extends U{constructor(e){super(e,o1)}getParser(){return this.parser}}Mn.NAME_OK=0;Mn.ERROR_NAME_REQUIRED=1;Mn.ERROR_NAME_TOO_SHORT=2;Mn.ERROR_NAME_TOO_LONG=3;Mn.ERROR_NAME_NOT_VALID=4;Mn.ERROR_NAME_IN_USE=5;Mn.ERROR_NAME_CHANGE_NOT_ALLOWED=6;Mn.ERROR_MERGE_HOTEL_DOWN=7;class HO extends U{constructor(e){super(e,l1)}getParser(){return this.parser}}class zp extends U{constructor(e){super(e,c1)}getParser(){return this.parser}}class cW extends U{constructor(e){super(e,h1)}getParser(){return this.parser}}class WO extends U{constructor(e){super(e,d1)}getParser(){return this.parser}}class jO extends U{constructor(e){super(e,_1)}getParser(){return this.parser}}class uW extends U{constructor(e){super(e,g1)}getParser(){return this.parser}}class YO extends U{constructor(e){super(e,m1)}getParser(){return this.parser}}class zO extends U{constructor(e){super(e,I1)}getParser(){return this.parser}}class KO extends U{constructor(e){super(e,T1)}getParser(){return this.parser}}class qO extends U{constructor(e){super(e,R1)}getParser(){return this.parser}}class XO extends U{constructor(e){super(e,S1)}getParser(){return this.parser}}class QO extends U{constructor(e){super(e,O1)}getParser(){return this.parser}}class hW extends U{constructor(e){super(e,C1)}getParser(){return this.parser}}class $O extends U{constructor(e){super(e,A1)}getParser(){return this.parser}}class dW extends U{constructor(e){super(e,N1)}getParser(){return this.parser}}class JO extends U{constructor(e){super(e,b1)}getParser(){return this.parser}}class _W extends U{constructor(e){super(e,y1)}getParser(){return this.parser}}class ZO extends U{constructor(e){super(e,v1)}getParser(){return this.parser}}class eC extends U{constructor(e){super(e,M1)}getParser(){return this.parser}}class tC extends U{constructor(e){super(e,D1)}getParser(){return this.parser}}class sC extends U{constructor(e){super(e,P1)}getParser(){return this.parser}}class rC extends U{constructor(e){super(e,L1)}getParser(){return this.parser}}class gW extends U{constructor(e){super(e,x1)}getParser(){return this.parser}}class iC extends U{constructor(e){super(e,k1)}getParser(){return this.parser}}class nC extends U{constructor(e){super(e,w1)}getParser(){return this.parser}}class mW extends U{constructor(e){super(e,G1)}getParser(){return this.parser}}class aC extends U{constructor(e){super(e,B1)}getParser(){return this.parser}}class Kp extends U{constructor(e){super(e,H1)}getParser(){return this.parser}}class oC extends U{constructor(e){super(e,W1)}getParser(){return this.parser}}class fW extends U{constructor(e){super(e,z1)}getParser(){return this.parser}}class lC extends U{constructor(e){super(e,K1)}getParser(){return this.parser}}class cC extends U{constructor(e){super(e,q1)}getParser(){return this.parser}}class pW extends U{constructor(e){super(e,X1)}getParser(){return this.parser}}class uC extends U{constructor(e){super(e,Q1)}getParser(){return this.parser}}class EW extends U{constructor(e){super(e,$1)}getParser(){return this.parser}}class hC extends U{constructor(e){super(e,J1)}getParser(){return this.parser}}class IW extends U{constructor(e){super(e,Z1)}getParser(){return this.parser}}class TW extends U{constructor(e){super(e,ew)}getParser(){return this.parser}}class dC extends U{constructor(e){super(e,tw)}getParser(){return this.parser}}class _C extends U{constructor(e){super(e,sw)}getParser(){return this.parser}}class gC extends U{constructor(e){super(e,rw)}getParser(){return this.parser}}class mC extends U{constructor(e){super(e,nw)}getParser(){return this.parser}}class fC extends U{constructor(e){super(e,hG)}getParser(){return this.parser}}class RW extends U{constructor(e){super(e,dG)}getParser(){return this.parser}}class pC extends U{constructor(e){super(e,gG)}getParser(){return this.parser}}class EC extends U{constructor(e){super(e,pG)}getParser(){return this.parser}}class SW extends U{constructor(e){super(e,fG)}getParser(){return this.parser}}class IC extends U{constructor(e){super(e,EG)}getParser(){return this.parser}}class TC extends U{constructor(e){super(e,IG)}getParser(){return this.parser}}class RC extends U{constructor(e){super(e,TG)}getParser(){return this.parser}}class OW extends U{constructor(e){super(e,Po)}getParser(){return this.parser}}class CW extends U{constructor(e){super(e,RG)}getParser(){return this.parser}}class AW extends U{constructor(e){super(e,SG)}getParser(){return this.parser}}class NW extends U{constructor(e){super(e,OG)}getParser(){return this.parser}}class bW extends U{constructor(e){super(e,CG)}getParser(){return this.parser}}class yW extends U{constructor(e){super(e,AG)}getParser(){return this.parser}}class SC extends U{constructor(e){super(e,NG)}getParser(){return this.parser}}class OC extends U{constructor(e){super(e,yG)}getParser(){return this.parser}}class CC extends U{constructor(e){super(e,vG)}getParser(){return this.parser}}class AC extends U{constructor(e){super(e,MG)}getParser(){return this.parser}}class Fu extends U{constructor(e){super(e,DG)}getParser(){return this.parser}}class vW extends U{constructor(e){super(e,LG)}getParser(){return this.parser}}class MW extends U{constructor(e){super(e,UG)}getParser(){return this.parser}}class DW extends U{constructor(e){super(e,xG)}getParser(){return this.parser}}class NC extends U{constructor(e){super(e,wG)}getParser(){return this.parser}}class bC extends U{constructor(e){super(e,FG)}getParser(){return this.parser}}class PW extends U{constructor(e){super(e,kG)}getParser(){return this.parser}}class yC extends U{constructor(e){super(e,GG)}getParser(){return this.parser}}class vC extends U{constructor(e){super(e,BG)}getParser(){return this.parser}}class LW extends U{constructor(e){super(e,VG)}getParser(){return this.parser}}class UW extends U{constructor(e){super(e,HG)}getParser(){return this.parser}}class MC extends U{constructor(e){super(e,WG)}getParser(){return this.parser}}class xW extends U{constructor(e){super(e,jG)}getParser(){return this.parser}}class wW extends U{constructor(e){super(e,YG)}getParser(){return this.parser}}class qp extends U{constructor(e){super(e,zG)}getParser(){return this.parser}}class Xp extends U{constructor(e){super(e,KG)}getParser(){return this.parser}}class DC extends U{constructor(e){super(e,qG)}getParser(){return this.parser}}class Qp extends U{constructor(e){super(e,XG)}getParser(){return this.parser}}class PC extends U{constructor(e){super(e,QG)}getParser(){return this.parser}}class FW extends U{constructor(e){super(e,Ju)}getParser(){return this.parser}}class kW extends U{constructor(e){super(e,$G)}getParser(){return this.parser}}class GW extends U{constructor(e){super(e,Ha)}getParser(){return this.parser}}class BW extends U{constructor(e){super(e,Fp)}getParser(){return this.parser}}class VW extends U{constructor(e){super(e,JG)}getParser(){return this.parser}}class HW extends U{constructor(e){super(e,ZG)}getParser(){return this.parser}}class WW extends U{constructor(e){super(e,eB)}getParser(){return this.parser}}class jW extends U{constructor(e){super(e,tB)}getParser(){return this.parser}}class YW extends U{constructor(e){super(e,sB)}getParser(){return this.parser}}class zW extends U{constructor(e){super(e,iB)}getParser(){return this.parser}}class KW extends U{constructor(e){super(e,aB)}getParser(){return this.parser}}class LC extends U{constructor(e){super(e,oB)}getParser(){return this.parser}}class UC extends U{constructor(e){super(e,kp)}getParser(){return this.parser}}class qW extends U{constructor(e){super(e,lB)}getParser(){return this.parser}}class XW extends U{constructor(e){super(e,MO)}getParser(){return this.parser}}class QW extends U{constructor(e){super(e,cB)}getParser(){return this.parser}}class $W extends U{constructor(e){super(e,uB)}getParser(){return this.parser}}class $p extends U{constructor(e){super(e,hB)}getParser(){return this.parser}}class JW extends U{constructor(e){super(e,dB)}getParser(){return this.parser}}class ZW extends U{constructor(e){super(e,_B)}getParser(){return this.parser}}class ej extends U{constructor(e){super(e,G_)}getParser(){return this.parser}}class tj extends U{constructor(e){super(e,G_)}getParser(){return this.parser}}class sj extends U{constructor(e){super(e,G_)}getParser(){return this.parser}}class rj extends U{constructor(e){super(e,G_)}getParser(){return this.parser}}class ij extends U{constructor(e){super(e,mB)}getParser(){return this.parser}}class nj extends U{constructor(e){super(e,fB)}getParser(){return this.parser}}class kd extends U{constructor(e){super(e,pB)}getParser(){return this.parser}}class aj extends U{constructor(e){super(e,EB)}getParser(){return this.parser}}class oj extends U{constructor(e){super(e,IB)}getParser(){return this.parser}}class lj extends U{constructor(e){super(e,TB)}getParser(){return this.parser}}class Jp extends U{constructor(e){super(e,RB)}getParser(){return this.parser}}class xC extends U{constructor(e){super(e,SB)}getParser(){return this.parser}}class wC extends U{constructor(e){super(e,OB)}getParser(){return this.parser}}class kc extends U{constructor(e){super(e,CB)}getParser(){return this.parser}}class FC extends U{constructor(e){super(e,bB)}getParser(){return this.parser}}class kC extends U{constructor(e){super(e,yB)}getParser(){return this.parser}}class GC extends U{constructor(e){super(e,vB)}getParser(){return this.parser}}class BC extends U{constructor(e){super(e,MB)}getParser(){return this.parser}}class cj extends U{constructor(e){super(e,DB)}getParser(){return this.parser}}class uj extends U{constructor(e){super(e,PB)}getParser(){return this.parser}}class hj extends U{constructor(e){super(e,LB)}getParser(){return this.parser}}class dj extends U{constructor(e){super(e,UB)}getParser(){return this.parser}}class _j extends U{constructor(e){super(e,xB)}getParser(){return this.parser}}class gj extends U{constructor(e){super(e,wB)}getParser(){return this.parser}}class mj extends U{constructor(e){super(e,FB)}getParser(){return this.parser}}class fj extends U{constructor(e){super(e,kB)}getParser(){return this.parser}}class pj extends U{constructor(e){super(e,GB)}getParser(){return this.parser}}class Ej extends U{constructor(e){super(e,BB)}getParser(){return this.parser}}class dt{}dt.LOGOUT=0;dt.JUST_BANNED=1;dt.CONCURRENT_LOGIN=2;dt.CONNECTION_LOST_TO_PEER=3;dt.AVATAR_IDENTITY_CHANGE=4;dt.REMOVE_FURNITURE_TOOL=5;dt.STILL_BANNED=10;dt.DUAL_LOGIN_BY_USERID=11;dt.HOTEL_CLOSED=12;dt.DUAL_LOGIN_BY_IP=13;dt.PEER_CONNECTION_MISSING=16;dt.NO_LOGIN_PERMISSION=17;dt.DUPLICATE_CONNECTION=18;dt.HOTEL_CLOSING=19;dt.INCORRECT_PASSWORD=20;dt.INVALID_LOGIN_TICKET=22;dt.VERSION_CHECK_URL=23;dt.VERSION_CHECK_PROPERTY=24;dt.VERSION_CHECK_MACHINE_ID=25;dt.NO_MESSENGER_SESSION=26;dt.USER_NOT_FOUND=27;dt.CRYPTO_NOT_INITIALIZED=28;dt.DEV_CRYPTO_NOT_ALLOWED=29;dt.DUPLICATE_UUID_DETECTED=100;dt.OLD_SESSION_IN_PROXY=101;dt.PUBLIC_KEY_NOT_NUMERIC=102;dt.PUBLIC_KEY_TOO_SHORT=103;dt.SOCKET_READ_GENERIC=104;dt.SOCKET_READ_FIRST_BYTE=105;dt.SOCKET_READ_LENGTH=106;dt.SOCKET_READ_BODY=107;dt.SOCKET_READ_POLICY=108;dt.SOCKET_IO_EXCEPTION=109;dt.SOCKET_WRONG_CRYPTO=110;dt.PROXY_RUNTIME_EXCEPTION=111;dt.IDLE_CONNECTION=112;dt.PONG_TIMEOUT=113;dt.IDLE_CONNECTION_NOT_AUTH=114;dt.IDLE_CONNECTION_NO_USER_ID=115;dt.WRITE_CLOSED_CHANNEL=116;dt.SOCKET_WRITE_EXCEPTION_1=117;dt.SOCKET_WRITE_EXCEPTION_2=118;dt.SOCKET_WRITE_EXCEPTION_3=119;class Ij extends U{constructor(e){super(e,VB)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case dt.JUST_BANNED:case dt.STILL_BANNED:return"banned";case dt.CONCURRENT_LOGIN:return"concurrentlogin";case dt.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class Tj extends U{constructor(e){super(e,HB)}getParser(){return this.parser}}class Rj extends U{constructor(e){super(e,WB)}getParser(){return this.parser}}class VC extends U{constructor(e){super(e,jB)}getParser(){return this.parser}}class HC extends U{constructor(e){super(e,YB)}getParser(){return this.parser}}class WC extends U{constructor(e){super(e,zB)}getParser(){return this.parser}}class jC extends U{constructor(e){super(e,KB)}getParser(){return this.parser}}class YC extends U{constructor(e){super(e,qB)}getParser(){return this.parser}}class zC extends U{constructor(e){super(e,XB)}getParser(){return this.parser}}class Sj extends U{constructor(e){super(e,QB)}getParser(){return this.parser}}class Oj extends U{constructor(e){super(e,$B)}getParser(){return this.parser}}class Cj extends U{constructor(e){super(e,JB)}getParser(){return this.parser}}class Aj extends U{constructor(e){super(e,ZB)}getParser(){return this.parser}}class Nj extends U{constructor(e){super(e,Sl)}getParser(){return this.parser}}class KC extends U{constructor(e){super(e,eV)}getParser(){return this.parser}}class bj extends U{constructor(e){super(e,th)}getParser(){return this.parser}}class qC extends U{constructor(e){super(e,sV)}getParser(){return this.parser}}class XC extends U{constructor(e){super(e,rV)}getParser(){return this.parser}}class Zp extends U{constructor(e){super(e,iV)}getParser(){return this.parser}}class eE extends U{constructor(e){super(e,Fc)}getParser(){return this.parser}}class QC extends U{constructor(e){super(e,nV)}getParser(){return this.parser}}class $C extends U{constructor(e){super(e,aV)}getParser(){return this.parser}}class JC extends U{constructor(e){super(e,oV)}getParser(){return this.parser}}class ZC extends U{constructor(e){super(e,lV)}getParser(){return this.parser}}class tE extends U{constructor(e){super(e,cV)}getParser(){return this.parser}}class yj extends U{constructor(e){super(e,sh)}getParser(){return this.parser}}class vj extends U{constructor(e){super(e,B_)}getParser(){return this.parser}}class Mj extends U{constructor(e){super(e,uV)}getParser(){return this.parser}}class eA extends U{constructor(e){super(e,hV)}getParser(){return this.parser}}class Dj extends U{constructor(e){super(e,dV)}getParser(){return this.parser}}class Pj extends U{constructor(e){super(e,_V)}getParser(){return this.parser}}class S{}S.ABOUT_ALERT=2676;S.WIRED_SELECTOR=2669;S.GET_FURNIFIXTOOL_FURNI_DATA=2670;S.FURNIFIXTOOL_BATCH_SAVE_RESPONSE=6006;S.WIRED_ADDON=6007;S.USER_ON_CLICKTHROUGH=6008;S.USER_WALKKEYS=6022;S.USER_VIMKEYS=6023;S.USER_FOCUS_STATUS=6060;S.ROOM_FURNI_VARIABLES=6009;S.ROOM_INTERNAL_FURNI_VARIABLES=6010;S.ROOM_USER_VARIABLES=6020;S.ROOM_INTERNAL_USER_VARIABLES=6021;S.ROOM_GLOBAL_VARIABLES=6040;S.ROOM_INTERNAL_GLOBAL_VARIABLES=6041;S.FURNI_WITH_VARIABLES=6011;S.USER_WITH_VARIABLES=6015;S.GET_FURNI_VARIABLE_BY_CLICK=6012;S.GET_USER_VARIABLE_BY_CLICK=6043;S.GET_GLOBAL_VARIABLES_AND_VALUES=6044;S.BLACKJACK_SESSION_STATUS=6013;S.BLACKJACK_BET_PROMPT=6014;S.ACHIEVEMENT_LIST=305;S.AUTHENTICATED=2491;S.AUTHENTICATION=-1;S.AVAILABILITY_STATUS=2033;S.BUILDERS_CLUB_EXPIRED=1452;S.CLUB_OFFERS=2405;S.CATALOG_PAGE=804;S.CATALOG_PAGE_LIST=1032;S.CATALOG_PURCHASE_OK=869;S.CATALOG_PURCHASE_ERROR=1404;S.CATALOG_PURCHASE_NOT_ALLOWED=3770;S.PRODUCT_OFFER=3388;S.LIMITED_SOLD_OUT=377;S.CATALOG_PUBLISHED=1866;S.CFH_RESULT_MESSAGE=3635;S.CLIENT_LATENCY=10;S.CLIENT_PING=3928;S.DESKTOP_CAMPAIGN=1745;S.DESKTOP_NEWS=286;S.DESKTOP_VIEW=122;S.BUNDLE_DISCOUNT_RULESET=2347;S.FIRST_LOGIN_OF_DAY=793;S.FURNITURE_ALIASES=1723;S.FURNITURE_DATA=2547;S.FURNITURE_FLOOR=1778;S.FURNITURE_FLOOR_ADD=1534;S.FURNITURE_FLOOR_REMOVE=2703;S.FURNITURE_FLOOR_UPDATE=3776;S.FURNITURE_ITEMDATA=2202;S.FURNITURE_STATE=2376;S.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293;S.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366;S.GAME_CENTER_ACHIEVEMENTS=2265;S.GAME_CENTER_GAME_LIST=222;S.GAME_CENTER_STATUS=2893;S.GAME_CENTER_IN_ARENA_QUEUE=872;S.GAME_CENTER_STOP_COUNTER=3191;S.GAME_CENTER_USER_LEFT_GAME=3138;S.GAME_CENTER_DIRECTORY_STATUS=2246;S.GAME_CENTER_STARTING_GAME_FAILED=2142;S.GAME_CENTER_JOINING_FAILED=1730;S.GAMESTATUSMESSAGE=3805;S.GAMEACHIEVEMENTS=1689;S.GAMEINVITE=904;S.JOININGQUEUEFAILED=3035;S.JOINEDQUEUEMESSAGE=2260;S.LEFTQUEUE=1477;S.LOAD_GAME_URL=2624;S.LOADGAME=3654;S.UNLOADGAME=1715;S.ACHIEVEMENTRESOLUTIONCOMPLETED=740;S.ACHIEVEMENTRESOLUTIONPROGRESS=3370;S.ACHIEVEMENTRESOLUTIONS=66;S.GENERIC_ALERT=3801;S.MODERATOR_MESSAGE=2030;S.GENERIC_ERROR=1600;S.GIFT_WRAPPER_CONFIG=2234;S.GROUP_BADGES=2402;S.GROUP_CREATE_OPTIONS=2159;S.GROUP_FORUM_DATA=3011;S.GROUP_FORUM_LIST=3001;S.GROUP_FORUM_THREADS=1073;S.GROUP_FORUM_POST=2049;S.GROUP_FORUM_POST_THREAD=1862;S.GROUP_FORUM_THREAD_MESSAGES=509;S.GROUP_FORUM_UNREAD_COUNT=2379;S.GROUP_FORUM_UPDATE_MESSAGE=324;S.GROUP_FORUM_UPDATE_THREAD=2528;S.GROUP_INFO=1702;S.GROUP_LIST=420;S.GROUP_MEMBER=265;S.GROUP_MEMBERS=1200;S.GROUP_MEMBERS_REFRESH=2445;S.GROUP_MEMBER_REMOVE_CONFIRM=1876;S.GROUP_PURCHASED=2808;S.GROUP_SETTINGS=3965;S.GROUP_BADGE_PARTS=2238;S.GROUP_MEMBERSHIP_REQUESTED=1180;S.GROUP_DETAILS_CHANGED=1459;S.GROUP_HABBO_JOIN_FAILED=762;S.GUILD_EDIT_FAILED=3988;S.GUILD_MEMBER_MGMT_FAILED=818;S.ITEM_DIMMER_SETTINGS=2710;S.ITEM_STACK_HELPER=2816;S.ITEM_WALL=1369;S.ITEM_WALL_ADD=2187;S.ITEM_WALL_REMOVE=3208;S.ITEM_WALL_UPDATE=2009;S.MARKETPLACE_CONFIG=1823;S.MESSENGER_ACCEPT_FRIENDS=896;S.MESSENGER_CHAT=1587;S.MESSENGER_FIND_FRIENDS=1210;S.MESSENGER_FOLLOW_FAILED=3048;S.MESSENGER_FRIEND_NOTIFICATION=3082;S.MESSENGER_FRIENDS=3130;S.MESSENGER_INIT=1605;S.MESSENGER_INSTANCE_MESSAGE_ERROR=3359;S.MESSENGER_INVITE=3870;S.MESSENGER_INVITE_ERROR=462;S.MESSENGER_MESSAGE_ERROR=892;S.MESSENGER_MINIMAIL_COUNT=2803;S.MESSENGER_MINIMAIL_NEW=1911;S.MESSENGER_RELATIONSHIPS=2016;S.MESSENGER_REQUEST=2219;S.MESSENGER_REQUEST_ERROR=892;S.MESSENGER_REQUESTS=280;S.MESSENGER_SEARCH=973;S.MESSENGER_UPDATE=2800;S.MODERATION_REPORT_DISABLED=1651;S.MODERATION_TOOL=2696;S.MODERATION_USER_INFO=2866;S.MOTD_MESSAGES=2035;S.NAVIGATOR_CATEGORIES=1562;S.NAVIGATOR_COLLAPSED=1543;S.NAVIGATOR_EVENT_CATEGORIES=3244;S.NAVIGATOR_LIFTED=3104;S.NAVIGATOR_METADATA=3052;S.NAVIGATOR_OPEN_ROOM_CREATOR=2064;S.NAVIGATOR_SEARCH=2690;S.NAVIGATOR_SEARCHES=3984;S.NAVIGATOR_SETTINGS=518;S.THUMBNAIL_UPDATE_RESULT=1927;S.CAN_CREATE_ROOM=378;S.CATEGORIES_WITH_VISITOR_COUNT=1455;S.COMPETITION_ROOMS_DATA=3954;S.CONVERTED_ROOM_ID=1331;S.GUEST_ROOM_SEARCH_RESULT=52;S.NOTIFICATION_LIST=1992;S.NOTIFICATION_OFFER_REWARD_DELIVERED=2125;S.NOTIFICATION_SIMPLE_ALERT=5100;S.NOTIFICATION_ELEMENT_POINTER=1787;S.PET_FIGURE_UPDATE=1924;S.PET_INFO=2901;S.PET_TRAINING_PANEL=1164;S.PET_LEVEL_UPDATE=2824;S.PET_SCRATCH_FAILED=1130;S.PET_OPEN_PACKAGE_REQUESTED=2380;S.PET_OPEN_PACKAGE_RESULT=546;S.PET_BREEDING=1746;S.PET_CONFIRM_BREEDING_RESULT=1625;S.PET_GO_TO_BREEDING_NEST_FAILURE=2621;S.PET_NEST_BREEDING_SUCCESS=2527;S.PET_CONFIRM_BREEDING_REQUEST=634;S.PET_BREEDING_RESULT=1553;S.RECYCLER_PRIZES=3164;S.RECYCLER_STATUS=3433;S.RECYCLER_FINISHED=468;S.ROOM_BAN_LIST=1869;S.ROOM_BAN_REMOVE=3429;S.ROOM_CREATED=1304;S.ROOM_DOORBELL=2309;S.ROOM_DOORBELL_ACCEPTED=3783;S.ROOM_DOORBELL_REJECTED=878;S.ROOM_ENTER=758;S.ROOM_ENTER_ERROR=899;S.ROOM_FORWARD=160;S.ROOM_HEIGHT_MAP=2753;S.ROOM_HEIGHT_MAP_UPDATE=558;S.ROOM_INFO=687;S.ROOM_INFO_OWNER=749;S.ROOM_MODEL=1301;S.ROOM_MODEL_BLOCKED_TILES=3990;S.ROOM_MODEL_DOOR=1664;S.ROOM_MODEL_NAME=2031;S.ROOM_MUTED=2533;S.ROOM_MUTE_USER=826;S.ROOM_PAINT=2454;S.ROOM_PROMOTION=2274;S.ROOM_QUEUE_STATUS=2208;S.ROOM_RIGHTS=780;S.ROOM_RIGHTS_CLEAR=2392;S.ROOM_RIGHTS_LIST=1284;S.ROOM_RIGHTS_LIST_ADD=2088;S.ROOM_RIGHTS_LIST_REMOVE=1327;S.ROOM_RIGHTS_OWNER=339;S.ROOM_ROLLING=3207;S.ROOM_SCORE=482;S.ROOM_SETTINGS=1498;S.ROOM_SETTINGS_CHAT=1191;S.ROOM_SETTINGS_SAVE=948;S.ROOM_SETTINGS_SAVE_ERROR=1555;S.ROOM_INFO_UPDATED=3297;S.ROOM_SPECTATOR=1033;S.ROOM_THICKNESS=3547;S.ROOM_GET_FILTER_WORDS=2937;S.ROOM_MESSAGE_NOTIFICATION=1634;S.ROOM_POPULAR_TAGS_RESULT=2012;S.INFO_FEED_ENABLE=3284;S.SECURITY_MACHINE=1488;S.MYSTERY_BOX_KEYS=2833;S.GOTMYSTERYBOXPRIZEMESSAGE=3712;S.CANCELMYSTERYBOXWAITMESSAGE=596;S.SHOWMYSTERYBOXWAITMESSAGE=3201;S.TRADE_ACCEPTED=2568;S.TRADE_CLOSED=1373;S.TRADE_COMPLETED=1001;S.TRADE_CONFIRMATION=2720;S.TRADE_LIST_ITEM=2024;S.TRADE_NOT_OPEN=3128;S.TRADE_OPEN=2505;S.TRADE_OPEN_FAILED=217;S.TRADE_OTHER_NOT_ALLOWED=1254;S.TRADE_YOU_NOT_ALLOWED=3058;S.TRADE_NO_SUCH_ITEM=2873;S.UNIT=374;S.UNIT_CHANGE_NAME=2182;S.UNIT_CHAT=1446;S.UNIT_CHAT_SHOUT=1036;S.UNIT_CHAT_WHISPER=2704;S.UNIT_DANCE=2233;S.UNIT_EFFECT=1167;S.UNIT_EXPRESSION=1631;S.UNIT_HAND_ITEM=1474;S.UNIT_IDLE=1797;S.UNIT_INFO=3920;S.UNIT_NUMBER=2324;S.UNIT_REMOVE=2661;S.UNIT_STATUS=1640;S.UNIT_TYPING=1717;S.UNSEEN_ITEMS=2103;S.USER_ACHIEVEMENT_SCORE=1968;S.USER_BADGES=717;S.USER_BADGES_ADD=2493;S.USER_BADGES_CURRENT=1087;S.USER_BOT_REMOVE=233;S.USER_BOTS=3086;S.USER_CHANGE_NAME=118;S.USER_CLOTHING=1450;S.USER_CREDITS=3475;S.USER_CURRENCY=2018;S.ACTIVITY_POINT_NOTIFICATION=2275;S.USER_EFFECTS=340;S.USER_FAVORITE_ROOM=2524;S.USER_FAVORITE_ROOM_COUNT=151;S.USER_FIGURE=2429;S.USER_FURNITURE=994;S.USER_FURNITURE_ADD=104;S.USER_FURNITURE_POSTIT_PLACED=1501;S.USER_FURNITURE_REFRESH=3151;S.USER_FURNITURE_REMOVE=159;S.USER_HOME_ROOM=2875;S.ROOM_EVENT_CANCEL=3479;S.ROOM_EVENT=1840;S.USER_IGNORED=126;S.USER_IGNORED_RESULT=207;S.USER_INFO=2725;S.USER_OUTFITS=3315;S.USER_PERKS=2586;S.USER_PERMISSIONS=411;S.USER_PET_ADD=2101;S.USER_PET_REMOVE=3253;S.USER_PETS=3522;S.USER_PROFILE=3898;S.USER_RESPECT=2815;S.USER_SANCTION_STATUS=3679;S.USER_SETTINGS=513;S.USER_SUBSCRIPTION=954;S.USER_WARDROBE_PAGE=3315;S.USER_CLASSIFICATION=966;S.GET_USER_TAGS=1255;S.WIRED_ACTION=1434;S.WIRED_CONDITION=1108;S.WIRED_ERROR=156;S.WIRED_OPEN=1830;S.WIRED_REWARD=178;S.WIRED_SAVE=1155;S.WIRED_TRIGGER=383;S.PLAYING_GAME=448;S.FURNITURE_STATE_2=3431;S.REMOVE_BOT_FROM_INVENTORY=233;S.ADD_BOT_TO_INVENTORY=1352;S.ACHIEVEMENT_PROGRESSED=2107;S.MODTOOL_ROOM_INFO=1333;S.MODTOOL_USER_CHATLOG=3377;S.MODTOOL_ROOM_CHATLOG=3434;S.MODTOOL_VISITED_ROOMS_USER=1752;S.MODERATOR_ACTION_RESULT=2335;S.ISSUE_DELETED=3192;S.ISSUE_INFO=3609;S.ISSUE_PICK_FAILED=3150;S.CFH_CHATLOG=607;S.MODERATOR_TOOL_PREFERENCES=1576;S.LOVELOCK_FURNI_START=3753;S.LOVELOCK_FURNI_FRIEND_COMFIRMED=382;S.LOVELOCK_FURNI_FINISHED=770;S.GIFT_RECEIVER_NOT_FOUND=1517;S.GIFT_OPENED=56;S.FLOOD_CONTROL=566;S.REMAINING_MUTE=826;S.USER_EFFECT_LIST=340;S.USER_EFFECT_LIST_ADD=2867;S.USER_EFFECT_LIST_REMOVE=2228;S.USER_EFFECT_ACTIVATE=1959;S.AVATAR_EFFECT_SELECTED=3473;S.CLUB_GIFT_INFO=619;S.REDEEM_VOUCHER_ERROR=714;S.REDEEM_VOUCHER_OK=3336;S.IN_CLIENT_LINK=2023;S.BOT_COMMAND_CONFIGURATION=1618;S.BOT_SKILL_LIST_UPDATE=69;S.BOT_FORCE_OPEN_CONTEXT_MENU=296;S.HAND_ITEM_RECEIVED=354;S.PET_PLACING_ERROR=2913;S.BOT_ERROR=639;S.MARKETPLACE_SELL_ITEM=54;S.MARKETPLACE_ITEM_STATS=725;S.MARKETPLACE_OWN_ITEMS=3884;S.MARKETPLACE_CANCEL_SALE=3264;S.MARKETPLACE_ITEM_POSTED=1359;S.MARKETPLACE_ITEMS_SEARCHED=680;S.MARKETPLACE_AFTER_ORDER_STATUS=2032;S.CATALOG_RECEIVE_PET_BREEDS=3331;S.CATALOG_APPROVE_NAME_RESULT=1503;S.OBJECTS_DATA_UPDATE=1453;S.PET_EXPERIENCE=2156;S.COMMUNITY_GOAL_VOTE_EVENT=1435;S.PROMO_ARTICLES=286;S.COMMUNITY_GOAL_EARNED_PRIZES=3319;S.COMMUNITY_GOAL_PROGRESS=2525;S.CONCURRENT_USERS_GOAL_PROGRESS=2737;S.QUEST_DAILY=1878;S.QUEST_CANCELLED=3027;S.QUEST_COMPLETED=949;S.COMMUNITY_GOAL_HALL_OF_FAME=3005;S.EPIC_POPUP=3945;S.SEASONAL_QUESTS=1122;S.QUESTS=3625;S.QUEST=230;S.BONUS_RARE_INFO=1533;S.CRAFTABLE_PRODUCTS=1e3;S.CRAFTING_RECIPE=2774;S.CRAFTING_RECIPES_AVAILABLE=2124;S.CRAFTING_RESULT=618;S.CAMERA_PUBLISH_STATUS=2057;S.CAMERA_PURCHASE_OK=2783;S.CAMERA_STORAGE_URL=3696;S.CAMERA_SNAPSHOT=463;S.COMPETITION_STATUS=133;S.INIT_CAMERA=3878;S.THUMBNAIL_STATUS=3595;S.ACHIEVEMENT_NOTIFICATION=806;S.CLUB_GIFT_NOTIFICATION=2188;S.INTERSTITIAL_MESSAGE=1808;S.ROOM_AD_ERROR=1759;S.AVAILABILITY_TIME=600;S.HOTEL_CLOSED_AND_OPENS=3728;S.HOTEL_CLOSES_AND_OPENS_AT=2771;S.HOTEL_WILL_CLOSE_MINUTES=1050;S.HOTEL_MAINTENANCE=1350;S.JUKEBOX_PLAYLIST_FULL=105;S.JUKEBOX_SONG_DISKS=34;S.NOW_PLAYING=469;S.OFFICIAL_SONG_ID=1381;S.PLAYLIST=1748;S.PLAYLIST_SONG_ADDED=1140;S.TRAX_SONG_INFO=3365;S.USER_SONG_DISKS_INVENTORY=2602;S.CHECK_USER_NAME=563;S.CFH_SANCTION=2782;S.CFH_TOPICS=325;S.CFH_SANCTION_STATUS=2221;S.CAMPAIGN_CALENDAR_DATA=2531;S.CAMPAIGN_CALENDAR_DOOR_OPENED=2551;S.BUILDERS_CLUB_FURNI_COUNT=3828;S.BUILDERS_CLUB_SUBSCRIPTION=1452;S.CATALOG_PAGE_EXPIRATION=2668;S.CATALOG_EARLIEST_EXPIRY=2515;S.CLUB_GIFT_SELECTED=659;S.TARGET_OFFER_NOT_FOUND=1237;S.TARGET_OFFER=119;S.DIRECT_SMS_CLUB_BUY=195;S.ROOM_AD_PURCHASE=2468;S.NOT_ENOUGH_BALANCE=3914;S.LIMITED_OFFER_APPEARING_NEXT=44;S.IS_OFFER_GIFTABLE=761;S.CLUB_EXTENDED_OFFER=3964;S.SEASONAL_CALENDAR_OFFER=1889;S.COMPETITION_ENTRY_SUBMIT=1177;S.COMPETITION_VOTING_INFO=3506;S.COMPETITION_TIMING_CODE=1745;S.COMPETITION_USER_PART_OF=3841;S.COMPETITION_NO_OWNED_ROOMS=2064;S.COMPETITION_SECONDS_UNTIL=3926;S.BADGE_POINT_LIMITS=2501;S.BADGE_REQUEST_FULFILLED=2998;S.HELPER_TALENT_TRACK=3406;S.TALENT_TRACK_LEVEL=1203;S.TALENT_TRACK_LEVEL_UP=638;S.USER_BANNED=1683;S.BOT_RECEIVED=3684;S.PET_LEVEL_NOTIFICATION=859;S.PET_RECEIVED=1111;S.MODERATION_CAUTION=1890;S.YOUTUBE_CONTROL_VIDEO=1554;S.YOUTUBE_DISPLAY_PLAYLISTS=1112;S.YOUTUBE_DISPLAY_VIDEO=1411;S.CFH_DISABLED_NOTIFY=1651;S.QUESTION=2665;S.POLL_CONTENTS=2997;S.POLL_ERROR=662;S.POLL_OFFER=3785;S.POLL_ROOM_RESULT=5201;S.POLL_START_ROOM=5200;S.QUESTION_ANSWERED=2589;S.QUESTION_FINISHED=1066;S.CFH_PENDING_CALLS=1121;S.GUIDE_ON_DUTY_STATUS=1548;S.GUIDE_SESSION_ATTACHED=1591;S.GUIDE_SESSION_DETACHED=138;S.GUIDE_SESSION_ENDED=1456;S.GUIDE_SESSION_ERROR=673;S.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219;S.GUIDE_SESSION_MESSAGE=841;S.GUIDE_SESSION_PARTNER_IS_TYPING=1016;S.GUIDE_SESSION_REQUESTER_ROOM=1847;S.GUIDE_SESSION_STARTED=3209;S.GUIDE_TICKET_CREATION_RESULT=3285;S.GUIDE_TICKET_RESOLUTION=2674;S.GUIDE_REPORTING_STATUS=3463;S.HOTEL_MERGE_NAME_CHANGE=1663;S.ISSUE_CLOSE_NOTIFICATION=934;S.QUIZ_DATA=2927;S.QUIZ_RESULTS=2772;S.CFH_PENDING_CALLS_DELETED=77;S.CFH_REPLY=3796;S.CHAT_REVIEW_SESSION_DETACHED=30;S.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735;S.CHAT_REVIEW_SESSION_RESULTS=3276;S.CHAT_REVIEW_SESSION_STARTED=143;S.CHAT_REVIEW_SESSION_VOTING_STATUS=1829;S.SCR_SEND_KICKBACK_INFO=3277;S.PET_STATUS=1907;S.GROUP_DEACTIVATE=3129;S.PET_RESPECTED=2788;S.PET_SUPPLEMENT=3441;S.NOOBNESS_LEVEL=3738;S.DISCONNECT_REASON=4e3;S.CAN_CREATE_ROOM_EVENT=2599;S.FAVORITE_GROUP_UDPATE=3403;S.NO_SUCH_FLAT=84;S.ROOM_SETTINGS_ERROR=2897;S.SHOW_ENFORCE_ROOM_CATEGORY=3896;S.CUSTOM_USER_NOTIFICATION=909;S.NEW_USER_EXPERIENCE_GIFT_OFFER=3575;S.RESTORE_CLIENT=426;S.FIREWORK_CHARGE_DATA=5210;S.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639;S.CONNECTION_ERROR=1004;S.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243;S.PHONE_COLLECTION_STATE=2890;S.PHONE_TRY_NUMBER_RESULT=800;S.PHONE_TRY_VERIFICATION_CODE_RESULT=91;S.EXTENDED_PROFILE_CHANGED=876;S.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293;S.WELCOME_GIFT_STATUS=2707;S.HANDSHAKE_INIT_DIFFIE=1347;S.HANDSHAKE_COMPLETE_DIFFIE=3885;S.RENTABLE_SPACE_RENT_OK=2046;S.RENTABLE_SPACE_STATUS=3559;S.RENTABLE_SPACE_RENT_FAILED=1868;S.EMAIL_STATUS=612;S.CHANGE_EMAIL_RESULT=1815;S.WEEKLY_GAME_REWARD=2641;S.WEEKLY_GAME_REWARD_WINNERS=3097;S.WEEKLY_COMPETITIVE_LEADERBOARD=3512;S.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560;S.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270;S.WEEKLY_GAME2_LEADERBOARD=2196;S.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35;S.HANDSHAKE_IDENTITY_ACCOUNT=3523;S.BULK_UPDATE_FLOOR_ITEMS=5300;S.BULK_SLIDE_ITEMS=5301;S.BULK_HEIGHT_MAP_UPDATE=5302;S.BULK_SLIDE_USERS_AND_ITEMS=5303;class tA extends U{constructor(e){super(e,vw)}getParser(){return this.parser}}class sA extends U{constructor(e){super(e,Mw)}getParser(){return this.parser}}class rA extends U{constructor(e){super(e,Dw)}getParser(){return this.parser}}class Lj extends U{constructor(e){super(e,Lw)}getParser(){return this.parser}}class Uj extends U{constructor(e){super(e,Uw)}getParser(){return this.parser}}class xj extends U{constructor(e){super(e,xw)}getParser(){return this.parser}}class wj extends U{constructor(e){super(e,ww)}getParser(){return this.parser}}class Fj extends U{constructor(e){super(e,Fw)}getParser(){return this.parser}}class Y_ extends U{constructor(e){super(e,Gw)}getParser(){return this.parser}}class iA extends U{constructor(e){super(e,Bw)}getParser(){return this.parser}}class nA extends U{constructor(e){super(e,Vw)}getParser(){return this.parser}}class kj extends U{constructor(e){super(e,Hw)}getParser(){return this.parser}}class aA extends U{constructor(e){super(e,Ww)}getParser(){return this.parser}}class sE extends U{constructor(e){super(e,Uk)}getParser(){return this.parser}}class Gd extends U{constructor(e){super(e,wk)}getParser(){return this.parser}}class oA extends U{constructor(e){super(e,xk)}getParser(){return this.parser}}class rE extends U{constructor(e){super(e,Fk)}getParser(){return this.parser}}class lA extends U{constructor(e){super(e,kk)}getParser(){return this.parser}}class cA extends U{constructor(e){super(e,Gk)}getParser(){return this.parser}}class Gj extends U{constructor(e){super(e,Bk)}getParser(){return this.parser}}class Bj extends U{constructor(e){super(e,Vk)}getParser(){return this.parser}}class Vj extends U{constructor(e){super(e,Hk)}getParser(){return this.parser}}class uA extends U{constructor(e){super(e,Wk)}getParser(){return this.parser}}class hA extends U{constructor(e){super(e,jk)}getParser(){return this.parser}}class dA extends U{constructor(e){super(e,Yk)}getParser(){return this.parser}}class _A extends U{constructor(e){super(e,zk)}getParser(){return this.parser}}class gA extends U{constructor(e){super(e,qk)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class mA extends U{constructor(e){super(e,xp)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class fA extends U{constructor(e){super(e,Xk)}getParser(){return this.parser}}class pA extends U{constructor(e){super(e,Qk)}getParser(){return this.parser}}class EA extends U{constructor(e){super(e,$k)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class Hj extends U{constructor(e){super(e,Jk)}getParser(){return this.parser}}class IA extends U{constructor(e){super(e,Zk)}getParser(){return this.parser}}class TA extends U{constructor(e){super(e,eG)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class RA extends U{constructor(e){super(e,wp)}getParser(){return this.parser}}class SA extends U{constructor(e){super(e,tG)}getParser(){return this.parser}}class OA extends U{constructor(e){super(e,sG)}getParser(){return this.parser}}class CA extends U{constructor(e){super(e,gV)}getParser(){return this.parser}}class Wj extends U{constructor(e){super(e,mV)}getParser(){return this.parser}}class AA extends U{constructor(e){super(e,fV)}getParser(){return this.parser}}class NA extends U{constructor(e){super(e,pV)}getParser(){return this.parser}}class jj extends U{constructor(e){super(e,EV)}getParser(){return this.parser}}class bA extends U{constructor(e){super(e,IV)}getParser(){return this.parser}}class Yj extends U{constructor(e){super(e,RV)}getParser(){return this.parser}}class yA extends U{constructor(e){super(e,TV)}getParser(){return this.parser}}class vA extends U{constructor(e){super(e,H_)}getParser(){return this.parser}}class MA extends U{constructor(e){super(e,LO)}getParser(){return this.parser}}class DA extends U{constructor(e){super(e,CV)}getParser(){return this.parser}}class PA extends U{constructor(e){super(e,AV)}getParser(){return this.parser}}class LA extends U{constructor(e){super(e,UO)}getParser(){return this.parser}}class UA extends U{constructor(e){super(e,bV)}getParser(){return this.parser}}class xA extends U{constructor(e){super(e,vV)}getParser(){return this.parser}}class wA extends U{constructor(e){super(e,yV)}getParser(){return this.parser}}class FA extends U{constructor(e){super(e,DV)}getParser(){return this.parser}}class kA extends U{constructor(e){super(e,PV)}getParser(){return this.parser}}class GA extends U{constructor(e){super(e,xV)}getParser(){return this.parser}}class BA extends U{constructor(e){super(e,wV)}getParser(){return this.parser}}class VA extends U{constructor(e){super(e,kV)}getParser(){return this.parser}}class HA extends U{constructor(e){super(e,GV)}getParser(){return this.parser}}class WA extends U{constructor(e){super(e,HV)}getParser(){return this.parser}}class jA extends U{constructor(e){super(e,WV)}getParser(){return this.parser}}class YA extends U{constructor(e){super(e,YV)}getParser(){return this.parser}}class zA extends U{constructor(e){super(e,zV)}getParser(){return this.parser}}class KA extends U{constructor(e){super(e,KV)}getParser(){return this.parser}}class qA extends U{constructor(e){super(e,qV)}getParser(){return this.parser}}class XA extends U{constructor(e){super(e,XV)}getParser(){return this.parser}}class zj extends U{constructor(e){super(e,Bp)}getParser(){return this.parser}}class QA extends U{constructor(e){super(e,QV)}getParser(){return this.parser}}class Kj extends U{constructor(e){super(e,iH)}getParser(){return this.parser}}class qj extends U{constructor(e){super(e,nH)}getParser(){return this.parser}}class Xj extends U{constructor(e){super(e,aH)}getParser(){return this.parser}}class iE extends U{constructor(e){super(e,oH)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class Qj extends U{constructor(e){super(e,lH)}getParser(){return this.parser}}class $j extends U{constructor(e){super(e,cH)}getParser(){return this.parser}}class Bd extends U{constructor(e){super(e,uH)}getParser(){return this.parser}}class $A extends U{constructor(e){super(e,hH)}getParser(){return this.parser}}class wa extends U{constructor(e){super(e,dH)}getParser(){return this.parser}}class Jj extends U{constructor(e){super(e,_H)}getParser(){return this.parser}}class Zj extends U{constructor(e){super(e,mH)}getParser(){return this.parser}}class JA extends U{constructor(e){super(e,pH)}getParser(){return this.parser}}class eY extends U{constructor(e){super(e,IH)}getParser(){return this.parser}}class ZA extends U{constructor(e){super(e,TH)}getParser(){return this.parser}}class eN extends U{constructor(e){super(e,RH)}getParser(){return this.parser}}class tY extends U{constructor(e){super(e,SH)}getParser(){return this.parser}}class tN extends U{constructor(e){super(e,OH)}getParser(){return this.parser}}class sY extends U{constructor(e){super(e,CH)}getParser(){return this.parser}}class rY extends U{constructor(e){super(e,bH)}getParser(){return this.parser}}class iY extends U{constructor(e){super(e,yH)}getParser(){return this.parser}}class sN extends U{constructor(e){super(e,vH)}getParser(){return this.parser}}class rN extends U{constructor(e){super(e,MH)}getParser(){return this.parser}}class iN extends U{constructor(e){super(e,DH)}getParser(){return this.parser}}class nY extends U{constructor(e){super(e,PH)}getParser(){return this.parser}}class nN extends U{constructor(e){super(e,LH)}getParser(){return this.parser}}class aN extends U{constructor(e){super(e,UH)}getParser(){return this.parser}}class oN extends U{constructor(e){super(e,wH)}getParser(){return this.parser}}class nE extends U{constructor(e){super(e,FH)}getParser(){return this.parser}}class lN extends U{constructor(e){super(e,kH)}getParser(){return this.parser}}class cN extends U{constructor(e){super(e,GH)}getParser(){return this.parser}}class uN extends U{constructor(e){super(e,BH)}getParser(){return this.parser}}class aY extends U{constructor(e){super(e,VH)}getParser(){return this.parser}}class hN extends U{constructor(e){super(e,HH)}getParser(){return this.parser}}class dN extends U{constructor(e){super(e,WH)}getParser(){return this.parser}}class _N extends U{constructor(e){super(e,jH)}getParser(){return this.parser}}class gN extends U{constructor(e){super(e,YH)}getParser(){return this.parser}}class oY extends U{constructor(e){super(e,zH)}getParser(){return this.parser}}class mN extends U{constructor(e){super(e,KH)}getParser(){return this.parser}}class fN extends U{constructor(e){super(e,qH)}getParser(){return this.parser}}class lY extends U{constructor(e){super(e,XH)}getParser(){return this.parser}}class pN extends U{constructor(e){super(e,QH)}getParser(){return this.parser}}class EN extends U{constructor(e){super(e,$H)}getParser(){return this.parser}}class cY{constructor(e){this._itemName=e.readString(),this._extraInfo=e.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class uY{constructor(e){this._thumbnailUrl=e.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const t=e.readInt();let r=0;for(;r<t;)this._productOfferList.push(new cY(e)),r++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class hY{flush(){return!0}parse(e){if(!e)return!1;const t=e.readInt();this._giftOptions=[];let r=0;for(;r<t;)this._giftOptions.push(new gY(e)),r++;return!0}get giftOptions(){return this._giftOptions}}class dY{flush(){return!0}parse(e){return!!e}}class _Y extends U{constructor(e){super(e,hY)}getParser(){return this.parser}}class gY{constructor(e){this._dayIndex=e.readInt(),this._stepIndex=e.readInt(),this._options=[];const t=e.readInt();let r=0;for(;r<t;)this._options.push(new uY(e)),r++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class mY extends U{constructor(e){super(e,dY)}getParser(){return this.parser}}class aE extends U{constructor(e){super(e,ZH)}getParser(){return this.parser}}class fY extends U{constructor(e){super(e,F_)}getParser(){return this.parser}}class IN extends U{constructor(e){super(e,e2)}getParser(){return this.parser}}class TN extends U{constructor(e){super(e,t2)}getParser(){return this.parser}}class RN extends U{constructor(e){super(e,s2)}getParser(){return this.parser}}class SN extends U{constructor(e){super(e,r2)}getParser(){return this.parser}}class ON extends U{constructor(e){super(e,i2)}getParser(){return this.parser}}class CN extends U{constructor(e){super(e,o2)}getParser(){return this.parser}}class AN extends U{constructor(e){super(e,l2)}getParser(){return this.parser}}class NN extends U{constructor(e){super(e,c2)}getParser(){return this.parser}}class bN extends U{constructor(e){super(e,u2)}getParser(){return this.parser}}class yN extends U{constructor(e){super(e,d2)}getParser(){return this.parser}}class vN extends U{constructor(e){super(e,h2)}getParser(){return this.parser}}class MN extends U{constructor(e){super(e,_2)}getParser(){return this.parser}}class DN extends U{constructor(e){super(e,g2)}getParser(){return this.parser}}class pY extends U{constructor(e){super(e,p2)}getParser(){return this.parser}}class PN extends U{constructor(e){super(e,T2)}getParser(){return this.parser}}class EY extends U{constructor(e){super(e,R2)}getParser(){return this.parser}}class IY extends U{constructor(e){super(e,S2)}getParser(){return this.parser}}class TY extends U{constructor(e){super(e,O2)}getParser(){return this.parser}}class RY extends U{constructor(e){super(e,C2)}getParser(){return this.parser}}class SY extends U{constructor(e){super(e,A2)}getParser(){return this.parser}}class OY extends U{constructor(e){super(e,N2)}getParser(){return this.parser}}class CY extends U{constructor(e){super(e,b2)}getParser(){return this.parser}}class AY extends U{constructor(e){super(e,y2)}getParser(){return this.parser}}class NY extends U{constructor(e){super(e,v2)}getParser(){return this.parser}}class oE extends U{constructor(e){super(e,M2)}getParser(){return this.parser}}oE.FINISHED_OK=1;oE.FINISHED_FAIL=2;class z_ extends U{constructor(e){super(e,D2)}getParser(){return this.parser}}z_.SYSTEM_STATUS_ENABLED=1;z_.SYSTEM_STATUS_DISABLED=2;z_.SYSTEM_STATUS_TIMEOUT=3;class Vd extends U{constructor(e){super(e,jw)}getParser(){return this.parser}}class ku extends U{constructor(e){super(e,Yw)}getParser(){return this.parser}}class Gu extends U{constructor(e){super(e,Kw)}getParser(){return this.parser}}class Hd extends U{constructor(e){super(e,zw)}getParser(){return this.parser}}class LN extends U{constructor(e){super(e,fo)}getParser(){return this.parser}}class Wd extends U{constructor(e){super(e,qw)}getParser(){return this.parser}}class UN extends U{constructor(e){super(e,Xw)}getParser(){return this.parser}}class xN extends U{constructor(e){super(e,Qw)}getParser(){return this.parser}}class bY extends U{constructor(e){super(e,$w)}getParser(){return this.parser}}class yY extends U{constructor(e){super(e,Zw)}getParser(){return this.parser}}class wN extends U{constructor(e){super(e,_F)}getParser(){return this.parser}}class lE extends U{constructor(e){super(e,gF)}getParser(){return this.parser}}class FN extends U{constructor(e){super(e,mF)}getParser(){return this.parser}}class Um extends U{constructor(e){super(e,fF)}getParser(){return this.parser}}class xm extends U{constructor(e){super(e,pF)}getParser(){return this.parser}}class kN extends U{constructor(e){super(e,EF)}getParser(){return this.parser}}class wm extends U{constructor(e){super(e,$F)}getParser(){return this.parser}}class Fm extends U{constructor(e){super(e,JF)}getParser(){return this.parser}}class GN extends U{constructor(e){super(e,TF)}getParser(){return this.parser}}class km extends U{constructor(e){super(e,RF)}getParser(){return this.parser}}class Gm extends U{constructor(e){super(e,SF)}getParser(){return this.parser}}class Bm extends U{constructor(e){super(e,OF)}getParser(){return this.parser}}class Vm extends U{constructor(e){super(e,CF)}getParser(){return this.parser}}class Hm extends U{constructor(e){super(e,AF)}getParser(){return this.parser}}class Wm extends U{constructor(e){super(e,NF)}getParser(){return this.parser}}class vY extends U{constructor(e){super(e,bF)}getParser(){return this.parser}}class jm extends U{constructor(e){super(e,yF)}getParser(){return this.parser}}class Ym extends U{constructor(e){super(e,Do)}getParser(){return this.parser}}class BN extends U{constructor(e){super(e,vF)}getParser(){return this.parser}}class MY{flush(){return this._id=0,this._spriteId=0,this._publicName="",this._itemName="",this._width=0,this._length=0,this._stackHeight=0,this._canStack=0,this._canSit=0,this._isWalkable=0,this._allowGift=0,this._allowTrade=0,this._allowRecycle=0,this._allowMarketplaceSell=0,this._interactionType="",this._interactionModesCount=0,this._vendingIds="",this._variableHeights="",this._pageId=0,this._catalogName="",this._costCredits=0,this._costPixels=0,this._costDiamonds=0,this._amount=0,this._orderNum=0,this._flatId=0,!0}parse(e){if(!e)return!1;try{return this._id=parseInt(e.readString()),this._spriteId=parseInt(e.readString()),this._publicName=e.readString(),this._itemName=e.readString(),this._width=parseInt(e.readString()),this._length=parseInt(e.readString()),this._stackHeight=parseFloat(e.readString()),this._canStack=parseInt(e.readString()),this._canSit=parseInt(e.readString()),this._isWalkable=parseInt(e.readString()),this._allowGift=parseInt(e.readString()),this._allowTrade=parseInt(e.readString()),this._allowRecycle=parseInt(e.readString()),this._allowMarketplaceSell=parseInt(e.readString()),this._interactionType=e.readString(),this._interactionModesCount=parseInt(e.readString()),this._vendingIds=e.readString(),this._variableHeights=e.readString(),this._pageId=parseInt(e.readString()),this._catalogName=e.readString(),this._costCredits=parseInt(e.readString()),this._costPixels=parseInt(e.readString()),this._costDiamonds=parseInt(e.readString()),this._amount=parseInt(e.readString()),this._orderNum=parseInt(e.readString()),this._flatId=parseInt(e.readString()),!0}catch(t){return console.error("ERROR in GetFurniFixToolFurniDataParser.parse():",t),!1}}get id(){return this._id}get spriteId(){return this._spriteId}get publicName(){return this._publicName}get itemName(){return this._itemName}get width(){return this._width}get length(){return this._length}get stackHeight(){return this._stackHeight}get canStack(){return this._canStack}get canSit(){return this._canSit}get isWalkable(){return this._isWalkable}get allowGift(){return this._allowGift}get allowTrade(){return this._allowTrade}get allowRecycle(){return this._allowRecycle}get allowMarketplaceSell(){return this._allowMarketplaceSell}get interactionType(){return this._interactionType}get interactionModesCount(){return this._interactionModesCount}get vendingIds(){return this._vendingIds}get variableHeights(){return this._variableHeights}get pageId(){return this._pageId}get catalogName(){return this._catalogName}get costCredits(){return this._costCredits}get costPixels(){return this._costPixels}get costDiamonds(){return this._costDiamonds}get amount(){return this._amount}get orderNum(){return this._orderNum}get flatId(){return this._flatId}}class VN extends U{constructor(e){super(e,MY)}getParser(){return this.parser}}class HN extends U{constructor(e){super(e,MF)}getParser(){return this.parser}}class zm extends U{constructor(e){super(e,DF)}getParser(){return this.parser}}class WN extends U{constructor(e){super(e,PF)}getParser(){return this.parser}}class jN extends U{constructor(e){super(e,LF)}getParser(){return this.parser}}class YN extends U{constructor(e){super(e,UF)}getParser(){return this.parser}}class Km extends U{constructor(e){super(e,xF)}getParser(){return this.parser}}class DY extends U{constructor(e){super(e,wF)}getParser(){return this.parser}}class PY extends U{constructor(e){super(e,FF)}getParser(){return this.parser}}class LY extends U{constructor(e){super(e,Ln)}getParser(){return this.parser}}class zN extends U{constructor(e){super(e,kF)}getParser(){return this.parser}}class KN extends U{constructor(e){super(e,BF)}getParser(){return this.parser}}class UY extends U{constructor(e){super(e,VF)}getParser(){return this.parser}}class qm extends U{constructor(e){super(e,HF)}getParser(){return this.parser}}class Xm extends U{constructor(e){super(e,WF)}getParser(){return this.parser}}class Qm extends U{constructor(e){super(e,jF)}getParser(){return this.parser}}class $m extends U{constructor(e){super(e,YF)}getParser(){return this.parser}}class xY extends U{constructor(e){super(e,zF)}getParser(){return this.parser}}class qN extends U{constructor(e){super(e,KF)}getParser(){return this.parser}}class XN extends U{constructor(e){super(e,XF)}getParser(){return this.parser}}class QN extends U{constructor(e){super(e,QF)}getParser(){return this.parser}}class jd extends U{constructor(e){super(e,Pp)}getParser(){return this.parser}}class Yd extends U{constructor(e){super(e,ZF)}getParser(){return this.parser}}class Jm extends U{constructor(e){super(e,po)}getParser(){return this.parser}}class Zm extends U{constructor(e){super(e,ek)}getParser(){return this.parser}}class $N extends U{constructor(e){super(e,tk)}getParser(){return this.parser}}class ef extends U{constructor(e){super(e,sk)}getParser(){return this.parser}}class Ic extends U{constructor(e){super(e,rk)}getParser(){return this.parser}}class zd extends U{constructor(e){super(e,ik)}getParser(){return this.parser}}class tf extends U{constructor(e){super(e,nk)}getParser(){return this.parser}}class JN extends U{constructor(e){super(e,ak)}getParser(){return this.parser}}class ZN extends U{constructor(e){super(e,ok)}getParser(){return this.parser}}class Kd extends U{constructor(e){super(e,lk)}getParser(){return this.parser}}class eb extends U{constructor(e){super(e,ck)}getParser(){return this.parser}}class tb extends U{constructor(e){super(e,uk)}getParser(){return this.parser}}class sb extends U{constructor(e){super(e,dk)}getParser(){return this.parser}}class rb extends U{constructor(e){super(e,_k)}getParser(){return this.parser}}class ib extends U{constructor(e){super(e,gk)}getParser(){return this.parser}}class nb extends U{constructor(e){super(e,mk)}getParser(){return this.parser}}class ab extends U{constructor(e){super(e,fk)}getParser(){return this.parser}}class ob extends U{constructor(e){super(e,pk)}getParser(){return this.parser}}class lb extends U{constructor(e){super(e,Ek)}getParser(){return this.parser}}class cE extends U{constructor(e){super(e,Lp)}getParser(){return this.parser}}class qd extends U{constructor(e){super(e,Lp)}getParser(){return this.parser}}class Xd extends U{constructor(e){super(e,Lp)}getParser(){return this.parser}}class sf extends U{constructor(e){super(e,Ik)}getParser(){return this.parser}}class Qd extends U{constructor(e){super(e,Tk)}getParser(){return this.parser}}class rf extends U{constructor(e){super(e,Rk)}getParser(){return this.parser}}class $d extends U{constructor(e){super(e,vk)}getParser(){return this.parser}}class nf extends U{constructor(e){super(e,Sk)}getParser(){return this.parser}}class af extends U{constructor(e){super(e,Ok)}getParser(){return this.parser}}class cb extends U{constructor(e){super(e,Ck)}getParser(){return this.parser}}class of extends U{constructor(e){super(e,Ak)}getParser(){return this.parser}}class Jd extends U{constructor(e){super(e,Nk)}getParser(){return this.parser}}class lf extends U{constructor(e){super(e,bk)}getParser(){return this.parser}}class cf extends U{constructor(e){super(e,yk)}getParser(){return this.parser}}class Zd extends U{constructor(e){super(e,Mk)}getParser(){return this.parser}}class uf extends U{constructor(e){super(e,Lk)}getParser(){return this.parser}}class ub extends U{constructor(e){super(e,P2)}getParser(){return this.parser}}class hb extends U{constructor(e){super(e,L2)}getParser(){return this.parser}}class db extends U{constructor(e){super(e,U2)}getParser(){return this.parser}}class _b extends U{constructor(e){super(e,x2)}getParser(){return this.parser}}class gb extends U{constructor(e){super(e,w2)}getParser(){return this.parser}}class mb extends U{constructor(e){super(e,F2)}getParser(){return this.parser}}class uE extends U{constructor(e){super(e,k2)}getParser(){return this.parser}}uE.PRODUCT_DONATED_CODE=6;uE.BADGE_DONATED_CODE=7;class fb extends U{constructor(e){super(e,G2)}getParser(){return this.parser}}class wY extends U{constructor(e){super(e,B2)}getParser(){return this.parser}}class pb extends U{constructor(e){super(e,tF)}getParser(){return this.parser}}class Eb extends U{constructor(e){super(e,rF)}getParser(){return this.parser}}class Ib extends U{constructor(e){super(e,iF)}getParser(){return this.parser}}class Tb extends U{constructor(e){super(e,nF)}getParser(){return this.parser}}class FY extends U{constructor(e){super(e,aF)}getParser(){return this.parser}}class kY extends U{constructor(e){super(e,oF)}getParser(){return this.parser}}class Rb extends U{constructor(e){super(e,lF)}getParser(){return this.parser}}class GY extends U{constructor(e){super(e,cF)}getParser(){return this.parser}}class BY extends U{constructor(e){super(e,uF)}getParser(){return this.parser}}class Sb extends U{constructor(e){super(e,jr)}getParser(){return this.parser}}class VY extends U{constructor(e){super(e,hF)}getParser(){return this.parser}}class HY extends U{constructor(e){super(e,dF)}getParser(){return this.parser}}class Ob extends U{constructor(e){super(e,V2)}getParser(){return this.parser}}class Cb extends U{constructor(e){super(e,H2)}getParser(){return this.parser}}class Ab extends U{constructor(e){super(e,W2)}getParser(){return this.parser}}class Nb extends U{constructor(e){super(e,j2)}getParser(){return this.parser}}class bb extends U{constructor(e){super(e,Y2)}getParser(){return this.parser}}class WY extends U{constructor(e){super(e,z2)}getParser(){return this.parser}}class jY extends U{constructor(e){super(e,K2)}getParser(){return this.parser}}class yb extends U{constructor(e){super(e,X2)}getParser(){return this.parser}}class vb extends U{constructor(e){super(e,Q2)}getParser(){return this.parser}}class YY extends U{constructor(e){super(e,$2)}getParser(){return this.parser}}class zY extends U{constructor(e){super(e,Z2)}getParser(){return this.parser}}class KY extends U{constructor(e){super(e,tW)}getParser(){return this.parser}}class hE extends U{constructor(e){super(e,aw)}getParser(){return this.parser}}class Mb extends U{constructor(e){super(e,L_)}getParser(){return this.parser}}class Db extends U{constructor(e){super(e,ow)}getParser(){return this.parser}}class qY extends U{constructor(e){super(e,RO)}getParser(){return this.parser}}class dE extends U{constructor(e){super(e,cw)}getParser(){return this.parser}}class _E extends U{constructor(e){super(e,uw)}getParser(){return this.parser}}class Tc extends U{constructor(e){super(e,dw)}getParser(){return this.parser}}class K_ extends U{constructor(e){super(e,_w)}getParser(){return this.parser}}class Pb extends U{constructor(e){super(e,gw)}getParser(){return this.parser}}class gE extends U{constructor(e){super(e,mw)}getParser(){return this.parser}}class Lb extends U{constructor(e){super(e,fw)}getParser(){return this.parser}}class Ub extends U{constructor(e){super(e,pw)}getParser(){return this.parser}}class xb extends U{constructor(e){super(e,Ew)}getParser(){return this.parser}}class XY extends U{constructor(e){super(e,Iw)}getParser(){return this.parser}}class QY extends U{constructor(e){super(e,Tw)}getParser(){return this.parser}}class $Y extends U{constructor(e){super(e,OO)}getParser(){return this.parser}}class JY extends U{constructor(e){super(e,Rw)}getParser(){return this.parser}}class wb extends U{constructor(e){super(e,Sw)}getParser(){return this.parser}}class Fb extends U{constructor(e){super(e,Ow)}getParser(){return this.parser}}class ZY extends U{constructor(e){super(e,CO)}getParser(){return this.parser}}class kb extends U{constructor(e){super(e,Cw)}getParser(){return this.parser}}class mE extends U{constructor(e){super(e,Aw)}getParser(){return this.parser}}class Gb extends U{constructor(e){super(e,Nw)}getParser(){return this.parser}}class Bb extends U{constructor(e){super(e,bw)}getParser(){return this.parser}}class Vb extends U{constructor(e){super(e,yw)}getParser(){return this.parser}}class Hb extends U{constructor(e){super(e,xc)}getParser(){return this.parser}}const Bl=class{constructor(s){this._type=s.readInt(),this._userId=s.readInt(),this._userName=s.readString(),this._figure=s.readString(),this._memberSince=s.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==Bl.TYPE_ADMIN}get owner(){return this._type==Bl.TYPE_OWNER}get pending(){return this._type==Bl.TYPE_PENDING}get member(){return this._type!=Bl.TYPE_MEMBER}get blocked(){return this._type==Bl.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};let Gc=Bl;Gc.TYPE_OWNER=0;Gc.TYPE_ADMIN=1;Gc.TYPE_PENDING=2;Gc.TYPE_MEMBER=3;Gc.TYPE_BLOCKED=4;class Wb extends U{constructor(e){super(e,rG)}getParser(){return this.parser}}class jb extends U{constructor(e){super(e,iG)}getParser(){return this.parser}}class fE extends U{constructor(e){super(e,nG)}getParser(){return this.parser}}class Yb extends U{constructor(e){super(e,lG)}getParser(){return this.parser}}class zb extends U{constructor(e){super(e,cG)}getParser(){return this.parser}}class ez extends U{constructor(e){super(e,uG)}getParser(){return this.parser}}class tz extends U{constructor(e){super(e,rW)}getParser(){return this.parser}}class sz extends U{constructor(e){super(e,iW)}getParser(){return this.parser}}class rz extends U{constructor(e){super(e,nW)}getParser(){return this.parser}}class iz{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class nz{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class Kb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qb{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Xb{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Qb{constructor(e=0){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class $b{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class az{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Jb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Zb{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class e_{constructor(e="",t="",r="",i=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(e){const t=Lt.generateImageUrl(e);if(!t)return;const r=t.split(",")[1],i=Uint8Array.from(atob(r),n=>n.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}assignBase64(e){const t=e.split(",")[1],r=Uint8Array.from(atob(t),i=>i.charCodeAt(0));this._data.push(r.byteLength,r.buffer)}}class hf extends e_{constructor(e="",t="",r="",i=-1,n=-1){super(e,t,r,i,n)}}class ey{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ty{constructor(e,t){this._data=[e,t]}dispose(){this._data=null}getMessageArray(){return this._data}}class sy{constructor(e,t){this._data=[e,t]}dispose(){this._data=null}getMessageArray(){return this._data}}class ry{constructor(e,t,r,i,n,o){this._data=[e,t,r,i,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class iy{constructor(e,t,r,i){this._data=[e,t,r,i]}dispose(){this._data=null}getMessageArray(){return this._data}}class ny{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class ay{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oz{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class oy{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ly{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class lz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class cz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class cy{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class uz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class uy{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class dz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class _z{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class gz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class mz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class hy{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dy{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class fz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class _y{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class EE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ez{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class gy{constructor(e,t,r,i,n,o,l,c,h){this._data=[e,t,r,i,n,o,l,c,h]}getMessageArray(){return this._data}dispose(){}}class ih{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class my{constructor(e,t,r,i,n,o,l){this._data=[e,t,r,i,n,o,l]}getMessageArray(){return this._data}dispose(){}}class fy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Iz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class py{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Tz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ey{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Rz{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Sz{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Oz{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Cz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Az{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Nz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class bz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class vz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nh{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}nh.CONFIRM_LEVEL_NOT_ACCEPTED=0;nh.CONFIRM_LEVEL_NOT_SUBMITTED=1;nh.CONFIRM_LEVEL_NOT_CONFIRMED=2;nh.CONFIRM_LEVEL_COMMIT=3;class Mz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Iy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Dz{constructor(e,t){this._data=[e,t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class Ty{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ry{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Pz{constructor(e,t){this._data=[e,t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class Sy{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Oy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Cy{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class df{constructor(e,...t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Lz{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class q_{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ay{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ny{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class by{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yy{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vy{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class IE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}let My=class{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}};class Dy{constructor(e,t){this._data=[t.length,...t,e]}getMessageArray(){return this._data}dispose(){}}class ac{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Uz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Py{constructor(e=!0){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class xz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class wz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Fz{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class kz{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Ly{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Gz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Bz{constructor(e,t){this._data=[e,t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Vz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Hz{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Uy{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class xy{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class wy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Wz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Fy{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class jz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Yz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class zz{constructor(e,t,r,i,n,o){this._data=[e,t,r,i,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class Kz{constructor(e,t,r,i,n,o){this._data=[e,t,r,i,n,o]}dispose(){this._data=null}getMessageArray(){return this._data}}class qz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Xz{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Qz{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class $z{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Jz{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Zz{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class ky{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}ky.NO_ISSUE_ID=-1;class e5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Gy{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}Gy.NO_ISSUE_ID=-1;class t5{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class s5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class r5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class By{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Vy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Hy{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Wy{constructor(e,t,r,i,n,o){this._data=[e,t,r,i,n,o.length,...o]}getMessageArray(){return this._data}dispose(){}}class jy{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Yy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class zy{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ky{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Rc{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class qy{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class _f{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class Xy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Qy{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class X_{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class $y{constructor(e,t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Jy{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class Zy{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class ev{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class tv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class sv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class i5{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class n5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class a5{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class o5{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class l5{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class c5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class u5{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class h5{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class d5{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class _5{constructor(...e){this._data=[e.length],e.forEach(t=>{this._data.push(t.k),this._data.push(t._arg_2),this._data.push(t._arg_3)})}getMessageArray(){return this._data}dispose(){}}class g5{constructor(e,t,r,i,n){this._data=[e,t,r,i,n]}getMessageArray(){return this._data}dispose(){}}class m5{constructor(e,t,r,i){this._data=[e,t,i,r]}getMessageArray(){return this._data}dispose(){}}class f5{constructor(e,t,r){if(this._type=e,t.length===r.length){this._data=[];for(let i=0;i<t.length;i++)this._data.push(t[i]),this._data.push(r[i])}}getMessageArray(){return this._data}dispose(){}}class rv{constructor(e,t,r,i){this._data=[`NITRO-${Uc.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",v_.HTML5,gp.BROWSER]}getMessageArray(){return this._data}dispose(){}}class p5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class E5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class iv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class I5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class av{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class T5{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class R5{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class ov{constructor(e,t,r,i,n){this._data=[e,t,r,i,n]}getMessageArray(){return this._data}dispose(){}}class lv{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class cv{constructor(e,t,r,i){this._data=[e,t,r,i.length/2,...i]}getMessageArray(){return this._data}dispose(){}}class uv{constructor(e,t,r,i,n){this._data=[e,t,r,i,n]}getMessageArray(){return this._data}dispose(){}}class S5{constructor(e,t,r,i,n){this._data=[e,t,r,i,n]}getMessageArray(){return this._data}dispose(){}}class hv{constructor(e,t,r,i,n){this._data=[e,t,r,i,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class O5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class C5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class A5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class N5{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class dv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _v{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class b5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class y5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class v5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class M5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mv{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class fv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ev{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Iv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class D5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Tv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gf{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class P5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Rv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Sv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class L5{constructor(e,t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class U5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class x5{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class w5{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class F5{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class k5{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class G5{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Ov{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cv{constructor(){this._badges=[]}getMessageArray(){const e=[];for(let t=1;t<=this._badges.length;t++)e.push(t),e.push(this._badges[t-1]);return e}dispose(){}addActivatedBadge(e){this._badges.push(e)}}class mf{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Av{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class V5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class H5{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class ff{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Nv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class pf{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Mv{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Dv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Pv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Lv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Uv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xv{constructor(e,...t){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}class wv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Ef{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class j5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Fv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){this._data=null}}class Y5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class z5{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Gv{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){this._data=null}}class Bv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Vv{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class Hv{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class K5{constructor(e,t,r){this._data=[e,t.length,...t,r]}getMessageArray(){return this._data}dispose(){}}class _o{constructor(e,t){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}_o.RESOLUTION_USELESS=1;_o.RESOLUTION_ABUSIVE=2;_o.RESOLUTION_RESOLVED=3;const Wv=class{constructor(s,e,t,r,i,n=-1){this._data=[s,e,t,r,i],n!=Wv.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}};let Wa=Wv;Wa.NO_ISSUE_ID=-1;class jv{constructor(e,t,r,i=-1){this._data=[e,t,r],i!=Wa.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Yv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class zv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Kv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class qv{constructor(e,t=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Xv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Qv{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class $v{constructor(e,t,r,i=-1){this._data=[e,t,r],i!=Wa.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class If{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class va{constructor(e,t,r){this._data=[],this._data.push(e),this._data.push(t),this._data.push(r)}getMessageArray(){return this._data}dispose(){}}va.ACTION_ALERT=0;va.ACTION_KICK=1;va.ACTION_MESSAGE=3;va.ACTION_MESSAGE_AND_SOFT_KICK=4;class Jv{constructor(e,t,r,i=-1){this._data=[e,t,r],i!=Wa.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class TE{constructor(e,t,r,i=-1){this._data=[],this._data.push(e),this._data.push(t),this._data.push(""),this._data.push(""),this._data.push(r),i!=Wa.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Zv{constructor(e,t,r,i=-1){this._data=[e,t,r],i!=Wa.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class q5{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class X5{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class eM{constructor(e,t,r,i,n=-1){this._data=[e,t,r,i],n!=Wa.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class tM{constructor(e,t,r,i){this._data=[e.length,...e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class RE{constructor(e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class sM{constructor(e){this._data=[e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Q5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class $5{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class J5{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Z5{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class rM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class iM{constructor(e,t,r,i,n,o){this._data=[e,t,r,i,n,o]}getMessageArray(){return this._data}dispose(){}}class e3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class nM{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class t3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class s3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class r3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class aM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Bu{constructor(e,t,r){this._data=[e,t?1:0,r?1:0]}getMessageArray(){return this._data}dispose(){}}class i3{constructor(e=0){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class n3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oM{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class a3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class o3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class l3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class c3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class u3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class h3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class d3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class g3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class m3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class f3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class lM{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gl{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class E3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class I3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class T3{constructor(e,t,r,i,n,o){this._data=[e,t,r,i,n,o]}getMessageArray(){return this._data}dispose(){}}class R3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class cM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class S3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class O3{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class C3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class A3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class N3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class y3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class v3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class uM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class hM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dM{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class M3{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class D3{constructor(...e){this._data=[e.length*3],e.forEach(t=>{this._data.push(t.dayIndex),this._data.push(t.stepIndex),this._data.push(t.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class _M{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class R{}R.KEYBOARD_INPUT=6028;R.WIRED_SELECTOR_SAVE=6027;R.WIRED_ADDON_SAVE=6008;R.REQUEST_ROOM_VARIABLES=6029;R.REQUEST_FURNI_WITH_VARIABLES=6030;R.REQUEST_USER_WITH_VARIABLES=6037;R.REQUEST_USER_VARIABLES=6036;R.REQUEST_GLOBAL_VARIABLES=6038;R.REQUEST_GLOBAL_WITH_VARIABLES=6039;R.TOGGLE_HIGHLIGHT_MODE=6031;R.TOGGLE_FURNI_INSPECTION_LOCK=6040;R.INSPECT_USER_VARIABLES=6041;R.TOGGLE_USER_INSPECTION_LOCK=6042;R.TOGGLE_GLOBAL_INSPECTION=6043;R.INSPECT_FURNI_VARIABLES=6044;R.BLACKJACK_BET=6032;R.BLACKJACK_HIT=6033;R.BLACKJACK_STAND=6034;R.BLACKJACK_JOIN_QUEUE_WITH_BET=6035;R.CLICK_FURNI=6002;R.IS_ON_FURNIFIXTOOL=6003;R.FURNIFIXTOOL_SAVE=6004;R.FURNIFIXTOOL_BATCH_SAVE=6005;R.ACHIEVEMENT_LIST=219;R.AUTHENTICATION=-1;R.BOT_CONFIGURATION=1986;R.BOT_PICKUP=3323;R.BOT_PLACE=1592;R.BOT_SKILL_SAVE=2624;R.GET_CLUB_OFFERS=3285;R.GET_CLUB_GIFT_INFO=487;R.GET_CATALOG_INDEX=1195;R.GET_CATALOG_PAGE=412;R.CATALOG_PURCHASE=3492;R.CATALOG_PURCHASE_GIFT=1411;R.GET_PRODUCT_OFFER=2594;R.CLIENT_LATENCY=295;R.CLIENT_LATENCY_MEASURE=96;R.CLIENT_POLICY=26979;R.CLIENT_PONG=2596;R.CLIENT_TOOLBAR_TOGGLE=2313;R.CLIENT_VARIABLES=1053;R.GET_CURRENT_TIMING_CODE=2912;R.DESKTOP_NEWS=1827;R.DESKTOP_VIEW=105;R.GET_BUNDLE_DISCOUNT_RULESET=223;R.EVENT_TRACKER=3457;R.FIND_NEW_FRIENDS=516;R.FURNITURE_ALIASES=3898;R.FURNITURE_FLOOR_UPDATE=248;R.FURNITURE_MULTISTATE=99;R.FURNITURE_PICKUP=3456;R.FURNITURE_PLACE=1258;R.FURNITURE_POSTIT_PLACE=2248;R.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283;R.FURNITURE_RANDOMSTATE=3617;R.FURNITURE_WALL_MULTISTATE=210;R.FURNITURE_WALL_UPDATE=168;R.GAMES_INIT=2914;R.GAMES_LIST=741;R.ACCEPTGAMEINVITE=3802;R.GAMEUNLOADEDMESSAGE=3207;R.GETGAMEACHIEVEMENTSMESSAGE=2399;R.GETGAMESTATUSMESSAGE=3171;R.GETUSERGAMEACHIEVEMENTSMESSAGE=389;R.JOINQUEUEMESSAGE=1458;R.LEAVEQUEUEMESSAGE=2384;R.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144;R.GETWEEKLYGAMEREWARDWINNERS=1054;R.GAME2GETACCOUNTGAMESTATUSMESSAGE=11;R.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259;R.GAME2EXITGAMEMESSAGE=1445;R.GAME2GAMECHATMESSAGE=2502;R.GAME2LOADSTAGEREADYMESSAGE=2415;R.GAME2PLAYAGAINMESSAGE=3196;R.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598;R.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232;R.GAME2GETWEEKLYLEADERBOARD=2565;R.GET_GIFT_WRAPPING_CONFIG=418;R.GROUP_ADMIN_ADD=2894;R.GROUP_ADMIN_REMOVE=722;R.GROUP_CREATE_OPTIONS=798;R.GROUP_FAVORITE=3549;R.GET_FORUM_STATS=3149;R.GET_FORUM_THREADS=873;R.GET_FORUMS_LIST=436;R.GET_FORUM_MESSAGES=232;R.GET_FORUM_THREAD=3900;R.GET_UNREAD_FORUMS_COUNT=2908;R.FORUM_MODERATE_MESSAGE=286;R.FORUM_MODERATE_THREAD=1397;R.FORUM_POST_MESSAGE=3529;R.UPDATE_FORUM_READ_MARKER=1855;R.UPDATE_FORUM_SETTINGS=2214;R.FORUM_UPDATE_THREAD=3045;R.GROUP_INFO=2991;R.GROUP_DELETE=1134;R.GROUP_MEMBER_REMOVE_CONFIRM=3593;R.GROUP_MEMBER_REMOVE=593;R.GROUP_MEMBERS=312;R.GROUP_MEMBERSHIPS=367;R.GROUP_REQUEST=998;R.GROUP_REQUEST_ACCEPT=3386;R.GROUP_REQUEST_DECLINE=1894;R.GROUP_SETTINGS=1004;R.GROUP_PARTS=813;R.GROUP_BUY=230;R.GROUP_SAVE_INFORMATION=3137;R.GROUP_SAVE_BADGE=1991;R.GROUP_SAVE_COLORS=1764;R.GROUP_SAVE_PREFERENCES=3435;R.GROUP_BADGES=21;R.GROUP_UNBLOCK_MEMBER=2864;R.GET_BADGE_POINTS_LIMITS=1371;R.REQUESTABADGE=3077;R.GETISBADGEREQUESTFULFILLED=1364;R.ITEM_CLOTHING_REDEEM=3374;R.ITEM_COLOR_WHEEL_CLICK=2144;R.ITEM_DICE_CLICK=1990;R.ITEM_DICE_CLOSE=1533;R.ITEM_DIMMER_SAVE=1648;R.ITEM_DIMMER_SETTINGS=2813;R.ITEM_DIMMER_TOGGLE=2296;R.ITEM_EXCHANGE_REDEEM=3115;R.ITEM_PAINT=711;R.SET_OBJECT_DATA=3608;R.ITEM_STACK_HELPER=3839;R.ITEM_WALL_CLICK=210;R.ITEM_WALL_UPDATE=168;R.MARKETPLACE_CONFIG=2597;R.ACCEPT_FRIEND=137;R.MESSENGER_CHAT=3567;R.DECLINE_FRIEND=2890;R.FOLLOW_FRIEND=3997;R.MESSENGER_FRIENDS=1523;R.MESSENGER_INIT=2781;R.MESSENGER_RELATIONSHIPS=2138;R.SET_RELATIONSHIP_STATUS=3768;R.REMOVE_FRIEND=1689;R.REQUEST_FRIEND=3157;R.GET_FRIEND_REQUESTS=2448;R.SEND_ROOM_INVITE=1276;R.HABBO_SEARCH=1210;R.FRIEND_LIST_UPDATE=1419;R.MOD_TOOL_USER_INFO=3295;R.GET_USER_FLAT_CATS=3027;R.NAVIGATOR_INIT=2110;R.NAVIGATOR_SEARCH=249;R.NAVIGATOR_SEARCH_CLOSE=1834;R.NAVIGATOR_SEARCH_OPEN=637;R.NAVIGATOR_SEARCH_SAVE=2226;R.GET_USER_EVENT_CATS=1782;R.NAVIGATOR_SETTINGS_SAVE=3159;R.NAVIGATOR_CATEGORY_LIST_MODE=1202;R.NAVIGATOR_DELETE_SAVED_SEARCH=1954;R.PET_INFO=2934;R.PET_PICKUP=1581;R.PET_PLACE=2647;R.PET_RESPECT=3202;R.PET_RIDE=1036;R.PET_MOVE=3449;R.PET_OPEN_PACKAGE=3698;R.PET_SELECTED=549;R.PETS_BREED=1638;R.PET_CANCEL_BREEDING=2713;R.PET_CONFIRM_BREEDING=3382;R.GET_PET_TRAINING_PANEL=2161;R.RECYCLER_PRIZES=398;R.RECYCLER_STATUS=1342;R.RECYCLER_ITEMS=2771;R.RELEASE_VERSION=4e3;R.CALL_FOR_HELP=1691;R.ROOM_AMBASSADOR_ALERT=2996;R.ROOM_BAN_GIVE=1477;R.ROOM_BAN_LIST=2267;R.ROOM_BAN_REMOVE=992;R.ROOM_CREATE=2752;R.ROOM_DELETE=532;R.ROOM_DOORBELL=1644;R.ROOM_ENTER=2312;R.ROOM_FAVORITE=3817;R.ROOM_FAVORITE_REMOVE=309;R.CAN_CREATE_ROOM=2128;R.CANCEL_ROOM_EVENT=2725;R.EDIT_ROOM_EVENT=3991;R.COMPETITION_ROOM_SEARCH=433;R.FORWARD_TO_RANDOM_PROMOTED_ROOM=10;R.FORWARD_TO_SOME_ROOM=1703;R.GET_CATEGORIES_WITH_USER_COUNT=3782;R.GET_GUEST_ROOM=2230;R.GET_OFFICIAL_ROOMS=1229;R.GET_POPULAR_ROOM_TAGS=826;R.GUILD_BASE_SEARCH=2930;R.MY_FAVOURITE_ROOMS_SEARCH=2578;R.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002;R.MY_FRIENDS_ROOM_SEARCH=2266;R.MY_GUILD_BASES_SEARCH=39;R.MY_RECOMMENDED_ROOMS=2537;R.MY_ROOM_HISTORY_SEARCH=2264;R.MY_ROOM_RIGHTS_SEARCH=272;R.MY_ROOMS_SEARCH=2277;R.POPULAR_ROOMS_SEARCH=2758;R.ROOM_AD_EVENT_TAB_CLICKED=2412;R.ROOM_AD_EVENT_TAB_VIEWED=2668;R.ROOM_AD_SEARCH=2809;R.ROOM_TEXT_SEARCH=3943;R.ROOMS_WHERE_MY_FRIENDS_ARE=1786;R.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939;R.SET_ROOM_SESSION_TAGS=3305;R.UPDATE_ROOM_THUMBNAIL=2468;R.ROOM_KICK=1320;R.ROOM_LIKE=3582;R.ROOM_MODEL=2300;R.GET_OCCUPIED_TILES=1687;R.GET_ROOM_ENTRY_TILE=3559;R.ROOM_MODEL_SAVE=875;R.ROOM_MUTE=3637;R.ROOM_MUTE_USER=3485;R.ROOM_RIGHTS_GIVE=808;R.ROOM_RIGHTS_LIST=3385;R.ROOM_RIGHTS_REMOVE=2064;R.ROOM_RIGHTS_REMOVE_ALL=2683;R.ROOM_RIGHTS_REMOVE_OWN=3182;R.ROOM_SETTINGS=3129;R.ROOM_SETTINGS_SAVE=1969;R.ROOM_SETTINGS_SAVE_WIRED=1970;R.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265;R.ROOM_STAFF_PICK=1918;R.ROOM_FILTER_WORDS=1911;R.ROOM_FILTER_WORDS_MODIFY=3001;R.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012;R.MYSTERYBOX_OPEN_TROPHY=3074;R.SECURITY_MACHINE=2490;R.SECURITY_TICKET=2419;R.TRADE=1481;R.TRADE_ACCEPT=3863;R.TRADE_CANCEL=2341;R.TRADE_CLOSE=2551;R.TRADE_CONFIRM=2760;R.TRADE_ITEM=3107;R.TRADE_ITEM_REMOVE=3845;R.TRADE_ITEMS=1263;R.TRADE_UNACCEPT=1444;R.UNIT_ACTION=2456;R.UNIT_CHAT=1314;R.UNIT_CHAT_SHOUT=2085;R.UNIT_CHAT_WHISPER=1543;R.UNIT_DANCE=2080;R.UNIT_DROP_HAND_ITEM=2814;R.UNIT_GIVE_HANDITEM=2941;R.UNIT_LOOK=3301;R.UNIT_POSTURE=2235;R.UNIT_SIGN=1975;R.UNIT_TYPING=1597;R.UNIT_TYPING_STOP=1474;R.UNIT_WALK=3320;R.USER_BADGES=2769;R.USER_BADGES_CURRENT=2091;R.USER_BADGES_CURRENT_UPDATE=644;R.USER_BOTS=3848;R.USER_CURRENCY=273;R.USER_EFFECT_ACTIVATE=2959;R.USER_EFFECT_ENABLE=1752;R.USER_FIGURE=2730;R.USER_FURNITURE=3150;R.REQUESTFURNIINVENTORYWHENNOTINROOM=3500;R.USER_HOME_ROOM=1740;R.USER_INFO=357;R.USER_MOTTO=2228;R.USER_IGNORED=3878;R.USER_PETS=3095;R.USER_PROFILE=3265;R.USER_PROFILE_BY_NAME=2249;R.USER_RESPECT=2694;R.GET_SOUND_SETTINGS=2388;R.USER_SETTINGS_CAMERA=1461;R.USER_SETTINGS_CHAT_STYLE=1030;R.USER_SETTINGS_INVITES=1086;R.USER_SETTINGS_OLD_CHAT=1262;R.USER_SETTINGS_ROTATIONS=4463;R.USER_SETTINGS_WIRED_ANIMATIONS=6045;R.USER_SETTINGS_VOLUME=1367;R.USER_SUBSCRIPTION=3166;R.GET_WARDROBE=2742;R.SAVE_WARDROBE_OUTFIT=800;R.USER_TAGS=17;R.PEER_USERS_CLASSIFICATION=1160;R.USER_CLASSIFICATION=2285;R.VISIT_USER=2970;R.WIRED_ACTION_SAVE=2281;R.WIRED_APPLY_SNAPSHOT=6046;R.WIRED_CONDITION_SAVE=3203;R.WIRED_OPEN=768;R.WIRED_TRIGGER_SAVE=1520;R.GET_ITEM_DATA=3964;R.ONE_WAY_DOOR_CLICK=2765;R.REMOVE_WALL_ITEM=3336;R.SET_ITEM_DATA=3666;R.CATALOG_REDEEM_VOUCHER=339;R.ROOM_TONER_APPLY=2880;R.FRIEND_FURNI_CONFIRM_LOCK=3775;R.MANNEQUIN_SAVE_NAME=2850;R.MANNEQUIN_SAVE_LOOK=2209;R.PRESENT_OPEN_PRESENT=3558;R.CATALOG_SELECT_VIP_GIFT=2276;R.USER_IGNORE_ID=3314;R.USER_IGNORE=1117;R.USER_UNIGNORE=2061;R.MODTOOL_REQUEST_ROOM_INFO=707;R.MODTOOL_CHANGE_ROOM_SETTINGS=3260;R.MODTOOL_REQUEST_USER_CHATLOG=1391;R.MODTOOL_REQUEST_ROOM_CHATLOG=2587;R.MODTOOL_SANCTION_ALERT=229;R.MODTOOL_SANCTION_BAN=2766;R.MODTOOL_SANCTION_KICK=2582;R.MODTOOL_SANCTION_TRADELOCK=3742;R.MODTOOL_ALERTEVENT=1840;R.MODTOOL_SANCTION_MUTE=1945;R.MODTOOL_REQUEST_USER_ROOMS=3526;R.MODTOOL_ROOM_ALERT=3842;R.MODTOOL_PREFERENCES=31;R.CLOSE_ISSUE_DEFAULT_ACTION=2717;R.CLOSE_ISSUES=2067;R.DEFAULT_SANCTION=1681;R.GET_CFH_CHATLOG=211;R.MODTOOL_SANCTION=1392;R.PICK_ISSUES=15;R.RELEASE_ISSUES=1572;R.CONVERT_GLOBAL_ROOM_ID=314;R.REQUEST_SELL_ITEM=848;R.REQUEST_MARKETPLACE_ITEM_STATS=3288;R.MARKETPLACE_SELL_ITEM=3447;R.MARKETPLACE_REQUEST_OWN_ITEMS=2105;R.MARKETPLACE_TAKE_BACK_ITEM=434;R.MARKETPLACE_REDEEM_CREDITS=2650;R.MARKETPLACE_REQUEST_OFFERS=2407;R.MARKETPLACE_BUY_OFFER=1603;R.MARKETPLACE_BUY_TOKENS=1866;R.CATALOG_REQUESET_PET_BREEDS=1756;R.APPROVE_NAME=2109;R.UNIT_GIVE_HANDITEM_PET=2768;R.PET_MOUNT=1036;R.PET_SUPPLEMENT=749;R.FURNITURE_GROUP_INFO=2651;R.ACHIEVEMENT_RESOLUTION_OPEN=359;R.USE_PET_PRODUCT=1328;R.REMOVE_PET_SADDLE=186;R.TOGGLE_PET_RIDING=1472;R.TOGGLE_PET_BREEDING=3379;R.UNSEEN_RESET_CATEGORY=3493;R.UNSEEN_RESET_ITEMS=2343;R.COMMUNITY_GOAL_VOTE_COMPOSER=3536;R.GET_PROMO_ARTICLES=1827;R.ACCEPT_QUEST=3604;R.ACTIVATE_QUEST=793;R.CANCEL_QUEST=3133;R.FRIEND_REQUEST_QUEST_COMPLETE=1148;R.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688;R.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167;R.GET_COMMUNITY_GOAL_PROGRESS=1145;R.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343;R.GET_CONCURRENT_USERS_REWARD=3872;R.GET_DAILY_QUEST=2486;R.GET_QUESTS=3333;R.GET_SEASONAL_QUESTS_ONLY=1190;R.OPEN_QUEST_TRACKER=2750;R.REDEEM_COMMUNITY_GOAL_PRIZE=90;R.REJECT_QUEST=2397;R.START_CAMPAIGN=1697;R.GET_BONUS_RARE_INFO=957;R.CRAFT=3591;R.CRAFT_SECRET=1251;R.GET_CRAFTABLE_PRODUCTS=633;R.GET_CRAFTING_RECIPE=1173;R.GET_CRAFTING_RECIPES_AVAILABLE=3086;R.PHOTO_COMPETITION=3959;R.PUBLISH_PHOTO=2068;R.PURCHASE_PHOTO=2408;R.RENDER_ROOM=3226;R.RENDER_ROOM_THUMBNAIL=1982;R.REQUEST_CAMERA_CONFIGURATION=796;R.ADD_JUKEBOX_DISK=753;R.GET_JUKEBOX_PLAYLIST=1435;R.GET_NOW_PLAYING=1325;R.GET_OFFICIAL_SONG_ID=3189;R.GET_SONG_INFO=3082;R.GET_SOUND_MACHINE_PLAYLIST=3498;R.GET_USER_SONG_DISKS=2304;R.REMOVE_JUKEBOX_DISK=3050;R.INTERSTITIAL_SHOWN=1109;R.GET_INTERSTITIAL=2519;R.CHANGE_USERNAME=2977;R.CHECK_USERNAME=3950;R.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889;R.OPEN_CAMPAIGN_CALENDAR_DOOR=2257;R.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051;R.BUILDERS_CLUB_PLACE_WALL_ITEM=462;R.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529;R.GET_CATALOG_PAGE_EXPIRATION=742;R.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135;R.GET_DIRECT_CLUB_BUY_AVAILABLE=801;R.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603;R.GET_HABBO_CLUB_EXTEND_OFFER=2462;R.GET_IS_OFFER_GIFTABLE=1347;R.GET_LIMITED_OFFER_APPEARING_NEXT=410;R.GET_NEXT_TARGETED_OFFER=596;R.GET_ROOM_AD_PURCHASE_INFO=1075;R.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257;R.GET_TARGETED_OFFER=2487;R.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150;R.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735;R.PURCHASE_ROOM_AD=777;R.PURCHASE_TARGETED_OFFER=1826;R.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407;R.ROOM_AD_PURCHASE_INITIATED=2283;R.SET_TARGETTED_OFFER_STATE=2041;R.SHOP_TARGETED_OFFER_VIEWED=3483;R.HELPER_TALENT_TRACK=196;R.TALENT_TRACK_GET_LEVEL=2127;R.FORWARD_TO_A_COMPETITION_ROOM=172;R.FORWARD_TO_A_SUBMITTABLE_ROOM=1450;R.FORWARD_TO_RANDOM_COMPETITION_ROOM=865;R.GET_IS_USER_PART_OF_COMPETITION=2077;R.GET_SECONDS_UNTIL=271;R.ROOM_COMPETITION_INIT=1334;R.SUBMIT_ROOM_TO_COMPETITION=2595;R.VOTE_FOR_ROOM=143;R.GET_GIFT=2436;R.RESET_PHONE_NUMBER_STATE=2741;R.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379;R.TRY_PHONE_NUMBER=790;R.VERIFY_CODE=2721;R.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005;R.GET_YOUTUBE_DISPLAY_STATUS=336;R.SET_YOUTUBE_DISPLAY_PLAYLIST=2069;R.GO_TO_FLAT=685;R.CHANGE_QUEUE=3093;R.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412;R.CALL_FOR_HELP_FROM_FORUM_THREAD=534;R.CALL_FOR_HELP_FROM_IM=2950;R.CALL_FOR_HELP_FROM_PHOTO=2492;R.CALL_FOR_HELP_FROM_SELFIE=2755;R.CHAT_REVIEW_GUIDE_DECIDES=3365;R.CHAT_REVIEW_GUIDE_DETACHED=2501;R.CHAT_REVIEW_GUIDE_VOTE=3961;R.CHAT_REVIEW_SESSION_CREATE=3060;R.DELETE_PENDING_CALLS_FOR_HELP=3605;R.GET_CFH_STATUS=2746;R.GET_FAQ_CATEGORY=3445;R.GET_FAQ_TEXT=1849;R.GET_GUIDE_REPORTING_STATUS=3786;R.GET_PENDING_CALLS_FOR_HELP=3267;R.GET_QUIZ_QUESTIONS=1296;R.GUIDE_SESSION_CREATE=3338;R.GUIDE_SESSION_FEEDBACK=477;R.GUIDE_SESSION_GET_REQUESTER_ROOM=1052;R.GUIDE_SESSION_GUIDE_DECIDES=1424;R.GUIDE_SESSION_INVITE_REQUESTER=234;R.GUIDE_SESSION_IS_TYPING=519;R.GUIDE_SESSION_MESSAGE=3899;R.GUIDE_SESSION_ON_DUTY_UPDATE=1922;R.GUIDE_SESSION_REPORT=3969;R.GUIDE_SESSION_REQUESTER_CANCELS=291;R.GUIDE_SESSION_RESOLVED=887;R.POST_QUIZ_ANSWERS=3720;R.SEARCH_FAQS=2031;R.POLL_ANSWER=3505;R.POLL_REJECT=1773;R.POLL_START=109;R.POLL_VOTE_COUNTER=6200;R.DISCONNECT=2445;R.SCR_GET_KICKBACK_INFO=869;R.COMPOST_PLANT=3835;R.HARVEST_PET=1521;R.SET_CLOTHING_CHANGE_DATA=924;R.GROUP_UNFAVORITE=1820;R.NEW_USER_EXPERIENCE_GET_GIFTS=1822;R.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299;R.HANDSHAKE_INIT_DIFFIE=3110;R.HANDSHAKE_COMPLETE_DIFFIE=773;R.WELCOME_OPEN_GIFT=2638;R.WELCOME_GIFT_CHANGE_EMAIL=66;R.EMAIL_GET_STATUS=2557;R.EMAIL_CHANGE=3965;R.APPROVE_ALL_MEMBERSHIP_REQUESTS=882;R.RENTABLE_SPACE_CANCEL_RENT=1667;R.RENTABLE_SPACE_RENT=2946;R.RENTABLE_SPACE_STATUS=872;R.TRACKING_PERFORMANCE_LOG=3230;R.TRACKING_LAG_WARNING_REPORT=3847;R.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736;R.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115;R.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071;R.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518;class gM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Tf{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Q_{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class P3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class mM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class fM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class pM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class EM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class IM{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class TM{constructor(e,t,r){this._data=[e,t,r.length,...r]}getMessageArray(){return this._data}dispose(){}}class RM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class SM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class OM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class L3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class U3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class x3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class w3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class F3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class CM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class k3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class G3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class V3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class H3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Y3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class z3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class K3{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class q3{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class X3{constructor(...e){this._data=[e.length],e.forEach(t=>{this._data.push(t.itemId)})}getMessageArray(){return this._data}dispose(){}}class AM{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class NM{constructor(e,t=null){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class bM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class yM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class vM{constructor(e,t=0,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class MM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class DM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class PM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class LM{constructor(e,t,r=0){this._data=[e,r,t]}getMessageArray(){return this._data}dispose(){}}class OE{constructor(...e){this._data=[e.length,...e]}getMessageArray(){return this._data}dispose(){}}class UM{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class xM{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class CE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class AE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class wM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class FM{constructor(e,t,r,i,n,o,l,c,h,u,g,m,p,f,T,I,O,A,N,P,y,D,x,w,k,F){this._data=[],this._data.push(e,t,r,i,n,o,l),this._data.push(h.length,...h),this._data.push(u,g,m,p,f,T,I,O,A,N,P,y,D,x,w,k,F)}getMessageArray(){return this._data}dispose(){}}class kM{constructor(e,t,r){this._data=[],this._data.push(e,t,r)}getMessageArray(){return this._data}dispose(){}}class GM{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class $_{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class jn{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class BM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class VM extends BM{constructor(e){super(e)}}class Rf{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Q3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class HM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class WM extends BM{constructor(e){super(e)}}class jM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Sf{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class YM{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class zM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class KM{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class qM{constructor(e,t,r=""){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class XM{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class NE{constructor(e,t){this._data=[e,t.size*2];for(const[r,i]of t.entries())this._data.push(r,i)}getMessageArray(){return this._data}dispose(){}}class QM{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class $M{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class JM{constructor(e,t,r,i,n){this._data=[e,t,r,i,n]}getMessageArray(){return this._data}dispose(){}}class ZM{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $3{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class J3{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Of{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class eD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class sD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class bE{constructor(e,t,r,i,n,o){this._itemId=e,this._category=t,this._wallLocation=r,this._x=i,this._y=n,this._direction=o}getMessageArray(){switch(this._category){case z.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case z.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class Ou{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class Z3{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class iD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class nD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class aD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class oD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Sc{constructor(e,t=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class lD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class cD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class t_{constructor(e,t=-100){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class uD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class hD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class _D{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class yE{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class e4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class gD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class t4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class s4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class r4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class mD{constructor(e,t,r,i){this._data=[e,t,r,i]}getMessageArray(){return this._data}dispose(){}}class fD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class cu{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class pD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Cf{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class ED{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Af{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ID{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vE{constructor(e,t,r,i,n,o,l){this._data=[e,t,r,i,n,o,l]}getMessageArray(){return this._data}dispose(){}}class TD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class RD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class SD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ME{constructor(e,t=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class OD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class CD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class AD{constructor(e,t,r){this._data=[e+" "+t,r]}getMessageArray(){return this._data}dispose(){}}class ND{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class vD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class MD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class DE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class PD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class LD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class UD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class J_{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}J_.STATE_START=0;J_.STATE_CANCEL=1;J_.STATE_ACCEPT=2;class i4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class n4{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class PE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class wD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class FD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kD{constructor(e,t,r,i,n,o,l,c,h,u,g=[]){this._data=[e,t.length,...t,r,i.length,...i,n,o,l,c,h,u],g&&g.length&&this._data.push(g.length,...g)}getMessageArray(){return this._data}dispose(){}}class GD{constructor(e,t,r,i,n){this._data=[e,t.length,...t,r,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class BD{constructor(e,t,r,i,n,o,l,c,h,u){this._data=[e,t.length,...t,r,i.length,...i,n,o,l,c,h,u]}getMessageArray(){return this._data}dispose(){}}class VD{constructor(e,t,r,i,n,o,l){this._data=[e,t.length,...t,r,i.length,...i,n,o,l]}getMessageArray(){return this._data}dispose(){}}class HD{constructor(e,t,r,i,n){this._data=[e,t.length,...t,r,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class a4{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class WD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class jD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class YD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class KD{constructor(...e){this._data=[e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class o4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class l4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qD{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class XD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class c4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class u4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class h4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class d4{constructor(e,t,r,i,n,o,l,c,h,u,g){this._data=[e,t,r,i,n,o,l,c,h,u,g]}getMessageArray(){return this._data}dispose(){}}class QD{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class LE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class g4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class $D{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class JD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class ZD{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class eP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class tP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class UE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class xE{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class sP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class rP{constructor(e,t=!0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class wE{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class m4{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class iP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Nf{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class aP{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class lP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class f4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class cP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class p4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class uP{constructor(e,t,r){this._data=[e,t,r]}getMessageArray(){return this._data}dispose(){}}class E4{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class hP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class I4{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class dP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class _P{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class T4 extends aa{constructor(e){super(),this._communication=e,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const e=this._communication.connection;e&&(e.addEventListener(cr.CONNECTION_OPENED,this.onConnectionOpenedEvent),e.addEventListener(cr.CONNECTION_CLOSED,this.onConnectionClosedEvent),e.addEventListener(cr.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new RC(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new Ob(this.onAuthenticatedEvent.bind(this)))}onDispose(){const e=this._communication.connection;e&&(e.removeEventListener(cr.CONNECTION_OPENED,this.onConnectionOpenedEvent),e.removeEventListener(cr.CONNECTION_CLOSED,this.onConnectionClosedEvent),e.removeEventListener(cr.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(e){const t=this._communication.connection;t&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Is.CONNECTION_ESTABLISHED,t),Ke.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(t),t.send(new rv(null,null,null,null)),this.tryAuthentication(t))}onConnectionClosedEvent(e){const t=this._communication.connection;t&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Is.CONNECTION_CLOSED,t))}onConnectionErrorEvent(e){const t=this._communication.connection;t&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Is.CONNECTION_ERROR,t))}tryAuthentication(e){if(!e||!this.getSSO()){this.getSSO()||xe.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(Is.CONNECTION_HANDSHAKE_FAILED,e);return}e.send(new av(this.getSSO(),tt()))}onClientPingEvent(e){!e||!e.connection||this.sendPong(e.connection)}onAuthenticatedEvent(e){!e||!e.connection||(this.completeHandshake(e.connection),this.dispatchCommunicationDemoEvent(Is.CONNECTION_AUTHENTICATED,e.connection),e.connection.send(new iv))}startHandshake(e){this.dispatchCommunicationDemoEvent(Is.CONNECTION_HANDSHAKING,e),this._handShaking=!0}completeHandshake(e){this.dispatchCommunicationDemoEvent(Is.CONNECTION_HANDSHAKED,e),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,Ke.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(e=null){e=e||this._communication.connection||null,e&&e.send(new nv)}dispatchCommunicationDemoEvent(e,t){ke.instance.events.dispatchEvent(new Is(e,t))}getSSO(){return Ke.getValue("sso.ticket",null)}}class R4{flush(){return this._username=null,this._look=null,this._version=null,this._onlineUsers=null,this._activeRooms=null,this._catalogPages=null,this._items=null,this._furnis=null,this._uptime=null,this._ramUsage=null,this._cpuCores=null,this._totalMemory=null,this._hotelName=null,!0}parse(e){return e?(this._username=e.readString(),this._look=e.readString(),this._version=e.readString(),this._onlineUsers=e.readString(),this._activeRooms=e.readString(),this._catalogPages=e.readString(),this._items=e.readString(),this._furnis=e.readString(),this._uptime=e.readString(),this._ramUsage=e.readString(),this._cpuCores=e.readString(),this._totalMemory=e.readString(),this._hotelName=e.readString(),!0):!1}get username(){return this._username}get look(){return this._look}get version(){return this._version}get onlineUsers(){return this._onlineUsers}get activeRooms(){return this._activeRooms}get catalogPages(){return this._catalogPages}get items(){return this._items}get furnis(){return this._furnis}get uptime(){return this._uptime}get ramUsage(){return this._ramUsage}get cpuCores(){return this._cpuCores}get totalMemory(){return this._totalMemory}get hotelName(){return this._hotelName}}class gP extends U{constructor(e){super(e,R4)}getParser(){return this.parser}}class S4{flush(){return this._success=!1,this._processedCount=0,this._message="",!0}parse(e){return e?(this._success=e.readBoolean(),this._processedCount=e.readInt(),this._message=e.readString(),!0):!1}get success(){return this._success}get processedCount(){return this._processedCount}get message(){return this._message}}class mP extends U{constructor(e){super(e,S4)}getParser(){return this.parser}}class O4{flush(){return this._variableName="",this._assignments=[],!0}parse(e){if(!e)return!1;this._variableName=e.readString();const t=e.readInt();this._assignments=[];for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),l=e.readBoolean()?e.readInt():null,c=e.readString();this._assignments.push({furniId:i,virtualId:n,value:l,label:c})}return!0}get variableName(){return this._variableName}get assignments(){return this._assignments}}class FE extends U{constructor(e){super(e,O4)}getParser(){return this.parser}}class C4{flush(){return this._furniId=0,this._virtualId=0,this._variables=new Map,!0}parse(e){this._furniId=e.readInt(),this._virtualId=e.readInt();const t=e.readInt();this._variables=new Map;for(let r=0;r<t;r++){const i=e.readString(),n=e.readString();this._variables.set(i,n)}return!0}get furniId(){return this._furniId}get variables(){return this._variables}get virtualId(){return this._virtualId}}class fP extends U{constructor(e){super(e,C4)}getParser(){return this.parser}}class A4{flush(){return this._variables=new Map,!0}parse(e){const t=e.readInt();this._variables=new Map;for(let r=0;r<t;r++){const i=e.readString(),n=e.readString();this._variables.set(i,n)}return!0}get variables(){return this._variables}}class pP extends U{constructor(e){super(e,A4)}getParser(){return this.parser}}class N4{flush(){return this._userId=0,this._roomIndex=0,this._figure="",this._variables=new Map,!0}parse(e){this._userId=e.readInt(),this._roomIndex=e.readInt(),this._figure=e.readString();const t=e.readInt();this._variables=new Map;for(let r=0;r<t;r++){const i=e.readString(),n=e.readString();this._variables.set(i,n)}return!0}get userId(){return this._userId}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get variables(){return this._variables}}class EP extends U{constructor(e){super(e,N4)}getParser(){return this.parser}}class b4{constructor(){this._vars=[]}flush(){return this._vars=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean(),h=e.readBoolean(),u=e.readBoolean(),g=e.readBoolean(),m=e.readBoolean(),p=e.readInt(),f=e.readBoolean();let T;f&&(T=e.readString());const I=e.readString(),O=e.readString(),A=I.length?Number(I):void 0,N=O.length?Number(O):void 0,P=e.readInt(),y=[];for(let D=0;D<P;D++){const x=e.readInt(),w=e.readString();y.push({index:x,text:w})}this._vars.push({name:i,availability:n,hasValue:o,canWriteTo:l,canCreateDelete:c,isAlwaysAvailable:h,hasCreationTime:u,hasUpdateTime:g,isTextConnected:m,furniId:p,hasRuntimeValue:f,runtimeValue:T,creationTimestamp:A,updateTimestamp:N,textEntries:y})}return!0}get vars(){return this._vars}}class Z_ extends U{constructor(e){super(e,b4)}getParser(){return this.parser}}class y4{constructor(){this._vars=[]}flush(){return this._vars=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean(),h=e.readBoolean(),u=e.readBoolean(),g=e.readBoolean(),m=e.readBoolean(),p=e.readInt(),f=e.readBoolean();let T;f&&(T=e.readString());const I=e.readString(),O=e.readString(),A=I.length?Number(I):void 0,N=O.length?Number(O):void 0,P=e.readInt(),y=[];for(let D=0;D<P;D++){const x=e.readInt(),w=e.readString();y.push({index:x,text:w})}this._vars.push({name:i,availability:n,hasValue:o,canWriteTo:l,canCreateDelete:c,isAlwaysAvailable:h,hasCreationTime:u,hasUpdateTime:g,isTextConnected:m,furniId:p,hasRuntimeValue:f,runtimeValue:T,creationTimestamp:A,updateTimestamp:N,textEntries:y})}return!0}get vars(){return this._vars}}class kE extends U{constructor(e){super(e,y4)}getParser(){return this.parser}}class v4{constructor(){this._vars=[]}flush(){return this._vars=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean(),h=e.readBoolean(),u=e.readBoolean(),g=e.readBoolean(),m=e.readBoolean(),p=e.readInt(),f=e.readBoolean();let T;f&&(T=e.readString());const I=e.readString(),O=e.readString(),A=I.length?Number(I):void 0,N=O.length?Number(O):void 0,P=e.readInt(),y=[];for(let D=0;D<P;D++){const x=e.readInt(),w=e.readString();y.push({index:x,text:w})}this._vars.push({name:i,availability:n,hasValue:o,canWriteTo:l,canCreateDelete:c,isAlwaysAvailable:h,hasCreationTime:u,hasUpdateTime:g,isTextConnected:m,userId:p,hasRuntimeValue:f,runtimeValue:T,creationTimestamp:A,updateTimestamp:N,textEntries:y})}return!0}get vars(){return this._vars}}class GE extends U{constructor(e){super(e,v4)}getParser(){return this.parser}}class M4{constructor(){this._vars=[]}flush(){return this._vars=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean(),h=e.readBoolean(),u=e.readBoolean(),g=e.readBoolean(),m=e.readBoolean(),p=e.readInt(),f=e.readBoolean();let T;f&&(T=e.readString());const I=e.readString(),O=e.readString(),A=I.length?Number(I):void 0,N=O.length?Number(O):void 0,P=e.readInt(),y=[];for(let D=0;D<P;D++){const x=e.readInt(),w=e.readString();y.push({index:x,text:w})}this._vars.push({name:i,availability:n,hasValue:o,canWriteTo:l,canCreateDelete:c,isAlwaysAvailable:h,hasCreationTime:u,hasUpdateTime:g,isTextConnected:m,userId:p,hasRuntimeValue:f,runtimeValue:T,creationTimestamp:A,updateTimestamp:N,textEntries:y})}return!0}get vars(){return this._vars}}class BE extends U{constructor(e){super(e,M4)}getParser(){return this.parser}}class D4{flush(){return this._variableName="",this._assignments=[],!0}parse(e){if(!e)return!1;this._variableName=e.readString();const t=e.readInt();this._assignments=[];for(let r=0;r<t;r++){const i=e.readInt(),n=e.readInt(),l=e.readBoolean()?e.readInt():null,c=e.readString();this._assignments.push({userId:i,roomIndex:n,value:l,label:c})}return!0}get variableName(){return this._variableName}get assignments(){return this._assignments}}class IP extends U{constructor(e){super(e,D4)}getParser(){return this.parser}}class P4{constructor(){this._vars=[]}flush(){return this._vars=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean(),h=e.readBoolean(),u=e.readBoolean(),g=e.readBoolean(),m=e.readBoolean(),p=e.readInt(),f=e.readBoolean();let T;f&&(T=e.readString());const I=e.readString(),O=e.readString(),A=I.length?Number(I):void 0,N=O.length?Number(O):void 0,P=e.readInt(),y=[];for(let D=0;D<P;D++){const x=e.readInt(),w=e.readString();y.push({index:x,text:w})}this._vars.push({name:i,availability:n,hasValue:o,canWriteTo:l,canCreateDelete:c,isAlwaysAvailable:h,hasCreationTime:u,hasUpdateTime:g,isTextConnected:m,wiredItemId:p,hasRuntimeValue:f,runtimeValue:T,creationTimestamp:A,updateTimestamp:N,textEntries:y})}return!0}get vars(){return this._vars}}class VE extends U{constructor(e){super(e,P4)}getParser(){return this.parser}}class L4{constructor(){this._vars=[]}flush(){return this._vars=[],!0}parse(e){if(!e)return!1;const t=e.readInt();for(let r=0;r<t;r++){const i=e.readString(),n=e.readString(),o=e.readBoolean(),l=e.readBoolean(),c=e.readBoolean(),h=e.readBoolean(),u=e.readBoolean(),g=e.readBoolean(),m=e.readBoolean(),p=e.readInt(),f=e.readBoolean();let T;f&&(T=e.readString());const I=e.readString(),O=e.readString(),A=I.length?Number(I):void 0,N=O.length?Number(O):void 0,P=e.readInt(),y=[];for(let D=0;D<P;D++){const x=e.readInt(),w=e.readString();y.push({index:x,text:w})}this._vars.push({name:i,availability:n,hasValue:o,canWriteTo:l,canCreateDelete:c,isAlwaysAvailable:h,hasCreationTime:u,hasUpdateTime:g,isTextConnected:m,wiredItemId:p,hasRuntimeValue:f,runtimeValue:T,creationTimestamp:A,updateTimestamp:N,textEntries:y})}return!0}get vars(){return this._vars}}class HE extends U{constructor(e){super(e,L4)}getParser(){return this.parser}}class TP{constructor(e){const t=JSON.stringify(e);this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=[]}}class RP{constructor(e){const t=JSON.stringify(e);this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=[]}}class bf{constructor(e,t){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class SP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class eg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class OP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Qn{constructor(e,t=""){this._data=[e,e?t:""]}getMessageArray(){return this._data}dispose(){}}class yf{constructor(e,t=0){this._data=e?[e,t]:[e]}getMessageArray(){return this._data}dispose(){}}class vf{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class CP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class Mf{constructor(e,t=0){this._data=e?[e,t]:[e]}getMessageArray(){return this._data}dispose(){}}class jE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AP{constructor(e){this._data=[e]}getMessageArray(){return this._data}dispose(){}}class U4{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(S.ABOUT_ALERT,gP),this._events.set(S.GET_FURNIFIXTOOL_FURNI_DATA,VN),this._events.set(S.USER_ON_CLICKTHROUGH,sb),this._events.set(S.USER_WALKKEYS,ib),this._events.set(S.USER_VIMKEYS,rb),this._events.set(S.ROOM_FURNI_VARIABLES,Z_),this._events.set(S.ROOM_INTERNAL_FURNI_VARIABLES,kE),this._events.set(S.ROOM_USER_VARIABLES,GE),this._events.set(S.ROOM_INTERNAL_USER_VARIABLES,BE),this._events.set(S.ROOM_GLOBAL_VARIABLES,VE),this._events.set(S.ROOM_INTERNAL_GLOBAL_VARIABLES,HE),this._events.set(S.FURNI_WITH_VARIABLES,FE),this._events.set(S.USER_WITH_VARIABLES,IP),this._events.set(S.GET_FURNI_VARIABLE_BY_CLICK,fP),this._events.set(S.GET_USER_VARIABLE_BY_CLICK,EP),this._events.set(S.GET_GLOBAL_VARIABLES_AND_VALUES,pP),this._events.set(S.BLACKJACK_SESSION_STATUS,sz),this._events.set(S.BLACKJACK_BET_PROMPT,rz),this._events.set(S.INTERSTITIAL_MESSAGE,aW),this._events.set(S.ROOM_AD_ERROR,oW),this._events.set(S.AVAILABILITY_STATUS,FO),this._events.set(S.AVAILABILITY_TIME,lW),this._events.set(S.HOTEL_CLOSED_AND_OPENS,kO),this._events.set(S.HOTEL_CLOSES_AND_OPENS_AT,GO),this._events.set(S.HOTEL_WILL_CLOSE_MINUTES,BO),this._events.set(S.HOTEL_MAINTENANCE,VO),this._events.set(S.USER_CHANGE_NAME,Mn),this._events.set(S.CHECK_USER_NAME,HO),this._events.set(S.USER_FIGURE,zp),this._events.set(S.USER_OUTFITS,cW),this._events.set(S.ADD_BOT_TO_INVENTORY,WO),this._events.set(S.USER_BOTS,jO),this._events.set(S.BOT_RECEIVED,uW),this._events.set(S.REMOVE_BOT_FROM_INVENTORY,YO),this._events.set(S.CFH_SANCTION,zO),this._events.set(S.CFH_TOPICS,KO),this._events.set(S.CFH_SANCTION_STATUS,qO),this._events.set(S.CAMERA_PUBLISH_STATUS,XO),this._events.set(S.CAMERA_PURCHASE_OK,QO),this._events.set(S.CAMERA_STORAGE_URL,$O),this._events.set(S.COMPETITION_STATUS,dW),this._events.set(S.INIT_CAMERA,JO),this._events.set(S.THUMBNAIL_STATUS,_W),this._events.set(S.CAMERA_SNAPSHOT,hW),this._events.set(S.CAMPAIGN_CALENDAR_DATA,ZO),this._events.set(S.CAMPAIGN_CALENDAR_DOOR_OPENED,eC),this._events.set(S.BONUS_RARE_INFO,tC),this._events.set(S.BUILDERS_CLUB_FURNI_COUNT,sC),this._events.set(S.BUILDERS_CLUB_SUBSCRIPTION,rC),this._events.set(S.BUNDLE_DISCOUNT_RULESET,gW),this._events.set(S.CATALOG_PAGE,iC),this._events.set(S.CATALOG_PAGE_LIST,nC),this._events.set(S.CATALOG_EARLIEST_EXPIRY,mW),this._events.set(S.CATALOG_PUBLISHED,aC),this._events.set(S.CLUB_GIFT_INFO,Kp),this._events.set(S.CLUB_GIFT_SELECTED,oC),this._events.set(S.GIFT_RECEIVER_NOT_FOUND,lC),this._events.set(S.GIFT_WRAPPER_CONFIG,cC),this._events.set(S.CLUB_EXTENDED_OFFER,pW),this._events.set(S.CLUB_OFFERS,uC),this._events.set(S.IS_OFFER_GIFTABLE,EW),this._events.set(S.LIMITED_SOLD_OUT,hC),this._events.set(S.LIMITED_OFFER_APPEARING_NEXT,IW),this._events.set(S.NOT_ENOUGH_BALANCE,TW),this._events.set(S.PRODUCT_OFFER,dC),this._events.set(S.CATALOG_PURCHASE_ERROR,_C),this._events.set(S.CATALOG_PURCHASE_NOT_ALLOWED,gC),this._events.set(S.CATALOG_PURCHASE_OK,mC),this._events.set(S.ROOM_AD_PURCHASE,fC),this._events.set(S.SEASONAL_CALENDAR_OFFER,RW),this._events.set(S.CATALOG_RECEIVE_PET_BREEDS,pC),this._events.set(S.TARGET_OFFER,EC),this._events.set(S.TARGET_OFFER_NOT_FOUND,SW),this._events.set(S.REDEEM_VOUCHER_ERROR,IC),this._events.set(S.REDEEM_VOUCHER_OK,TC),this._events.set(S.CLIENT_PING,RC),this._events.set(S.COMPETITION_ENTRY_SUBMIT,OW),this._events.set(S.COMPETITION_VOTING_INFO,CW),this._events.set(S.COMPETITION_TIMING_CODE,AW),this._events.set(S.COMPETITION_USER_PART_OF,NW),this._events.set(S.COMPETITION_NO_OWNED_ROOMS,bW),this._events.set(S.COMPETITION_SECONDS_UNTIL,yW),this._events.set(S.CRAFTABLE_PRODUCTS,SC),this._events.set(S.CRAFTING_RECIPE,OC),this._events.set(S.CRAFTING_RECIPES_AVAILABLE,CC),this._events.set(S.CRAFTING_RESULT,AC),this._events.set(S.DESKTOP_VIEW,Fu),this._events.set(S.MESSENGER_ACCEPT_FRIENDS,vW),this._events.set(S.MESSENGER_FIND_FRIENDS,MW),this._events.set(S.MESSENGER_FOLLOW_FAILED,DW),this._events.set(S.MESSENGER_FRIENDS,NC),this._events.set(S.MESSENGER_UPDATE,bC),this._events.set(S.MESSENGER_FRIEND_NOTIFICATION,PW),this._events.set(S.MESSENGER_REQUESTS,yC),this._events.set(S.MESSENGER_SEARCH,vC),this._events.set(S.MESSENGER_INSTANCE_MESSAGE_ERROR,LW),this._events.set(S.MESSENGER_MESSAGE_ERROR,UW),this._events.set(S.MESSENGER_INIT,MC),this._events.set(S.MESSENGER_MINIMAIL_NEW,xW),this._events.set(S.MESSENGER_MINIMAIL_COUNT,wW),this._events.set(S.MESSENGER_CHAT,qp),this._events.set(S.MESSENGER_REQUEST,Xp),this._events.set(S.MESSENGER_INVITE_ERROR,DC),this._events.set(S.MESSENGER_INVITE,Qp),this._events.set(S.ACHIEVEMENTRESOLUTIONCOMPLETED,WW),this._events.set(S.ACHIEVEMENTRESOLUTIONPROGRESS,jW),this._events.set(S.ACHIEVEMENTRESOLUTIONS,YW),this._events.set(S.LOAD_GAME_URL,$p),this._events.set(S.LOADGAME,$W),this._events.set(S.UNLOADGAME,JW),this._events.set(S.GAME_CENTER_GAME_LIST,LC),this._events.set(S.GAMESTATUSMESSAGE,UC),this._events.set(S.GAME_CENTER_ACHIEVEMENTS,ZW),this._events.set(S.GAME_CENTER_STATUS,PC),this._events.set(S.GAME_CENTER_IN_ARENA_QUEUE,kW),this._events.set(S.GAME_CENTER_STOP_COUNTER,VW),this._events.set(S.GAME_CENTER_USER_LEFT_GAME,HW),this._events.set(S.GAME_CENTER_DIRECTORY_STATUS,FW),this._events.set(S.GAME_CENTER_STARTING_GAME_FAILED,BW),this._events.set(S.GAME_CENTER_JOINING_FAILED,GW),this._events.set(S.GAMEACHIEVEMENTS,zW),this._events.set(S.GAMEINVITE,KW),this._events.set(S.JOINEDQUEUEMESSAGE,qW),this._events.set(S.JOININGQUEUEFAILED,XW),this._events.set(S.LEFTQUEUE,QW),this._events.set(S.WEEKLY_GAME_REWARD,ij),this._events.set(S.WEEKLY_GAME_REWARD_WINNERS,nj),this._events.set(S.WEEKLY_COMPETITIVE_LEADERBOARD,rj),this._events.set(S.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,sj),this._events.set(S.WEEKLY_GAME2_FRIENDS_LEADERBOARD,ej),this._events.set(S.WEEKLY_GAME2_LEADERBOARD,tj),this._events.set(S.GROUP_INFO,kc),this._events.set(S.GROUP_MEMBER_REMOVE_CONFIRM,wC),this._events.set(S.GROUP_MEMBERS,FC),this._events.set(S.GROUP_CREATE_OPTIONS,xC),this._events.set(S.GROUP_BADGE_PARTS,Jp),this._events.set(S.GROUP_SETTINGS,GC),this._events.set(S.GROUP_PURCHASED,kC),this._events.set(S.GROUP_BADGES,Fb),this._events.set(S.GROUP_DEACTIVATE,BC),this._events.set(S.GROUP_MEMBERSHIP_REQUESTED,QY),this._events.set(S.GROUP_DETAILS_CHANGED,XY),this._events.set(S.GROUP_HABBO_JOIN_FAILED,ZY),this._events.set(S.GROUP_FORUM_DATA,cj),this._events.set(S.GROUP_FORUM_LIST,uj),this._events.set(S.GROUP_FORUM_THREADS,hj),this._events.set(S.GROUP_FORUM_POST,dj),this._events.set(S.GROUP_FORUM_POST_THREAD,_j),this._events.set(S.GROUP_FORUM_THREAD_MESSAGES,gj),this._events.set(S.GROUP_FORUM_UNREAD_COUNT,mj),this._events.set(S.GROUP_FORUM_UPDATE_MESSAGE,fj),this._events.set(S.GROUP_FORUM_UPDATE_THREAD,pj),this._events.set(S.CFH_DISABLED_NOTIFY,HC),this._events.set(S.CFH_PENDING_CALLS_DELETED,WC),this._events.set(S.CFH_PENDING_CALLS,jC),this._events.set(S.CFH_REPLY,YC),this._events.set(S.CFH_RESULT_MESSAGE,zC),this._events.set(S.GUIDE_ON_DUTY_STATUS,KC),this._events.set(S.GUIDE_SESSION_ATTACHED,qC),this._events.set(S.GUIDE_SESSION_DETACHED,XC),this._events.set(S.GUIDE_SESSION_ENDED,Zp),this._events.set(S.GUIDE_SESSION_ERROR,eE),this._events.set(S.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,QC),this._events.set(S.GUIDE_SESSION_MESSAGE,$C),this._events.set(S.GUIDE_SESSION_PARTNER_IS_TYPING,JC),this._events.set(S.GUIDE_SESSION_REQUESTER_ROOM,ZC),this._events.set(S.GUIDE_SESSION_STARTED,tE),this._events.set(S.GUIDE_TICKET_CREATION_RESULT,yj),this._events.set(S.GUIDE_TICKET_RESOLUTION,vj),this._events.set(S.GUIDE_REPORTING_STATUS,bj),this._events.set(S.HOTEL_MERGE_NAME_CHANGE,Mj),this._events.set(S.ISSUE_CLOSE_NOTIFICATION,eA),this._events.set(S.QUIZ_DATA,Dj),this._events.set(S.QUIZ_RESULTS,Pj),this._events.set(S.CHAT_REVIEW_SESSION_DETACHED,Sj),this._events.set(S.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,Oj),this._events.set(S.CHAT_REVIEW_SESSION_RESULTS,Cj),this._events.set(S.CHAT_REVIEW_SESSION_STARTED,Aj),this._events.set(S.CHAT_REVIEW_SESSION_VOTING_STATUS,Nj),this._events.set(S.ACHIEVEMENT_PROGRESSED,tA),this._events.set(S.ACHIEVEMENT_LIST,sA),this._events.set(S.USER_ACHIEVEMENT_SCORE,rA),this._events.set(S.USER_EFFECT_ACTIVATE,Lj),this._events.set(S.USER_EFFECT_LIST_ADD,Uj),this._events.set(S.USER_EFFECT_LIST_REMOVE,xj),this._events.set(S.USER_EFFECT_LIST,Fj),this._events.set(S.AVATAR_EFFECT_SELECTED,wj),this._events.set(S.USER_BADGES,nA),this._events.set(S.USER_BADGES_ADD,iA),this._events.set(S.BADGE_POINT_LIMITS,Y_),this._events.set(S.BADGE_REQUEST_FULFILLED,kj),this._events.set(S.USER_CLOTHING,aA),this._events.set(S.USER_FURNITURE_ADD,sE),this._events.set(S.USER_FURNITURE,Gd),this._events.set(S.USER_FURNITURE_REFRESH,oA),this._events.set(S.USER_FURNITURE_REMOVE,rE),this._events.set(S.USER_FURNITURE_POSTIT_PLACED,lA),this._events.set(S.USER_PETS,hA),this._events.set(S.USER_PET_REMOVE,_A),this._events.set(S.USER_PET_ADD,uA),this._events.set(S.PET_RECEIVED,dA),this._events.set(S.PET_PLACING_ERROR,fN),this._events.set(S.YOUTUBE_CONTROL_VIDEO,qN),this._events.set(S.YOUTUBE_DISPLAY_PLAYLISTS,XN),this._events.set(S.YOUTUBE_DISPLAY_VIDEO,QN),this._events.set(S.TRADE_ACCEPTED,gA),this._events.set(S.TRADE_CLOSED,mA),this._events.set(S.TRADE_COMPLETED,fA),this._events.set(S.TRADE_CONFIRMATION,pA),this._events.set(S.TRADE_LIST_ITEM,EA),this._events.set(S.TRADE_NOT_OPEN,IA),this._events.set(S.TRADE_OPEN_FAILED,RA),this._events.set(S.TRADE_OPEN,TA),this._events.set(S.TRADE_OTHER_NOT_ALLOWED,SA),this._events.set(S.TRADE_YOU_NOT_ALLOWED,OA),this._events.set(S.TRADE_NO_SUCH_ITEM,Hj),this._events.set(S.COMMUNITY_GOAL_VOTE_EVENT,Wj),this._events.set(S.PROMO_ARTICLES,CA),this._events.set(S.MARKETPLACE_AFTER_ORDER_STATUS,AA),this._events.set(S.MARKETPLACE_CANCEL_SALE,NA),this._events.set(S.MARKETPLACE_SELL_ITEM,jj),this._events.set(S.MARKETPLACE_CONFIG,bA),this._events.set(S.MARKETPLACE_ITEM_STATS,Yj),this._events.set(S.MARKETPLACE_ITEM_POSTED,yA),this._events.set(S.MARKETPLACE_ITEMS_SEARCHED,vA),this._events.set(S.MARKETPLACE_OWN_ITEMS,MA),this._events.set(S.USER_BANNED,jA),this._events.set(S.MODERATION_CAUTION,wA),this._events.set(S.MODTOOL_ROOM_INFO,GA),this._events.set(S.MODTOOL_USER_CHATLOG,YA),this._events.set(S.MODTOOL_ROOM_CHATLOG,HA),this._events.set(S.MODERATION_USER_INFO,VA),this._events.set(S.MODERATION_TOOL,FA),this._events.set(S.MODTOOL_VISITED_ROOMS_USER,WA),this._events.set(S.CFH_CHATLOG,DA),this._events.set(S.ISSUE_DELETED,PA),this._events.set(S.ISSUE_INFO,LA),this._events.set(S.ISSUE_PICK_FAILED,UA),this._events.set(S.MODERATOR_ACTION_RESULT,xA),this._events.set(S.MODERATOR_MESSAGE,kA),this._events.set(S.MODERATOR_TOOL_PREFERENCES,BA),this._events.set(S.MYSTERY_BOX_KEYS,qA),this._events.set(S.GOTMYSTERYBOXPRIZEMESSAGE,KA),this._events.set(S.CANCELMYSTERYBOXWAITMESSAGE,zA),this._events.set(S.SHOWMYSTERYBOXWAITMESSAGE,XA),this._events.set(S.CAN_CREATE_ROOM,zj),this._events.set(S.CAN_CREATE_ROOM_EVENT,QA),this._events.set(S.CATEGORIES_WITH_VISITOR_COUNT,Kj),this._events.set(S.COMPETITION_ROOMS_DATA,qj),this._events.set(S.CONVERTED_ROOM_ID,Xj),this._events.set(S.ROOM_DOORBELL,iE),this._events.set(S.USER_FAVORITE_ROOM,Qj),this._events.set(S.USER_FAVORITE_ROOM_COUNT,$j),this._events.set(S.ROOM_DOORBELL_REJECTED,Bd),this._events.set(S.ROOM_CREATED,$A),this._events.set(S.ROOM_INFO,wa),this._events.set(S.GUEST_ROOM_SEARCH_RESULT,Jj),this._events.set(S.USER_HOME_ROOM,JA),this._events.set(S.ROOM_EVENT_CANCEL,iY),this._events.set(S.ROOM_EVENT,sN),this._events.set(S.ROOM_INFO_UPDATED,iN),this._events.set(S.THUMBNAIL_UPDATE_RESULT,nY),this._events.set(S.NAVIGATOR_EVENT_CATEGORIES,nN),this._events.set(S.NAVIGATOR_CATEGORIES,aN),this._events.set(S.NAVIGATOR_COLLAPSED,Zj),this._events.set(S.NAVIGATOR_LIFTED,eY),this._events.set(S.NAVIGATOR_METADATA,ZA),this._events.set(S.NAVIGATOR_OPEN_ROOM_CREATOR,eN),this._events.set(S.NAVIGATOR_SEARCHES,tY),this._events.set(S.NAVIGATOR_SEARCH,tN),this._events.set(S.NAVIGATOR_SETTINGS,sY),this._events.set(S.GENERIC_ALERT,hN),this._events.set(S.MOTD_MESSAGES,_N),this._events.set(S.NOTIFICATION_LIST,gN),this._events.set(S.UNSEEN_ITEMS,EN),this._events.set(S.ACHIEVEMENT_NOTIFICATION,oN),this._events.set(S.INFO_FEED_ENABLE,dN),this._events.set(S.CLUB_GIFT_NOTIFICATION,cN),this._events.set(S.ACTIVITY_POINT_NOTIFICATION,nE),this._events.set(S.BOT_ERROR,lN),this._events.set(S.PET_LEVEL_NOTIFICATION,mN),this._events.set(S.NOTIFICATION_OFFER_REWARD_DELIVERED,oY),this._events.set(S.NOTIFICATION_SIMPLE_ALERT,pN),this._events.set(S.NOTIFICATION_ELEMENT_POINTER,aY),this._events.set(S.USER_PERKS,aE),this._events.set(S.PET_TRAINING_PANEL,ON),this._events.set(S.PET_LEVEL_UPDATE,RN),this._events.set(S.PET_SCRATCH_FAILED,SN),this._events.set(S.PET_OPEN_PACKAGE_REQUESTED,IN),this._events.set(S.PET_OPEN_PACKAGE_RESULT,TN),this._events.set(S.PET_BREEDING_RESULT,JN),this._events.set(S.QUESTION,yN),this._events.set(S.POLL_CONTENTS,CN),this._events.set(S.POLL_ERROR,AN),this._events.set(S.POLL_OFFER,NN),this._events.set(S.POLL_START_ROOM,DN),this._events.set(S.QUESTION_ANSWERED,bN),this._events.set(S.QUESTION_FINISHED,vN),this._events.set(S.POLL_ROOM_RESULT,MN),this._events.set(S.COMMUNITY_GOAL_EARNED_PRIZES,pY),this._events.set(S.COMMUNITY_GOAL_PROGRESS,EY),this._events.set(S.CONCURRENT_USERS_GOAL_PROGRESS,IY),this._events.set(S.QUEST_DAILY,OY),this._events.set(S.QUEST_CANCELLED,RY),this._events.set(S.QUEST_COMPLETED,SY),this._events.set(S.COMMUNITY_GOAL_HALL_OF_FAME,PN),this._events.set(S.EPIC_POPUP,TY),this._events.set(S.SEASONAL_QUESTS,NY),this._events.set(S.QUESTS,AY),this._events.set(S.QUEST,CY),this._events.set(S.ROOM_ENTER_ERROR,LN),this._events.set(S.ROOM_ENTER,Wd),this._events.set(S.ROOM_FORWARD,UN),this._events.set(S.ROOM_DOORBELL_ACCEPTED,Vd),this._events.set(S.ROOM_RIGHTS_CLEAR,ku),this._events.set(S.ROOM_RIGHTS_OWNER,Hd),this._events.set(S.ROOM_RIGHTS,Gu),this._events.set(S.BOT_COMMAND_CONFIGURATION,xN),this._events.set(S.BOT_SKILL_LIST_UPDATE,yY),this._events.set(S.BOT_FORCE_OPEN_CONTEXT_MENU,bY),this._events.set(S.ROOM_SETTINGS_CHAT,wN),this._events.set(S.ROOM_INFO_OWNER,lE),this._events.set(S.ROOM_SCORE,FN),this._events.set(S.ROOM_ROLLING,Fm),this._events.set(S.FURNITURE_FLOOR_ADD,Bm),this._events.set(S.FURNITURE_FLOOR,Vm),this._events.set(S.FURNITURE_FLOOR_REMOVE,Hm),this._events.set(S.FURNITURE_FLOOR_UPDATE,Wm),this._events.set(S.BULK_UPDATE_FLOOR_ITEMS,Gm),this._events.set(S.BULK_SLIDE_ITEMS,Um),this._events.set(S.BULK_SLIDE_USERS_AND_ITEMS,xm),this._events.set(S.ITEM_WALL_ADD,qm),this._events.set(S.ITEM_WALL,Xm),this._events.set(S.ITEM_WALL_REMOVE,Qm),this._events.set(S.ITEM_WALL_UPDATE,$m),this._events.set(S.FURNITURE_ALIASES,jm),this._events.set(S.FURNITURE_DATA,Ym),this._events.set(S.FURNITURE_ITEMDATA,zm),this._events.set(S.ITEM_STACK_HELPER,BN),this._events.set(S.FURNITURE_STATE,Km),this._events.set(S.ITEM_DIMMER_SETTINGS,KN),this._events.set(S.FURNITURE_STATE_2,km),this._events.set(S.LOVELOCK_FURNI_FINISHED,WN),this._events.set(S.LOVELOCK_FURNI_FRIEND_COMFIRMED,jN),this._events.set(S.LOVELOCK_FURNI_START,YN),this._events.set(S.OBJECTS_DATA_UPDATE,wm),this._events.set(S.FURNITURE_GROUP_CONTEXT_MENU_INFO,HN),this._events.set(S.FURNITURE_POSTIT_STICKY_POLE_OPEN,zN),this._events.set(S.ROOM_SPECTATOR,ab),this._events.set(S.CUSTOM_USER_NOTIFICATION,GN),this._events.set(S.ROOM_MESSAGE_NOTIFICATION,UY),this._events.set(S.ROOM_POPULAR_TAGS_RESULT,rY),this._events.set(S.ROOM_RIGHTS_LIST,Tb),this._events.set(S.ROOM_RIGHTS_LIST_ADD,Eb),this._events.set(S.ROOM_RIGHTS_LIST_REMOVE,Ib),this._events.set(S.ROOM_BAN_LIST,pb),this._events.set(S.ROOM_SETTINGS_SAVE_ERROR,Sb),this._events.set(S.ROOM_SETTINGS,Rb),this._events.set(S.ROOM_SETTINGS_SAVE,BY),this._events.set(S.ROOM_SETTINGS_ERROR,GY),this._events.set(S.SHOW_ENFORCE_ROOM_CATEGORY,VY),this._events.set(S.ROOM_BAN_REMOVE,HY),this._events.set(S.ROOM_MUTED,FY),this._events.set(S.NO_SUCH_FLAT,kY),this._events.set(S.FAVORITE_GROUP_UDPATE,kN),this._events.set(S.ROOM_MODEL_DOOR,Yd),this._events.set(S.ROOM_HEIGHT_MAP,Jm),this._events.set(S.ROOM_HEIGHT_MAP_UPDATE,Zm),this._events.set(S.BULK_HEIGHT_MAP_UPDATE,tf),this._events.set(S.ROOM_MODEL,jd),this._events.set(S.ROOM_MODEL_NAME,Ic),this._events.set(S.ROOM_PAINT,ef),this._events.set(S.ROOM_THICKNESS,zd),this._events.set(S.ROOM_GET_FILTER_WORDS,rN),this._events.set(S.ROOM_MODEL_BLOCKED_TILES,$N),this._events.set(S.PET_FIGURE_UPDATE,Kd),this._events.set(S.PET_INFO,eb),this._events.set(S.PET_STATUS,tb),this._events.set(S.PET_EXPERIENCE,ZN),this._events.set(S.PLAYING_GAME,nb),this._events.set(S.UNIT_DANCE,Qd),this._events.set(S.UNIT_EFFECT,rf),this._events.set(S.UNIT,$d),this._events.set(S.UNIT_EXPRESSION,nf),this._events.set(S.USER_FOCUS_STATUS,lf),this._events.set(S.UNIT_HAND_ITEM,af),this._events.set(S.UNIT_IDLE,of),this._events.set(S.UNIT_INFO,Jd),this._events.set(S.UNIT_NUMBER,cf),this._events.set(S.UNIT_REMOVE,Zd),this._events.set(S.UNIT_STATUS,uf),this._events.set(S.HAND_ITEM_RECEIVED,cb),this._events.set(S.FLOOD_CONTROL,ob),this._events.set(S.REMAINING_MUTE,lb),this._events.set(S.UNIT_CHAT,cE),this._events.set(S.UNIT_CHAT_SHOUT,qd),this._events.set(S.UNIT_CHAT_WHISPER,Xd),this._events.set(S.UNIT_TYPING,sf),this._events.set(S.WIRED_ACTION,ub),this._events.set(S.WIRED_CONDITION,db),this._events.set(S.WIRED_SELECTOR,_b),this._events.set(S.WIRED_ADDON,hb),this._events.set(S.WIRED_TRIGGER,gb),this._events.set(S.WIRED_OPEN,mb),this._events.set(S.WIRED_REWARD,uE),this._events.set(S.WIRED_SAVE,fb),this._events.set(S.WIRED_ERROR,wY),this._events.set(S.AUTHENTICATED,Ob),this._events.set(S.JUKEBOX_PLAYLIST_FULL,Cb),this._events.set(S.JUKEBOX_SONG_DISKS,Ab),this._events.set(S.NOW_PLAYING,Nb),this._events.set(S.OFFICIAL_SONG_ID,bb),this._events.set(S.PLAYLIST,WY),this._events.set(S.PLAYLIST_SONG_ADDED,jY),this._events.set(S.TRAX_SONG_INFO,yb),this._events.set(S.USER_SONG_DISKS_INVENTORY,vb),this._events.set(S.HELPER_TALENT_TRACK,KY),this._events.set(S.TALENT_TRACK_LEVEL,zY),this._events.set(S.TALENT_TRACK_LEVEL_UP,YY),this._events.set(S.IN_CLIENT_LINK,Gb),this._events.set(S.USER_IGNORED,kb),this._events.set(S.USER_IGNORED_RESULT,mE),this._events.set(S.USER_RESPECT,fE),this._events.set(S.USER_PERMISSIONS,hE),this._events.set(S.USER_BADGES_CURRENT,_E),this._events.set(S.USER_INFO,Tc),this._events.set(S.UNIT_CHANGE_NAME,K_),this._events.set(S.USER_SETTINGS,gE),this._events.set(S.USER_PROFILE,Pb),this._events.set(S.MESSENGER_RELATIONSHIPS,dE),this._events.set(S.GIFT_OPENED,cA),this._events.set(S.USER_CREDITS,Bb),this._events.set(S.USER_CURRENCY,Vb),this._events.set(S.USER_SUBSCRIPTION,Hb),this._events.set(S.USER_WARDROBE_PAGE,zb),this._events.set(S.USER_CLASSIFICATION,tz),this._events.set(S.GET_USER_TAGS,Lb),this._events.set(S.SCR_SEND_KICKBACK_INFO,Yb),this._events.set(S.PET_RESPECTED,Wb),this._events.set(S.PET_SUPPLEMENT,jb),this._events.set(S.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,Mb),this._events.set(S.GENERIC_ERROR,kd),this._events.set(S.GROUP_LIST,wb),this._events.set(S.CATALOG_APPROVE_NAME_RESULT,Db),this._events.set(S.CONNECTION_ERROR,uN),this._events.set(S.GUILD_EDIT_FAILED,$Y),this._events.set(S.GUILD_MEMBER_MGMT_FAILED,JY),this._events.set(S.EXTENDED_PROFILE_CHANGED,xb),this._events.set(S.NOOBNESS_LEVEL,VC),this._events.set(S.DISCONNECT_REASON,Ij),this._events.set(S.HANDSHAKE_INIT_DIFFIE,Rj),this._events.set(S.HANDSHAKE_COMPLETE_DIFFIE,Ej),this._events.set(S.HANDSHAKE_IDENTITY_ACCOUNT,Tj),this._events.set(S.NEW_USER_EXPERIENCE_GIFT_OFFER,_Y),this._events.set(S.NEW_USER_EXPERIENCE_NOT_COMPLETE,mY),this._events.set(S.RESTORE_CLIENT,lY),this._events.set(S.FIREWORK_CHARGE_DATA,fW),this._events.set(S.PHONE_COLLECTION_STATE,aj),this._events.set(S.PHONE_TRY_NUMBER_RESULT,oj),this._events.set(S.PHONE_TRY_VERIFICATION_CODE_RESULT,lj),this._events.set(S.WELCOME_GIFT_CHANGE_EMAIL_RESULT,ez),this._events.set(S.WELCOME_GIFT_STATUS,xY),this._events.set(S.RENTABLE_SPACE_RENT_OK,PY),this._events.set(S.RENTABLE_SPACE_STATUS,LY),this._events.set(S.RENTABLE_SPACE_RENT_FAILED,DY),this._events.set(S.RECYCLER_STATUS,z_),this._events.set(S.RECYCLER_FINISHED,oE),this._events.set(S.EMAIL_STATUS,Ub),this._events.set(S.CHANGE_EMAIL_RESULT,qY),this._events.set(S.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,vY),this._events.set(S.FURNIFIXTOOL_BATCH_SAVE_RESPONSE,mP)}registerComposers(){this._composers.set(R.KEYBOARD_INPUT,jM),this._composers.set(R.BLACKJACK_BET,Qz),this._composers.set(R.BLACKJACK_HIT,$z),this._composers.set(R.BLACKJACK_STAND,Jz),this._composers.set(R.BLACKJACK_JOIN_QUEUE_WITH_BET,Zz),this._composers.set(R.CLICK_FURNI,Rf),this._composers.set(R.INSPECT_FURNI_VARIABLES,Q3),this._composers.set(R.IS_ON_FURNIFIXTOOL,bf),this._composers.set(R.FURNIFIXTOOL_SAVE,RP),this._composers.set(R.FURNIFIXTOOL_BATCH_SAVE,TP),this._composers.set(R.REQUEST_ROOM_VARIABLES,eg),this._composers.set(R.REQUEST_USER_VARIABLES,WE),this._composers.set(R.REQUEST_FURNI_WITH_VARIABLES,SP),this._composers.set(R.REQUEST_USER_WITH_VARIABLES,OP),this._composers.set(R.REQUEST_GLOBAL_VARIABLES,jE),this._composers.set(R.REQUEST_GLOBAL_WITH_VARIABLES,AP),this._composers.set(R.TOGGLE_HIGHLIGHT_MODE,Qn),this._composers.set(R.TOGGLE_FURNI_INSPECTION_LOCK,yf),this._composers.set(R.INSPECT_USER_VARIABLES,CP),this._composers.set(R.TOGGLE_USER_INSPECTION_LOCK,Mf),this._composers.set(R.TOGGLE_GLOBAL_INSPECTION,vf),this._composers.set(R.AUTHENTICATION,f5),this._composers.set(R.INTERSTITIAL_SHOWN,nz),this._composers.set(R.GET_INTERSTITIAL,iz),this._composers.set(R.GET_WARDROBE,Qb),this._composers.set(R.SAVE_WARDROBE_OUTFIT,$b),this._composers.set(R.CHANGE_USERNAME,qb),this._composers.set(R.CHECK_USERNAME,Xb),this._composers.set(R.REQUEST_CAMERA_CONFIGURATION,ey),this._composers.set(R.RENDER_ROOM,e_),this._composers.set(R.RENDER_ROOM_THUMBNAIL,hf),this._composers.set(R.PURCHASE_PHOTO,Zb),this._composers.set(R.PUBLISH_PHOTO,Jb),this._composers.set(R.PHOTO_COMPETITION,az),this._composers.set(R.OPEN_CAMPAIGN_CALENDAR_DOOR,sy),this._composers.set(R.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,ty),this._composers.set(R.BUILDERS_CLUB_PLACE_ROOM_ITEM,ry),this._composers.set(R.BUILDERS_CLUB_PLACE_WALL_ITEM,iy),this._composers.set(R.BUILDERS_CLUB_QUERY_FURNI_COUNT,ny),this._composers.set(R.GET_CATALOG_INDEX,oy),this._composers.set(R.GET_CATALOG_PAGE,ly),this._composers.set(R.CATALOG_PURCHASE,ih),this._composers.set(R.CATALOG_PURCHASE_GIFT,gy),this._composers.set(R.GET_PRODUCT_OFFER,hy),this._composers.set(R.GET_CLUB_OFFERS,cy),this._composers.set(R.GET_CLUB_GIFT_INFO,pE),this._composers.set(R.CATALOG_REDEEM_VOUCHER,py),this._composers.set(R.GROUP_MEMBERSHIPS,LE),this._composers.set(R.GET_GIFT_WRAPPING_CONFIG,uy),this._composers.set(R.CATALOG_SELECT_VIP_GIFT,Ey),this._composers.set(R.CATALOG_REQUESET_PET_BREEDS,_y),this._composers.set(R.GET_BONUS_RARE_INFO,ay),this._composers.set(R.GET_BUNDLE_DISCOUNT_RULESET,oz),this._composers.set(R.GET_CATALOG_PAGE_EXPIRATION,lz),this._composers.set(R.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,cz),this._composers.set(R.GET_DIRECT_CLUB_BUY_AVAILABLE,uz),this._composers.set(R.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,hz),this._composers.set(R.GET_HABBO_CLUB_EXTEND_OFFER,dz),this._composers.set(R.GET_IS_OFFER_GIFTABLE,_z),this._composers.set(R.GET_LIMITED_OFFER_APPEARING_NEXT,gz),this._composers.set(R.GET_NEXT_TARGETED_OFFER,mz),this._composers.set(R.GET_ROOM_AD_PURCHASE_INFO,dy),this._composers.set(R.GET_SEASONAL_CALENDAR_DAILY_OFFER,fz),this._composers.set(R.GET_TARGETED_OFFER,EE),this._composers.set(R.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,pz),this._composers.set(R.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,Ez),this._composers.set(R.PURCHASE_ROOM_AD,my),this._composers.set(R.PURCHASE_TARGETED_OFFER,fy),this._composers.set(R.PURCHASE_VIP_MEMBERSHIP_EXTENSION,Iz),this._composers.set(R.ROOM_AD_PURCHASE_INITIATED,Tz),this._composers.set(R.SET_TARGETTED_OFFER_STATE,Rz),this._composers.set(R.SHOP_TARGETED_OFFER_VIEWED,Sz),this._composers.set(R.FORWARD_TO_A_COMPETITION_ROOM,Oz),this._composers.set(R.FORWARD_TO_A_SUBMITTABLE_ROOM,Cz),this._composers.set(R.FORWARD_TO_RANDOM_COMPETITION_ROOM,Az),this._composers.set(R.GET_CURRENT_TIMING_CODE,Nz),this._composers.set(R.GET_IS_USER_PART_OF_COMPETITION,bz),this._composers.set(R.GET_SECONDS_UNTIL,yz),this._composers.set(R.ROOM_COMPETITION_INIT,vz),this._composers.set(R.SUBMIT_ROOM_TO_COMPETITION,nh),this._composers.set(R.VOTE_FOR_ROOM,Mz),this._composers.set(R.CRAFT,Iy),this._composers.set(R.CRAFT_SECRET,Dz),this._composers.set(R.GET_CRAFTABLE_PRODUCTS,Ry),this._composers.set(R.GET_CRAFTING_RECIPE,Ty),this._composers.set(R.GET_CRAFTING_RECIPES_AVAILABLE,Pz),this._composers.set(R.FRIEND_FURNI_CONFIRM_LOCK,Oy),this._composers.set(R.ACCEPT_FRIEND,Cy),this._composers.set(R.DECLINE_FRIEND,df),this._composers.set(R.FIND_NEW_FRIENDS,Lz),this._composers.set(R.FOLLOW_FRIEND,q_),this._composers.set(R.FRIEND_LIST_UPDATE,Ay),this._composers.set(R.GET_FRIEND_REQUESTS,Ny),this._composers.set(R.HABBO_SEARCH,by),this._composers.set(R.MESSENGER_INIT,yy),this._composers.set(R.REMOVE_FRIEND,vy),this._composers.set(R.REQUEST_FRIEND,IE),this._composers.set(R.MESSENGER_CHAT,My),this._composers.set(R.SEND_ROOM_INVITE,Dy),this._composers.set(R.SET_RELATIONSHIP_STATUS,ac),this._composers.set(R.VISIT_USER,Uz),this._composers.set(R.ACHIEVEMENT_RESOLUTION_OPEN,wy),this._composers.set(R.ACCEPTGAMEINVITE,Bz),this._composers.set(R.GAMEUNLOADEDMESSAGE,Vz),this._composers.set(R.GETGAMEACHIEVEMENTSMESSAGE,Hz),this._composers.set(R.GAMES_LIST,Uy),this._composers.set(R.GETGAMESTATUSMESSAGE,xy),this._composers.set(R.GETUSERGAMEACHIEVEMENTSMESSAGE,Wz),this._composers.set(R.JOINQUEUEMESSAGE,Fy),this._composers.set(R.LEAVEQUEUEMESSAGE,jz),this._composers.set(R.RESETRESOLUTIONACHIEVEMENTMESSAGE,Yz),this._composers.set(R.GAMES_INIT,qz),this._composers.set(R.GETWEEKLYGAMEREWARDWINNERS,Xz),this._composers.set(R.GAME2GETACCOUNTGAMESTATUSMESSAGE,Ly),this._composers.set(R.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,kz),this._composers.set(R.GAME2EXITGAMEMESSAGE,Py),this._composers.set(R.GAME2GAMECHATMESSAGE,xz),this._composers.set(R.GAME2LOADSTAGEREADYMESSAGE,wz),this._composers.set(R.GAME2PLAYAGAINMESSAGE,Fz),this._composers.set(R.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,Gz),this._composers.set(R.GAME2GETWEEKLYFRIENDSLEADERBOARD,zz),this._composers.set(R.GAME2GETWEEKLYLEADERBOARD,Kz),this._composers.set(R.GET_GIFT,ky),this._composers.set(R.RESET_PHONE_NUMBER_STATE,e5),this._composers.set(R.SET_PHONE_NUMBER_VERIFICATION_STATUS,Gy),this._composers.set(R.TRY_PHONE_NUMBER,t5),this._composers.set(R.VERIFY_CODE,s5),this._composers.set(R.GET_FORUM_STATS,n5),this._composers.set(R.GET_FORUMS_LIST,i5),this._composers.set(R.GET_FORUM_MESSAGES,a5),this._composers.set(R.GET_FORUM_THREAD,o5),this._composers.set(R.GET_FORUM_THREADS,l5),this._composers.set(R.GET_UNREAD_FORUMS_COUNT,c5),this._composers.set(R.FORUM_MODERATE_MESSAGE,u5),this._composers.set(R.FORUM_MODERATE_THREAD,h5),this._composers.set(R.FORUM_POST_MESSAGE,d5),this._composers.set(R.UPDATE_FORUM_READ_MARKER,_5),this._composers.set(R.UPDATE_FORUM_SETTINGS,g5),this._composers.set(R.FORUM_UPDATE_THREAD,m5),this._composers.set(R.CLIENT_PONG,nv),this._composers.set(R.RELEASE_VERSION,rv),this._composers.set(R.SECURITY_TICKET,av),this._composers.set(R.USER_INFO,iv),this._composers.set(R.DISCONNECT,E5),this._composers.set(R.SECURITY_MACHINE,T5),this._composers.set(R.CLIENT_VARIABLES,R5),this._composers.set(R.HANDSHAKE_INIT_DIFFIE,I5),this._composers.set(R.HANDSHAKE_COMPLETE_DIFFIE,p5),this._composers.set(R.CALL_FOR_HELP_FROM_FORUM_MESSAGE,ov),this._composers.set(R.CALL_FOR_HELP_FROM_FORUM_THREAD,lv),this._composers.set(R.CALL_FOR_HELP_FROM_IM,cv),this._composers.set(R.CALL_FOR_HELP_FROM_PHOTO,uv),this._composers.set(R.CALL_FOR_HELP_FROM_SELFIE,S5),this._composers.set(R.CALL_FOR_HELP,hv),this._composers.set(R.CHAT_REVIEW_GUIDE_DECIDES,O5),this._composers.set(R.CHAT_REVIEW_GUIDE_DETACHED,C5),this._composers.set(R.CHAT_REVIEW_GUIDE_VOTE,A5),this._composers.set(R.CHAT_REVIEW_SESSION_CREATE,N5),this._composers.set(R.DELETE_PENDING_CALLS_FOR_HELP,dv),this._composers.set(R.GET_CFH_STATUS,_v),this._composers.set(R.GET_FAQ_CATEGORY,b5),this._composers.set(R.GET_FAQ_TEXT,y5),this._composers.set(R.GET_GUIDE_REPORTING_STATUS,v5),this._composers.set(R.GET_PENDING_CALLS_FOR_HELP,gv),this._composers.set(R.GET_QUIZ_QUESTIONS,M5),this._composers.set(R.GUIDE_SESSION_CREATE,mv),this._composers.set(R.GUIDE_SESSION_FEEDBACK,fv),this._composers.set(R.GUIDE_SESSION_GET_REQUESTER_ROOM,pv),this._composers.set(R.GUIDE_SESSION_GUIDE_DECIDES,Ev),this._composers.set(R.GUIDE_SESSION_INVITE_REQUESTER,Iv),this._composers.set(R.GUIDE_SESSION_IS_TYPING,D5),this._composers.set(R.GUIDE_SESSION_MESSAGE,Tv),this._composers.set(R.GUIDE_SESSION_ON_DUTY_UPDATE,gf),this._composers.set(R.GUIDE_SESSION_REPORT,P5),this._composers.set(R.GUIDE_SESSION_REQUESTER_CANCELS,Rv),this._composers.set(R.GUIDE_SESSION_RESOLVED,Sv),this._composers.set(R.POST_QUIZ_ANSWERS,L5),this._composers.set(R.SEARCH_FAQS,U5),this._composers.set(R.DESKTOP_VIEW,Sy),this._composers.set(R.GROUP_INFO,Rc),this._composers.set(R.GROUP_REQUEST,qy),this._composers.set(R.GROUP_MEMBER_REMOVE_CONFIRM,Yy),this._composers.set(R.GROUP_MEMBER_REMOVE,X_),this._composers.set(R.GROUP_MEMBERS,_f),this._composers.set(R.GROUP_ADMIN_ADD,By),this._composers.set(R.GROUP_ADMIN_REMOVE,Vy),this._composers.set(R.GROUP_REQUEST_ACCEPT,Xy),this._composers.set(R.GROUP_REQUEST_DECLINE,Qy),this._composers.set(R.GROUP_DELETE,zy),this._composers.set(R.GROUP_CREATE_OPTIONS,jy),this._composers.set(R.GROUP_PARTS,Hy),this._composers.set(R.GROUP_BUY,Wy),this._composers.set(R.GROUP_SETTINGS,tv),this._composers.set(R.GROUP_SAVE_BADGE,$y),this._composers.set(R.GROUP_SAVE_COLORS,Jy),this._composers.set(R.GROUP_SAVE_INFORMATION,Zy),this._composers.set(R.GROUP_SAVE_PREFERENCES,ev),this._composers.set(R.GROUP_FAVORITE,Ky),this._composers.set(R.GROUP_UNFAVORITE,sv),this._composers.set(R.GROUP_BADGES,iP),this._composers.set(R.APPROVE_ALL_MEMBERSHIP_REQUESTS,r5),this._composers.set(R.GROUP_UNBLOCK_MEMBER,E4),this._composers.set(R.ROOM_FAVORITE,Q5),this._composers.set(R.CAN_CREATE_ROOM,J5),this._composers.set(R.CANCEL_ROOM_EVENT,$5),this._composers.set(R.CONVERT_GLOBAL_ROOM_ID,rM),this._composers.set(R.COMPETITION_ROOM_SEARCH,Z5),this._composers.set(R.ROOM_CREATE,iM),this._composers.set(R.GET_USER_FLAT_CATS,oM),this._composers.set(R.GET_USER_EVENT_CATS,SE),this._composers.set(R.ROOM_FAVORITE_REMOVE,e3),this._composers.set(R.EDIT_ROOM_EVENT,nM),this._composers.set(R.FORWARD_TO_RANDOM_PROMOTED_ROOM,t3),this._composers.set(R.FORWARD_TO_SOME_ROOM,s3),this._composers.set(R.GET_CATEGORIES_WITH_USER_COUNT,r3),this._composers.set(R.GET_GUEST_ROOM,Bu),this._composers.set(R.GET_OFFICIAL_ROOMS,i3),this._composers.set(R.GET_POPULAR_ROOM_TAGS,n3),this._composers.set(R.GUILD_BASE_SEARCH,a3),this._composers.set(R.MY_FAVOURITE_ROOMS_SEARCH,o3),this._composers.set(R.MY_FREQUENT_ROOM_HISTORY_SEARCH,l3),this._composers.set(R.MY_FRIENDS_ROOM_SEARCH,c3),this._composers.set(R.MY_GUILD_BASES_SEARCH,u3),this._composers.set(R.MY_RECOMMENDED_ROOMS,h3),this._composers.set(R.MY_ROOM_HISTORY_SEARCH,d3),this._composers.set(R.MY_ROOM_RIGHTS_SEARCH,_3),this._composers.set(R.MY_ROOMS_SEARCH,g3),this._composers.set(R.POPULAR_ROOMS_SEARCH,R3),this._composers.set(R.ROOM_LIKE,cM),this._composers.set(R.ROOM_RIGHTS_REMOVE_OWN,S3),this._composers.set(R.ROOM_AD_EVENT_TAB_CLICKED,O3),this._composers.set(R.ROOM_AD_EVENT_TAB_VIEWED,C3),this._composers.set(R.ROOM_AD_SEARCH,A3),this._composers.set(R.ROOM_TEXT_SEARCH,y3),this._composers.set(R.ROOMS_WHERE_MY_FRIENDS_ARE,N3),this._composers.set(R.ROOMS_WITH_HIGHEST_SCORE_SEARCH,b3),this._composers.set(R.SET_ROOM_SESSION_TAGS,v3),this._composers.set(R.ROOM_STAFF_PICK,uM),this._composers.set(R.ROOM_FILTER_WORDS,aM),this._composers.set(R.ROOM_FILTER_WORDS_MODIFY,dM),this._composers.set(R.USER_HOME_ROOM,hM),this._composers.set(R.UPDATE_ROOM_THUMBNAIL,M3),this._composers.set(R.NAVIGATOR_INIT,lM),this._composers.set(R.NAVIGATOR_SEARCH_CLOSE,p3),this._composers.set(R.NAVIGATOR_SEARCH,gl),this._composers.set(R.NAVIGATOR_SEARCH_OPEN,E3),this._composers.set(R.NAVIGATOR_SEARCH_SAVE,I3),this._composers.set(R.NAVIGATOR_SETTINGS_SAVE,T3),this._composers.set(R.NAVIGATOR_CATEGORY_LIST_MODE,m3),this._composers.set(R.NAVIGATOR_DELETE_SAVED_SEARCH,f3),this._composers.set(R.POLL_ANSWER,TM),this._composers.set(R.POLL_REJECT,RM),this._composers.set(R.POLL_START,SM),this._composers.set(R.POLL_VOTE_COUNTER,OM),this._composers.set(R.USER_EFFECT_ACTIVATE,x5),this._composers.set(R.USER_EFFECT_ENABLE,w5),this._composers.set(R.USER_BADGES,Ov),this._composers.set(R.USER_BADGES_CURRENT_UPDATE,Cv),this._composers.set(R.GET_BADGE_POINTS_LIMITS,F5),this._composers.set(R.REQUESTABADGE,G5),this._composers.set(R.GETISBADGEREQUESTFULFILLED,k5),this._composers.set(R.USER_BOTS,mf),this._composers.set(R.USER_FURNITURE,Av),this._composers.set(R.REQUESTFURNIINVENTORYWHENNOTINROOM,B5),this._composers.set(R.USER_PETS,ff),this._composers.set(R.TRADE_ACCEPT,Nv),this._composers.set(R.TRADE_CANCEL,bv),this._composers.set(R.TRADE_CLOSE,yv),this._composers.set(R.TRADE_CONFIRM,vv),this._composers.set(R.TRADE_ITEM,pf),this._composers.set(R.TRADE_ITEMS,Mv),this._composers.set(R.TRADE_ITEM_REMOVE,Dv),this._composers.set(R.TRADE,Pv),this._composers.set(R.TRADE_UNACCEPT,Lv),this._composers.set(R.UNSEEN_RESET_CATEGORY,Uv),this._composers.set(R.UNSEEN_RESET_ITEMS,xv),this._composers.set(R.ACHIEVEMENT_LIST,Kb),this._composers.set(R.PET_MOUNT,Tf),this._composers.set(R.PET_RESPECT,Q_),this._composers.set(R.PET_SUPPLEMENT,P3),this._composers.set(R.REMOVE_PET_SADDLE,mM),this._composers.set(R.PET_INFO,fM),this._composers.set(R.TOGGLE_PET_BREEDING,pM),this._composers.set(R.TOGGLE_PET_RIDING,EM),this._composers.set(R.USE_PET_PRODUCT,IM),this._composers.set(R.GET_PET_TRAINING_PANEL,gM),this._composers.set(R.PET_OPEN_PACKAGE,yE),this._composers.set(R.PET_SELECTED,i4),this._composers.set(R.PETS_BREED,J_),this._composers.set(R.PET_CANCEL_BREEDING,V5),this._composers.set(R.PET_CONFIRM_BREEDING,H5),this._composers.set(R.ROOM_ENTER,NM),this._composers.set(R.ROOM_DOORBELL,AM),this._composers.set(R.GO_TO_FLAT,SD),this._composers.set(R.CHANGE_QUEUE,RD),this._composers.set(R.ROOM_AMBASSADOR_ALERT,yM),this._composers.set(R.ROOM_BAN_GIVE,vM),this._composers.set(R.ROOM_BAN_REMOVE,UM),this._composers.set(R.ROOM_RIGHTS_GIVE,DM),this._composers.set(R.ROOM_KICK,PM),this._composers.set(R.ROOM_MUTE_USER,LM),this._composers.set(R.ROOM_RIGHTS_REMOVE,OE),this._composers.set(R.ROOM_RIGHTS_REMOVE_ALL,bM),this._composers.set(R.ROOM_DELETE,MM),this._composers.set(R.ROOM_SETTINGS,AE),this._composers.set(R.ROOM_SETTINGS_SAVE,FM),this._composers.set(R.ROOM_SETTINGS_SAVE_WIRED,kM),this._composers.set(R.ROOM_RIGHTS_LIST,wM),this._composers.set(R.ROOM_BAN_LIST,CE),this._composers.set(R.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,a4),this._composers.set(R.BOT_CONFIGURATION,xM),this._composers.set(R.GET_ITEM_DATA,HM),this._composers.set(R.REMOVE_WALL_ITEM,KM),this._composers.set(R.BOT_PLACE,GM),this._composers.set(R.BOT_PICKUP,$_),this._composers.set(R.BOT_SKILL_SAVE,jn),this._composers.set(R.PET_PLACE,YM),this._composers.set(R.PET_MOVE,Sf),this._composers.set(R.PET_PICKUP,zM),this._composers.set(R.SET_ITEM_DATA,XM),this._composers.set(R.SET_OBJECT_DATA,NE),this._composers.set(R.COMPOST_PLANT,VM),this._composers.set(R.HARVEST_PET,WM),this._composers.set(R.SET_CLOTHING_CHANGE_DATA,qM),this._composers.set(R.FURNITURE_ALIASES,eD),this._composers.set(R.FURNITURE_GROUP_INFO,tD),this._composers.set(R.FURNITURE_PICKUP,sD),this._composers.set(R.FURNITURE_PLACE,bE),this._composers.set(R.ITEM_PAINT,Ou),this._composers.set(R.FURNITURE_POSTIT_PLACE,rD),this._composers.set(R.FURNITURE_POSTIT_SAVE_STICKY_POLE,QM),this._composers.set(R.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,cu),this._composers.set(R.GET_YOUTUBE_DISPLAY_STATUS,pD),this._composers.set(R.SET_YOUTUBE_DISPLAY_PLAYLIST,Cf),this._composers.set(R.FURNITURE_FLOOR_UPDATE,Of),this._composers.set(R.FURNITURE_WALL_UPDATE,fD),this._composers.set(R.ITEM_DIMMER_SETTINGS,$M),this._composers.set(R.ITEM_DIMMER_SAVE,JM),this._composers.set(R.ITEM_DIMMER_TOGGLE,ZM),this._composers.set(R.ROOM_TONER_APPLY,mD),this._composers.set(R.ITEM_COLOR_WHEEL_CLICK,iD),this._composers.set(R.ITEM_DICE_CLICK,nD),this._composers.set(R.ITEM_DICE_CLOSE,aD),this._composers.set(R.FURNITURE_MULTISTATE,Sc),this._composers.set(R.FURNITURE_RANDOMSTATE,cD),this._composers.set(R.ITEM_STACK_HELPER,t_),this._composers.set(R.FURNITURE_WALL_MULTISTATE,uD),this._composers.set(R.ONE_WAY_DOOR_CLICK,lD),this._composers.set(R.ITEM_EXCHANGE_REDEEM,oD),this._composers.set(R.ITEM_CLOTHING_REDEEM,TD),this._composers.set(R.ROOM_MODEL,Af),this._composers.set(R.GET_OCCUPIED_TILES,ED),this._composers.set(R.GET_ROOM_ENTRY_TILE,ID),this._composers.set(R.ROOM_MODEL_SAVE,vE),this._composers.set(R.UNIT_ACTION,yD),this._composers.set(R.UNIT_DANCE,vD),this._composers.set(R.UNIT_DROP_HAND_ITEM,MD),this._composers.set(R.UNIT_GIVE_HANDITEM,DD),this._composers.set(R.UNIT_GIVE_HANDITEM_PET,DE),this._composers.set(R.UNIT_LOOK,PD),this._composers.set(R.UNIT_SIGN,UD),this._composers.set(R.UNIT_POSTURE,LD),this._composers.set(R.UNIT_WALK,xD),this._composers.set(R.UNIT_CHAT,ME),this._composers.set(R.UNIT_CHAT_SHOUT,OD),this._composers.set(R.USER_SETTINGS_CHAT_STYLE,CD),this._composers.set(R.UNIT_CHAT_WHISPER,AD),this._composers.set(R.UNIT_TYPING,ND),this._composers.set(R.UNIT_TYPING_STOP,bD),this._composers.set(R.WIRED_APPLY_SNAPSHOT,PE),this._composers.set(R.WIRED_OPEN,wD),this._composers.set(R.WIRED_ACTION_SAVE,kD),this._composers.set(R.WIRED_ADDON_SAVE,GD),this._composers.set(R.WIRED_CONDITION_SAVE,BD),this._composers.set(R.WIRED_SELECTOR_SAVE,VD),this._composers.set(R.WIRED_TRIGGER_SAVE,HD),this._composers.set(R.ROOM_MUTE,FD),this._composers.set(R.APPROVE_NAME,QD),this._composers.set(R.USER_RESPECT,hP),this._composers.set(R.SCR_GET_KICKBACK_INFO,aP),this._composers.set(R.PEER_USERS_CLASSIFICATION,dP),this._composers.set(R.USER_CLASSIFICATION,_P),this._composers.set(R.USER_IGNORED,$D),this._composers.set(R.USER_IGNORE,ZD),this._composers.set(R.USER_IGNORE_ID,eP),this._composers.set(R.USER_UNIGNORE,tP),this._composers.set(R.USER_BADGES_CURRENT,UE),this._composers.set(R.USER_FIGURE,xE),this._composers.set(R.USER_MOTTO,sP),this._composers.set(R.USER_PROFILE,rP),this._composers.set(R.USER_PROFILE_BY_NAME,g4),this._composers.set(R.USER_TAGS,JD),this._composers.set(R.MESSENGER_RELATIONSHIPS,wE),this._composers.set(R.MANNEQUIN_SAVE_NAME,dD),this._composers.set(R.MANNEQUIN_SAVE_LOOK,hD),this._composers.set(R.PRESENT_OPEN_PRESENT,gD),this._composers.set(R.MARKETPLACE_CONFIG,kv),this._composers.set(R.MARKETPLACE_SELL_ITEM,Vv),this._composers.set(R.MARKETPLACE_REQUEST_OWN_ITEMS,Bv),this._composers.set(R.MARKETPLACE_TAKE_BACK_ITEM,Fv),this._composers.set(R.MARKETPLACE_REQUEST_OFFERS,Gv),this._composers.set(R.MARKETPLACE_BUY_OFFER,Ef),this._composers.set(R.MARKETPLACE_REDEEM_CREDITS,Hv),this._composers.set(R.MARKETPLACE_BUY_TOKENS,j5),this._composers.set(R.REQUEST_SELL_ITEM,Y5),this._composers.set(R.REQUEST_MARKETPLACE_ITEM_STATS,z5),this._composers.set(R.USER_BOTS,mf),this._composers.set(R.USER_PETS,ff),this._composers.set(R.USER_CURRENCY,nP),this._composers.set(R.USER_SUBSCRIPTION,Nf),this._composers.set(R.MODTOOL_REQUEST_ROOM_INFO,zv),this._composers.set(R.MODTOOL_CHANGE_ROOM_SETTINGS,If),this._composers.set(R.MODTOOL_REQUEST_USER_CHATLOG,Qv),this._composers.set(R.MODTOOL_REQUEST_ROOM_CHATLOG,qv),this._composers.set(R.MOD_TOOL_USER_INFO,Kv),this._composers.set(R.MODTOOL_SANCTION_ALERT,$v),this._composers.set(R.MODTOOL_SANCTION_BAN,Wa),this._composers.set(R.MODTOOL_SANCTION_KICK,Jv),this._composers.set(R.MODTOOL_SANCTION_TRADELOCK,eM),this._composers.set(R.MODTOOL_ALERTEVENT,TE),this._composers.set(R.MODTOOL_SANCTION_MUTE,Zv),this._composers.set(R.MODTOOL_REQUEST_USER_ROOMS,Xv),this._composers.set(R.MODTOOL_ROOM_ALERT,va),this._composers.set(R.CLOSE_ISSUE_DEFAULT_ACTION,K5),this._composers.set(R.CLOSE_ISSUES,_o),this._composers.set(R.DEFAULT_SANCTION,jv),this._composers.set(R.GET_CFH_CHATLOG,Yv),this._composers.set(R.MODTOOL_PREFERENCES,q5),this._composers.set(R.MODTOOL_SANCTION,X5),this._composers.set(R.PICK_ISSUES,tM),this._composers.set(R.RELEASE_ISSUES,RE),this._composers.set(R.MYSTERYBOXWAITINGCANCELEDMESSAGE,sM),this._composers.set(R.MYSTERYBOX_OPEN_TROPHY,_D),this._composers.set(R.USER_SETTINGS_CAMERA,oP),this._composers.set(R.USER_SETTINGS_OLD_CHAT,lP),this._composers.set(R.USER_SETTINGS_ROTATIONS,f4),this._composers.set(R.USER_SETTINGS_INVITES,cP),this._composers.set(R.USER_SETTINGS_WIRED_ANIMATIONS,p4),this._composers.set(R.USER_SETTINGS_VOLUME,uP),this._composers.set(R.COMMUNITY_GOAL_VOTE_COMPOSER,W5),this._composers.set(R.GET_PROMO_ARTICLES,wv),this._composers.set(R.ACCEPT_QUEST,L3),this._composers.set(R.ACTIVATE_QUEST,U3),this._composers.set(R.CANCEL_QUEST,x3),this._composers.set(R.FRIEND_REQUEST_QUEST_COMPLETE,w3),this._composers.set(R.GET_COMMUNITY_GOAL_EARNED_PRIZES,F3),this._composers.set(R.GET_COMMUNITY_GOAL_HALL_OF_FAME,CM),this._composers.set(R.GET_COMMUNITY_GOAL_PROGRESS,k3),this._composers.set(R.GET_CONCURRENT_USERS_GOAL_PROGRESS,G3),this._composers.set(R.GET_CONCURRENT_USERS_REWARD,B3),this._composers.set(R.GET_DAILY_QUEST,V3),this._composers.set(R.GET_QUESTS,H3),this._composers.set(R.GET_SEASONAL_QUESTS_ONLY,W3),this._composers.set(R.OPEN_QUEST_TRACKER,j3),this._composers.set(R.REDEEM_COMMUNITY_GOAL_PRIZE,Y3),this._composers.set(R.REJECT_QUEST,z3),this._composers.set(R.START_CAMPAIGN,K3),this._composers.set(R.GET_SOUND_SETTINGS,l4),this._composers.set(R.ADD_JUKEBOX_DISK,WD),this._composers.set(R.GET_JUKEBOX_PLAYLIST,jD),this._composers.set(R.GET_NOW_PLAYING,YD),this._composers.set(R.GET_OFFICIAL_SONG_ID,zD),this._composers.set(R.GET_SONG_INFO,KD),this._composers.set(R.GET_SOUND_MACHINE_PLAYLIST,o4),this._composers.set(R.GET_USER_SONG_DISKS,qD),this._composers.set(R.REMOVE_JUKEBOX_DISK,XD),this._composers.set(R.HELPER_TALENT_TRACK,u4),this._composers.set(R.TALENT_TRACK_GET_LEVEL,c4),this._composers.set(R.NEW_USER_EXPERIENCE_GET_GIFTS,D3),this._composers.set(R.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,_M),this._composers.set(R.WELCOME_OPEN_GIFT,e4),this._composers.set(R.WELCOME_GIFT_CHANGE_EMAIL,I4),this._composers.set(R.EMAIL_GET_STATUS,m4),this._composers.set(R.EMAIL_CHANGE,_4),this._composers.set(R.RENTABLE_SPACE_CANCEL_RENT,t4),this._composers.set(R.RENTABLE_SPACE_RENT,s4),this._composers.set(R.RENTABLE_SPACE_STATUS,r4),this._composers.set(R.RECYCLER_STATUS,q3),this._composers.set(R.RECYCLER_ITEMS,X3),this._composers.set(R.TRACKING_PERFORMANCE_LOG,d4),this._composers.set(R.TRACKING_LAG_WARNING_REPORT,h4),this._composers.set(R.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,n4),this._composers.set(R.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,J3),this._composers.set(R.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,$3),this._composers.set(R.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,Z3)}get events(){return this._events}get composers(){return this._composers}}class x4 extends aa{constructor(e){super(),this._communication=e,this._connection=null,this._messages=new U4,this._demo=new T4(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(ke.instance.events.addEventListener(Is.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(cr.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(cr.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(cr.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(Ke.getValue("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(cr.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(cr.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(cr.CONNECTION_ERROR,this.onConnectionErrorEvent)),ke.instance.events.removeEventListener(Is.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(e){xe.log("Connection Initialized")}onConnectionClosedEvent(e){xe.log("Connection Closed")}onConnectionErrorEvent(e){xe.log("Connection Error")}onConnectionAuthenticatedEvent(e){xe.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(e){xe.log("Initializing Connection",e)}registerMessageEvent(e){return this._connection&&this._connection.addMessageEvent(e),e}removeMessageEvent(e){this._connection&&this._connection.removeMessageEvent(e)}get demo(){return this._demo}get connection(){return this._connection}}const md=class{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",s=>{if(typeof s.data=="string"&&s.data.startsWith(md.MESSAGE_KEY)){const{method:e,params:t}=JSON.parse(s.data.substr(md.MESSAGE_KEY.length)),r=window[e];if(!r)return;r(...t);return}})),!0}static call(s,...e){if(window.top!==window&&window.top.postMessage(md.MESSAGE_KEY+JSON.stringify({method:s,params:e}),"*"),!("FlashExternalInterface"in window))return;const t=window.FlashExternalInterface[s];return typeof t<"u"?t(...e):void 0}static callGame(s,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:s,params:e}),"*"),!("FlashExternalGameInterface"in window))return;const t=window.FlashExternalGameInterface[s];return typeof t<"u"?t(...e):void 0}static addCallback(s,e){window[s]=e}};let It=md;It.MESSAGE_KEY="Nitro_LegacyExternalInterface";It._isListeningForPostMessages=!1;class w4{constructor(e){e.addMessageEvent(new $p(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(e){if(!e)return;const t=e.getParser();t&&It.callGame("showGame",t.url)}}class Lg{constructor(e){this._badgeId="",this._level=1,this._base="",this._badgeId=e,this.parseText()}parseText(){let e=this._badgeId.length-1;for(;e>0&&this.isNumber(this._badgeId.charAt(e));)e--;this._base=this._badgeId.substr(0,e+1);const t=this._badgeId.substr(e+1,this._badgeId.length);t&&t!==""&&(this._level=Number.parseInt(t))}isNumber(e){const t=e.charCodeAt(0);return t>=48&&t<=57}get level(){return this._level}set level(e){this._level=Math.max(1,e)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class F4 extends aa{constructor(e){super(),this._communication=e,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new Y_(this.onBadgePointLimitsEvent.bind(this)));let e=Ke.getValue("external.texts.url");Array.isArray(e)||(e=[Ke.getValue("external.texts.url")]);for(let t=0;t<e.length;t++)e[t]=Ke.interpolate(e[t]);this._pendingUrls=e,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new uo(uo.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(e){fetch(e).then(t=>t.json()).then(t=>this.onLocalizationLoaded(t,e)).catch(t=>this.onLocalizationFailed(t))}onLocalizationLoaded(e,t){if(!e)return;if(!this.parseLocalization(e))throw new Error(`Invalid json data for file ${t}`);const r=this._pendingUrls.indexOf(t);r>=0&&this._pendingUrls.splice(r,1),this.loadNextLocalization()}onLocalizationFailed(e){this.events&&this.events.dispatchEvent(new uo(uo.FAILED))}parseLocalization(e){if(!e)return!1;for(const t in e)this._definitions.set(t,e[t]);return!0}onBadgePointLimitsEvent(e){const t=e.getParser();for(const r of t.data)this.setBadgePointLimit(r.badgeId,r.limit)}getBadgePointLimit(e){return this._badgePointLimits.get(e)||-1}setBadgePointLimit(e,t){this._badgePointLimits.set(e,t)}getRomanNumeral(e){return this._romanNumerals[Math.max(0,e-1)]}getPreviousLevelBadgeId(e){const t=new Lg(e);return t.level--,t.getBadgeId}hasValue(e){return this._definitions.has(e)}getValue(e,t=!0){if(!e||!e.length)return null;const r=e.match(/\$\{.[^}]*\}/g);if(r&&r.length)for(const n of r)e=e.replace(n,this.getValue(n.slice(2,-1),t));let i=this._definitions.get(e)||null;if(!i&&(i=Ke.definitions.get(e),i))return i;if(i&&t){const n=this._parameters.get(e);if(n)for(const[o,l]of n)i=i.replace("%"+o+"%",l)}return i||e}getValueWithParameter(e,t,r){const i=this.getValue(e,!1),n=i.replace("%"+t+"%",r);if(i.startsWith("%{")){const o=new RegExp("%{"+t.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=i.match(o);if(!l)return n;let c=-1;switch(Number.parseInt(r)){case 0:c=1;break;case 1:c=2;break;default:case 2:c=3;break}if(c==-1||typeof l[c]>"u")return n;const u=l[c];if(u)return u.replace("%%",r)}return n}getValueWithParameters(e,t,r){let i=this.getValue(e,!1);if(t)for(let n=0;n<t.length;n++){const o=t[n],l=r[n];if(l!==void 0&&(i=i.replace("%"+o+"%",l),i.startsWith("%{"))){const c=new RegExp("%{"+o.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),h=i.match(c);if(!h)continue;const u=parseInt(l);let g=-1;switch(u){case 0:g=1;break;case 1:g=2;break;case 2:default:g=3;break}if(g===-1||typeof h[g]>"u")continue;const m=h[g];m&&(i=m.replace("%%",l))}}return i}setValue(e,t){this._definitions.set(e,t)}registerParameter(e,t,r){if(!e||e.length===0||!t||t.length===0)return;let i=this._parameters.get(e);i||(i=new Map,this._parameters.set(e,i)),i.set(t,r)}getBadgeName(e){const t=new Lg(e),r=["badge_name_"+e,"badge_name_"+t.base];let i=this.fixBadLocalization(this.getExistingKey(r));return i=i.replace("%roman%",this.getRomanNumeral(t.level)),i}getBadgeDesc(e){const t=new Lg(e),r=["badge_desc_"+e,"badge_desc_"+t.base];let i=this.fixBadLocalization(this.getExistingKey(r));const n=this.getBadgePointLimit(e);return n>-1&&(i=i.replace("%limit%",n.toString())),i=i.replace("%roman%",this.getRomanNumeral(t.level)),i}getExistingKey(e){for(const t of e){const r=this.getValue(t);if(r!=t)return r}return""}fixBadLocalization(e){return e.replace("${","$").replace("{","$").replace("}","$")}}lU.add(cU,uU,hU,dU,_U,gU,mU);class tT{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?Lt.generateImage(this.data):null}}class qr extends rr{constructor(e){super(null,null),this._type=e}get type(){return this._type}}qr.IMAGE_LOADED="ROAUM_IMAGE_LOADED";qr.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";class Xs extends rr{constructor(){super(null,null)}}class NP extends Xs{constructor(e,t){super(),this._itemType=e,this._itemName=t}get itemType(){return this._itemType}get itemName(){return this._itemName}}class YE extends Xs{constructor(e=0){super(),this._numberOfWords=e}get numberOfWords(){return this._numberOfWords}}class bP extends Xs{constructor(e=0){super(),this._danceStyle=e}get danceStyle(){return this._danceStyle}}class yP extends Xs{constructor(e,t=0){super(),this._effect=e,this._delayMilliseconds=t}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class vP extends Xs{constructor(e){super(),this._gainedExperience=e}get gainedExperience(){return this._gainedExperience}}class MP extends Xs{constructor(e=0){super(),this._expressionType=e}get expressionType(){return this._expressionType}}class s_ extends Xs{constructor(e,t=null,r=null,i=!1){super(),this._figure=e,this._gender=t,this._subType=r,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class DP extends Xs{constructor(e=0){super(),this._level=e}get level(){return this._level}}class PP extends Xs{constructor(e=0){super(),this._gesture=e}get gesture(){return this._gesture}}class k4 extends Xs{constructor(e){super(),this._guideStatus=e}get guideStatus(){return this._guideStatus}}class LP extends Xs{constructor(e=!1){super(),this._isMuted=e}get isMuted(){return this._isMuted}}class UP extends Xs{}class xP extends Xs{constructor(e){super(),this._gesture=e}get gesture(){return this._gesture}}class wP extends Xs{constructor(e){super(),this._value=e}get value(){return this._value}}class FP extends Xs{constructor(e){super(),this._isPlayingGame=e}get isPlayingGame(){return this._isPlayingGame}}class zE extends Xs{constructor(e,t=""){super(),this._postureType=e,this._parameter=t}get postureType(){return this._postureType}get parameter(){return this._parameter}}class r_ extends Xs{constructor(e){super(),this._selected=e}get selected(){return this._selected}}class kP extends Xs{constructor(e=0){super(),this._signType=e}get signType(){return this._signType}}class KE extends Xs{constructor(e=!1){super(),this._isSleeping=e}get isSleeping(){return this._isSleeping}}class GP extends Xs{constructor(e=!1){super(),this._isTyping=e}get isTyping(){return this._isTyping}}class To extends rr{constructor(e,t,r,i=!1,n=500){super(e,r),this._targetLocation=t,this._isSlide=i,this._animationTime=n}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}get animationTime(){return this._animationTime}}class i_ extends To{constructor(e,t,r,i,n,o,l=500){super(e,t,r,!1,l),this._headDirection=i,this._canStandUp=n,this._baseY=o}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class BP extends Xs{constructor(e){super(),this._itemType=e}get itemType(){return this._itemType}}class Zt extends rr{constructor(e,t,r=null){super(null,null),this._state=e,this._data=t,this._extra=r}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}class Oc extends rr{constructor(e,t){super(null,null),this._badgeId=e,this._assetName=t}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}Oc.BADGE_LOADED="ROGBUM_BADGE_LOADED";class VP extends rr{constructor(e,t,r){super(e,t),this._height=r}get height(){return this._height}}class qE extends rr{constructor(e){super(null,null),this._data=e}get data(){return this._data}}class HP extends rr{constructor(e,t){super(null,null),this._numberKey=e,this._numberValue=t}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}class n_ extends rr{constructor(e,t,r,i){super(null,null),this._type=e,this._color=t,this._light=r,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}n_.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";class Ma extends rr{constructor(e,t,r=0,i=0,n=0,o=0){super(null,null),this._type=e,this._id=t,this._x=r,this._y=i,this._width=n,this._height=o}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}Ma.ADD="ORPFHUM_ADD";Ma.REMOVE="ORPFHUM_REMOVE";const WP=class extends rr{constructor(s){super(null,null),this._type=WP.UPDATE_MAP,this._mapData=s}get type(){return this._type}get mapData(){return this._mapData}};let XE=WP;XE.UPDATE_MAP="RORMUM_UPDATE_MAP";class gr extends rr{constructor(e,t,r=null,i=null,n="window"){super(null,null),this._type=e,this._maskId=t,this._maskType=r,this._maskLocation=i?new G(i.x,i.y,i.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}gr.ADD_MASK="RORMUM_ADD_MASK";gr.REMOVE_MASK="RORMUM_ADD_MASK";gr.DOOR="door";gr.WINDOW="window";gr.HOLE="hole";class Da extends rr{constructor(e,t){super(null,null),this._type=e,this._value=t}get type(){return this._type}get value(){return this._value}}Da.WALL_THICKNESS="RORPPUM_WALL_THICKNESS";Da.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";class Pa extends rr{constructor(e,t){super(null,null),this._type=e,this._visible=t}get type(){return this._type}get visible(){return this._visible}}Pa.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY";Pa.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";class _r extends rr{constructor(e,t){super(null,null),this._type=e,this._value=t}get type(){return this._type}get value(){return this._value}}_r.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE";_r.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE";_r.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";class Vu extends Xs{constructor(e){super(),this._selected=e}get selected(){return this._selected}}class Vl extends rr{constructor(e,t,r,i,n=!1){super(e,null),this._height=t,this._visible=r,this._sourceEventId=i,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}class La extends rr{constructor(e){super(null,null),this._type=e}get type(){return this._type}}La.ENABLED="ROVUM_ENABLED";La.DISABLED="ROVUM_DISABLED";const Hl=class extends D_{constructor(){super(),this._liftAmount=0,this._location=new G,this._locationDelta=new G,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=Hl.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,this._updateInterval=Hl.DEFAULT_UPDATE_INTERVAL,super.onDispose()}update(s){super.update(s);const e=this.getLocationOffset(),t=this.object&&this.object.model;if(t&&(e?this._liftAmount!==e.z&&(this._liftAmount=e.z,t.setValue(b.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,t.setValue(b.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||e){const r=Hl.TEMP_VECTOR;let i=this.time-this._changeTime;i===this._updateInterval>>1&&i++,i>this._updateInterval&&(i=this._updateInterval),this._locationDelta.length>0?(r.assign(this._locationDelta),r.multiply(i/this._updateInterval),r.add(this._location)):r.assign(this._location),e&&r.add(e),this.object.setLocation(r),i>=this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0,this._updateInterval=Hl.DEFAULT_UPDATE_INTERVAL)}this._lastUpdateTime=this.time}setObject(s){super.setObject(s),s&&this._location.assign(s.getLocation())}processUpdateMessage(s){if(s&&(super.processUpdateMessage(s),s.location&&this._location.assign(s.location),s instanceof To))return this.processMoveMessage(s)}processMoveMessage(s){if(!s||!this.object||!s.location)return;this._changeTime=this._lastUpdateTime,this._locationDelta.assign(s.targetLocation),this._locationDelta.subtract(this._location);const e=Math.max(50,Math.min(s.animationTime||Hl.DEFAULT_UPDATE_INTERVAL,2e3));this.updateInterval=e}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(s){s<=0&&(s=1),this._updateInterval=s}};let Ro=Hl;Ro.DEFAULT_UPDATE_INTERVAL=500;Ro.TEMP_VECTOR=new G;const Kr=class extends Ro{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=tt()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const s=[$e.CLICK,$e.DOUBLE_CLICK,Vr.POSITION_CHANGED,$e.MOUSE_ENTER,$e.MOUSE_LEAVE,Re.MOUSE_BUTTON,Re.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),s)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Vr(Vr.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(s){if(super.update(s),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==t.x||this._reportedLocation.y!==t.y||this._reportedLocation.z!==t.z)&&(this._reportedLocation||(this._reportedLocation=new G),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new Vr(Vr.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(s,e){this._talkingEndTimestamp>0&&(s>this._talkingEndTimestamp?(e.setValue(b.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=s+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&s>this._talkingPauseStartTimestamp?(e.setValue(b.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&s>this._talkingPauseEndTimestamp&&(e.setValue(b.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&s>this._animationEndTimestamp&&(e.setValue(b.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&s>this._gestureEndTimestamp&&(e.setValue(b.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&s>this._signEndTimestamp&&(e.setValue(b.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&s>this._carryObjectEndTimestamp&&(e.setValue(b.FIGURE_CARRY_OBJECT,0),e.setValue(b.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&s-this._carryObjectStartTimestamp>5e3&&((s-this._carryObjectStartTimestamp)%1e4<1e3?e.setValue(b.FIGURE_USE_OBJECT,1):e.setValue(b.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&s>this._blinkingStartTimestamp&&(e.setValue(b.FIGURE_BLINK,1),this._blinkingStartTimestamp=s+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=s+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&s>this._blinkingEndTimestamp&&(e.setValue(b.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&s>this._effectChangeTimeStamp&&(e.setValue(b.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&s>this._numberValueEndTimestamp&&(e.setValue(b.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(s){if(!s||!this.object)return;super.processUpdateMessage(s);const e=this.object&&this.object.model;if(e){if(s instanceof zE){e.setValue(b.FIGURE_POSTURE,s.postureType),e.setValue(b.FIGURE_POSTURE_PARAMETER,s.parameter);return}if(s instanceof YE){e.setValue(b.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+s.numberOfWords*1e3;return}if(s instanceof GP){e.setValue(b.FIGURE_IS_TYPING,s.isTyping?1:0);return}if(s instanceof LP){e.setValue(b.FIGURE_IS_MUTED,s.isMuted?1:0);return}if(s instanceof FP){e.setValue(b.FIGURE_IS_PLAYING_GAME,s.isPlayingGame?1:0);return}if(s instanceof i_){e.setValue(b.HEAD_DIRECTION,s.headDirection),e.setValue(b.FIGURE_CAN_STAND_UP,s.canStandUp),e.setValue(b.FIGURE_VERTICAL_OFFSET,s.baseY);return}if(s instanceof PP){e.setValue(b.FIGURE_GESTURE,s.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(s instanceof MP){e.setValue(b.FIGURE_EXPRESSION,s.expressionType),this._animationEndTimestamp=he.getExpressionTimeout(e.getValue(b.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(s instanceof bP){e.setValue(b.FIGURE_DANCE,s.danceStyle);return}if(s instanceof KE){e.setValue(b.FIGURE_SLEEP,s.isSleeping?1:0),s.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(s instanceof wP){e.setValue(b.FIGURE_NUMBER_VALUE,s.value),this._numberValueEndTimestamp=this.time+3e3;return}if(s instanceof yP){this.updateAvatarEffect(s.effect,s.delayMilliseconds,e);return}if(s instanceof NP){e.setValue(b.FIGURE_CARRY_OBJECT,s.itemType),e.setValue(b.FIGURE_USE_OBJECT,0),s.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,s.itemType<Kr.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=s.itemType<=Kr.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(s instanceof BP){e.setValue(b.FIGURE_USE_OBJECT,s.itemType);return}if(s instanceof kP){e.setValue(b.FIGURE_SIGN,s.signType),this._signEndTimestamp=this.time+5e3;return}if(s instanceof DP){e.setValue(b.FIGURE_FLAT_CONTROL,s.level);return}if(s instanceof s_){e.setValue(b.FIGURE,s.figure),e.setValue(b.GENDER,s.gender);return}if(s instanceof r_){this._selected=s.selected,this._reportedLocation=null;return}if(s instanceof UP){e.setValue(b.OWN_USER,1);return}}}updateAvatarEffect(s,e,t){if(s===Kr.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=tt()+Kr.EFFECT_SPLASH_LENGTH,this._newEffect=Kr.EFFECT_TYPE_SWIM;else if(s===Kr.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=tt()+Kr.EFFECT_SPLASH_LENGTH,this._newEffect=Kr.EFFECT_TYPE_SWIM_DARK;else if(t.getValue(b.FIGURE_EFFECT)===Kr.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=tt()+Kr.EFFECT_SPLASH_LENGTH,this._newEffect=s,s=Kr.EFFECT_TYPE_SPLASH;else if(t.getValue(b.FIGURE_EFFECT)===Kr.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=tt()+Kr.EFFECT_SPLASH_LENGTH,this._newEffect=s,s=Kr.EFFECT_TYPE_SPLASH_DARK;else if(e===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=tt()+e,this._newEffect=s;return}t.setValue(b.FIGURE_EFFECT,s)}mouseEvent(s,e){let t=null;switch(s.type){case fe.MOUSE_CLICK:t=$e.CLICK;break;case fe.DOUBLE_CLICK:t=$e.DOUBLE_CLICK;break;case fe.ROLL_OVER:t=$e.MOUSE_ENTER,this.object.model&&this.object.model.setValue(b.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Re(Re.MOUSE_BUTTON,this.object));break;case fe.ROLL_OUT:t=$e.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(b.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Re(Re.MOUSE_ARROW,this.object));break}t&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new $e(t,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};let Lo=Kr;Lo.MAX_HAND_ID=999999999;Lo.MAX_HAND_USE_ID=999;Lo.EFFECT_TYPE_SPLASH=28;Lo.EFFECT_SPLASH_LENGTH=500;Lo.EFFECT_TYPE_SWIM=29;Lo.EFFECT_TYPE_SPLASH_DARK=184;Lo.EFFECT_TYPE_SWIM_DARK=185;const gn=class extends Ro{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new G,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,gn.BOUNCING_STEPS===-1&&(gn.BOUNCING_STEPS=Ke.getValue("furni.rotation.bounce.steps",8)),gn.BOUNCING_Z===-1&&(gn.BOUNCING_Z=Ke.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const s=[vt.STATE_CHANGE,$e.CLICK,$e.MOUSE_DOWN,$e.MOUSE_DOWN_LONG,is.ROOM_AD_TOOLTIP_SHOW,is.ROOM_AD_TOOLTIP_HIDE,is.ROOM_AD_FURNI_DOUBLE_CLICK,is.ROOM_AD_FURNI_CLICK];return this.widget&&s.push(Q.OPEN_WIDGET,Q.CLOSE_WIDGET),this.contextMenu&&s.push(Q.OPEN_FURNI_CONTEXT_MENU,Q.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),s)}initialize(s){if(!s)return;const e=this.object&&this.object.model;if(e){if(s.logic){if(s.logic.model){const t=s.logic.model.dimensions;t&&(this._sizeX=t.x,this._sizeY=t.y,this._sizeZ=t.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const r=s.logic.model.directions;if(r&&r.length){for(const i of r)this._directions.push(i);this._directions.sort((i,n)=>i-n)}}if(s.logic.customVars){const t=s.logic.customVars.variables;t&&t.length&&e.setValue(b.FURNITURE_CUSTOM_VARIABLES,t)}}e.setValue(b.FURNITURE_SIZE_X,this._sizeX),e.setValue(b.FURNITURE_SIZE_Y,this._sizeY),e.setValue(b.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(b.FURNITURE_CENTER_X,this._centerX),e.setValue(b.FURNITURE_CENTER_Y,this._centerY),e.setValue(b.FURNITURE_CENTER_Z,this._centerZ),e.setValue(b.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(b.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(s){super.setObject(s),s&&s.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(s){return s.getValue(b.FURNITURE_AD_URL)}handleAdClick(s,e,t){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new is(is.ROOM_AD_FURNI_CLICK,this.object))}update(s){super.update(s),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>gn.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(s){if(s instanceof Zt){this.processDataUpdateMessage(s);return}if(s instanceof VP){this.processObjectHeightUpdateMessage(s);return}if(s instanceof qE){this.processItemDataUpdateMessage(s);return}if(this._mouseOver=!1,s.location&&s.direction){if(!(s instanceof To)){const e=this.object.getDirection(),t=this.object.getLocation();e.x!==s.direction.x&&this._directionInitialized&&t.x===s.location.x&&t.y===s.location.y&&t.z===s.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new rr(s.location,s.direction),s=null)}this._directionInitialized=!0}if(s instanceof Vu&&this.contextMenu&&this.eventDispatcher&&this.object){const e=s.selected?Q.OPEN_FURNI_CONTEXT_MENU:Q.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new Q(e,this.object))}super.processUpdateMessage(s)}processDataUpdateMessage(s){s&&(this.object.setState(s.state,0),s.data&&s.data.writeRoomObjectModel(this.object.model),s.extra!==null&&this.object.model.setValue(b.FURNITURE_EXTRAS,s.extra.toString()),this.object.model.setValue(b.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(s){s&&this.object.model.setValue(b.FURNITURE_SIZE_Z,s.height)}processItemDataUpdateMessage(s){s&&this.object.model.setValue(b.FURNITURE_ITEMDATA,s.data)}mouseEvent(s,e){const t=this.getAdClickUrl(this.object.model);switch(s.type){case fe.MOUSE_MOVE:if(this.eventDispatcher){const r=new $e($e.MOUSE_MOVE,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown);r.localX=s.localX,r.localY=s.localY,r.spriteOffsetX=s.spriteOffsetX,r.spriteOffsetY=s.spriteOffsetY,this.eventDispatcher.dispatchEvent(r)}return;case fe.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){t&&t.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new is(is.ROOM_AD_TOOLTIP_SHOW,this.object));const r=new $e($e.MOUSE_ENTER,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown);r.localX=s.localX,r.localY=s.localY,r.spriteOffsetX=s.spriteOffsetX,r.spriteOffsetY=s.spriteOffsetY,this.eventDispatcher.dispatchEvent(r)}this._mouseOver=!0}return;case fe.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){t&&t.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new is(is.ROOM_AD_TOOLTIP_HIDE,this.object));const r=new $e($e.MOUSE_LEAVE,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown);r.localX=s.localX,r.localY=s.localY,r.spriteOffsetX=s.spriteOffsetX,r.spriteOffsetY=s.spriteOffsetY,this.eventDispatcher.dispatchEvent(r)}this._mouseOver=!1}return;case fe.DOUBLE_CLICK:this.useObject();return;case fe.MOUSE_CLICK:if(this.eventDispatcher){const r=new $e($e.CLICK,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown);r.localX=s.localX,r.localY=s.localY,r.spriteOffsetX=s.spriteOffsetX,r.spriteOffsetY=s.spriteOffsetY,this.eventDispatcher.dispatchEvent(r),t&&t.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new is(is.ROOM_AD_TOOLTIP_HIDE,this.object)),t&&t.length&&this.handleAdClick(this.object.id,this.object.type,t)}return;case fe.MOUSE_DOWN:if(this.eventDispatcher){const r=new $e($e.MOUSE_DOWN,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown);this.eventDispatcher.dispatchEvent(r)}return;case fe.MOUSE_DOWN_LONG:if(this.eventDispatcher){const r=new $e($e.MOUSE_DOWN_LONG,this.object,s.eventId,s.altKey,s.ctrlKey,s.shiftKey,s.buttonDown);this.eventDispatcher.dispatchEvent(r)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=gn.BOUNCING_STEPS/2?this._locationOffset.z=gn.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=gn.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=gn.BOUNCING_Z*(gn.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const s=this.getAdClickUrl(this.object.model);s&&s.length&&this.eventDispatcher.dispatchEvent(new is(is.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,s)),this.widget&&this.eventDispatcher.dispatchEvent(new Q(Q.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new vt(vt.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new Q(Q.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new Q(Q.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}};let wt=gn;wt.BOUNCING_STEPS=-1;wt.BOUNCING_Z=-1;class jP extends wt{getEventTypes(){const e=[Q.BADGE_DISPLAY_ENGRAVING,ea.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){if(super.processUpdateMessage(e),!!this.object){if(e instanceof Zt){const t=e.data;t instanceof vn&&this.updateBadge(t.getValue(1));return}if(e instanceof Oc){e.assetName!=="loading_icon"&&(this.object.model.setValue(b.FURNITURE_BADGE_ASSET_NAME,e.assetName),this.object.model.setValue(b.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(tt()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(e){e!==""&&this.eventDispatcher&&(this.object.model.setValue(b.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new ea(ea.LOAD_BADGE,this.object,e,!1)))}}const Xo=class extends jP{getEventTypes(){const s=[Q.ACHIEVEMENT_RESOLUTION_OPEN,Q.ACHIEVEMENT_RESOLUTION_ENGRAVING,Q.ACHIEVEMENT_RESOLUTION_FAILED,ea.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),s)}processUpdateMessage(s){if(super.processUpdateMessage(s),s instanceof Oc&&s.assetName!=="loading_icon"&&this.object.model.setValue(b.FURNITURE_BADGE_VISIBLE_IN_STATE,Xo.BADGE_VISIBLE_IN_STATE),s instanceof Vu){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new Q(Q.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let s=null;switch(this.object.getState(0)){case Xo.STATE_RESOLUTION_NOT_STARTED:case Xo.STATE_RESOLUTION_IN_PROGRESS:s=new Q(Q.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case Xo.STATE_RESOLUTION_ACHIEVED:s=new Q(Q.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case Xo.STATE_RESOLUTION_FAILED:s=new Q(Q.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}s&&this.eventDispatcher.dispatchEvent(s)}updateBadge(s){s!==Xo.ACH_NOT_SET&&super.updateBadge(s)}};let Cl=Xo;Cl.STATE_RESOLUTION_NOT_STARTED=0;Cl.STATE_RESOLUTION_IN_PROGRESS=1;Cl.STATE_RESOLUTION_ACHIEVED=2;Cl.STATE_RESOLUTION_FAILED=3;Cl.ACH_NOT_SET="ach_0";Cl.BADGE_VISIBLE_IN_STATE=2;class G4 extends wt{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(e){super.initialize(e),this.eventDispatcher&&this.eventDispatcher.addEventListener(xu.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(xu.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(e){if(!e||!this.object)return;const t=this.object.getLocation(),r=e.targetLocation;if(!r)return;let i=this.object.model.getValue(b.FURNITURE_SIZE_X),n=this.object.model.getValue(b.FURNITURE_SIZE_Y);const o=(Math.floor(this.object.getDirection().x)+45)%360/90;(o===1||o===3)&&([i,n]=[n,i]),r.x>=t.x&&r.x<t.x+i&&r.y>=t.y&&r.y<t.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class B4 extends wt{getEventTypes(){const e=[Q.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e);const t=this.object.model.getValue(b.FURNITURE_DATA);this.updateClothingData(t)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Zt&&e.data&&this.updateClothingData(e.data.getLegacyString())}updateClothingData(e){if(!e||!e.length)return;const[t,r]=e.split(",");t&&t.length&&this.object.model.setValue(b.FURNITURE_CLOTHING_BOY,t),r&&r.length&&this.object.model.setValue(b.FURNITURE_CLOTHING_GIRL,r)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.CLOTHING_CHANGE,this.object))}}class V4 extends wt{getEventTypes(){const e=[vt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let r=null;switch(e.type){case fe.DOUBLE_CLICK:switch(e.spriteTag){case"start_stop":r=new vt(vt.STATE_CHANGE,this.object,1);break;case"reset":r=new vt(vt.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&r){this.eventDispatcher.dispatchEvent(r);return}break}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new vt(vt.STATE_CHANGE,this.object,1))}}class H4 extends wt{processUpdateMessage(e){super.processUpdateMessage(e),this.object&&this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(ms.INFOSTAND_EXTRA_PARAM,ms.CRACKABLE_FURNI)}}class W4 extends wt{get widget(){return et.CRAFTING}}class j4 extends wt{getEventTypes(){const e=[Q.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e);let t=0;e.logic&&e.logic.credits&&e.logic.credits!==""&&e.logic.credits.length>0&&(t=parseInt(e.logic.credits)),this.object.model.setValue(b.FURNITURE_CREDIT_VALUE,t)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new Q(Q.CREDITFURNI,this.object)),super.useObject())}}class Bs extends wt{getEventTypes(){const e=[Re.MOUSE_BUTTON,Re.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case fe.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Re(Re.MOUSE_BUTTON,this.object));break;case fe.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Re(Re.MOUSE_ARROW,this.object));break}super.mouseEvent(e,t)}}}class Y4 extends Bs{constructor(){super(...arguments),this._state=1}getEventTypes(){const e=[ya.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Zt&&(this._state!==-1&&e.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=e.state)}dispatchSoundEvent(e){const t=Math.pow(2,e-1.2);this.eventDispatcher.dispatchEvent(new ya(ya.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",t))}}class z4 extends Bs{getEventTypes(){const e=[Q.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),this.object&&this.object.model&&this.object.model.setValue(b.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new Q(Q.STACK_HEIGHT,this.object)),super.useObject())}}class K4 extends wt{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const e=[Re.DICE_ACTIVATE,Re.DICE_OFF];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let r=null;switch(e.type){case fe.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(r=new Re(Re.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(r=new Re(Re.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):e.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?r=new Re(Re.DICE_ACTIVATE,this.object):e.spriteTag==="deactivate"&&(r=new Re(Re.DICE_OFF,this.object)),r&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(r);return}super.mouseEvent(e,t)}}class q4 extends wt{getEventTypes(){const e=[Q.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.ECOTRONBOX,this.object))}}class X4 extends wt{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const e=[Q.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&e.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(e){super.update(e),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(b.FURNITURE_AUTOMATIC_STATE_INDEX,e)}mouseEvent(e,t){!e||!t||(e.type===fe.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(e,t))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.INERNAL_LINK,this.object))}}class Q4 extends wt{getEventTypes(){const e=[Q.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&e.logic.action.link&&e.logic.action.link!==""&&e.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(b.FURNITURE_INTERNAL_LINK,e.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(b.FURNITURE_AUTOMATIC_STATE_INDEX,e)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new Q(Q.ROOM_LINK,this.object))}}class $4 extends wt{getEventTypes(){const e=[Q.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return Wt.EFFECT_BOX}}class J4 extends Bs{getEventTypes(){const e=[Q.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(super.initialize(e),!!e&&this.object&&this.object.model){let t="";e.logic&&e.logic.maskType&&e.logic.maskType!==""&&e.logic.maskType.length>0&&(t=e.logic.maskType),this.object.model.setValue(b.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(b.FURNITURE_PLANE_MASK_TYPE,t)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new Q(Q.EXTERNAL_IMAGE,this.object)),super.useObject())}}class Z4 extends wt{getEventTypes(){const e=[vt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.particleSystems&&e.logic.particleSystems.length&&this.object.model.setValue(b.FURNITURE_FIREWORKS_DATA,e.logic.particleSystems)}mouseEvent(e,t){if(!e||!t||!this.object)return;let r=null;switch(e.type){case fe.DOUBLE_CLICK:switch(e.spriteTag){case"start_stop":r=new vt(vt.STATE_CHANGE,this.object,1);break;case"reset":r=new vt(vt.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&r){this.eventDispatcher.dispatchEvent(r);return}break}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new vt(vt.STATE_CHANGE,this.object,0))}}const uu=class extends Bs{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const s=[wr.ADD_HOLE,wr.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),s)}onDispose(){this._currentState===uu.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new wr(wr.REMOVE_HOLE,this.object)),super.onDispose()}update(s){super.update(s),this.handleAutomaticStateUpdate()}processUpdateMessage(s){if(super.processUpdateMessage(s),!this.object)return;s instanceof Zt&&this.handleStateUpdate(this.object.getState(0));const e=this.object.getLocation();this._currentLocation?(e.x!==this._currentLocation.x||e.y!==this._currentLocation.y)&&this._currentState===uu.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new wr(wr.ADD_HOLE,this.object)):this._currentLocation=new G,this._currentLocation.assign(e)}handleStateUpdate(s){s!==this._currentState&&(this.eventDispatcher&&(s===uu.STATE_HOLE?this.eventDispatcher.dispatchEvent(new wr(wr.ADD_HOLE,this.object)):this._currentState===uu.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new wr(wr.REMOVE_HOLE,this.object))),this._currentState=s)}handleAutomaticStateUpdate(){if(!this.object)return;const s=this.object.model;if(!s)return;const e=s.getValue(b.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this.handleStateUpdate(e%2)}};let YP=uu;YP.STATE_HOLE=0;const Df=class extends Bs{constructor(){super(...arguments),this._state=-1}initialize(s){super.initialize(s),this.object&&this.object.model.setValue(b.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(s){if(s instanceof Zt){const e=s.data;e?this._state=e.state:this._state=s.state}super.processUpdateMessage(s)}getEventTypes(){const s=[Q.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),s)}useObject(){!this.object||!this.eventDispatcher||(this._state===Df.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new Q(Q.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===Df.STATE_UNLOCKED?Wt.FRIEND_FURNITURE:Wt.DUMMY}};let ah=Df;ah.STATE_UNINITIALIZED=-1;ah.STATE_UNLOCKED=0;ah.STATE_LOCKED=1;const hu=class extends Bs{getEventTypes(){const s=[ea.LOAD_BADGE,Q.GUILD_FURNI_CONTEXT_MENU,Q.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),s)}processUpdateMessage(s){if(super.processUpdateMessage(s),s instanceof Zt){const e=s.data;e instanceof vn&&(this.updateGroupId(e.getValue(hu.GROUPID_KEY)),this.updateBadge(e.getValue(hu.BADGE_KEY)),this.updateColors(e.getValue(hu.COLOR1_KEY),e.getValue(hu.COLOR2_KEY)))}else s instanceof Oc?s.assetName!=="loading_icon"&&(this.object.model.setValue(b.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,s.assetName),this.update(tt())):s instanceof Vu&&(s.selected||this.eventDispatcher.dispatchEvent(new Q(Q.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(s){this.object.model.setValue(b.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(s))}updateBadge(s){this.eventDispatcher.dispatchEvent(new ea(ea.LOAD_BADGE,this.object,s,!0))}updateColors(s,e){this.object.model.setValue(b.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(s,16)),this.object.model.setValue(b.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}mouseEvent(s,e){if(!(!s||!e||!this.object)){switch(s.type){case fe.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(s,e)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new Q(Q.GUILD_FURNI_CONTEXT_MENU,this.object))}};let Bc=hu;Bc.GROUPID_KEY=1;Bc.BADGE_KEY=2;Bc.COLOR1_KEY=3;Bc.COLOR2_KEY=4;class eK extends Bc{getEventTypes(){const e=[Q.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}updateGroupId(e){super.updateGroupId(e),this.object.model.setValue(b.FURNITURE_INTERNAL_LINK,`groupforum/${e}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new Q(Q.INERNAL_LINK,this.object)),super.useObject())}}class tK extends wt{getEventTypes(){const e=[Re.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.USE_HABBOWHEEL,this.object))}}const zP=class extends wt{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[Q.HIGH_SCORE_DISPLAY,Q.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new Q(Q.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(s){super.processUpdateMessage(s),this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&s instanceof Zt&&(s.state===zP.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new Q(Q.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new Q(Q.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=s.state)}};let KP=zP;KP.SHOW_WIDGET_IN_STATE=1;class sK extends wt{getEventTypes(){const e=[vt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),e)}mouseEvent(e,t){if(!e||!t||!this.object)return;let r=null;switch(e.type){case fe.DOUBLE_CLICK:switch(e.spriteTag){case"off":r=new vt(vt.STATE_CHANGE,this.object,3);break}break;case fe.MOUSE_CLICK:switch(e.spriteTag){case"inc":r=new vt(vt.STATE_CHANGE,this.object,2);break;case"dec":r=new vt(vt.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&r){this.eventDispatcher.dispatchEvent(r);return}super.mouseEvent(e,t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new vt(vt.STATE_CHANGE,this.object,3))}}class rK extends ah{get engravingDialogType(){return Tl.HABBOWEEN}}class iK extends Bs{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(e){if(this._nextStateTimestamp>0&&e>=this._nextStateTimestamp){this._nextStateTimestamp=0;const t=new ei;t.setString(this._nextState.toString()),super.processUpdateMessage(new Zt(this._nextState,t,this._nextStateExtra))}super.update(e)}processUpdateMessage(e){if(e instanceof Zt){this.processUpdate(e);return}super.processUpdateMessage(e)}processUpdate(e){if(!e)return;const t=~~(e.state/1e3),r=~~(e.state%1e3);if(r)this._nextState=t,this._nextStateExtra=e.extra,this._nextStateTimestamp=this.time+r;else{this._nextStateTimestamp=0;const i=new ei;i.setString(t.toString()),super.processUpdateMessage(new Zt(t,i,e.extra))}}}class nK extends wt{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const e=[Q.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){super.initialize(e),e.logic&&e.logic.action&&(this.object.model.setValue(b.FURNITURE_INTERNAL_LINK,e.logic.action.link),e.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(e){super.update(e),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(e){this.object&&this.object.model&&this.object.model.setValue(b.FURNITURE_AUTOMATIC_STATE_INDEX,e)}mouseEvent(e,t){!e||!t||(e.type===fe.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(e,t))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.INERNAL_LINK,this.object))}}class aK extends Bs{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const e=[Re.JUKEBOX_START,Re.JUKEBOX_MACHINE_STOP,Re.JUKEBOX_DISPOSE,Re.JUKEBOX_INIT,Q.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(ms.INFOSTAND_EXTRA_PARAM,ms.JUKEBOX),e instanceof Zt)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,t===1?this.requestPlayList():t===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Re(Re.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Re(Re.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new Q(Q.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new vt(vt.STATE_CHANGE,this.object,-1)))}}class oK extends ah{get engravingDialogType(){return Tl.LOVE_LOCK}}const fd=class extends wt{getEventTypes(){const s=[Q.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),s)}processUpdateMessage(s){super.processUpdateMessage(s),s instanceof Zt&&(s.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const s=new Ao;s.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(b.FURNITURE_MANNEQUIN_GENDER,s.getValue(fd.GENDER)),this.object.model.setValue(b.FURNITURE_MANNEQUIN_FIGURE,s.getValue(fd.FIGURE)),this.object.model.setValue(b.FURNITURE_MANNEQUIN_NAME,s.getValue(fd.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.MANNEQUIN,this.object))}};let tg=fd;tg.GENDER="GENDER";tg.FIGURE="FIGURE";tg.OUTFIT_NAME="OUTFIT_NAME";class lK extends Bs{getEventTypes(){const e=[Q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return Wt.MONSTERPLANT_SEED}}class cK extends Bs{initialize(e){super.initialize(e),this.object&&this.object.model&&this.object.model.setValue(b.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class uK extends Bs{getEventTypes(){const e=[Q.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return Wt.MYSTERY_BOX}}class hK extends Bs{getEventTypes(){const e=[Q.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return Wt.MYSTERY_TROPHY}}class dK extends wt{getEventTypes(){const e=[Re.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.ENTER_ONEWAYDOOR,this.object))}}class _K extends wt{getEventTypes(){const e=[Q.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),e)}processUpdateMessage(e){super.processUpdateMessage(e),this.object&&this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(ms.INFOSTAND_EXTRA_PARAM,ms.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.PET_PRODUCT_MENU,this.object))}}class gK extends wt{getEventTypes(){const e=[Q.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.PLACEHOLDER,this.object))}}class mK extends wt{initialize(e){super.initialize(e),e.logic&&e.logic.planetSystems&&this.object.model.setValue(b.FURNITURE_PLANETSYSTEM_DATA,e.logic.planetSystems)}}const Wl=class extends wt{getEventTypes(){const s=[Q.PRESENT];return this.mergeTypes(super.getEventTypes(),s)}initialize(s){super.initialize(s),s.logic&&s.logic.particleSystems&&s.logic.particleSystems.length&&this.object.model.setValue(b.FURNITURE_FIREWORKS_DATA,s.logic.particleSystems)}processUpdateMessage(s){super.processUpdateMessage(s),s instanceof Zt&&(s.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),s instanceof HP&&s.numberKey===b.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(b.FURNITURE_DISABLE_PICKING_ANIMATION,s.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const s=new Ao;s.initializeFromRoomObjectModel(this.object.model);const e=s.getValue(Wl.MESSAGE),t=this.object.model.getValue(b.FURNITURE_DATA);!e&&typeof t=="string"?this.object.model.setValue(b.FURNITURE_DATA,t.substr(1)):this.object.model.setValue(b.FURNITURE_DATA,s.getValue(Wl.MESSAGE)),this.writeToModel(b.FURNITURE_TYPE_ID,s.getValue(Wl.PRODUCT_CODE)),this.writeToModel(b.FURNITURE_PURCHASER_NAME,s.getValue(Wl.PURCHASER_NAME)),this.writeToModel(b.FURNITURE_PURCHASER_FIGURE,s.getValue(Wl.PURCHASER_FIGURE))}writeToModel(s,e){e&&this.object.model.setValue(s,e)}mouseEvent(s,e){if(!(!s||!e||!this.object)){switch(s.type){case fe.ROLL_OVER:this.eventDispatcher.dispatchEvent(new Re(Re.MOUSE_BUTTON,this.object));break;case fe.ROLL_OUT:this.eventDispatcher.dispatchEvent(new Re(Re.MOUSE_ARROW,this.object));break}super.mouseEvent(s,e)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.PRESENT,this.object))}};let Vc=Wl;Vc.MESSAGE="MESSAGE";Vc.PRODUCT_CODE="PRODUCT_CODE";Vc.EXTRA_PARAM="EXTRA_PARAM";Vc.PURCHASER_NAME="PURCHASER_NAME";Vc.PURCHASER_FIGURE="PURCHASER_FIGURE";class fK extends Bs{getEventTypes(){const e=[Q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return Wt.PURCHASABLE_CLOTHING}}const du=class extends Bs{constructor(){super(),this.updateInterval=Ro.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new G}processUpdateMessage(s){if(!s)return;const e=s instanceof To;if(this.object&&!e&&s.location){const t=this.object.getLocation(),r=G.dif(s.location,t);if(r&&Math.abs(r.x)<2&&Math.abs(r.y)<2){let i=t;(Math.abs(r.x)>1||Math.abs(r.y)>1)&&(i=G.sum(t,G.product(r,.5))),super.processUpdateMessage(new To(i,s.location,s.direction));return}}if(s.location&&!e&&super.processUpdateMessage(new To(s.location,s.location,s.direction)),s instanceof Zt){s.state>0?this.updateInterval=Ro.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(s.state):this.updateInterval=1,this.handleDataUpdate(s);return}e&&s.isSlide&&(this.updateInterval=Ro.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(s)}getUpdateIntervalValue(s){return s/du.MAX_ANIMATION_COUNT}getAnimationValue(s){return s%du.MAX_ANIMATION_COUNT}handleDataUpdate(s){const e=this.getAnimationValue(s.state);if(e!==s.state){const t=new ei;t.setString(e.toString()),s=new Zt(e,t,s.extra)}super.processUpdateMessage(s)}update(s){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(s),G.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==du.ANIMATION_NOT_MOVING&&this.object.setState(du.ANIMATION_NOT_MOVING,0))}};let sg=du;sg.ANIMATION_NOT_MOVING=0;sg.ANIMATION_MOVING=1;sg.MAX_ANIMATION_COUNT=10;class pK extends wt{getEventTypes(){const e=[vt.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new vt(vt.STATE_RANDOM,this.object))}}class EK extends Bs{get contextMenu(){return Wt.RANDOM_TELEPORT}}class IK extends wt{getEventTypes(){const e=[Zi.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),e)}update(e){if(super.update(e),this.object&&this.object.model){this.object.model.getValue(b.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new Zi(Zi.RODRE_CURRENT_USER_ID,this.object));const t=this.object.model.getValue(b.FURNITURE_DATA).renterId,r=this.object.model.getValue(b.SESSION_CURRENT_USER_ID);t?parseInt(t)===r?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return et.RENTABLESPACE}}class TK extends Bs{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const e=[Q.BACKGROUND_COLOR,oo.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new oo(oo.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(e){super.processUpdateMessage(e),e instanceof Zt&&(e.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const e=new Lu;e.initializeFromRoomObjectModel(this.object.model);const t=e.getValue(0),r=e.getValue(1),i=e.getValue(2),n=e.getValue(3);t>-1&&r>-1&&i>-1&&n>-1&&(this.object.model.setValue(b.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,r),this.object.model.setValue(b.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(b.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(t,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new oo(oo.ROOM_BACKGROUND_COLOR,this.object,t===1,r,i,n)),this._roomColorUpdated=!0)}mouseEvent(e,t){if(!(!e||!t||!this.object)){switch(e.type){case fe.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Q(Q.BACKGROUND_COLOR,this.object));return}super.mouseEvent(e,t)}}}const Wi=class extends wt{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const s=[is.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),s)}initialize(s){super.initialize(s),this._disableFurnitureSelection&&this.object.model.setValue(b.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(s){super.processUpdateMessage(s),s instanceof Zt&&this.processAdDataUpdateMessage(s),s instanceof qr&&this.processAdUpdate(s)}processAdDataUpdateMessage(s){if(!s)return;const e=new Ao;e.initializeFromRoomObjectModel(this.object.model);const t=parseInt(e.getValue(Wi.STATE));!isNaN(t)&&this.object.getState(0)!==t&&this.object.setState(t,0);const r=e.getValue(Wi.IMAGEURL_KEY),i=this.object.model.getValue(b.FURNITURE_BRANDING_IMAGE_URL);(!i||i!==r)&&(this.object.model.setValue(b.FURNITURE_BRANDING_IMAGE_URL,r),this.object.model.setValue(b.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const n=e.getValue(Wi.CLICKURL_KEY);if(n){const u=this.object.model.getValue(b.FURNITURE_BRANDING_URL);(!u||u!==n)&&this.object.model&&this.object.model.setValue(b.FURNITURE_BRANDING_URL,n)}const o=parseInt(e.getValue(Wi.OFFSETX_KEY)),l=parseInt(e.getValue(Wi.OFFSETY_KEY)),c=parseInt(e.getValue(Wi.OFFSETZ_KEY));isNaN(o)||this.object.model.setValue(b.FURNITURE_BRANDING_OFFSET_X,o),isNaN(l)||this.object.model.setValue(b.FURNITURE_BRANDING_OFFSET_Y,l),isNaN(c)||this.object.model.setValue(b.FURNITURE_BRANDING_OFFSET_Z,c);let h=Wi.IMAGEURL_KEY+"="+(r!==null?r:"")+"	";this._hasClickUrl&&(h=h+(Wi.CLICKURL_KEY+"="+(n!==null?n:"")+"	")),h=h+(Wi.OFFSETX_KEY+"="+o+"	"),h=h+(Wi.OFFSETY_KEY+"="+l+"	"),h=h+(Wi.OFFSETZ_KEY+"="+c+"	"),this.object.model.setValue(ms.INFOSTAND_EXTRA_PARAM,ms.BRANDING_OPTIONS+h)}processAdUpdate(s){if(!(!s||!this.object))switch(s.type){case qr.IMAGE_LOADED:this.object.model.setValue(b.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case qr.IMAGE_LOADING_FAILED:this.object.model.setValue(b.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(s,e){!s||!e||s.type===fe.MOUSE_MOVE||s.type===fe.DOUBLE_CLICK||super.mouseEvent(s,e)}async downloadBackground(){const s=this.object&&this.object.model;if(!s)return;const e=s.getValue(b.FURNITURE_BRANDING_IMAGE_URL),t=s.getValue(b.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!e||e===""||t===1))if(e.endsWith(".gif"))this.object.model.setValue(b.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(e).then(r=>r.arrayBuffer()).then(r=>fU(r)).then(r=>{const i=r.lsd.width,n=r.lsd.height,o=i*n,l=pU(r,!1),c=[],h=[];let u=new Uint8Array(o*4);for(let g=0;g<l.length;g++){g>0&&(u=u.slice(0));const m=l[g].pixels,p=l[g].colorTable,f=l[g].transparentIndex,T=l[g].dims;for(let O=0;O<T.height;O++)for(let A=0;A<T.width;A++){const N=m[O*T.width+A],P=(O+T.top)*i+(A+T.left);if(f!==N){const y=p[N];u[4*P]=y[0],u[4*P+1]=y[1],u[4*P+2]=y[2],u[4*P+3]=255}}const I=O_.fromBuffer(u,i,n);c.push(new ys(I)),h.push(l[g].delay)}ke.instance.roomEngine.roomContentLoader.createGifCollection(e,c,h),this.processUpdateMessage(new qr(qr.IMAGE_LOADED))}).catch(r=>{this.processUpdateMessage(new qr(qr.IMAGE_LOADING_FAILED))});else{const r=di();if(!r)return;if(!r.getTexture(e)){await r.downloadAsset(e)?this.processUpdateMessage(new qr(qr.IMAGE_LOADED)):this.processUpdateMessage(new qr(qr.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new qr(qr.IMAGE_LOADED))}}};let Uo=Wi;Uo.STATE="state";Uo.IMAGEURL_KEY="imageUrl";Uo.CLICKURL_KEY="clickUrl";Uo.OFFSETX_KEY="offsetX";Uo.OFFSETY_KEY="offsetY";Uo.OFFSETZ_KEY="offsetZ";class RK extends Uo{getAdClickUrl(e){return null}}class SK extends Uo{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(e){return e.getValue(b.FURNITURE_BRANDING_URL)}handleAdClick(e,t,r){if(r.indexOf("http")===0){an.openWebPage(r);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new is(is.ROOM_AD_FURNI_CLICK,this.object,"",r))}}class OK extends wt{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const e=[Q.DIMMER,Q.WIDGET_REMOVE_DIMMER,_c.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new _c(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new Q(Q.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(e){if(e instanceof Zt){if(e.data){const t=e.data.getLegacyString();this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(t),super.processUpdateMessage(new Zt(this.getStateFromDimmerData(t),e.data))}return}super.processUpdateMessage(e)}getStateFromDimmerData(e){if(!e)return 0;const t=e.split(",");return t.length>=5?parseInt(t[0])-1:0}processDimmerData(e){if(!e)return;const t=e.split(",");if(t.length>=5){const r=this.getStateFromDimmerData(e),i=parseInt(t[1]),n=parseInt(t[2]),o=t[3];let l=parseInt(o.substr(1),16),c=parseInt(t[4]);r||(l=16777215,c=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new _c(this.object,r,i,n,l,c)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.DIMMER,this.object))}update(e){super.update(e)}}const _u=class extends wt{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(s){if(s instanceof Zt)return this.updateScore(s.state);super.processUpdateMessage(s)}updateScore(s){this._score=s;const e=this.object.getState(0);if(this._score!==e){let t=this._score-e;t<0&&(t=-t),t*_u.UPDATE_INTERVAL>_u.MAX_UPDATE_TIME?this._scoreIncreaser=_u.MAX_UPDATE_TIME/t:this._scoreIncreaser=_u.UPDATE_INTERVAL,this._scoreTimer=tt()}}update(s){super.update(s);const e=this.object.getState(0);if(e!==this._score&&s>=this._scoreTimer+this._scoreIncreaser){const t=s-this._scoreTimer;let r=t/this._scoreIncreaser,i=1;this._score<e&&(i=-1),r>i*(this._score-e)&&(r=i*(this._score-e)),this.object.setState(e+i*r,0),this._scoreTimer=s-(t-r*this._scoreIncreaser)}}};let QE=_u;QE.UPDATE_INTERVAL=50;QE.MAX_UPDATE_TIME=3e3;class CK extends wt{processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1){const t=this.object.model.getValue(b.FURNITURE_EXTRAS),r=parseInt(t);this.object.model.setValue(ms.INFOSTAND_EXTRA_PARAM,ms.SONGDISK+r)}}}const eo=class extends Bs{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const s=[Ds.ROOM_OBJECT_INITIALIZED,Ds.ROOM_OBJECT_DISPOSED,Ds.PLAY_SAMPLE,Ds.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),s)}initialize(s){super.initialize(s),s.logic&&s.logic.soundSample&&(this._sampleId=s.logic.soundSample.id,this._noPitch=s.logic.soundSample.noPitch),this.object.model.setValue(b.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==eo.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new Ds(Ds.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(s){super.processUpdateMessage(s),s instanceof Zt&&this.updateSoundBlockMessage(s)}updateSoundBlockMessage(s){if(!s)return;const e=this.object&&this.object.model,t=this.object&&this.object.location;!e||!t||(this._state===eo.STATE_UNINITIALIZED&&e.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=t.z,this.eventDispatcher.dispatchEvent(new Ds(Ds.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(t.z)))),this._state!==eo.STATE_UNINITIALIZED&&e.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==t.z&&(this._lastLocZ=t.z,this.eventDispatcher.dispatchEvent(new Ds(Ds.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(t.z)))),this._state!==eo.STATE_UNINITIALIZED&&s.state!==this._state&&this.playSoundAt(t.z),this._state=s.state)}playSoundAt(s){if(!this.object)return;const e=this.getPitchForHeight(s);this.object.model.setValue(b.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,e),this.eventDispatcher.dispatchEvent(new Ds(Ds.PLAY_SAMPLE,this.object,this._sampleId,e))}getPitchForHeight(s){if(this._noPitch)return 1;let e=s*2;return e>eo.HIGHEST_SEMITONE&&(e=Math.min(0,eo.LOWEST_SEMITONE+(e-eo.HIGHEST_SEMITONE-1))),Math.pow(2,e/12)}};let rg=eo;rg.HIGHEST_SEMITONE=12;rg.LOWEST_SEMITONE=-12;rg.STATE_UNINITIALIZED=-1;class AK extends Bs{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const e=[Re.SOUND_MACHINE_START,Re.SOUND_MACHINE_STOP,Re.SOUND_MACHINE_DISPOSE,Re.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),e)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(e){if(super.processUpdateMessage(e),this.object.model.getValue(b.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(ms.INFOSTAND_EXTRA_PARAM,ms.JUKEBOX),e instanceof Zt)){const t=this.object.getState(0);t!==this._currentState&&(this._currentState=t,t===1?this.requestPlayList():t===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Re(Re.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new Re(Re.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.SOUND_MACHINE_DISPOSE,this.object))}}const qP=class extends wt{getEventTypes(){const s=[Q.STICKIE,Re.STICKIE];return this.mergeTypes(super.getEventTypes(),s)}initialize(s){super.initialize(s),this.updateColor(),this.object&&this.object.model.setValue(b.FURNITURE_IS_STICKIE,"")}processUpdateMessage(s){super.processUpdateMessage(s),s instanceof qE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Q(Q.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const s=this.object.model.getValue(b.FURNITURE_DATA);let e=qP.STICKIE_COLORS.indexOf(s);e<0&&(e=3),this.object.model.setValue(b.FURNITURE_COLOR,e+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Re(Re.STICKIE,this.object))}};let XP=qP;XP.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];class NK extends wt{getEventTypes(){const e=[Q.TROPHY];return this.mergeTypes(super.getEventTypes(),e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.TROPHY,this.object))}}const gu=class extends Bs{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(s){if(super.processUpdateMessage(s),s instanceof Zt){const e=s.data;if(!e)return;this.updateTotal(e.result)}}updateTotal(s){if(this._total=s,!this._lastUpdate){this.object.model.setValue(b.FURNITURE_VOTE_COUNTER_COUNT,s),this._lastUpdate=tt();return}if(this._total!==this.currentTotal){const e=Math.abs(this._total-this.currentTotal);e*gu.UPDATE_INTERVAL>gu.MAX_UPDATE_TIME?this._interval=gu.MAX_UPDATE_TIME/e:this._interval=gu.UPDATE_INTERVAL,this._lastUpdate=tt()}}update(s){if(super.update(s),this.object&&this.currentTotal!==this._total&&s>=this._lastUpdate+this._interval){const e=s-this._lastUpdate;let t=e/this._interval,r=1;this._total<this.currentTotal&&(r=-1),t>r*(this._total-this.currentTotal)&&(t=r*(this._total-this.currentTotal)),this.object.model.setValue(b.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+r*t),this._lastUpdate=s-(e-t*this._interval)}}get currentTotal(){return this.object.model.getValue(b.FURNITURE_VOTE_COUNTER_COUNT)}};let $E=gu;$E.UPDATE_INTERVAL=33;$E.MAX_UPDATE_TIME=1e3;class bK extends Bs{processUpdateMessage(e){if(super.processUpdateMessage(e),!!this.object&&e instanceof Zt){const t=e.data;t instanceof vd&&this.object.model.setValue(b.FURNITURE_VOTE_MAJORITY_RESULT,t.result)}}}class yK extends Bs{mouseEvent(e,t){!e||!t||(e.type===fe.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new vt(vt.STATE_CHANGE,this.object)),super.mouseEvent(e,t))}}class vK extends Bs{initialize(e){super.initialize(e);let t="";e.logic&&e.logic.maskType&&e.logic.maskType!==""&&e.logic.maskType.length>0&&(t=e.logic.maskType),this.object.model.setValue(b.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(b.FURNITURE_PLANE_MASK_TYPE,t)}}class MK extends wt{getEventTypes(){const e=[Q.YOUTUBE,Zi.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),e)}update(e){super.update(e),this.object.model.getValue(b.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new Zi(Zi.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new Q(Q.YOUTUBE,this.object))}}class DK extends Ro{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const e=[$e.CLICK,Vr.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),e)}initialize(e){if(!e)return;const t=this.object&&this.object.model;if(t){if(e.logic&&e.logic.model){const r=e.logic.model.directions;if(r&&r.length){for(const i of r)this._directions.push(i);this._directions.sort()}}t.setValue(b.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Vr(Vr.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(e){if(super.update(e),this._selected&&this.object&&this.eventDispatcher){const t=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==t.x||this._reportedLocation.y!==t.y||this._reportedLocation.z!==t.z)&&(this._reportedLocation||(this._reportedLocation=new G),this._reportedLocation.assign(t),this.eventDispatcher.dispatchEvent(new Vr(Vr.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(e,this.object.model)}updateModel(e,t){this._gestureEndTimestamp>0&&e>this._gestureEndTimestamp&&(t.setValue(b.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&e>this._talkingEndTimestamp&&(t.setValue(b.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&e>this._expressionEndTimestamp&&(t.setValue(b.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(e){if(!e||!this.object)return;super.processUpdateMessage(e);const t=this.object&&this.object.model;if(t){if(e instanceof i_){t.setValue(b.HEAD_DIRECTION,e.headDirection);return}if(e instanceof s_){const r=new ra(e.figure);t.setValue(b.FIGURE,e.figure),t.setValue(b.RACE,e.subType),t.setValue(b.PET_PALETTE_INDEX,r.paletteId),t.setValue(b.PET_COLOR,r.color),t.setValue(b.PET_TYPE,r.typeId),t.setValue(b.PET_CUSTOM_LAYER_IDS,r.customLayerIds),t.setValue(b.PET_CUSTOM_PARTS_IDS,r.customPartIds),t.setValue(b.PET_CUSTOM_PALETTE_IDS,r.customPaletteIds),t.setValue(b.PET_IS_RIDING,e.isRiding?1:0);return}if(e instanceof zE){t.setValue(b.FIGURE_POSTURE,e.postureType);return}if(e instanceof YE){t.setValue(b.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+e.numberOfWords*1e3;return}if(e instanceof KE){t.setValue(b.FIGURE_SLEEP,e.isSleeping?1:0);return}if(e instanceof xP){t.setValue(b.FIGURE_GESTURE,e.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(e instanceof r_){this._selected=e.selected,this._reportedLocation=null;return}if(e instanceof vP){t.setValue(b.FIGURE_EXPERIENCE_TIMESTAMP,this.time),t.setValue(b.FIGURE_GAINED_EXPERIENCE,e.gainedExperience);return}}}mouseEvent(e,t){let r=null;switch(e.type){case fe.MOUSE_CLICK:r=$e.CLICK;break;case fe.DOUBLE_CLICK:break;case fe.MOUSE_DOWN:{this.object.model.getValue(b.PET_TYPE)===ht.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new $e($e.MOUSE_DOWN,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown));break}}r&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new $e(r,this.object,e.eventId,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown))}}class QP{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get wallHeight(){return this._wallHeight}set wallHeight(e){this._wallHeight=e}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(e){this._fixedWallsHeight=e}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(e){this._restrictsDragging=e}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(e){this._restrictsScaling=e}get restrictedScale(){return this._restrictedScale}set restrictedScale(e){this._restrictedScale=e}}class ml{constructor(e,t,r){this.type=e,this.loc=t,this.category=r}get loc(){return this._loc}set loc(e){this._loc||(this._loc=new G),this._loc.assign(e)}get type(){return this._type}set type(e){this._type=e}get category(){return this._category}set category(e){this._category=e}dispose(){this._loc=null}}ml.WINDOW="window";ml.HOLE="hole";class PK{constructor(){this._masks=[]}get masks(){return this._masks}}class $P{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(e){if(!e)return!1;if(this._masks.clear(),e.masks.length)for(const t of e.masks){if(!t)continue;const r=t.locations.length?t.locations[0]:null;r&&this._masks.set(t.id,new ml(t.type,r,t.category))}return!0}reset(){for(const e of this._masks.values())e&&e.dispose();this._masks.clear()}addMask(e,t,r,i){const n=new ml(t,r,i);this._masks.delete(e),this._masks.set(e,n)}removeMask(e){const t=this._masks.get(e);return t?(this._masks.delete(e),t.dispose(),!0):!1}getXML(){const e=new PK;for(const[t,r]of this._masks.entries()){if(!r)continue;const i=this.getMaskType(r),n=this.getMaskCategory(r),o=this.getMaskLocation(r);if(i&&n&&o){const l={id:t,type:i,category:n,locations:[{x:o.x,y:o.y,z:o.z}]};e.masks.push(l)}}return e}getMaskLocation(e){return e?e.loc:null}getMaskType(e){return e?e.type:null}getMaskCategory(e){return e?e.category:null}get masks(){return this._masks}}class LK{constructor(e,t,r,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=e,this._rightSideLoc=t,this._leftSideLength=r,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class ns{constructor(e,t,r,i,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let o,l,c,h,u,g,m,p;if(this._secondaryNormals=[],this._masks=[],this._loc=new G,this._loc.assign(t),this._leftSide=new G,this._leftSide.assign(r),this._rightSide=new G,this._rightSide.assign(i),this._type=e,r!=null&&i!=null&&(this._normal=G.crossProduct(r,i),o=0,l=0,c=0,h=0,u=0,this.normal.x!=0||this.normal.y!=0?(h=this.normal.x,u=this.normal.y,o=360+Math.atan2(u,h)/Math.PI*180,o>=360&&(o=o-360),h=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),u=this.normal.z,l=360+Math.atan2(u,h)/Math.PI*180,l>=360&&(l=l-360)):this.normal.z<0?l=90:l=270,this._normalDirection=new G(o,l,c)),n!=null&&n.length>0)for(g=0;g<n.length;)m=n[g],m!=null&&m.length>0&&(p=new G,p.assign(m),p.multiply(1/p.length),this._secondaryNormals.push(p)),g++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(e){if(e<0||e>=this.secondaryNormalCount)return null;const t=new G;return t.assign(this._secondaryNormals[e]),t}addMask(e,t,r,i){const n=new LK(e,t,r,i);this._masks.push(n)}getMask(e){return e<0||e>=this.maskCount?null:this._masks[e]}getMaskLeftSideLoc(e){const t=this.getMask(e);return t!=null?t.leftSideLoc:-1}getMaskRightSideLoc(e){const t=this.getMask(e);return t!=null?t.rightSideLoc:-1}getMaskLeftSideLength(e){const t=this.getMask(e);return t!=null?t.leftSideLength:-1}getMaskRightSideLength(e){const t=this.getMask(e);return t!=null?t.rightSideLength:-1}}ns.PLANE_UNDEFINED=0;ns.PLANE_FLOOR=1;ns.PLANE_WALL=2;ns.PLANE_LANDSCAPE=3;ns.PLANE_BILLBOARD=4;class UK{constructor(e,t,r,i){this._x=e,this._y=t,this._width=r,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}const Pf=class{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(s,e,t,r,i){(this._addDuplicates||this.checkIsNotDuplicate(s,e,t,r,i))&&(this._corners.push(s),this._directions.push(e),this._lengths.push(t),this._borders.push(r),this._leftTurns.push(i),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(s,e,t,r,i){let n=0;for(;n<this._count;){if(this._corners[n].x==s.x&&this._corners[n].y==s.y&&this._directions[n]==e&&this._lengths[n]==t&&this._borders[n]==r&&this._leftTurns[n]==i)return!1;n++}return!0}get count(){return this._count}getCorner(s){return this._corners[s]}getEndPoint(s){return this.calculateWallEndPoints(),this._endPoints[s]}getLength(s){return this._lengths[s]}getDirection(s){return this._directions[s]}getBorder(s){return this._borders[s]}getHideWall(s){return this._hideWalls[s]}getLeftTurn(s){return this._leftTurns[s]}getManuallyLeftCut(s){return this._manuallyLeftCut[s]}getManuallyRightCut(s){return this._manuallyRightCut[s]}setHideWall(s,e){this._hideWalls[s]=e}setLength(s,e){e<this._lengths[s]&&(this._lengths[s]=e,this._manuallyRightCut[s]=!0)}moveCorner(s,e){let t;if(e>0&&e<this._lengths[s]){const r=this._corners[s];t=Pf.WALL_DIRECTION_VECTORS[this.getDirection(s)],this._corners[s]=new it(r.x+e*t.x,r.y+e*t.y),this._lengths[s]=this._lengths[s]-e,this._manuallyLeftCut[s]=!0}}calculateWallEndPoints(){let s,e,t,r,i;if(this._endPoints.length!=this.count)for(this._endPoints=[],s=0;s<this.count;)e=this.getCorner(s),t=new it(e.x,e.y),r=Pf.WALL_DIRECTION_VECTORS[this.getDirection(s)],i=this.getLength(s),t.x=t.x+r.x*i,t.y=t.y+r.y*i,this._endPoints.push(t),s++}};let Yn=Pf;Yn.WALL_DIRECTION_VECTORS=[new G(1,0,0),new G(0,1,0),new G(-1,0,0),new G(0,-1,0)];Yn.WALL_NORMAL_VECTORS=[new G(0,1,0),new G(-1,0,0),new G(0,-1,0),new G(1,0,0)];const Vt=class{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._highlights=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(s){const e=s.length;if(!e)return 0;let t=0,r=0;for(;r<e;){const i=s[r];let n=0;for(;n<i.length;){const o=i[n];o>t&&(t=o),n++}r++}return t}static findEntranceTile(s){if(!s)return null;const e=s.length;if(!e)return null;const t=[];let r=0;for(;r<e;){const i=s[r];if(!i||!i.length)return null;let n=0;for(;n<i.length;){if(i[n]>=0){t.push(n);break}n++}t.length<r+1&&t.push(i.length+1),r++}for(r=1;r<t.length-1;){if(Math.trunc(t[r])<=Math.trunc(t[r-1])-1&&Math.trunc(t[r])<=Math.trunc(t[r+1])-1)return new it(Math.trunc(t[r]|0),r);r++}return null}static expandFloorTiles(s){let e,t,r,i,n,o,l,c,h,u,g,m;const p=s.length,f=s[0].length,T=[];for(t=0;t<p*4;)T[t]=[],t++;let I=0;for(t=0;t<p;){for(n=0,e=0;e<f;){if(o=s[t][e],o<0||o<=255)for(i=0;i<4;){for(r=0;r<4;)T[I+i]===void 0&&(T[I+i]=[]),T[I+i][n+r]=o<0?o:o*4,r++;i++}else{for(l=(o&255)*4,c=l+(o>>11&1)*3,h=l+(o>>10&1)*3,u=l+(o>>9&1)*3,g=l+(o>>8&1)*3,r=0;r<3;)m=r+1,T[I][n+r]=(c*(3-r)+h*r)/3,T[I+3][n+m]=(u*(3-m)+g*m)/3,T[I+m][n]=(c*(3-m)+u*m)/3,T[I+r][n+3]=(h*(3-r)+g*r)/3,r++;T[I+1][n+1]=c>l?l+2:l+1,T[I+1][n+2]=h>l?l+2:l+1,T[I+2][n+1]=u>l?l+2:l+1,T[I+2][n+2]=g>l?l+2:l+1}n=n+4,e++}I=I+4,t++}return T}static addTileTypes(s){let e,t,r,i,n,o,l,c,h,u,g,m,p;const f=s.length-1,T=s[0].length-1;for(t=1;t<f;){for(e=1;e<T;)r=s[t][e],r<0||(i=s[t-1][e-1]&255,n=s[t-1][e]&255,o=s[t-1][e+1]&255,l=s[t][e-1]&255,c=s[t][e+1]&255,h=s[t+1][e-1]&255,u=s[t+1][e]&255,g=s[t+1][e+1]&255,m=r+1,p=(i==m||n==m||l==m?8:0)|(o==m||n==m||c==m?4:0)|(h==m||u==m||l==m?2:0)|(g==m||u==m||c==m?1:0),p==15&&(p=0),s[t][e]=r|p<<8),e++;t++}}static unpadHeightMap(s){s.shift(),s.pop();for(const e of s)e.shift(),e.pop()}static padHeightMap(s){const e=[],t=[];for(const r of s)r.push(Vt.TILE_BLOCKED),r.unshift(Vt.TILE_BLOCKED);for(const r of s[0])e.push(Vt.TILE_BLOCKED),t.push(Vt.TILE_BLOCKED);s.push(t),s.unshift(e)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(s){s<0&&(s=0),this._wallHeight=s}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(s){s<0&&(s=0),this._wallThicknessMultiplier=s}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(s){s<0&&(s=0),this._floorThicknessMultiplier=s}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(s,e){s<0&&(s=0),e<0&&(e=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let t=0;for(;t<e;){const r=[],i=[],n=[];let o=0;for(;o<s;)r[o]=Vt.TILE_BLOCKED,i[o]=Vt.TILE_BLOCKED,n[o]=!1,o++;this._tileMatrix.push(r),this._tileMatrixOriginal.push(i),this._floorHoleMatrix.push(n),t++}return this._width=s,this._height=e,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(s,e,t){let r,i,n,o,l;if(s>=0&&s<this._width&&e>=0&&e<this._height){if(r=this._tileMatrix[e],r[s]=t,t>=0)s<this._minX&&(this._minX=s),s>this._maxX&&(this._maxX=s),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(s==this._minX||s==this._maxX){for(i=!1,n=this._minY;n<this._maxY;){if(this.getTileHeightInternal(s,n)>=0){i=!0;break}n++}i||(s==this._minX&&this._minX++,s==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(o=!1,l=this._minX;l<this._maxX;){if(this.getTileHeight(l,e)>=0){o=!0;break}l++}o||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(s,e){if(s<0||s>=this._width||e<0||e>=this._height)return Vt.TILE_BLOCKED;const t=this._tileMatrix[e];return t[s]===void 0?0:Math.abs(t[s])}getTileHeightOriginal(s,e){return s<0||s>=this._width||e<0||e>=this._height?Vt.TILE_BLOCKED:this._floorHoleMatrix[e][s]?Vt.TILE_HOLE:this._tileMatrixOriginal[e][s]}getTileHeightInternal(s,e){return s<0||s>=this._width||e<0||e>=this._height?Vt.TILE_BLOCKED:this._tileMatrix[e][s]}initializeFromTileData(s=-1){let e,t;for(this._fixedWallHeight=s,t=0;t<this._height;){for(e=0;e<this._width;)this._tileMatrixOriginal[t]===void 0&&(this._tileMatrixOriginal[t]=[]),this._tileMatrixOriginal[t][e]=this._tileMatrix[t][e],e++;t++}const r=Vt.findEntranceTile(this._tileMatrix);for(t=0;t<this._height;){for(e=0;e<this._width;)this._floorHoleMatrix[t]===void 0&&(this._floorHoleMatrix[t]=[]),this._floorHoleMatrix[t][e]&&this.setTileHeight(e,t,Vt.TILE_HOLE),e++;t++}return this.initialize(r)}initialize(s){let e=0;s!=null&&(e=this.getTileHeight(s.x,s.y),this.setTileHeight(s.x,s.y,Vt.TILE_BLOCKED)),this._floorHeight=Vt.getFloorHeight(this._tileMatrix),this.createWallPlanes();const t=[];for(const i of this._tileMatrix)t.push(i.concat());Vt.padHeightMap(t),Vt.addTileTypes(t),Vt.unpadHeightMap(t);const r=Vt.expandFloorTiles(t);return this.floorTiles=r,this.extractPlanes(r),s!=null&&(this.setTileHeight(s.x,s.y,e),this.addFloor(new G(s.x+.5,s.y+.5,e),new G(-1,0,0),new G(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(s,e){let t,r,i,n,o;const l=new Yn,c=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let h=0,u=new it(s.x,s.y),g=0;for(;g++<1e3;){if(t=!1,r=!1,i=h,(u.x<this.minX||u.x>this.maxX||u.y<this.minY||u.y>this.maxY)&&(t=!0),n=c[h](u,e),n==null)return null;if(o=Math.abs(n.x-u.x)+Math.abs(n.y-u.y),u.x==n.x||u.y==n.y?(h=(h-1+c.length)%c.length,o=o+1,r=!0):(h=(h+1)%c.length,o--),l.addWall(u,i,o,t,r),n.x==s.x&&n.y==s.y&&(n.x!=u.x||n.y!=u.y))break;u=n}return l.count==0?null:l}hidePeninsulaWallChains(s){let e,t,r,i,n=0;const o=s.count;for(;n<o;){const l=n;for(e=n,t=0,r=!1;!s.getBorder(n)&&n<o;)s.getLeftTurn(n)?t++:t>0&&t--,t>1&&(r=!0),e=n,n++;if(r)for(i=l;i<=e;)s.setHideWall(i,!0),i++;n++}}updateWallsNextToHoles(s){let e,t,r,i,n,o,l;const c=s.count;let h=0;for(;h<c;){if(!s.getHideWall(h)){for(e=s.getCorner(h),t=s.getDirection(h),r=s.getLength(h),i=Yn.WALL_DIRECTION_VECTORS[t],n=Yn.WALL_NORMAL_VECTORS[t],o=0,l=0;l<r;){if(this.getTileHeightInternal(e.x+l*i.x-n.x,e.y+l*i.y-n.y)==Vt.TILE_HOLE){if(l>0&&o==0){s.setLength(h,l);break}o++}else if(o>0){s.moveCorner(h,o);break}l++}o==r&&s.setHideWall(h,!0)}h++}}resolveOriginalWallIndex(s,e,t){let r,i,n,o,l,c;const h=Math.min(s.y,e.y),u=Math.max(s.y,e.y),g=Math.min(s.x,e.x),m=Math.max(s.x,e.x),p=t.count;let f=0;for(;f<p;){if(r=t.getCorner(f),i=t.getEndPoint(f),s.x==e.x){if(r.x==s.x&&i.x==s.x&&(n=Math.min(r.y,i.y),o=Math.max(r.y,i.y),n<=h&&u<=o))return f}else if(s.y==e.y&&r.y==s.y&&i.y==s.y&&(l=Math.min(r.x,i.x),c=Math.max(r.x,i.x),l<=g&&m<=c))return f;f++}return-1}hideOriginallyHiddenWalls(s,e){let t,r,i,n,o;const l=s.count;let c=0;for(;c<l;)s.getHideWall(c)||(t=s.getCorner(c),r=new it(t.x,t.y),i=Yn.WALL_DIRECTION_VECTORS[s.getDirection(c)],n=s.getLength(c),r.x=r.x+i.x*n,r.y=r.y+i.y*n,o=this.resolveOriginalWallIndex(t,r,e),o>=0?e.getHideWall(o)&&s.setHideWall(c,!0):s.setHideWall(c,!0)),c++}checkWallHiding(s,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(s),this.hideOriginallyHiddenWalls(s,e)}addWalls(s,e){const t=s.count,r=e.count;let i=0;for(;i<t;){if(!s.getHideWall(i)){const n=s.getCorner(i),o=s.getDirection(i),l=s.getLength(i),c=Yn.WALL_DIRECTION_VECTORS[o],h=Yn.WALL_NORMAL_VECTORS[o];let u=-1,g=0;for(;g<l;){const F=this.getTileHeightInternal(n.x+g*c.x+h.x,n.y+g*c.y+h.y);F>=0&&(F<u||u<0)&&(u=F),g++}const m=u;let p=new G(n.x,n.y,m);p=G.sum(p,G.product(h,.5)),p=G.sum(p,G.product(c,-.5));const f=this.wallHeight+Math.min(Vt.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-u,T=G.product(c,-l),I=new G(0,0,f);p=G.dif(p,T);const O=this.resolveOriginalWallIndex(n,s.getEndPoint(i),e);let A=0,N=0;O>=0?(A=e.getDirection((O+1)%r),N=e.getDirection((O-1+r)%r)):(A=s.getDirection((i+1)%t),N=s.getDirection((i-1+t)%t));let P=null;(A-o+4)%4==3?P=Yn.WALL_NORMAL_VECTORS[A]:(o-N+4)%4==3&&(P=Yn.WALL_NORMAL_VECTORS[N]);const y=s.getLeftTurn(i),D=s.getLeftTurn((i-1+t)%t),x=s.getHideWall((i+1)%t),w=s.getManuallyLeftCut(i),k=s.getManuallyRightCut(i);this.addWall(p,T,I,P,!D||w,!y||k,!x)}i++}}createWallPlanes(){const s=this._tileMatrix;if(s==null)return!1;let e,t,r;const i=s.length;let n=0;if(i==0)return!1;for(e=0;e<i;){if(r=s[e],r==null||r.length==0)return!1;n>0?n=Math.min(n,r.length):n=r.length,e++}const o=Math.min(Vt.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:Vt.getFloorHeight(s)),l=this.minX;let c=this.minY;for(c=this.minY;c<=this.maxY;){if(this.getTileHeightInternal(l,c)>Vt.TILE_HOLE){c--;break}c++}if(c>this.maxY)return!1;const h=new it(l,c),u=this.generateWallData(h,!0),g=this.generateWallData(h,!1);for(u!=null&&(u.count,g.count,this.checkWallHiding(u,g),this.addWalls(u,g)),t=0;t<this.tileMapHeight;){for(e=0;e<this.tileMapWidth;)this.getTileHeightInternal(e,t)<0&&this.setTileHeight(e,t,-(o+this.wallHeight)),e++;t++}return!0}extractTopWall(s,e){if(s==null)return null;let t=1,r=Vt.TILE_HOLE;for(e||(r=Vt.TILE_BLOCKED);t<1e3;){if(this.getTileHeightInternal(s.x+t,s.y)>r)return new it(s.x+t-1,s.y);if(this.getTileHeightInternal(s.x+t,s.y+1)<=r)return new it(s.x+t,s.y+1);t++}return null}extractRightWall(s,e){if(s==null)return null;let t=1,r=Vt.TILE_HOLE;for(e||(r=Vt.TILE_BLOCKED);t<1e3;){if(this.getTileHeightInternal(s.x,s.y+t)>r)return new it(s.x,s.y+(t-1));if(this.getTileHeightInternal(s.x-1,s.y+t)<=r)return new it(s.x-1,s.y+t);t++}return null}extractBottomWall(s,e){if(s==null)return null;let t=1,r=Vt.TILE_HOLE;for(e||(r=Vt.TILE_BLOCKED);t<1e3;){if(this.getTileHeightInternal(s.x-t,s.y)>r)return new it(s.x-(t-1),s.y);if(this.getTileHeightInternal(s.x-t,s.y-1)<=r)return new it(s.x-t,s.y-1);t++}return null}extractLeftWall(s,e){if(s==null)return null;let t=1,r=Vt.TILE_HOLE;for(e||(r=Vt.TILE_BLOCKED);t<1e3;){if(this.getTileHeightInternal(s.x,s.y-t)>r)return new it(s.x,s.y-(t-1));if(this.getTileHeightInternal(s.x+1,s.y-t)<=r)return new it(s.x+1,s.y-t);t++}return null}addWall(s,e,t,r,i,n,o){this.addPlane(ns.PLANE_WALL,s,e,t,[r]),this.addPlane(ns.PLANE_LANDSCAPE,s,e,t,[r]);const l=Vt.WALL_THICKNESS*this._wallThicknessMultiplier,c=Vt.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=G.crossProduct(e,t),u=G.product(h,1/h.length*-l);if(this.addPlane(ns.PLANE_WALL,G.sum(s,t),e,u,[h,r]),i&&this.addPlane(ns.PLANE_WALL,G.sum(G.sum(s,e),t),G.product(t,-(t.length+c)/t.length),u,[h,r]),n&&(this.addPlane(ns.PLANE_WALL,G.sum(s,G.product(t,-c/t.length)),G.product(t,(t.length+c)/t.length),u,[h,r]),o)){const g=G.product(e,l/e.length);this.addPlane(ns.PLANE_WALL,G.sum(G.sum(s,t),G.product(g,-1)),g,u,[h,e,r])}}addFloor(s,e,t,r,i,n,o,l=!1){let c,h,u;this.addPlane(ns.PLANE_FLOOR,s,e,t,null,l)!=null&&(c=Vt.FLOOR_THICKNESS*this._floorThicknessMultiplier,h=new G(0,0,c),u=G.dif(s,h),n&&this.addPlane(ns.PLANE_FLOOR,u,e,h,null,l),o&&this.addPlane(ns.PLANE_FLOOR,G.sum(u,G.sum(e,t)),G.product(e,-1),h,null,l),r&&this.addPlane(ns.PLANE_FLOOR,G.sum(u,t),G.product(t,-1),h,null,l),i&&this.addPlane(ns.PLANE_FLOOR,G.sum(u,e),t,h,null,l))}initializeFromMapData(s){if(!s)return!1;this.reset(),this.resetFloorHoles();const e=s.width,t=s.height,r=s.wallHeight,i=s.fixedWallsHeight;if(this.initializeTileMap(e,t),s.tileMap){let n=0;for(;n<s.tileMap.length;){const o=s.tileMap[n];if(o){let l=0;for(;l<o.length;){const c=o[l];c&&this.setTileHeight(l,n,c.height),l++}}n++}}if(s.holeMap&&s.holeMap.length){let n=0;for(;n<s.holeMap.length;){const o=s.holeMap[n];o&&(this.addFloorHole(o.id,o.x,o.y,o.width,o.height),n++)}this.initializeHoleMap()}return this.wallHeight=r,this.restrictsDragging=s.restrictsDragging,this.restrictsScaling=s.restrictsScaling,this.restrictedScale=s.restrictedScale,this.initializeFromTileData(i),!0}isPlaneTemporaryHighlighter(s){if(s<0||s>=this.planeCount)return!1;const e=this._planes[s];return e==null?!1:this._highlights.indexOf(e)!=-1}addPlane(s,e,t,r,i=null,n=!1){if(t.length==0||r.length==0)return null;const o=new ns(s,e,t,r,i);return this._planes.push(o),n&&this._highlights.push(o),o}getMapData(){const s=new QP;s.width=this._width,s.height=this._height,s.wallHeight=this._wallHeight,s.fixedWallsHeight=this._fixedWallHeight,s.dimensions.minX=this.minX,s.dimensions.maxX=this.maxX,s.dimensions.minY=this.minY,s.dimensions.maxY=this.maxY,s.restrictsDragging=this.restrictsDragging,s.restrictsScaling=this.restrictsScaling,s.restrictedScale=this.restrictedScale;let e=0;for(;e<this._height;){const t=[],r=this._tileMatrixOriginal[e];let i=0;for(;i<this._width;){const n=r[i];t.push({height:n}),i++}s.tileMap.push(t),e++}for(const[t,r]of this._floorHoles.entries())r&&s.holeMap.push({id:t,x:r.x,y:r.y,width:r.width,height:r.height});return s}getPlaneLocation(s){if(s<0||s>=this.planeCount)return null;const e=this._planes[s];return e?e.loc:null}getPlaneNormal(s){if(s<0||s>=this.planeCount)return null;const e=this._planes[s];return e?e.normal:null}getPlaneLeftSide(s){if(s<0||s>=this.planeCount)return null;const e=this._planes[s];return e?e.leftSide:null}getPlaneRightSide(s){if(s<0||s>=this.planeCount)return null;const e=this._planes[s];return e?e.rightSide:null}getPlaneNormalDirection(s){if(s<0||s>=this.planeCount)return null;const e=this._planes[s];return e?e.normalDirection:null}getPlaneSecondaryNormals(s){let e,t;if(s<0||s>=this.planeCount)return null;const r=this._planes[s];if(r!=null){for(e=[],t=0;t<r.secondaryNormalCount;)e.push(r.getSecondaryNormal(t)),t++;return e}return null}getPlaneType(s){if(s<0||s>=this.planeCount)return ns.PLANE_UNDEFINED;const e=this._planes[s];return e?e.type:ns.PLANE_UNDEFINED}getPlaneMaskCount(s){if(s<0||s>=this.planeCount)return 0;const e=this._planes[s];return e?e.maskCount:0}getPlaneMaskLeftSideLoc(s,e){if(s<0||s>=this.planeCount)return-1;const t=this._planes[s];return t?t.getMaskLeftSideLoc(e):-1}getPlaneMaskRightSideLoc(s,e){if(s<0||s>=this.planeCount)return-1;const t=this._planes[s];return t?t.getMaskRightSideLoc(e):-1}getPlaneMaskLeftSideLength(s,e){if(s<0||s>=this.planeCount)return-1;const t=this._planes[s];return t?t.getMaskLeftSideLength(e):-1}getPlaneMaskRightSideLength(s,e){if(s<0||s>=this.planeCount)return-1;const t=this._planes[s];return t?t.getMaskRightSideLength(e):-1}addFloorHole(s,e,t,r,i){this.removeFloorHole(s),this._floorHoles.set(s,new UK(e,t,r,i))}removeFloorHole(s){this._floorHoles.delete(s)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let s,e,t,r,i,n,o,l;for(e=0;e<this._height;){for(t=this._floorHoleMatrix[e],s=0;s<this._width;)t[s]=!1,s++;e++}for(const c of this._floorHoles.values())if(r=c,r!=null)for(i=r.x,n=r.x+r.width-1,o=r.y,l=r.y+r.height-1,i=i<0?0:i,n=n>=this._width?this._width-1:n,o=o<0?0:o,l=l>=this._height?this._height-1:l,e=o;e<=l;){for(t=this._floorHoleMatrix[e],s=i;s<=n;)t[s]=!0,s++;e++}}initializeHighlightArea(s,e,t,r){this.clearHighlightArea(),this.extractPlanes(this.floorTiles,s*4,e*4,t*4,r*4,!0)}clearHighlightArea(){const s=this._highlights.length;return this._planes=this._planes.slice(0,this._planes.length-this._highlights.length),this._highlights.length=0,s}extractPlanes(s,e=0,t=0,r=-1,i=-1,n=!1){if(n){this.extractHighlightPlanes(s,e,t,r,i);return}let o=0,l=0,c=0,h=0,u=0,g=0,m=!1,p=!1,f=!1,T=!1,I=0,O=0,A=!1,N=NaN,P=NaN,y=NaN,D=NaN;const x=s.length,w=s[0].length,k=i==-1?x:Math.min(x,t+i),F=r==-1?w:Math.min(w,e+r),L=[];for(o=0;o<k;)L[o]=[],o++;for(l=t;l<k;){for(c=e;c<F;){if(!((h=s[l][c])<0||L[l][c])){for(m=c==0||s[l][c-1]!=h,p=l==0||s[l-1][c]!=h,u=c+1;u<F&&!(s[l][u]!=h||L[l][u]||l>0&&s[l-1][u]==h==p);)u++;for(f=u==w||s[l][u]!=h,A=!1,g=l+1;g<=k&&!A&&(T=g==x||s[g][c]!=h,A=g==k||T||c>0&&s[g][c-1]==h==m||u<w&&s[g][u]==h==f,g!=x);){for(I=c;I<u;){if(s[g][I]==h==T){A=!0,u=I;break}I++}if(A)break;g++}for(T||(T=g==x),f=u==w||s[l][u]!=h,O=l;O<g;){for(I=c;I<u;)L[O][I]=!0,I++;O++}N=c/4-.5,P=l/4-.5,y=(u-c)/4,D=(g-l)/4,this.addFloor(new G(N+y,P+D,h/4),new G(-y,0,0),new G(0,-D,0),f,m,T,p,n)}c++}l++}}extractHighlightPlanes(s,e=0,t=0,r=-1,i=-1){const n=s.length,o=s[0].length,l=i==-1?n:Math.min(n,t+i),c=r==-1?o:Math.min(o,e+r),h=[];for(let g=0;g<n;g++){h[g]=[];for(let m=0;m<o;m++)h[g][m]=g>=t&&g<l&&m>=e&&m<c&&s[g][m]>=0}const u=new Map;for(let g=t;g<l;g++)for(let m=e;m<c;m++){const p=s[g][m];if(p>=0){u.has(p)||u.set(p,{minX:m,maxX:m,minY:g,maxY:g,tiles:[]});const f=u.get(p);f.minX=Math.min(f.minX,m),f.maxX=Math.max(f.maxX,m),f.minY=Math.min(f.minY,g),f.maxY=Math.max(f.maxY,g),f.tiles.push({x:m,y:g})}}for(const[g,m]of u){const p=e/4-.5,f=t/4-.5,T=(r==-1?c-e:r)/4,I=(i==-1?l-t:i)/4,O=g/4+.01,A=e==0||!this.hasValidTileAt(s,e-1,t,l-t,g),N=t==0||!this.hasValidTileAt(s,e,t-1,c-e,g),P=c==o||!this.hasValidTileAt(s,c,t,l-t,g),y=l==n||!this.hasValidTileAt(s,e,l,c-e,g);this.addFloor(new G(p+T,f+I,O),new G(-T,0,0),new G(0,-I,0),P,A,y,N,!0)}}hasValidTileAt(s,e,t,r,i){const n=s.length,o=s[0].length;for(let l=0;l<r;l++){const c=e+(t===t?l:0),h=t+(e===e?l:0);if(c>=0&&c<o&&h>=0&&h<n&&s[h][c]===i)return!0}return!1}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(s){this._restrictsDragging=s}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(s){this._restrictsScaling=s}get restrictedScale(){return this._restrictedScale}set restrictedScale(s){this._restrictedScale=s}};let Ps=Vt;Ps.FLOOR_THICKNESS=.25;Ps.WALL_THICKNESS=.25;Ps.MAX_WALL_ADDITIONAL_HEIGHT=20;Ps.TILE_BLOCKED=-110;Ps.TILE_HOLE=-100;class xK extends D_{constructor(){super(),this._planeParser=new Ps,this._planeBitmapMaskParser=new $P,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const e=[$e.MOUSE_MOVE,$e.CLICK];return this.mergeTypes(super.getEventTypes(),e)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(e){!e||!this.object||e instanceof QP&&this._planeParser.initializeFromMapData(e)&&(this.object.model.setValue(b.ROOM_MAP_DATA,e),this.object.model.setValue(b.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(b.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(b.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(b.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=Ke.getValue("room.color.skip.transition")===!0)}update(e){if(super.update(e),this.updateBackgroundColor(e),this._needsMapUpdate){if(this._lastHoleUpdate&&e-this._lastHoleUpdate<5)return;const t=this.object&&this.object.model;if(t){const r=this._planeParser.getMapData();t.setValue(b.ROOM_MAP_DATA,r),t.setValue(b.ROOM_FLOOR_HOLE_UPDATE_TIME,e),this._planeParser.initializeFromMapData(r)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(e){if(!this.object||!this._colorChangedTime)return;let t=this._color,r=this._light;if(e-this._colorChangedTime>=this._colorTransitionLength)t=this._targetColor,r=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,o=this._originalColor>>8&255,l=this._originalColor&255;const c=this._targetColor>>16&255,h=this._targetColor>>8&255,u=this._targetColor&255,g=(e-this._colorChangedTime)/this._colorTransitionLength;n=n+(c-n)*g,o=o+(h-o)*g,l=l+(u-l)*g,t=(n<<16)+(o<<8)+l,r=this._originalLight+(this._targetLight-this._originalLight)*g,this._color=t,this._light=r}let i=Sr.rgbToHSL(t);i=(i&16776960)+r,t=Sr.hslToRGB(i),this.object.model&&this.object.model.setValue(b.ROOM_BACKGROUND_COLOR,t)}processUpdateMessage(e){if(!e||!this.object)return;const t=this.object.model;if(t){if(e instanceof _r){this.onObjectRoomUpdateMessage(e,t);return}if(e instanceof gr){this.onObjectRoomMaskUpdateMessage(e,t);return}if(e instanceof Pa){this.onObjectRoomPlaneVisibilityUpdateMessage(e,t);return}if(e instanceof Da){this.onObjectRoomPlanePropertyUpdateMessage(e,t);return}if(e instanceof Ma){this.onObjectRoomFloorHoleUpdateMessage(e,t);return}if(e instanceof n_){this.onObjectRoomColorUpdateMessage(e,t);return}e instanceof XE&&this.onObjectRoomMapUpdateMessage(e)}}onObjectRoomUpdateMessage(e,t){switch(e.type){case _r.ROOM_FLOOR_UPDATE:t.setValue(b.ROOM_FLOOR_TYPE,e.value);return;case _r.ROOM_WALL_UPDATE:t.setValue(b.ROOM_WALL_TYPE,e.value);return;case _r.ROOM_LANDSCAPE_UPDATE:t.setValue(b.ROOM_LANDSCAPE_TYPE,e.value);return}}onObjectRoomMaskUpdateMessage(e,t){let r=null,i=!1;switch(e.type){case gr.ADD_MASK:r=ml.WINDOW,e.maskCategory===gr.HOLE&&(r=ml.HOLE),this._planeBitmapMaskParser.addMask(e.maskId,e.maskType,e.maskLocation,r),i=!0;break;case gr.REMOVE_MASK:i=this._planeBitmapMaskParser.removeMask(e.maskId);break}i&&t.setValue(b.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(e,t){let r=0;switch(e.visible&&(r=1),e.type){case Pa.FLOOR_VISIBILITY:t.setValue(b.ROOM_FLOOR_VISIBILITY,r);return;case Pa.WALL_VISIBILITY:t.setValue(b.ROOM_WALL_VISIBILITY,r),t.setValue(b.ROOM_LANDSCAPE_VISIBILITY,r);return}}onObjectRoomPlanePropertyUpdateMessage(e,t){switch(e.type){case Da.FLOOR_THICKNESS:t.setValue(b.ROOM_FLOOR_THICKNESS,e.value);return;case Da.WALL_THICKNESS:t.setValue(b.ROOM_WALL_THICKNESS,e.value);return}}onObjectRoomFloorHoleUpdateMessage(e,t){switch(e.type){case Ma.ADD:this._planeParser.addFloorHole(e.id,e.x,e.y,e.width,e.height),this._needsMapUpdate=!0;return;case Ma.REMOVE:this._planeParser.removeFloorHole(e.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(e,t){!e||!t||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=e.color,this._targetLight=e.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,t.setValue(b.ROOM_COLORIZE_BG_ONLY,e.backgroundOnly))}onObjectRoomMapUpdateMessage(e){!e||!e.mapData||(this.object.model.setValue(b.ROOM_MAP_DATA,e.mapData),this.object.model.setValue(b.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(e.mapData))}mouseEvent(e,t){if(!e||!t||!this.object||!this.object.model)return;const r=e.spriteTag;let i=0;if(r&&r.indexOf("@")>=0&&(i=parseInt(r.substr(r.indexOf("@")+1))),i<1||i>this._planeParser.planeCount){e.type===fe.ROLL_OUT&&this.object.model.setValue(b.ROOM_SELECTED_PLANE,0);return}i--;let n=null;const o=this._planeParser.getPlaneLocation(i),l=this._planeParser.getPlaneLeftSide(i),c=this._planeParser.getPlaneRightSide(i),h=this._planeParser.getPlaneNormalDirection(i),u=this._planeParser.getPlaneType(i);if(o==null||l==null||c==null||h==null)return;const g=l.length,m=c.length;if(g==0||m==0)return;const p=e.screenX,f=e.screenY,T=new it(p,f);if(n=t.getPlanePosition(T,o,l,c),!n){this.object.model.setValue(b.ROOM_SELECTED_PLANE,0);return}const I=G.product(l,n.x/g);I.add(G.product(c,n.y/m)),I.add(o);const O=I.x,A=I.y,N=I.z;if(n.x>=0&&n.x<g&&n.y>=0&&n.y<m)this.object.model.setValue(b.ROOM_SELECTED_X,O),this.object.model.setValue(b.ROOM_SELECTED_Y,A),this.object.model.setValue(b.ROOM_SELECTED_Z,N),this.object.model.setValue(b.ROOM_SELECTED_PLANE,i+1);else{this.object.model.setValue(b.ROOM_SELECTED_PLANE,0);return}let P=null;switch(e.type===fe.MOUSE_MOVE||e.type===fe.ROLL_OVER?P=$e.MOUSE_MOVE:e.type===fe.MOUSE_CLICK?P=$e.CLICK:e.type===fe.MOUSE_DOWN&&(P=$e.MOUSE_DOWN),e.type){case fe.MOUSE_MOVE:case fe.MOUSE_DOWN:case fe.ROLL_OVER:case fe.MOUSE_CLICK:{let y=null;if(u===ns.PLANE_FLOOR)y=new Gn(P,this.object,e.eventId,O,A,N,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown);else if(u===ns.PLANE_WALL||u===ns.PLANE_LANDSCAPE){let D=90;h&&(D=h.x+90,D>360&&(D-=360));const x=l.length*n.x/g,w=c.length*n.y/m;y=new Gl(P,this.object,e.eventId,o,l,c,x,w,D,e.altKey,e.ctrlKey,e.shiftKey,e.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(y);return}}}}class wK extends D_{initialize(e){this.object&&(this.object.model.setValue(b.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(e){if(super.processUpdateMessage(e),e instanceof La&&this.object)switch(e.type){case La.ENABLED:this.object.setState(0,0);return;case La.DISABLED:this.object.setState(1,0);return}}}const jl=class extends D_{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(s){this.object&&(this.object.model.setValue(b.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(jl.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(s){s instanceof Vl&&(this._lastEventId&&this._lastEventId===s.sourceEventId||(s.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(s),this.object&&(this._isHidden?this.object.setState(jl.CURSOR_HIDDEN_STATE,0):s.visible?(this.object.model.setValue(b.TILE_CURSOR_HEIGHT,s.height),this.object.setState(s.height>.8?jl.CURSOR_HEIGHT_STATE:jl.CURSOR_VISIBLE_STATE)):this.object.setState(jl.CURSOR_HIDDEN_STATE,0)),this._lastEventId=s.sourceEventId))}};let ig=jl;ig.CURSOR_VISIBLE_STATE=0;ig.CURSOR_HIDDEN_STATE=1;ig.CURSOR_HEIGHT_STATE=6;class JP{constructor(e,t,r){this._id=e,this._type=t,this._visualization=r}dispose(){this._visualization=null}update(e,t){}animate(e){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const to=class extends JP{constructor(s,e,t){super(s,e,t),this._asset=null,this._startTime=tt(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(s,e){if(!s)return;this._scale=e;let t=64,r=0;if(e<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?r=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?r=6:r=-6,this._offsetY=-38,t=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?r=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?r=22:r=-30,this._offsetY=-70),this.visualization.posture===he.POSTURE_SIT?this._offsetY+=t/2:this.visualization.posture===he.POSTURE_LAY&&(this._offsetY+=t),this._asset){s.texture=this._asset,s.offsetX=r,s.offsetY=this._offsetY,s.relativeDepth=-.02,s.alpha=0;const i=this._delta;this.animate(s),this._delta=i}}animate(s){if(!s)return!1;if(this._asset&&(s.texture=this._asset),this._state===to.STATE_DELAY)return tt()-this._startTime<to.DELAY_BEFORE_ANIMATION?!1:(this._state=to.STATE_FADE_IN,s.alpha=0,s.visible=!0,this._delta=0,!0);if(this._state===to.STATE_FADE_IN)return this._delta+=.1,s.offsetY=this._offsetY,s.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(s.alpha=255,this._delta=0,this._state=to.STATE_FLOAT),!0;if(this._state===to.STATE_FLOAT){const e=Math.pow(this._delta,.9);this._delta+=.05;const t=this._scale<48?-30:-40;return s.offsetY=this._offsetY+(this._delta<1?e:1)*t,s.alpha=(1-e)*255,s.alpha<=0&&(s.visible=!1,this._state=to.STATE_COMPLETE),!0}return!1}};let Hc=to;Hc.DELAY_BEFORE_ANIMATION=300;Hc.STATE_DELAY=0;Hc.STATE_FADE_IN=1;Hc.STATE_FLOAT=2;Hc.STATE_COMPLETE=3;class Wc{static getExpressionAddition(e,t,r){switch(t){case this.BLOW:return new Hc(e,this.BLOW,r);default:return new JP(e,t,r)}}}Wc.WAVE=1;Wc.BLOW=2;Wc.LAUGH=3;Wc.CRY=4;Wc.IDLE=5;const mn=class{constructor(s,e){this._id=s,this._visualization=e,this._asset=null,this._startTime=tt(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(s){let e="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(e="right"),"avatar_addition_user_idle_"+e+"_"+s+(this._scale<48?"_small":"")}update(s,e){if(!s)return;this._scale=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===mn.STATE_FRAME_A?1:2));let t=64,r=0;e<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?r=10:r=-16,this._offsetY=-38,t=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?r=22:r=-30,this._offsetY=-70),this._visualization.posture===he.POSTURE_SIT?this._offsetY+=t/2:this._visualization.posture===he.POSTURE_LAY&&(this._offsetY+=t-.3*t),this._asset&&(s.texture=this._asset,s.offsetX=r,s.offsetY=this._offsetY,s.relativeDepth=-.02,s.alpha=0)}animate(s){if(!s)return!1;const e=tt();return this._state===mn.STATE_DELAY&&e-this._startTime>=mn.DELAY_BEFORE_ANIMATION&&(this._state=mn.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===mn.STATE_FRAME_A&&e-this._startTime>=mn.DELAY_PER_FRAME&&(this._state=mn.STATE_FRAME_B,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===mn.STATE_FRAME_B&&e-this._startTime>=mn.DELAY_PER_FRAME&&(this._state=mn.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(s.texture=this._asset,s.alpha=255,s.visible=!0):s.visible=!1,!1}get id(){return this._id}};let jc=mn;jc.DELAY_BEFORE_ANIMATION=2e3;jc.DELAY_PER_FRAME=2e3;jc.STATE_DELAY=0;jc.STATE_FRAME_A=1;jc.STATE_FRAME_B=2;const mu=class{constructor(s){this._id=s,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(s,e){if(s){if(!this._asset){const t=new bs(ys.WHITE);t.alpha=0,t.width=mu.WIDTH,t.height=mu.HEIGHT,this._asset=Lt.generateTexture(t)}s.visible=!0,s.texture=this._asset,s.offsetX=mu.OFFSET_X,s.offsetY=mu.OFFSET_Y,s.alphaTolerance=vi.MATCH_ALL_PIXELS}}animate(s){return!1}get id(){return this._id}};let oh=mu;oh.WIDTH=46;oh.HEIGHT=60;oh.OFFSET_X=-23;oh.OFFSET_Y=-48;class FK{constructor(e,t,r){this._id=e,this._visualization=t,this._asset=null,this._relativeDepth=0,this._status=r}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;e.visible=!0,e.relativeDepth=this._relativeDepth,e.alpha=255;let r=64,i=0,n=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===Tn.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),t<48?(i=-19,n=-80,r=32):(i=-19,n=-120),this._visualization.posture===he.POSTURE_SIT?n+=r/2:this._visualization.posture===he.POSTURE_LAY&&(n+=t),this._asset&&(e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.02+0)}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth=e}}class kK{constructor(e,t){this._id=e,this._visualization=t,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;let r=64,i=0,n=0;t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),r=32,i=-12,n=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),i=-15,n=-110),this._visualization.posture===he.POSTURE_SIT?n+=r/2:this._visualization.posture===he.POSTURE_LAY&&(n+=t),this._asset?(e.visible=!0,e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.02):e.visible=!1}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}}class GK{constructor(e,t,r){this._id=e,this._visualization=r,this._asset=null,this._scale=0,this._number=t,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;this._scale=t;let r=64,i=0,n=0;this._number>0?(t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),r=32,i=-6,n=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),i=-8,n=-105),this._visualization.posture===he.POSTURE_SIT?n+=r/2:this._visualization.posture===he.POSTURE_LAY&&(n+=t),this._asset?(e.visible=!0,e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.01,e.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):e.visible=!1):e.visible&&(this._numberValueFadeDirection=-1)}animate(e){if(!e)return!1;this._asset&&(e.texture=this._asset);let t=e.alpha,r=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?e.offsetY-=2:e.offsetY-=4;else{let i=4;this._scale<48&&(i=8),this._numberValueMoveCounter%i||(e.offsetY--,r=!0)}}return this._numberValueFadeDirection>0?(t<255&&(t+=32),t>=255&&(t=255,this._numberValueFadeDirection=0),e.alpha=t,!0):this._numberValueFadeDirection<0?(t>=0&&(t-=32),t<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,t=0,e.visible=!1),e.alpha=t,!0):r}get id(){return this._id}}class BK{constructor(e,t){this._id=e,this._visualization=t,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(e,t){if(!e)return;e.visible=!0,e.relativeDepth=this._relativeDepth,e.alpha=255;let r=64,i=0,n=0;t<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),i=3,n=-42,r=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),i=14,n=-83),this._visualization.posture===he.POSTURE_SIT?n+=r/2:this._visualization.posture===he.POSTURE_LAY&&(n+=t),this._asset&&(e.texture=this._asset,e.offsetX=i,e.offsetY=n,e.relativeDepth=-.02+0)}animate(e){return this._asset&&e&&(e.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(e){this._relativeDepth=e}}class a_ extends Ti{constructor(){super()}initialize(e){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(e,t,r=null,i=null,n=null){let o=null;return t>48?o=this._avatarRenderer.createAvatarImage(e,yi.LARGE,r,i,n):o=this._avatarRenderer.createAvatarImage(e,yi.SMALL,r,i,n),o}getAvatarRendererAsset(e){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(e):null}get avatarManager(){return this._avatarRenderer}set avatarManager(e){this._avatarRenderer=e}get layerCount(){return 0}}const st=class extends $u{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new As,this._cachedAvatarEffects=new As,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._focusAlpha=255,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(s){return s instanceof a_?(this._data=s,this.createSprites(st.INITIAL_RESERVED_SPRITES),super.initialize(s),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(s,e,t,r){if(!this.object||!s||!this._data||e<this._lastUpdate+st.UPDATE_TIME_INCREASER)return;this._lastUpdate+=st.UPDATE_TIME_INCREASER,this._lastUpdate+st.UPDATE_TIME_INCREASER<e&&(this._lastUpdate=e-st.UPDATE_TIME_INCREASER);const i=this.object.model,n=s.scale,o=this._effect;let l=!1,c=!1,h=!1,u=!1;const g=this.updateModel(i,n);if(g||n!==this._scale||!this._avatarImage){if(n!==this._scale&&(l=!0,this.updateScale(n)),o!==this._effect&&(c=!0),l||!this._avatarImage||c){if(this._avatarImage=this.createAvatarImage(n,this._effect),!this._avatarImage)return;h=!0;const f=this.getSprite(st.AVATAR_LAYER_ID);f&&this._avatarImage&&this._avatarImage.isPlaceholder()?f.alpha=150:f&&(f.alpha=255),this.applyFocusAlpha(f)}if(!this._avatarImage)return;if(c&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(n),u=this.updateObject(this.object,s,t,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let f=this._extraSpritesStartIndex;for(const T of this._additions.values())T.update(this.getSprite(f++),n)}this._scale=n}else u=this.updateObject(this.object,s,t);if(this._additions){let f=this._extraSpritesStartIndex;for(const T of this._additions.values())T.animate(this.getSprite(f++))&&this.updateSpriteCounter++}this.enforceFocusAlpha();const m=u||g||l,p=(this._isAnimating||this._forcedAnimFrames>0)&&t;if(m&&(this._forcedAnimFrames=st.ANIMATION_FRAME_UPDATE_INTERVAL),m||p){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||l||g||h)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=st.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let f=this._avatarImage.getCanvasOffsets();(!f||f.length<3)&&(f=st.DEFAULT_CANVAS_OFFSETS);const T=this.getSprite(st.SPRITE_INDEX_AVATAR);if(T){const N=this.object.model.getValue(b.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(b.FIGURE_HIGHLIGHT)===1,P=this._avatarImage.getImage(lr.FULL,N);P&&(T.texture=P,N||(T.filters=[])),T.texture&&(T.offsetX=-1*n/2+f[0]-(T.texture.width-n)/2,T.offsetY=-T.texture.height+n/4+f[1]+this._postureOffset),this._isLaying?this._layInside?T.relativeDepth=-.5:T.relativeDepth=st.AVATAR_SPRITE_LAYING_DEPTH+f[2]:T.relativeDepth=st.AVATAR_SPRITE_DEFAULT_DEPTH+f[2],this._ownUser?(T.relativeDepth-=st.AVATAR_OWN_DEPTH_ADJUST,T.spriteType=$r.AVATAR_OWN):T.spriteType=$r.AVATAR}const I=this.getAddition(st.TYPING_BUBBLE_ID);I&&(this._isLaying?I.relativeDepth=st.AVATAR_SPRITE_LAYING_DEPTH-.01+f[2]:I.relativeDepth=st.AVATAR_SPRITE_DEFAULT_DEPTH-.01+f[2]),this._isAnimating=this._avatarImage.isAnimating();let O=st.INITIAL_RESERVED_SPRITES;const A=this._avatarImage.getDirection();for(const N of this._avatarImage.getSprites())if(N.id===st.AVATAR){const P=this.getSprite(st.SPRITE_INDEX_AVATAR);if(P){P.alpha=this._avatarImage&&this._avatarImage.isPlaceholder()?150:255;const y=this._avatarImage.getLayerData(N);let D=N.getDirectionOffsetX(A),x=N.getDirectionOffsetY(A);y&&(D+=y.dx,x+=y.dy),n<48&&(D/=2,x/=2),this._canStandUp||(P.offsetX+=D,P.offsetY+=x),this.applyFocusAlpha(P)}}else{const P=this.getSprite(O);if(P){P.alphaTolerance=vi.MATCH_NOTHING,P.visible=!0,P.alpha=255;const y=this._avatarImage.getLayerData(N);let D=0,x=N.getDirectionOffsetX(A),w=N.getDirectionOffsetY(A);const k=N.getDirectionOffsetZ(A);let F=0;N.hasDirections&&(F=A),y&&(D=y.animationFrame,x+=y.dx,w+=y.dy,F+=y.dd),n<48&&(x/=2,w/=2),F<0?F+=8:F>7&&(F-=8);const L=this._avatarImage.getScale()+"_"+N.member+"_"+F+"_"+D,B=this._avatarImage.getAsset(L);if(!B)continue;P.texture=B.texture,P.offsetX=B.offsetX-n/2+x,P.offsetY=B.offsetY+w,P.flipH=B.flipH,N.hasStaticY?P.offsetY+=this._verticalOffset*n/(2*st.BASE_Y_SCALE):P.offsetY+=this._postureOffset,this._isLaying?P.relativeDepth=st.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*k:P.relativeDepth=st.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*k,this.applyFocusAlpha(P),N.ink===33?P.blendMode=ba.ADD:P.blendMode=ba.NORMAL}O++}}}createAvatarImage(s,e){let t=null,r="avatarImage"+s.toString();if(e?(r+="-"+e,t=this._cachedAvatarEffects.getValue(r)):t=this._cachedAvatars.getValue(r),!t&&(t=this._data.createAvatarImage(this._figure,s,this._gender,this,this),t))if(!e)this._cachedAvatars.add(r,t);else{if(this._cachedAvatarEffects.length>=st.MAX_EFFECT_CACHE){const i=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));i&&i.dispose()}this._cachedAvatarEffects.add(r,t)}return t}updateObject(s,e,t,r=!1){if(!r&&this.updateObjectCounter===s.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let i=s.getDirection().x-e.direction.x,n=this._headDirection-e.direction.x;return this._posture==="float"&&(n=i),i=(i%360+360)%360,n=(n%360+360)%360,this._posture==="sit"&&this._canStandUp&&(i-=i%90-45,n-=n%90-45),(i!==this._angle||r)&&(t=!0,this._angle=i,i=i-(135-22.5),i=(i+360)%360,this._avatarImage.setDirectionAngle(lr.FULL,i)),(n!==this._headAngle||r)&&(t=!0,this._headAngle=n,this._headAngle!==this._angle&&(n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(lr.HEAD,n))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,t}updateModel(s,e){if(!s||this.updateModelCounter===s.updateCounter)return!1;let t=!1;const r=s.getValue(b.FIGURE_TALK)>0;r!==this._talk&&(this._talk=r,t=!0);const i=s.getValue(b.FIGURE_EXPRESSION);i!==this._expression&&(this._expression=i,t=!0);const n=s.getValue(b.FIGURE_SLEEP)>0;n!==this._sleep&&(this._sleep=n,t=!0);const o=s.getValue(b.FIGURE_BLINK)>0;o!==this._blink&&(this._blink=o,t=!0);const l=s.getValue(b.FIGURE_GESTURE)||0;l!==this._gesture&&(this._gesture=l,t=!0);const c=s.getValue(b.FIGURE_POSTURE);c!==this._posture&&(this._posture=c,t=!0);const h=s.getValue(b.FIGURE_POSTURE_PARAMETER);h!==this._postureParameter&&(this._postureParameter=h,t=!0);const u=s.getValue(b.FIGURE_CAN_STAND_UP);u!==this._canStandUp&&(this._canStandUp=u,t=!0);const g=s.getValue(b.FIGURE_VERTICAL_OFFSET)*st.BASE_Y_SCALE;g!==this._verticalOffset&&(this._verticalOffset=g,t=!0);const m=s.getValue(b.FIGURE_DANCE)||0;m!==this._dance&&(this._dance=m,t=!0);const p=s.getValue(b.FIGURE_EFFECT)||0;p!==this._effect&&(this._effect=p,t=!0);const f=s.getValue(b.FIGURE_CARRY_OBJECT)||0;f!==this._carryObject&&(this._carryObject=f,t=!0);const T=s.getValue(b.FIGURE_USE_OBJECT)||0;T!==this._useObject&&(this._useObject=T,t=!0);const I=s.getValue(b.HEAD_DIRECTION);I!==this._headDirection&&(this._headDirection=I,t=!0),this._carryObject>0&&T>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,t=!0):this._useObject!==0&&(this._useObject=0,t=!0);let O=this.getAddition(st.FLOATING_IDLE_Z_ID);this._sleep?(O||(O=this.addAddition(new jc(st.FLOATING_IDLE_Z_ID,this))),t=!0):O&&this.removeAddition(st.FLOATING_IDLE_Z_ID);const A=s.getValue(b.FIGURE_IS_MUTED)>0;let N=this.getAddition(st.MUTED_BUBBLE_ID);if(A)N||(N=this.addAddition(new kK(st.MUTED_BUBBLE_ID,this))),t=!0;else{N&&(this.removeAddition(st.MUTED_BUBBLE_ID),t=!0);const Z=s.getValue(b.FIGURE_IS_TYPING)>0;let H=this.getAddition(st.TYPING_BUBBLE_ID);Z?(H||(H=this.addAddition(new BK(st.TYPING_BUBBLE_ID,this))),t=!0):H&&(this.removeAddition(st.TYPING_BUBBLE_ID),t=!0)}const P=s.getValue(b.FIGURE_GUIDE_STATUS)||0;P!==Tn.NONE?(this.removeAddition(st.GUIDE_BUBBLE_ID),this.addAddition(new FK(st.GUIDE_BUBBLE_ID,this,P)),t=!0):this.getAddition(st.GUIDE_BUBBLE_ID)&&(this.removeAddition(st.GUIDE_BUBBLE_ID),t=!0);const y=s.getValue(b.FIGURE_IS_PLAYING_GAME)>0;let D=this.getAddition(st.GAME_CLICK_TARGET_ID);y?(D||(D=this.addAddition(new oh(st.GAME_CLICK_TARGET_ID))),t=!0):D&&this.removeAddition(st.GAME_CLICK_TARGET_ID);const x=s.getValue(b.FIGURE_NUMBER_VALUE);let w=this.getAddition(st.NUMBER_BUBBLE_ID);x>0?(w||(w=this.addAddition(new GK(st.NUMBER_BUBBLE_ID,x,this))),t=!0):w&&this.removeAddition(st.NUMBER_BUBBLE_ID);let k=this.getAddition(st.EXPRESSION_ID);this._expression>0?k||(k=Wc.getExpressionAddition(st.EXPRESSION_ID,this._expression,this),k&&this.addAddition(k)):k&&this.removeAddition(st.EXPRESSION_ID),this.updateScale(e);const F=s.getValue(b.GENDER);F!==this._gender&&(this._gender=F,t=!0),this.updateFigure(s.getValue(b.FIGURE))&&(t=!0);let L=s.getValue(b.FIGURE_SIGN);L===null&&(L=-1),this._sign!==L&&(this._sign=L,t=!0);const B=s.getValue(b.FIGURE_HIGHLIGHT_ENABLE)>0;if(B!==this._highlightEnabled&&(this._highlightEnabled=B,t=!0),this._highlightEnabled){const Z=s.getValue(b.FIGURE_HIGHLIGHT)>0;Z!==this._highlight&&(this._highlight=Z,t=!0)}let V=s.getValue(b.FIGURE_FOCUS_ALPHA);V==null&&(V=255),V=Math.max(0,Math.min(255,V)),V!==this._focusAlpha&&(this._focusAlpha=V,t=!0);const q=s.getValue(b.OWN_USER)>0;return q!==this._ownUser&&(this._ownUser=q,t=!0),this.updateModelCounter=s.updateCounter,t}setDirection(s){this._direction!==s&&(this._direction=s,this._needsUpdate=!0)}updateScale(s){s<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=s/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(s){if(!s)return;if(s.initActionAppends(),s.appendAction(he.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(he.GESTURE,he.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(he.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(he.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(he.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(he.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(he.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(he.SLEEP),this._expression>0){const t=he.getExpression(this._expression);if(t!=="")switch(t){case he.DANCE:this._avatarImage.appendAction(he.DANCE,2);break;default:this._avatarImage.appendAction(t);break}}this._effect>0&&this._avatarImage.appendAction(he.EFFECT,this._effect),s.endActionAppends(),this._isAnimating=s.isAnimating();let e=st.INITIAL_RESERVED_SPRITES;for(const t of this._avatarImage.getSprites())t.id!==st.AVATAR&&e++;if(e!==this.totalSprites&&this.createSprites(e),this._extraSpritesStartIndex=e,this._additions)for(const t of this._additions.values())this.createSprite()}updateFigure(s){return this._figure===s?!1:(this._figure=s,this.clearAvatar(),!0)}resetFigure(s){this.clearAvatar()}resetEffect(s){this.clearAvatar()}clearAvatar(){for(const e of this._cachedAvatars.getValues())e&&e.dispose();for(const e of this._cachedAvatarEffects.getValues())e&&e.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const s=this.getSprite(st.AVATAR_LAYER_ID);s&&(s.texture=ys.EMPTY,s.alpha=255,this.applyFocusAlpha(s))}getAddition(s){if(!this._additions)return null;const e=this._additions.get(s);return e||null}addAddition(s){if(!this.getAddition(s.id))return this._additions.set(s.id,s),s}removeAddition(s){const e=this.getAddition(s);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(s){this._shadow=null;const e=this.getSprite(st.SHADOW_LAYER_ID);if(!e)return;let t=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===st.SNOWBOARDING_EFFECT&&(t=!1),this.object.getLocation().z>0&&(t=!1),t){if(e.visible=!0,!this._shadow||s!==this._scale){let r=0,i=0;s<48?(e.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),r=-8,i=this._canStandUp?6:-3):(e.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),r=-17,i=this._canStandUp?10:-7),this._shadow?(e.texture=this._shadow.texture,e.offsetX=r,e.offsetY=i,e.alpha=50,e.relativeDepth=1,this.applyFocusAlpha(e)):e.visible=!1}}else this._shadow=null,e.visible=!1}applyFocusAlpha(s){this.enforceFocusAlphaForSprite(s)}enforceFocusAlpha(){const s=this.sprites;if(!(!s||!s.length))for(const e of s)!e||!e.visible||this.enforceFocusAlphaForSprite(e)}enforceFocusAlphaForSprite(s){if(!s)return;const e=s,t=st.FOCUS_BASE_ALPHA_KEY,r=s.alpha===void 0||s.alpha===null?255:s.alpha;if(this._focusAlpha>=255){const n=e[t];n!==void 0?(s.alpha=n,delete e[t]):s.alpha=r;return}(e[t]===void 0||r!==this._focusAlpha)&&(e[t]=r);const i=e[t]===void 0?r:e[t];i>this._focusAlpha?s.alpha=this._focusAlpha:s.alpha=i}getAvatarRenderAsset(s){return this._data?this._data.getAvatarRendererAsset(s):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};let Us=st;Us.AVATAR="avatar";Us.FLOATING_IDLE_Z_ID=1;Us.TYPING_BUBBLE_ID=2;Us.EXPRESSION_ID=3;Us.NUMBER_BUBBLE_ID=4;Us.GAME_CLICK_TARGET_ID=5;Us.MUTED_BUBBLE_ID=6;Us.GUIDE_BUBBLE_ID=7;Us.OWN_USER_ID=4;Us.UPDATE_TIME_INCREASER=41;Us.AVATAR_LAYER_ID=0;Us.SHADOW_LAYER_ID=1;Us.SNOWBOARDING_EFFECT=97;Us.INITIAL_RESERVED_SPRITES=2;Us.ANIMATION_FRAME_UPDATE_INTERVAL=2;Us.DEFAULT_CANVAS_OFFSETS=[0,0,0];Us.MAX_EFFECT_CACHE=2;Us.SPRITE_INDEX_AVATAR=0;Us.BASE_Y_SCALE=1e3;Us.AVATAR_SPRITE_DEFAULT_DEPTH=-.01;Us.AVATAR_OWN_DEPTH_ADJUST=.001;Us.AVATAR_SPRITE_LAYING_DEPTH=-.409;Us.FOCUS_BASE_ALPHA_KEY="__focusBaseAlpha";const ma=class{static allocate(s,e,t,r,i,n,o=-1,l=0){const c=ma.POOL.length?ma.POOL.pop():new ma;return r<1&&(r=1),i<0&&(i=ma.FRAME_REPEAT_FOREVER),c._id=s,c._x=e||0,c._y=t||0,c._repeats=r,c._frameRepeats=i,c._remainingFrameRepeats=i,c._isLastFrame=n,c._isRecycled=!1,o>=0?(c._activeSequence=o,c._activeSequenceOffset=l):(c._activeSequence=-1,c._activeSequenceOffset=0),c}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?ma.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(s){s<0&&(s=0),this._frameRepeats>0&&s>this._frameRepeats&&(s=this._frameRepeats),this._remainingFrameRepeats=s}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,ma.POOL.length<ma.POOL_SIZE_LIMIT&&ma.POOL.push(this))}};let ta=ma;ta.FRAME_REPEAT_FOREVER=-1;ta.SEQUENCE_NOT_DEFINED=-1;ta.POOL_SIZE_LIMIT=3e3;ta.POOL=[];class ZP{constructor(e,t,r,i,n,o){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=e,this._x=t,this._y=r,this._randomX=i,this._randomY=n,this._repeats=o}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(e){return this._x}getY(e){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class VK extends ZP{constructor(e,t,r,i,n,o,l){super(e,t,r,i,n,l),this._directionalOffsets=o}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(e){return this._directionalOffsets?this._directionalOffsets.getXOffset(e,super.getX(e)):super.getX(e)}getY(e){return this._directionalOffsets?this._directionalOffsets.getYOffset(e,super.getY(e)):super.getY(e)}}class HK{constructor(e,t){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=t,this._loopCount=e<1?1:e}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let e=this._frameIndexes.length-1,t=-1,r=1;for(;e>=0;)this._frameIndexes[e]===t?r++:(t=this._frameIndexes[e],r=1),this._frameRepeats[e]=r,e--}addFrame(e,t,r,i,n,o){let l=1;if(this._frames.length>0){const h=this._frames[this._frames.length-1];h.id===e&&!h.hasDirectionalOffsets()&&h.x===t&&h.y===r&&h.randomX===i&&i===0&&h.randomY===n&&n===0&&(l+=h.repeats,this._frames.pop())}const c=o?new VK(e,t,r,i,n,o,l):new ZP(e,t,r,i,n,l);this._frames.push(c),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(e){return!this._frames.length||e<0||e>=this.frameCount?null:this._frames[this._frameIndexes[e%this._frameIndexes.length]]}getFrameIndex(e){return e<0||e>=this.frameCount?-1:(this._isRandom&&(e=Math.round(Math.random()*this._frameIndexes.length),e===this._frameIndexes.length&&e--),e)}getRepeats(e){return e<0||e>=this.frameCount?0:this._frameRepeats[e%this._frameRepeats.length]}}class WK{constructor(e,t,r){this._frameSequences=[],this._frameCount=-1,this._loopCount=e<0?0:e,this._frameRepeat=t<1?1:t,this._isRandom=r}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const e of this._frameSequences)e&&e.dispose();this._frameSequences=[]}}addFrameSequence(e,t){const r=new HK(e,t);return this._frameSequences.push(r),r}calculateLength(){this._frameCount=0;for(const e of this._frameSequences)e&&(this._frameCount+=e.frameCount)}getFrame(e,t){if(this._frameCount<1)return null;if(t=t/this._frameRepeat,!this._isRandom){const n=Math.floor(t/this._frameCount);t=Math.floor(t%this._frameCount);let o=!1,l=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(t=this._frameCount-1,o=!0);let c=0,h=0;for(;h<this._frameSequences.length;){if(l=this._frameSequences[h],l){if(t<c+l.frameCount)break;c+=l.frameCount}h++}return this.getFrameFromSpecificSequence(e,l,h,t-c,o)}const r=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[r];return i.frameCount<1?null:this.getFrameFromSpecificSequence(e,i,r,0,!1)}getFrameFromSequence(e,t,r,i){if(t<0||t>=this._frameSequences.length)return null;const n=this._frameSequences[t];return n?r>=n.frameCount?this.getFrame(e,i):this.getFrameFromSpecificSequence(e,n,t,r,!1):null}getFrameFromSpecificSequence(e,t,r,i,n){if(!t)return null;const o=t.getFrameIndex(i),l=t.getFrame(o);if(!l)return null;let c=l.getX(e),h=l.getY(e);const u=l.randomX,g=l.randomY;let m=l.repeats,p=!1;u&&(c=Math.trunc(c+u*Math.random())),g&&(h=Math.trunc(h+g*Math.random())),m>1&&(m=t.getRepeats(o));let f=this._frameRepeat*m;return n&&(f=ta.FRAME_REPEAT_FOREVER),!this._isRandom&&!t.isRandom&&r===this._frameSequences.length-1&&i===t.frameCount-1&&(p=!0),ta.allocate(l.id,c,h,m,f,p,r,i)}}class eL{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(e,t){const r=this._offsetX.get(e);return r??t}getYOffset(e,t){const r=this._offsetY.get(e);return r??t}setDirection(e,t,r){this._offsetX.set(e,t),this._offsetY.set(e,r)}}const Yl=class{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(s){return Yl.TRANSITION_TO_ANIMATION_OFFSET+s}static getTransitionFromAnimationId(s){return Yl.TRANSITION_FROM_ANIMATION_OFFSET+s}static isTransitionToAnimation(s){return s>=Yl.TRANSITION_TO_ANIMATION_OFFSET&&s<Yl.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(s){return s>=Yl.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const s of this._layers.values())s&&s.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(s){this._immediateChanges=s}isImmediateChange(s){return!(!this._immediateChanges||this._immediateChanges.indexOf(s)===-1)}getStartFrame(s){return this._randomStart?Math.random()*this._frameCount:0}initialize(s){if(s.randomStart&&(this._randomStart=!0),s.layers)for(const e in s.layers){const t=s.layers[e];if(!t)return!1;const r=parseInt(e),i=t.loopCount!==void 0?t.loopCount:1,n=t.frameRepeat!==void 0?t.frameRepeat:1,o=t.random!==void 0&&t.random!==0;if(!this.addLayer(r,i,n,o,t))return!1}return!0}addLayer(s,e,t,r,i){const n=new WK(e,t,r);if(i.frameSequences)for(const l in i.frameSequences){const c=i.frameSequences[l];if(!c)continue;const h=c.loopCount!==void 0?c.loopCount:1,u=c.random!==void 0&&c.random!==0,g=n.addFrameSequence(h,u);if(c.frames)for(const m in c.frames){const p=c.frames[m];if(!p)return n.dispose(),!1;g.addFrame(p.id,p.x||0,p.y||0,p.randomX||0,p.randomY||0,this.readDirectionalOffsets(p))}g.initialize()}n.calculateLength(),this._layers.set(s,n);const o=n.frameCount;return o>this._frameCount&&(this._frameCount=o),!0}readDirectionalOffsets(s){let e=null;if(s&&s.offsets)for(const t in s.offsets){const r=s.offsets[t];r&&(e||(e=new eL),e.setDirection(r.direction,r.x,r.y))}return e}getFrame(s,e,t){const r=this._layers.get(e);return r?r.getFrame(s,t):null}getFrameFromSequence(s,e,t,r,i){const n=this._layers.get(e);return n?n.getFrameFromSequence(s,t,r,i):null}};let Js=Yl;Js.TRANSITION_TO_ANIMATION_OFFSET=1e6;Js.TRANSITION_FROM_ANIMATION_OFFSET=2e6;Js.DEFAULT_FRAME_NUMBER=0;const Lf=class{constructor(s){this._colors=[],this.createColors(s)}createColors(s){if(s)for(let e=0;e<s;e++)this._colors.push(Lf.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(s){const e=this._colors[s];return e||Lf.DEFAULT_COLOR}setColorLayer(s,e){this._colors[s]&&(this._colors[s]=e)}};let Cc=Lf;Cc.DEFAULT_COLOR=16777215;const so=class{constructor(){this._tag=so.DEFAULT_TAG,this._ink=so.DEFAULT_INK,this._alpha=so.DEFAULT_ALPHA,this._ignoreMouse=so.DEFAULT_IGNORE_MOUSE,this._xOffset=so.DEFAULT_XOFFSET,this._yOffset=so.DEFAULT_YOFFSET,this._zOffset=so.DEFAULT_ZOFFSET}setFromLayer(s){s&&(this._tag=s.tag,this._ink=s.ink,this._alpha=s.alpha,this._ignoreMouse=s.ignoreMouse,this._xOffset=s.xOffset,this._yOffset=s.yOffset,this._zOffset=s.zOffset)}get tag(){return this._tag}set tag(s){this._tag=s}get ink(){return this._ink}set ink(s){this._ink=s}get alpha(){return this._alpha}set alpha(s){this._alpha=s}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(s){this._ignoreMouse=s}get xOffset(){return this._xOffset}set xOffset(s){this._xOffset=s}get yOffset(){return this._yOffset}set yOffset(s){this._yOffset=s}get zOffset(){return this._zOffset}set zOffset(s){this._zOffset=s}};let At=so;At.DEFAULT_COUNT=0;At.DEFAULT_DIRECTION=0;At.DEFAULT_TAG="";At.DEFAULT_INK=ba.NORMAL;At.DEFAULT_ALPHA=255;At.DEFAULT_IGNORE_MOUSE=!1;At.DEFAULT_XOFFSET=0;At.DEFAULT_YOFFSET=0;At.DEFAULT_ZOFFSET=0;class rl{constructor(e){this._layers=[],this.createLayers(e)}createLayers(e){if(e)for(let t=0;t<e;t++)this._layers.push(new At)}dispose(){this._layers=[]}setFromDirection(e){if(!e)return;const t=this.layerCount;if(t===e.layerCount)for(let r=0;r<t;r++){const i=this.getLayer(r),n=e.getLayer(r);i&&i.setFromLayer(n)}}getLayer(e){const t=this._layers[e];return t||null}getLayerTag(e){const t=this.getLayer(e);return t?t.tag:At.DEFAULT_TAG}setLayerTag(e,t){const r=this.getLayer(e);r&&(r.tag=t)}getLayerInk(e){const t=this.getLayer(e);return t?t.ink:At.DEFAULT_INK}setLayerInk(e,t){const r=this.getLayer(e);r&&(isNaN(t)||(r.ink=t))}getLayerAlpha(e){const t=this.getLayer(e);return t?t.alpha:At.DEFAULT_ALPHA}setLayerAlpha(e,t){const r=this.getLayer(e);r&&(isNaN(t)||(r.alpha=t))}getLayerIgnoreMouse(e){const t=this.getLayer(e);return t?t.ignoreMouse:At.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(e,t){const r=this.getLayer(e);r&&(r.ignoreMouse=t||!1)}getLayerXOffset(e){const t=this.getLayer(e);return t?t.xOffset:At.DEFAULT_XOFFSET}setLayerXOffset(e,t){const r=this.getLayer(e);r&&(isNaN(t)||(r.xOffset=t))}getLayerYOffset(e){const t=this.getLayer(e);return t?t.yOffset:At.DEFAULT_YOFFSET}setLayerYOffset(e,t){const r=this.getLayer(e);r&&(isNaN(t)||(r.yOffset=t))}getLayerZOffset(e){const t=this.getLayer(e);return t?t.zOffset:At.DEFAULT_ZOFFSET}setLayerZOffset(e,t){const r=this.getLayer(e);r&&(isNaN(t)||(r.zOffset=t))}get layerCount(){return this._layers.length}}rl.USE_DEFAULT_DIRECTION=-1;const Uf=class{constructor(s,e){this._layerCount=s<0?0:s>Uf.MAX_LAYERS?Uf.MAX_LAYERS:s,this._angle=e<1?1:e>360?360:e,this._defaultDirection=new rl(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const s of this._directions.values())s&&s.dispose();for(const s of this._colors)s&&s.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(s){return s?this.setDirectionLayers(this._defaultDirection,s):!1}processDirections(s){if(!s)return!1;for(const e in s){const t=s[e];if(!t)continue;const r=parseInt(e);if(this._directions.get(r))return!1;const i=new rl(this._layerCount);i.setFromDirection(this._defaultDirection),this.setDirectionLayers(i,t.layers),this._directions.set(r,i),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(s){if(!s)return!1;for(const e in s){const t=s[e];if(!t)continue;const r=parseInt(e);if(this._colors[r])return!1;const i=new Cc(this._layerCount);for(const n in t.layers){const o=t.layers[n];if(!o)continue;const l=parseInt(n),c=o.color;i.setColorLayer(l,c)}this._colors[r]=i}return!0}setDirectionLayers(s,e){if(!s||!e)return!1;for(const t in e){const r=e[t];if(!r)continue;const i=parseInt(t);if(i<0||i>=this._layerCount)return!1;r.ink!==void 0&&s.setLayerInk(i,jx.inkToBlendMode(r.ink)),r.tag!==void 0&&s.setLayerTag(i,r.tag),r.alpha!==void 0&&s.setLayerAlpha(i,r.alpha),r.ignoreMouse!==void 0&&s.setLayerIgnoreMouse(i,r.ignoreMouse),r.x!==void 0&&s.setLayerXOffset(i,r.x),r.y!==void 0&&s.setLayerYOffset(i,r.y),r.z!==void 0&&s.setLayerZOffset(i,r.z/-1e3)}return!0}getValidDirection(s){if(this._directions.get(s))return s;s=(s%360+360)%360;let t=-1,r=-1;for(const i of this._directions.keys()){let n=(i*this._angle-s+360)%360;n>180&&(n=360-n),(n<t||t<0)&&(t=n,r=i)}return r>=0?Math.trunc(r):0}getDirectionData(s){if(s===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(s);return e||(e=this._defaultDirection),this._lastDirection=s,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(s,e){const t=this.getDirectionData(s);return t?t.getLayerTag(e):At.DEFAULT_TAG}getLayerInk(s,e){const t=this.getDirectionData(s);return t?t.getLayerInk(e):At.DEFAULT_INK}getLayerAlpha(s,e){const t=this.getDirectionData(s);return t?t.getLayerAlpha(e):At.DEFAULT_ALPHA}getLayerColor(s,e){const t=this._colors[e];return t?t.getLayerColor(s):Cc.DEFAULT_COLOR}getLayerIgnoreMouse(s,e){const t=this.getDirectionData(s);return t?t.getLayerIgnoreMouse(e):At.DEFAULT_IGNORE_MOUSE}getLayerXOffset(s,e){const t=this.getDirectionData(s);return t?t.getLayerXOffset(e):At.DEFAULT_XOFFSET}getLayerYOffset(s,e){const t=this.getDirectionData(s);return t?t.getLayerYOffset(e):At.DEFAULT_YOFFSET}getLayerZOffset(s,e){const t=this.getDirectionData(s);return t?t.getLayerZOffset(e):At.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};let JE=Uf;JE.MAX_LAYERS=26;class o_ extends JE{constructor(e,t){super(e,t),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const e of this._animations.values())e&&e.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(e){if(!e)return!0;for(const t in e){const r=e[t];if(!r)return!1;let i=parseInt(t.split("_")[0]),n=!1;const o=r.transitionTo,l=r.transitionFrom;o!==void 0&&(i=Js.getTransitionToAnimationId(o),n=!0),l!==void 0&&(i=Js.getTransitionFromAnimationId(l),n=!0);const c=this.createAnimationData();if(!c.initialize(r))return c.dispose(),!1;const h=r.immediateChangeFrom;if(h!==void 0){const u=h.split(","),g=[];for(const m of u){const p=parseInt(m);g.indexOf(p)===-1&&g.push(p)}c.setImmediateChanges(g)}this._animations.set(i,c),n||this._animationIds.push(i)}return!0}createAnimationData(){return new Js}hasAnimation(e){return!!this._animations.get(e)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(e){const t=this.getAnimationCount();return e<0||t<=0?0:this._animationIds[e%t]}isImmediateChange(e,t){const r=this._animations.get(e);return r?r.isImmediateChange(t):!1}getStartFrame(e,t){const r=this._animations.get(e);return r?r.getStartFrame(t):0}getFrame(e,t,r,i){const n=this._animations.get(e);return n?n.getFrame(t,r,i):null}getFrameFromSequence(e,t,r,i,n,o){const l=this._animations.get(e);return l?l.getFrameFromSequence(t,r,i,n,o):null}}class tL{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(e){this._animationOver=e}get frameCounter(){return this._frameCounter}set frameCounter(e){this._frameCounter=e}get animationId(){return this._animationId}set animationId(e){e!==this._animationId&&(this._animationId=e,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(e){this._animationAfterTransitionId=e}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(e){this._layerCount=e,this.resetAnimationFrames()}resetAnimationFrames(e=!0){(e||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let t=0;for(;t<this._layerCount;){if(e||this._frames.length<=t)this._frames[t]=null;else{const r=this._frames[t];r&&(r.recycle(),this._frames[t]=ta.allocate(r.id,r.x,r.y,r.repeats,0,r.isLastFrame))}this._lastFramePlayed[t]=!1,this._animationPlayed[t]=!1,t++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const e of this._frames)e&&e.recycle()}getFrame(e){return e<0||e>=this._layerCount?null:this._frames[e]}setFrame(e,t){if(e<0||e>=this._layerCount)return;const r=this._frames[e];r&&r.recycle(),this._frames[e]=t}getAnimationPlayed(e){return e<0||e>=this._layerCount?!0:this._animationPlayed[e]}setAnimationPlayed(e,t){e<0||e>=this._layerCount||(this._animationPlayed[e]=t)}getLastFramePlayed(e){return e<0||e>=this._layerCount?!0:this._lastFramePlayed[e]}setLastFramePlayed(e,t){e<0||e>=this._layerCount||(this._lastFramePlayed[e]=t)}}const sL=class extends o_{constructor(s,e){super(s,e),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(s){if(!s||(s.defaultPosture&&s.defaultPosture.length&&(this._defaultPosture=s.defaultPosture),!s.postures))return!1;for(const e of s.postures)this._posturesToAnimations.get(e.id)||(this._defaultPosture===null&&(this._defaultPosture=e.id),this._posturesToAnimations.set(e.id,e.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(s){if(!s)return!1;for(const e of s)this._gesturesToAnimations.get(e.id)||this._gesturesToAnimations.set(e.id,e.animationId);return!0}postureToAnimation(s){return this._posturesToAnimations.get(s)||(s=this._defaultPosture),this._posturesToAnimations.get(s)}getGestureDisabled(s){return s==="ded"}gestureToAnimation(s){return this._gesturesToAnimations.get(s)?this._gesturesToAnimations.get(s):sL.DEFAULT}animationToPosture(s,e){if(s>=0&&s<this._posturesToAnimations.size){const t=this._posturesToAnimations.keys();for(;;){const r=t.next();if(r.done)return null;if(s<=0)return r.value;--s}}return e?this._defaultPosture:null}animationToGesture(s){if(s>=0&&s<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const t=e.next();if(t.done)return null;if(s<=0)return t.value;--s}}return null}getGestureForAnimationId(s){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===s)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};let zl=sL;zl.DEFAULT=-1;class Ua{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(e){return this.reset(),e?(this._type=e.name,this.defineVisualizations(e.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const e of this._sizeDatas.values())e&&e.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const e of this._sizeDatas.values())e&&e.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(e,t,r){return new JE(t,r)}defineVisualizations(e){if(!e)return!1;for(const t in e){const r=e[t],i=r.layerCount,n=r.angle;let o=r.size;if(o<1&&(o=1),this._sizeDatas.get(o))return!1;const l=this.createSizeData(o,i,n);if(!l)return!1;for(const c in r){const h=r[c];if(!this.processVisualElement(l,c,h))return l.dispose(),!1}this._sizeDatas.set(o,l),this._sizes.push(o)}return this._sizes.sort(),!0}processVisualElement(e,t,r){if(!e||!t||!r)return!1;switch(t){case"layers":if(!e.processLayers(r))return!1;break;case"directions":if(!e.processDirections(r))return!1;break;case"colors":if(!e.processColors(r))return!1;break}return!0}getValidSize(e){if(e===this._lastSizeScale)return this._lastSize;const t=this.getSizeIndex(e);let r=-1;return t<this._sizes.length&&(r=this._sizes[t]),this._lastSizeScale=e,this._lastSize=r,r}getSizeIndex(e){if(e<=0)return 0;let t=0,r=1;for(;r<this._sizes.length;){if(this._sizes[r]>e){this._sizes[r]/e<e/this._sizes[r-1]&&(t=r);break}t=r,r++}return t}getSizeData(e){if(e===this._lastSizeDataScale)return this._lastSizeData;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[t]):this._lastSizeData=null,this._lastSizeDataScale=e,this._lastSizeData}getLayerCount(e){const t=this.getSizeData(e);return t?t.layerCount:At.DEFAULT_COUNT}getValidDirection(e,t){const r=this.getSizeData(e);return r?r.getValidDirection(t):At.DEFAULT_DIRECTION}getLayerTag(e,t,r){const i=this.getSizeData(e);return i?i.getLayerTag(t,r):At.DEFAULT_TAG}getLayerInk(e,t,r){const i=this.getSizeData(e);return i?i.getLayerInk(t,r):At.DEFAULT_INK}getLayerAlpha(e,t,r){const i=this.getSizeData(e);return i?i.getLayerAlpha(t,r):At.DEFAULT_ALPHA}getLayerColor(e,t,r){const i=this.getSizeData(e);return i?i.getLayerColor(t,r):Cc.DEFAULT_COLOR}getLayerIgnoreMouse(e,t,r){const i=this.getSizeData(e);return i?i.getLayerIgnoreMouse(t,r):At.DEFAULT_IGNORE_MOUSE}getLayerXOffset(e,t,r){const i=this.getSizeData(e);return i?i.getLayerXOffset(t,r):At.DEFAULT_XOFFSET}getLayerYOffset(e,t,r){const i=this.getSizeData(e);return i?i.getLayerYOffset(t,r):At.DEFAULT_YOFFSET}getLayerZOffset(e,t,r){const i=this.getSizeData(e);return i?i.getLayerZOffset(t,r):At.DEFAULT_ZOFFSET}get type(){return this._type}}Ua.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];class ZE extends Ua{createSizeData(e,t,r){return new o_(t,r)}processVisualElement(e,t,r){if(!e||!t||!r)return!1;switch(t){case"animations":if(!(e instanceof o_)||!e.defineAnimations(r))return!1;break;default:if(!super.processVisualElement(e,t,r))return!1;break}return!0}hasAnimation(e,t){const r=this.getSizeData(e);return r?r.hasAnimation(t):null}getAnimationCount(e){const t=this.getSizeData(e);return t?t.getAnimationCount():null}getAnimationId(e,t){const r=this.getSizeData(e);return r?r.getAnimationId(t):null}isImmediateChange(e,t,r){const i=this.getSizeData(e);return i?i.isImmediateChange(t,r):null}getStartFrame(e,t,r){const i=this.getSizeData(e);return i?i.getStartFrame(t,r):null}getFrame(e,t,r,i,n){const o=this.getSizeData(e);return o?o.getFrame(t,r,i,n):null}getFrameFromSequence(e,t,r,i,n,o,l){const c=this.getSizeData(e);return c?c.getFrameFromSequence(t,r,i,n,o,l):null}}const rL=class extends $u{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0,this._lookThrough=!1,this._lookThroughCustom=!1,this._lookThroughCustomVar=!1}initialize(s){return this.reset(),s instanceof Ua?(this._type=s.type,this._data=s,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(s,e){this._cacheDirection===e&&this._cacheScale===s||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=s,this._cacheSize=this.getValidSize(s),this.setLayerCount((this._data&&this._data.getLayerCount(s)||0)+this.getAdditionalLayerCount()))}update(s,e,t,r){if(!s)return;const i=s.scale;let n=!1;this.updateObject(i,s.direction.x)&&(n=!0),this.updateModel(i)&&(n=!0),this._needsLookThroughUpdate&&(n=!0,this._needsLookThroughUpdate=!1),this._needsLookThroughUpdateCustom&&(n=!0,this._needsLookThroughUpdateCustom=!1),this._needsLookThroughUpdateCustomVar&&(n=!0,this._needsLookThroughUpdateCustomVar=!1);let o=0;r?this._animationNumber=this._animationNumber|this.updateAnimation(i):(o=this.updateAnimation(i)|this._animationNumber,this._animationNumber=0),(n||o!==0)&&(this.updateSprites(i,n,o),this._scale=i,this.updateSpriteCounter++)}updateObject(s,e){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&s===this._scale&&this._lastCameraAngle===e)return!1;let t=this.object.getDirection().x-(e+135);if(t=(t%360+360)%360,this._data){const r=this._data.getValidDirection(s,t);this.setDirection(r)}return this._lastCameraAngle=e,this._scale=s,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(s,this._direction),!0}updateModel(s){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(b.FURNITURE_COLOR),this._clickUrl=e.getValue(b.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=e.getValue(b.FURNITURE_LIFT_AMOUNT)||0;let t=e.getValue(b.FURNITURE_ALPHA_MULTIPLIER);return isNaN(t)&&(t=1),this._alphaMultiplier!==t&&(this._alphaMultiplier=t,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(s,e,t){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),e){let r=this.totalSprites-1;for(;r>=0;)this.updateSprite(s,r),r--}else{let r=0;for(;t>0;)t&&this.updateSprite(s,r),r++,t=t>>1}this._alphaChanged=!1}updateSprite(s,e){const t=this.getSpriteAssetName(s,e),r=this.getSprite(e);if(t&&r){const i=this.getAsset(t,e);if(i&&i.texture){r.visible=!0,r.type=this._type,r.texture=i.texture,r.flipH=i.flipH,r.flipV=i.flipV,r.direction=this._direction;let n=0;e!==this._shadowLayerIndex?(r.tag=this.getLayerTag(s,this._direction,e),r.alpha=this.getLayerAlpha(s,this._direction,e),r.color=this.getLayerColor(s,e,this._selectedColor),r.offsetX=i.offsetX+this.getLayerXOffset(s,this._direction,e),r.offsetY=i.offsetY+this.getLayerYOffset(s,this._direction,e),r.blendMode=this.getLayerInk(s,this._direction,e),r.alphaTolerance=this.getLayerIgnoreMouse(s,this._direction,e)?vi.MATCH_NOTHING:vi.MATCH_OPAQUE_PIXELS,n=this.getLayerZOffset(s,this._direction,e),n=n-e*.001):(r.offsetX=i.offsetX,r.offsetY=i.offsetY+this.getLayerYOffset(s,this._direction,e),r.alpha=48*this._alphaMultiplier,r.alphaTolerance=vi.MATCH_NOTHING,n=1),this._lookThroughCustom&&(r.alpha*=.6,r.color=65535),this._lookThroughCustomVar&&(r.alpha*=.6,r.color=10027263),this._lookThrough&&(r.alpha*=.2),r.relativeDepth=n*rL.DEPTH_MULTIPLIER,r.name=t,r.libraryAssetName=this.getLibraryAssetNameForSprite(i,r),r.posture=this.getPostureForAsset(s,i.source),r.clickHandling=this._clickHandling}else this.resetSprite(r)}else r&&this.resetSprite(r)}getLibraryAssetNameForSprite(s,e){return s.source}getPostureForAssetFile(s,e){return null}resetSprite(s){s&&(s.texture=null,s.libraryAssetName="",s.posture="",s.tag="",s.offsetX=0,s.offsetY=0,s.flipH=!1,s.flipV=!1,s.relativeDepth=0,s.clickHandling=!1)}getSpriteAssetName(s,e){if(!this._data||e>=Ua.LAYER_LETTERS.length)return"";let t=this._assetNames[e],r=this._updatedLayers[e];return(!t||!t.length)&&(t=this.cacheSpriteAssetName(s,e,!0),r=this._cacheSize!==1),r&&(t+=this.getFrameNumber(s,e)),t}cacheSpriteAssetName(s,e,t){this._type;const r=t?this._cacheSize:this.getValidSize(s);let i="";const n=r!==1;if(e!==this._shadowLayerIndex?i=Ua.LAYER_LETTERS[e]||"":i="sd",i==="")return null;const o=this._type+(n?"_"+r+"_"+i+"_"+this._direction+"_":"_icon_"+i);return t&&(this._assetNames[e]=o,this._updatedLayers[e]=n),o}getLayerTag(s,e,t){const r=this._spriteTags[t];if(r!==void 0)return r;if(!this._data)return At.DEFAULT_TAG;const i=this._data.getLayerTag(s,e,t);return this._spriteTags[t]=i,i}getLayerInk(s,e,t){const r=this._spriteInks[t];if(r!==void 0)return r;if(!this._data)return At.DEFAULT_INK;const i=this._data.getLayerInk(s,e,t);return this._spriteInks[t]=i,i}getLayerAlpha(s,e,t){if(!this._alphaChanged){const i=this._spriteAlphas[t];if(i!==void 0)return i}if(!this._data)return At.DEFAULT_ALPHA;let r=this._data.getLayerAlpha(s,e,t);return this._alphaMultiplier!==null&&(r=r*this._alphaMultiplier),this._spriteAlphas[t]=r,r}getLayerColor(s,e,t){const r=this._spriteColors[e];if(r!==void 0)return r;if(!this._data)return Cc.DEFAULT_COLOR;const i=this._data.getLayerColor(s,e,t);return this._spriteColors[e]=i,i}getLayerIgnoreMouse(s,e,t){const r=this._spriteMouseCaptures[t];if(r!==void 0)return r;if(!this._data)return At.DEFAULT_IGNORE_MOUSE;const i=this._data.getLayerIgnoreMouse(s,e,t);return this._spriteMouseCaptures[t]=i,i}getLayerXOffset(s,e,t){const r=this._spriteXOffsets[t];if(r!==void 0)return r;if(!this._data)return At.DEFAULT_XOFFSET;const i=this._data.getLayerXOffset(s,e,t);return this._spriteXOffsets[t]=i,i}getLayerYOffset(s,e,t){if(t===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(s/2));const r=this._spriteYOffsets[t];if(r!==void 0)return r;if(!this._data)return At.DEFAULT_YOFFSET;const i=this._data.getLayerYOffset(s,e,t);return this._spriteYOffsets[t]=i,i}getLayerZOffset(s,e,t){const r=this._spriteZOffsets[t];if(r!==void 0)return r;if(!this._data)return At.DEFAULT_ZOFFSET;const i=this._data.getLayerZOffset(s,e,t);return this._spriteZOffsets[t]=i,i}getValidSize(s){return this._data?this._data.getValidSize(s):s}setLayerCount(s){this._layerCount=s,this._shadowLayerIndex=s-this.getAdditionalLayerCount()}setDirection(s){this._direction!==s&&(this._direction=s)}getAdditionalLayerCount(){return 1}updateAnimation(s){return 0}getFrameNumber(s,e){return 0}getPostureForAsset(s,e){return null}getAsset(s,e=-1){return this.asset?this.asset.getAsset(s):null}get direction(){return this._direction}get data(){return this._data}set lookThrough(s){this._lookThrough!=s&&(this._lookThrough=s,this._needsLookThroughUpdate=!0)}set lookThroughCustom(s){this._lookThroughCustom!=s&&(this._lookThroughCustom=s,this._needsLookThroughUpdateCustom=!0)}set lookThroughCustomVar(s){this._lookThroughCustomVar!=s&&(this._lookThroughCustomVar=s,this._needsLookThroughUpdateCustomVar=!0)}};let la=rL;la.DEPTH_MULTIPLIER=Math.sqrt(.5);la.TYPE=pe.FURNITURE_STATIC;const xf=class extends la{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new tL,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(s){return s instanceof ZE?super.initialize(s):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(s){return this.animationId!==xf.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:xf.DEFAULT_ANIMATION_ID}updateObject(s,e){if(super.updateObject(s,e)){const t=this.object.getState(0);return t!==this._state&&(this.setAnimation(t),this._state=t,this._animationChangeTime=this.object.model.getValue(b.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(s){if(super.updateModel(s)){if(this.usesAnimationResetting()){const t=this.object.model.getValue(b.FURNITURE_STATE_UPDATE_TIME);t>this._animationChangeTime&&(this._animationChangeTime=t,this.setAnimation(this._state))}const e=this.object.model.getValue(b.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(e)){const t=this.data.getAnimationId(this._animationScale,e);this.setAnimation(t)}return!0}return!1}isPlayingTransition(s,e){return!(!Js.isTransitionFromAnimation(s.animationId)&&!Js.isTransitionToAnimation(s.animationId)||e!==s.animationAfterTransitionId||s.animationOver)}getCurrentState(s){const e=s.animationId;return!Js.isTransitionFromAnimation(e)&&!Js.isTransitionToAnimation(e)?e:s.animationAfterTransitionId}setAnimation(s){this.data&&this.setSubAnimation(this._animationData,s,this._state>=0)}setSubAnimation(s,e,t=!0){const r=s.animationId;if(t){if(this.isPlayingTransition(s,e))return!1;const i=this.getCurrentState(s);if(e!==i){if(!this.data.isImmediateChange(this._animationScale,e,i)){let n=Js.getTransitionFromAnimationId(i);this.data.hasAnimation(this._animationScale,n)?(s.animationAfterTransitionId=e,e=n):(n=Js.getTransitionToAnimationId(e),this.data.hasAnimation(this._animationScale,n)&&(s.animationAfterTransitionId=e,e=n))}}else if(Js.isTransitionFromAnimation(s.animationId)){const n=Js.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,n)&&(s.animationAfterTransitionId=e,e=n)}else if(!Js.isTransitionToAnimation(s.animationId)&&this.usesAnimationResetting()){const n=Js.getTransitionFromAnimationId(i);if(this.data.hasAnimation(this._animationScale,n))s.animationAfterTransitionId=e,e=n;else{const o=Js.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,o)&&(s.animationAfterTransitionId=e,e=o)}}}return r!==e?(s.animationId=e,!0):!1}getLastFramePlayed(s){return this._animationData.getLastFramePlayed(s)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(s){if(!this.data)return 0;s!==this._animationScale&&(this._animationScale=s,this._animatedLayerCount=this.data.getLayerCount(s),this.resetAllAnimationFrames());const e=this.updateAnimations(s);return this._directionChanged=!1,e}updateAnimations(s){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,s);return this._animationData.animationOver&&(Js.isTransitionFromAnimation(this._animationData.animationId)||Js.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(s,e){if(s.animationOver&&!this._directionChanged)return 0;const t=this.getAnimationId(s);let r=s.frameCounter;r||(r=this.data.getStartFrame(e,t,this._direction)),r+=this.frameIncrease,s.frameCounter=r,s.animationOver=!0;let i=!1,n=this._animatedLayerCount-1,o=0,l=1<<this._animatedLayerCount-1;for(;n>=0;){let c=0;if(i=s.getAnimationPlayed(n),!i||this._directionChanged){let h=s.getLastFramePlayed(n),u=s.getFrame(n);u&&u.isLastFrame&&u.remainingFrameRepeats<=this.frameIncrease&&(h=!0),(this._directionChanged||!u||u.remainingFrameRepeats>=0&&(u.remainingFrameRepeats=u.remainingFrameRepeats-this.frameIncrease)<=0)&&(c=ta.SEQUENCE_NOT_DEFINED,u&&(c=u.activeSequence),c===ta.SEQUENCE_NOT_DEFINED?u=this.data.getFrame(e,t,this._direction,n,r):u=this.data.getFrameFromSequence(e,t,this._direction,n,c,u.activeSequenceOffset+u.repeats,r),s.setFrame(n,u),o=o|l),!u||u.remainingFrameRepeats==ta.FRAME_REPEAT_FOREVER?(h=!0,i=!0):s.animationOver=!1,s.setLastFramePlayed(n,h),s.setAnimationPlayed(n,i)}l=l>>1,n--}return o}getFrameNumber(s,e){const t=this._animationData.getFrame(e);return t?t.id:super.getFrameNumber(s,e)}getLayerXOffset(s,e,t){const r=super.getLayerXOffset(s,e,t),i=this._animationData.getFrame(t);return i?r+i.x:r}getLayerYOffset(s,e,t){const r=super.getLayerYOffset(s,e,t),i=this._animationData.getFrame(t);return i?r+i.y:r}usesAnimationResetting(){return!1}setDirection(s){this._direction!==s&&(super.setDirection(s),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};let Vs=xf;Vs.TYPE=pe.FURNITURE_ANIMATED;Vs.DEFAULT_ANIMATION_ID=0;const pd=class extends Vs{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(s){let e=super.updateModel(s);const t=this.object.model.getValue(b.FURNITURE_BADGE_IMAGE_STATUS),r=this.object.model.getValue(b.FURNITURE_BADGE_ASSET_NAME);if(t===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(t===1&&r!==this._badgeId){this._badgeId=r,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const i=this.object.model.getValue(b.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(i)||(this._badgeVisibleInState=i),e=!0}return e}getSpriteAssetName(s,e){return this.getLayerTag(s,this.direction,e)!==pd.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(s,e):s===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(s,e,t){let r=super.getLayerXOffset(s,e,t);if(this.getLayerTag(s,e,t)===pd.BADGE){const i=this.getAsset(s===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,t);i&&(s===64?r+=(40-i.width)/2:r+=(20-i.width)/2)}return r}getLayerYOffset(s,e,t){let r=super.getLayerYOffset(s,e,t);if(this.getLayerTag(s,e,t)===pd.BADGE){const i=this.getAsset(s===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,t);i&&(s===64?r+=(40-i.height)/2:r+=(20-i.height)/2)}return r}};let iL=pd;iL.BADGE="BADGE";const Qo=class extends la{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(s,e){return super.updateObject(s,e)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(s){const e=super.updateModel(s);if(e&&(this._offsetX=this.object.model.getValue(b.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(b.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(b.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(b.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}checkIfImageChanged(){const s=this.object.model.getValue(b.FURNITURE_BRANDING_IMAGE_URL);return s&&s===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const e=this.object.model.getValue(b.FURNITURE_BRANDING_IMAGE_URL);if(!e||this._imageUrl&&this._imageUrl===e)return!1;if(this.object.model.getValue(b.FURNITURE_BRANDING_IMAGE_STATUS)===1){let r=null;if(this._isAnimated){const i=ke.instance.roomEngine.roomContentLoader.getGifCollection(e);i&&(this._gifCollection=i,r=i.textures[0])}else r=di().getTexture(e);return r?(this.imageReady(r,e),!0):!1}return!1}imageReady(s,e){if(!s){this._imageUrl=null;return}this._imageUrl=e}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const s=di().getTexture(this._imageUrl);if(!s)return;const e=this.object.getState(0);this.addBackgroundAsset(s,e,0)}buildAssetsForGif(){if(!this._gifCollection)return;const s=this._gifCollection.textures,e=this._gifCollection.durations;if(!s.length||!e.length||s.length!==e.length)return;const t=this.object.getState(0);for(let r=0;r<s.length;r++){const i=s[r];e[r],i&&this.addBackgroundAsset(i,t,r)}this._currentFrame=-1,this._totalFrames=s.length}addBackgroundAsset(s,e,t){let r=0,i=0,n=!1,o=!1;switch(e){case Qo.STATE_0:r=0,i=0,n=!1,o=!1;break;case Qo.STATE_1:r=-s.width,i=0,n=!0,o=!1;break;case Qo.STATE_2:r=-s.width,i=-s.height,n=!0,o=!0;break;case Qo.STATE_3:r=0,i=-s.height,n=!1,o=!0;break}this.asset.addAsset(`${this._imageUrl}_${t}`,s,!0,r,i,n,o)}getSpriteAssetName(s,e){return this.getLayerTag(s,this._direction,e)===Qo.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(s,e)}`:super.getSpriteAssetName(s,e)}updateAnimation(s){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(s,e){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(s,this._direction,e)===Qo.BRANDED_IMAGE&&this._imageUrl){let r=this._currentFrame;return r<0?r=0:r+=1,r===this._totalFrames&&(r=0),this._currentFrame=r,this._currentFrame}return 0}};let xo=Qo;xo.BRANDED_IMAGE="branded_image";xo.STATE_0=0;xo.STATE_1=1;xo.STATE_2=2;xo.STATE_3=3;class nL extends xo{getLayerXOffset(e,t,r){return super.getLayerXOffset(e,t,r)+this._offsetX}getLayerYOffset(e,t,r){return super.getLayerYOffset(e,t,r)+this._offsetY}getLayerZOffset(e,t,r){return super.getLayerZOffset(e,t,r)+this._offsetZ}}const Ed=class extends Vs{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(s){if(s===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ed.ANIMATION_ID_ROLL);return}if(s>=0&&s<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Ed.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(Ed.ANIMATION_ID_OFFSET_SLOW2+s),this._stateQueue.push(s);return}super.setAnimation(s)}}updateAnimation(s){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(s)}};let ng=Ed;ng.ANIMATION_ID_OFFSET_SLOW1=20;ng.ANIMATION_ID_OFFSET_SLOW2=9;ng.ANIMATION_ID_ROLL=-1;class jK extends la{}const fu=class extends Vs{getFrameNumber(s,e){const t=this.getLayerTag(s,this.direction,e),r=this.object.getState(0);switch(t){case fu.SECONDS_SPRITE:return Math.floor(r%60%10);case fu.TEN_SECONDS_SPRITE:return Math.floor(r%60/10);case fu.MINUTES_SPRITE:return Math.floor(r/60%10);case fu.TEN_MINUTES_SPRITE:return Math.floor(r/60/10%10);default:return super.getFrameNumber(s,e)}}get animationId(){return 0}};let lh=fu;lh.SECONDS_SPRITE="seconds_sprite";lh.TEN_SECONDS_SPRITE="ten_seconds_sprite";lh.MINUTES_SPRITE="minutes_sprite";lh.TEN_MINUTES_SPRITE="ten_minutes_sprite";class YK extends $u{}const wf=class extends Vs{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(s){this._thumbnailImageNormal=s,this._thumbnailChanged=!0}updateModel(s){const e=super.updateModel(s);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?e:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(s,e){let t=0;for(;t<this.totalSprites;){if(this.getLayerTag(e,this.direction,t)===wf.THUMBNAIL){const r=this.cacheSpriteAssetName(e,t,!1)+this.getFrameNumber(e,t),i=this.getAsset(r,t);if(i){const n=this.generateTransformedThumbnail(s,i),o=this.getThumbnailAssetName(e);this.asset.disposeAsset(o),this.asset.addAsset(o,n,!0,i.offsetX,i.offsetY,!1,!1)}return}t++}}generateTransformedThumbnail(s,e){if(this._hasOutline){const o=new ds,l=new ds(dp.WHITE);l.tint=0,l.width=s.width+40,l.height=s.height+40;const c=new ds(s),h=(l.width-c.width)/2,u=(l.height-c.height)/2;c.position.set(h,u),o.addChild(l,c),s=Lt.generateTexture(o)}const t=1.1,r=new Zr,i=e.width/s.width;switch(this.direction){case 2:r.a=i,r.b=-.5*i,r.c=0,r.d=i*t,r.tx=0,r.ty=.5*i*s.width;break;case 0:case 4:r.a=i,r.b=.5*i,r.c=0,r.d=i*t,r.tx=0,r.ty=0;break;default:r.a=i,r.b=0,r.c=0,r.d=i,r.tx=0,r.ty=0}const n=new ds(s);return n.transform.setFromMatrix(r),Lt.generateTexture(n)}getSpriteAssetName(s,e){return this._thumbnailImageNormal&&this.getLayerTag(s,this.direction,e)===wf.THUMBNAIL?this.getThumbnailAssetName(s):super.getSpriteAssetName(s,e)}getThumbnailAssetName(s){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(s,e){return[this._type,s,"thumb",e].join("_")}};let eI=wf;eI.THUMBNAIL="THUMBNAIL";class aL extends eI{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(e){if(this.object){const t=this.getThumbnailURL();if(this._cachedUrl!==t)if(this._cachedUrl=t,this._cachedUrl&&this._cachedUrl!==""){const r=new Image;r.src=t,r.crossOrigin="*",r.onload=()=>{const i=ys.from(r);i.baseTexture.scaleMode=dm.LINEAR,this.setThumbnailImages(i)}}else this.setThumbnailImages(null)}return super.updateModel(e)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class zK extends aL{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const e=this.object.model.getValue(b.FURNITURE_DATA);if(!e||e==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let r=JSON.parse(e).w||"";return r=this.buildThumbnailUrl(r),this._url=r,this._url}buildThumbnailUrl(e){return e=e.replace(".png","_small.png"),e.indexOf(".png")===-1&&(e=e+"_small.png"),e}}class sT{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(e,t,r,i,n,o,l,c=!1,h=null,u=!1){this._x=e,this._y=t,this._z=r,this._particleDirection=new Pi(i.x,i.y,i.z),this._particleDirection.scaleBy(n),this._lastX=this._x-this._particleDirection.x*o,this._lastY=this._y-this._particleDirection.y*o,this._lastZ=this._z-this._particleDirection.z*o,this._age=0,this._hasMoved=!1,this._lifeTime=l,this._isEmitter=c,this._frames=h,this._fade=u,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}get lastX(){return this._lastX}set lastX(e){this._hasMoved=!0,this._lastX=e}get lastY(){return this._lastY}set lastY(e){this._hasMoved=!0,this._lastY=e}get lastZ(){return this._lastZ}set lastZ(e){this._hasMoved=!0,this._lastZ=e}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(e,t){this._x=e._x*t,this._y=e._y*t,this._z=e._z*t,this._lastX=e._lastX*t,this._lastY=e._lastY*t,this._lastZ=e._lastZ*t,this._hasMoved=e.hasMoved,this._particleDirection=e._particleDirection,this._age=e._age,this._lifeTime=e._lifeTime,this._isEmitter=e._isEmitter,this._fade=e._fade,this._fadeTime=e._fadeTime,this._alphaMultiplier=e._alphaMultiplier}}const Id=class extends sT{constructor(s="",e=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=s,this._roomObjectSpriteId=e,this._particleConfigurations=[]}dispose(){for(const s of this._particles)s.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(s,e,t,r,i,n,o,l,c,h){this._maxNumberOfParticles=s,this._particlesPerFrame=e,this._force=t,this._emitterDirection=r,this._emitterDirection.normalize(),this._gravity=i,this._airFriction=n,this._explosionShape=o,this._fuseTime=c,this._energy=l,this._burstPulse=h,this.reset()}reset(){for(const s of this._particles)s.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(s,e){super.copy(s,e),this._force=s._force,this._emitterDirection=s._emitterDirection,this._gravity=s._gravity,this._airFriction=s._airFriction,this._explosionShape=s._explosionShape,this._fuseTime=s._fuseTime,this._energy=s._energy,this._burstPulse=s._burstPulse,this._timeStep=s._timeStep,this._hasIgnited=s._hasIgnited}configureParticle(s,e,t,r){const i={};i.lifeTime=s,i.isEmitter=e,i.frames=t,i.fade=r,this._particleConfigurations.push(i)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(s,e=null){e||(e=new Pi);const t=new Pi,r=this.getRandomParticleConfiguration();let i=0;for(;i<this._particlesPerFrame;){switch(this._explosionShape){case Id.CONE:t.x=this.randomBoolean(.5)?Math.random():-Math.random(),t.y=-(Math.random()+1),t.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case Id.PLANE:t.x=this.randomBoolean(.5)?Math.random():-Math.random(),t.y=0,t.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case Id.SPHERE:t.x=this.randomBoolean(.5)?Math.random():-Math.random(),t.y=this.randomBoolean(.5)?Math.random():-Math.random(),t.z=this.randomBoolean(.5)?Math.random():-Math.random();break}t.normalize();const n=new sT;let o=0,l=!1,c=!1,h=[];r?(o=Math.floor(Math.random()*r.lifeTime+10),l=r.isEmitter,h=r.frames,c=r.fade):(o=Math.trunc(Math.floor(Math.random()*20+10)),l=!1,h=[]),n.init(s.x,s.y,s.z,t,this._energy,this._timeStep,o,l,h,c),this._particles.push(n),this._emittedParticles++,i++}}getRandomParticleConfiguration(){const s=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[s]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const e=this.x,t=this.y,r=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=e,this.lastY=t,this.lastZ=r}const s=[];for(const e of this._particles){e.update();const t=e.x,r=e.y,i=e.z;e.x=(2-this._airFriction)*e.x-(1-this._airFriction)*e.lastX,e.y=(2-this._airFriction)*e.y-(1-this._airFriction)*e.lastY+this._gravity*this._timeStep*this._timeStep,e.z=(2-this._airFriction)*e.z-(1-this._airFriction)*e.lastZ,e.lastX=t,e.lastY=r,e.lastZ=i,(e.y>10||!e.isAlive)&&s.push(e)}for(const e of s)e.isEmitter,this._particles.splice(this._particles.indexOf(e),1),e.dispose()}satisfyConstraints(){}accumulateForces(){for(const s of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(s){return Math.random()<s}get roomObjectSpriteId(){return this._roomObjectSpriteId}};let ag=Id;ag.CONE="cone";ag.PLANE="plane";ag.SPHERE="sphere";class KK{constructor(e){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new As,this._visualization=e,this._blackOverlayAlphaTransform=new um,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new um,this._identityMatrix=new Zr,this._translationMatrix=new Zr}dispose(){for(const e of this._emitters.getValues())e.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(e){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(e),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(e,t,r){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===r?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(e){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==e:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const e=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const t=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const r of this._currentEmitter.particles){const i=this._centerX+(r.x-r.z)*e/10*this._scaleMultiplier,n=this._centerY-t+(r.y+(r.x+r.z)/2)*e/10*this._scaleMultiplier,o=r.getAsset();if(o&&o.texture)if(r.fade&&r.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(i+o.offsetX,n+o.offsetY);const l=new ds(o.texture);this._particleColorTransform.alpha=r.alphaMultiplier,l.filters=[this._particleColorTransform],sr.instance.renderer.render(l,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const l=new vr(i+o.offsetX,n+o.offsetY),c=new ds(o.texture);c.x=l.x,c.y=l.y,sr.instance.renderer.render(c,{renderTexture:this._canvasTexture,clear:!1})}else{const l=new ds(ys.WHITE);l.tint=16777215,l.x=i-1,l.y=n-1,l.width=2,l.height=2,sr.instance.renderer.render(l,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(e){this._size=e.size,this._canvasId=e.canvasId!==void 0?e.canvasId:-1,this._offsetY=e.offsetY!==void 0?e.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=e.blend!==void 0?e.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const t=e.bgColor!==void 0?e.bgColor:"0";if(this._bgColor=parseInt(t,16)||0,!(!e.emitters||!e.emitters.length))for(const r of e.emitters){const i=r.id,n=r.name,o=r.spriteId,l=new ag(n,o);this._emitters.add(i,l);const c=r.maxNumParticles,h=r.particlesPerFrame,u=r.burstPulse!==void 0?r.burstPulse:1,g=r.fuseTime,m=r.simulation.force,p=r.simulation.direction,f=r.simulation.gravity,T=r.simulation.airFriction,I=r.simulation.shape,O=r.simulation.energy;for(const A of r.particles){const N=A.lifeTime,P=A.isEmitter||!1,y=A.fade||!1,D=[];for(const x of A.frames)D.push(this._visualization.asset.getAsset(x));l.configureParticle(N,P,D,y)}l.setup(c,h,m,new Pi(0,p,0),f,T,I,O,g,u)}}copyStateFrom(e){let t=0;e._emitters&&e._currentEmitter&&(t=e._emitters.getKey(e._emitters.getValues().indexOf(e._currentEmitter))),this.setAnimation(t),this._currentEmitter&&this._currentEmitter.copyStateFrom(e._currentEmitter,e._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new ds(ys.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?sr.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=yn.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class oL extends Vs{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const e of this._particleSystems.getValues())e.dispose();this._particleSystems=null}}updateObject(e,t){if(super.updateObject(e,t)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(e):xe.log("ERROR Particle systems could not be read!",this.object.type);else if(e!==this._scale||this._particleSystems.getValue(e)!==this._currentParticleSystem){const r=this._particleSystems.getValue(e);r.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=r}return!0}return!1}updateSprites(e,t,r){super.updateSprites(e,t,r),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(e){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(e)}setAnimation(e){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(e),super.setAnimation(e)}getLayerYOffset(e,t,r){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(r)?this._currentParticleSystem.getLayerYOffset(e,t,r):super.getLayerYOffset(e,t,r)}readDefinition(){if(!this.object||!this.object.model)return!1;const e=this.object.model.getValue(b.FURNITURE_FIREWORKS_DATA);if(!e||!e.length)return!1;this._particleSystems=new As;for(const t of e){const r=t.size,i=new KK(this);i.parseData(t),this._particleSystems.add(r,i)}return!0}}const Td=class extends oL{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(s,e,t,r){this.updatePresentWrap(),super.update(s,e,t,r)}updatePresentWrap(){if(!this.object)return;const s=1e3,e=this.object.model.getValue(b.FURNITURE_EXTRAS),t=parseInt(e),r=Math.floor(t/s),i=t%s;this._packetType=r>Td.MAX_PACKET_TYPE_VALUE?0:r,this._ribbonType=i>Td.MAX_RIBBON_TYPE_VALUE?0:i}getFrameNumber(s,e){if(this._lastAnimationId===Td.PRESENT_DEFAULT_STATE){if(e<=1)return this._packetType;if(e===2)return this._ribbonType}return super.getFrameNumber(s,e)}getSpriteAssetName(s,e){const t=this.getValidSize(s);let r=this._type,i="";e<this.spriteCount-1?i=String.fromCharCode("a".charCodeAt(0)+e):i="sd";const n=this.getFrameNumber(s,e);return r=r+("_"+t+"_"+i+"_"+this.direction),r=r+("_"+n),r}setAnimation(s){this._lastAnimationId=s,super.setAnimation(s)}};let og=Td;og.PRESENT_DEFAULT_STATE=0;og.MAX_PACKET_TYPE_VALUE=9;og.MAX_RIBBON_TYPE_VALUE=11;class qK extends la{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(e,t,r,i){this.updatePresentWrap(),super.update(e,t,r,i)}updatePresentWrap(){if(!this.object)return;const e=this.object.model.getValue(b.FURNITURE_EXTRAS),t=1e3,r=parseInt(e);this._packetType=Math.floor(r/t),this._ribbonType=r%t}getFrameNumber(e,t){return t<=1?this._packetType:this._ribbonType}getSpriteAssetName(e,t){const r=this.getValidSize(e);let i=this._type,n="";t<this.spriteCount-1?n=String.fromCharCode("a".charCodeAt(0)+t):n="sd";const o=this.getFrameNumber(e,t);return i=i+("_"+r+"_"+n+"_"+this.direction),i=i+("_"+o),i}}const fa=class extends Vs{constructor(){super(),this._color1=fa.DEFAULT_COLOR_1,this._color2=fa.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(s){const e=super.updateModel(s);if(this._badgeAssetNameNormalScale===""){const i=this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);i&&(this._badgeAssetNameNormalScale=i,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const t=this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=t||fa.DEFAULT_COLOR_1;const r=this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=r||fa.DEFAULT_COLOR_2,e}getLayerColor(s,e,t){switch(this.getLayerTag(s,this._direction,e)){case fa.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case fa.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(s,e,t)}getSpriteAssetName(s,e){return this.getLayerTag(s,this._direction,e)===fa.BADGE?s===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(s,e)}getLibraryAssetNameForSprite(s,e){return e.tag===fa.BADGE?"%group.badge.url%"+e.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(s,e)}};let Yc=fa;Yc.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";Yc.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";Yc.BADGE="BADGE";Yc.DEFAULT_COLOR_1=15658734;Yc.DEFAULT_COLOR_2=4934475;const Kl=class extends eI{updateModel(s){const e=super.updateModel(s);if(!this.hasThumbnailImage){const i=this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);i&&i.length&&this.setThumbnailImages(this.getBitmapAsset(i))}const t=this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=t||Kl.DEFAULT_COLOR_1;const r=this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=r||Kl.DEFAULT_COLOR_2,e}generateTransformedThumbnail(s,e){const r=new Zr,i=e.width/s.width;switch(this.direction){case 2:r.a=i,r.b=-.5*i,r.c=0,r.d=i*1.1,r.tx=0,r.ty=.5*i*s.width;break;case 0:case 4:r.a=i,r.b=.5*i,r.c=0,r.d=i*1.1,r.tx=0,r.ty=0;break;default:r.a=i,r.b=0,r.c=0,r.d=i,r.tx=0,r.ty=0}const n=new ds(s);return n.transform.setFromMatrix(r),n.position.set(0),Lt.generateTexture(n)}getLayerColor(s,e,t){switch(this.getLayerTag(s,this._direction,e)){case Kl.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Kl.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(s,e,t)}getLibraryAssetNameForSprite(s,e){return e.tag===Kl.THUMBNAIL&&this.object&&this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(s,e)}getBitmapAsset(s){const e=this.asset.getAsset(s);return!e||!e.texture?null:e.texture}};let ch=Kl;ch.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";ch.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";ch.DEFAULT_COLOR_1=15658734;ch.DEFAULT_COLOR_2=4934475;const ql=class extends Vs{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(s){if(s===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(ql.ANIMATION_ID_START_ROLL),this._stateQueue.push(ql.ANIMATION_ID_ROLL);return}if(s>0&&s<=ql.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(ql.ANIMATION_ID_OFFSET_SLOW1+s),this._stateQueue.push(ql.ANIMATION_ID_OFFSET_SLOW2+s),this._stateQueue.push(s);return}super.setAnimation(s)}}updateAnimation(s){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(s)}};let uh=ql;uh.ANIMATION_ID_OFFSET_SLOW1=10;uh.ANIMATION_ID_OFFSET_SLOW2=20;uh.ANIMATION_ID_START_ROLL=31;uh.ANIMATION_ID_ROLL=32;class XK extends nL{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(e){if(!this._gifCollection)return;const t=this._gifCollection.textures;if(t.length){for(let r=0;r<t.length;r++){const i=t[r];if(!i||!this.getAsset(`${this._imageUrl}_${r}`))continue;const o=1.1,l=new Zr,c=e.width/i.width;switch(this.direction){case 2:l.a=c,l.b=-.5*c,l.c=0,l.d=c*o,l.tx=0,l.ty=.5*c*i.width;break;case 0:case 4:l.a=c,l.b=.5*c,l.c=0,l.d=c*o,l.tx=0,l.ty=0;break;default:l.a=c,l.b=0,l.c=0,l.d=c,l.tx=0,l.ty=0}const h=new ds(i),u=yn.create({width:e.width+l.tx,height:e.height+l.ty});sr.instance.renderer.render(h,{renderTexture:u,clear:!0,transform:l}),this.asset.disposeAsset(`${this._imageUrl}_${r}`),this.asset.addAsset(`${this._imageUrl}_${r}`,u,!0,e.x,e.y,e.flipH,e.flipV)}this._needsTransform=!1}}generateTransformedImage(e,t){const i=new Zr,n=t.width/e.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*e.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const o=new ds(e),l=yn.create({width:t.width+i.tx,height:t.height+i.ty});sr.instance.renderer.render(o,{renderTexture:l,clear:!0,transform:i}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,l,!0,o.x,o.y,t.flipH,t.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(e,t){return this.getLayerTag(e,this._direction,t)===xo.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(e,t))):this.generateTransformedImage(di().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(e,t)))),`${this._imageUrl}_${this.getFrameNumber(e,t)}`):super.getSpriteAssetName(e,t)}}class Ff extends Ua{constructor(){super(),this._avatarData=new a_}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(e,t,r=null,i=null,n=null){return this._avatarData.createAvatarImage(e,t,r,i,n)}set avatarManager(e){this._avatarData.avatarManager=e}}const Rd=class extends la{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(s){return s instanceof Ff?super.initialize(s):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(s,e){const t=super.updateObject(s,e);return t&&this._mannequinScale!==s&&(this._mannequinScale=s,this.updateAvatar()),t}updateModel(s){let e=super.updateModel(s);if(e){const t=this.object.model.getValue(b.FURNITURE_MANNEQUIN_FIGURE)||null;t&&(this._figure=t+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(b.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(s=!1){if(!this.avatarExists()||s){const e=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);e&&(e.setDirection(lr.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),e.getImage(lr.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,e.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(s){s===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(s,e){const t=this.getLayerTag(s,this.direction,e);return this._figure&&t===Rd.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(s,e)}getLayerXOffset(s,e,t){return this.getLayerTag(s,e,t)===Rd.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(t).width/2:super.getLayerXOffset(s,e,t)}getLayerYOffset(s,e,t){return this.getLayerTag(s,e,t)===Rd.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(t).height:super.getLayerYOffset(s,e,t)}get disposed(){return this._disposed}get data(){return this._data}};let lL=Rd;lL.AVATAR_IMAGE_SPRITE_TAG="avatar_image";const $o=class extends Vs{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(s){this._animSpeedIndex||this.initItems(s);let e=this.getSprite(2);return e&&(this._animOffsetIndex[0]=this.getNewPoint(s,0)),e=this.getSprite(3),e&&(this._animOffsetIndex[1]=this.getNewPoint(s,1)),super.updateAnimation(s)}getNewPoint(s,e){let t=0,r=this._animPhaseIndex[e],i=this._animDirectionIndex[e];const n=this._animSpeedIndex[e],o=this._animFactorIndex[e];let l=1;s==32?(t=$o.AREA_DIAMETER_SMALL,l=.5):t=$o.AREA_DIAMETER_LARGE;const c=r+i*n;Math.abs(c)>=t&&(i>0?r=r-(c-t):r=r+(-t-c),i=-i,this._animDirectionIndex[e]=i);const h=(t-Math.abs(r))*o;let u=i*Math.sin(Math.abs(r/4))*h;return i>0?u=u-h:u=u+h,r=r+i*n*l,this._animPhaseIndex[e]=r,Math.trunc(u)==0&&(this._animFactorIndex[e]=this.getRandomAmplitudeFactor()),new vr(r,u)}initItems(s){let e;s===32?e=$o.AREA_DIAMETER_SMALL:e=$o.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*e*1.5),this._animPhaseIndex.push(Math.random()*e*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push($o.ANIM_SPEED_FAST),this._animSpeedIndex.push($o.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(s,e,t){return(t===2||t===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[t-2].x:super.getLayerXOffset(s,e,t)}getLayerYOffset(s,e,t){return(t===2||t===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[t-2].y:super.getLayerYOffset(s,e,t)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};let zc=$o;zc.UPDATE_INTERVAL=2;zc.AREA_DIAMETER_SMALL=15;zc.AREA_DIAMETER_LARGE=31;zc.ANIM_SPEED_FAST=2;zc.ANIM_SPEED_SLOW=1;const cL=class{constructor(s,e,t,r,i,n){this._name=s,this._index=e,this._radius=t,this._arcSpeed=r*Math.PI*2/360,this._arcOffset=i*Math.PI*2/360,this._height=n,this._position=0,this._positionVector=new G(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(s,e,t){this._position=this._position+this._arcSpeed/cL.SYSTEM_TEMPO,s[this._index]=this.getPositionVector(e,t);for(const r of this._children)r.update(s,this._positionVector,t)}getPositionVector(s,e){const t=this._radius*Math.cos(this._position+this._arcOffset),r=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(t-r)*(e/2),this._positionVector.y=(r+t)*(e/2)*.5-this._height*(e/2),this._positionVector.z=-Math.trunc(4*(t+r)-.7),s&&this._positionVector.add(s),this._positionVector}addChild(s){this._children.indexOf(s)>=0||this._children.push(s)}hasChild(s){return!!this.getChild(s)}getChild(s){for(const e of this._children){if(e.name===s)return e;if(e.hasChild(s))return e.getChild(s)}return null}get name(){return this._name}};let uL=cL;uL.SYSTEM_TEMPO=30;class QK extends Vs{constructor(){super(),this._offsetArray=[],this._rootPosition=new G}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(e){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const t of this._planetIndex)t.update(this._offsetArray,this._rootPosition,e);return super.updateAnimation(e)}return 0}getLayerXOffset(e,t,r){return this._offsetArray[r]?this._offsetArray[r].x:super.getLayerXOffset(e,t,r)}getLayerYOffset(e,t,r){return this._offsetArray[r]?this._offsetArray[r].y:super.getLayerYOffset(e,t,r)}getLayerZOffset(e,t,r){return this._offsetArray[r]?this._offsetArray[r].z:super.getLayerZOffset(e,t,r)}processPlanets(){if(!this.object||!this.object.model)return;const e=this.object.model.getValue(b.FURNITURE_PLANETSYSTEM_DATA);if(!e)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const t of e)this.getSprite(t.id)&&this.addPlanet(t.name,t.id,t.parent,t.radius||0,t.arcSpeed||0,t.arcOffset||0,t.height||0);return!0}addPlanet(e,t,r,i,n,o,l){if(!this._planetIndex)return;const c=new uL(e,t,i,n,o,l),h=this.getPlanet(r);h?h.addChild(c):(this._planetIndex.push(c),this._planetNameIndex.push(e))}getPlanet(e){for(const t of this._planetIndex){if(t.name===e)return t;if(t.hasChild(e))return t.getChild(e)}return null}}class $K extends Vs{}const Sd=class extends Vs{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(s){return s===Sd.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(Sd.ANIMATION_ID_NORMAL),this._animationCounter=Sd.ANIMATION_DURATION),super.setAnimation(s)}updateAnimation(s){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(s)}usesAnimationResetting(){return!0}};let hh=Sd;hh.ANIMATION_ID_ROLL=3;hh.ANIMATION_ID_ROLL_ONCE=2;hh.ANIMATION_ID_NORMAL=1;hh.ANIMATION_DURATION=15;class JK extends Vs{usesAnimationResetting(){return!0}}class ZK extends xo{imageReady(e,t){super.imageReady(e,t),e&&this.setImageOffset(e.width,e.height)}setImageOffset(e,t){const r=new eL;r.setDirection(1,0,-t),r.setDirection(3,0,0),r.setDirection(5,-e,0),r.setDirection(7,-e,-t),r.setDirection(4,-e/2,-t/2),this._imageOffset=r}getLayerXOffset(e,t,r){if(this._imageOffset){const i=this._imageOffset.getXOffset(t,0);if(i!==void 0)return i+this._offsetX}return super.getLayerXOffset(e,t,r)+this._offsetX}getLayerYOffset(e,t,r){if(this._imageOffset){const i=this._imageOffset.getYOffset(t,0);if(i!==void 0)return i+this._offsetY}return super.getLayerYOffset(e,t,r)+this._offsetY}getLayerZOffset(e,t,r){return super.getLayerZOffset(e,t,r)+-this._offsetZ}getLayerIgnoreMouse(e,t,r){return!0}}const pu=class extends Vs{getFrameNumber(s,e){const t=this.getLayerTag(s,this.direction,e),r=this.object.getState(0);switch(t){case pu.ONES_SPRITE:return Math.floor(r%10);case pu.TENS_SPRITE:return Math.floor(r/10%10);case pu.HUNDREDS_SPRITE:return Math.floor(r/100%10);case pu.THOUSANDS_SPRITE:return Math.floor(r/1e3%10);default:return super.getFrameNumber(s,e)}}};let dh=pu;dh.ONES_SPRITE="ones_sprite";dh.TENS_SPRITE="tens_sprite";dh.HUNDREDS_SPRITE="hundreds_sprite";dh.THOUSANDS_SPRITE="thousands_sprite";class e6 extends Vs{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(e){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(b.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(e)}}class t6 extends la{getLayerColor(e,t,r){return this._data?this._data.getLayerColor(e,t,r):Cc.DEFAULT_COLOR}}const fn=class extends Vs{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(fn.ANIMATION_ID_OFF)}setAnimation(s){if(s===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(fn.ANIMATION_ID_START_ROLL),this._stateQueue.push(fn.ANIMATION_ID_ROLL);return}if(s>0&&s<=fn.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(fn.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(fn.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(fn.ANIMATION_ID_OFFSET_SLOW1+s),this._stateQueue.push(fn.ANIMATION_ID_OFFSET_SLOW2+s)),this._stateQueue.push(fn.ANIMATION_ID_OFF);return}super.setAnimation(fn.ANIMATION_ID_OFF)}}updateAnimation(s){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(s)}};let Kc=fn;Kc.ANIMATION_ID_OFFSET_SLOW1=20;Kc.ANIMATION_ID_OFFSET_SLOW2=10;Kc.ANIMATION_ID_START_ROLL=31;Kc.ANIMATION_ID_ROLL=32;Kc.ANIMATION_ID_OFF=30;const ro=class extends Vs{updateObject(s,e){return super.updateObject(s,e),!0}getFrameNumber(s,e){const t=this.object.model.getValue(b.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(s,this.direction,e)){case ro.ONES_SPRITE:return t%10;case ro.TENS_SPRITE:return t/10%10;case ro.HUNDREDS_SPRITE:return t/100%10;default:return super.getFrameNumber(s,e)}}getLayerAlpha(s,e,t){if(this.object.model.getValue(b.FURNITURE_VOTE_COUNTER_COUNT)===ro.HIDE_COUNTER_SCORE)switch(this.getLayerTag(s,e,t)){case ro.ONES_SPRITE:case ro.TENS_SPRITE:case ro.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(s,e,t)}};let _h=ro;_h.ONES_SPRITE="ones_sprite";_h.TENS_SPRITE="tens_sprite";_h.HUNDREDS_SPRITE="hundreds_sprite";_h.HIDE_COUNTER_SCORE=-1;const pa=class extends Vs{getFrameNumber(s,e){const t=this.object.model.getValue(b.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(s,this.direction,e)){case pa.ONES_SPRITE:return t%10;case pa.TENS_SPRITE:return t/10%10;case pa.HUNDREDS_SPRITE:return t/100%10;default:return super.getFrameNumber(s,e)}}getLayerAlpha(s,e,t){const r=this.object.model.getValue(b.FURNITURE_VOTE_MAJORITY_RESULT);if(pa.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||r===pa.HIDE_RESULTS_VALUE)switch(this.getLayerTag(s,e,t)){case pa.ONES_SPRITE:case pa.TENS_SPRITE:case pa.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(s,e,t)}};let qc=pa;qc.ONES_SPRITE="ones_sprite";qc.TENS_SPRITE="tens_sprite";qc.HUNDREDS_SPRITE="hundreds_sprite";qc.HIDE_RESULTS_STATES=[-1,1];qc.HIDE_RESULTS_VALUE=-1;class s6 extends Vs{}const hL=class extends aL{getThumbnailURL(){if(!this.object)return null;const s=this.object.model.getValue(b.FURNITURE_DATA);return s&&s[hL.THUMBNAIL_URL]||null}};let dL=hL;dL.THUMBNAIL_URL="THUMBNAIL_URL";class r6{constructor(e){this._sprite=new ds(e),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(e){if(!this._sprite||this._amount===e)return null;const t=new Qi;t.addChild(this._sprite);const r=new EU("+"+e,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return r.anchor.x=.5,r.x=this._sprite.width/2,r.y=19,t.addChild(r),this._texture?sr.instance.renderer.render(t,{renderTexture:this._texture,clear:!0}):this._texture=Lt.generateTexture(t),this._texture}get amount(){return this._amount}set amount(e){this._amount=e}get alpha(){return this._alpha}set alpha(e){this._alpha=e}}class _L extends ZE{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(e,t,r){return e>1?new zl(t,r):new o_(t,r)}defineVisualizations(e){return this._isAllowedToTurnHead=!0,super.defineVisualizations(e)}processVisualElement(e,t,r){if(!e||!t||!r)return!1;switch(t){case"postures":if(!(e instanceof zl)||!e.processPostures(r))return!1;break;case"gestures":if(!(e instanceof zl)||!e.processGestures(r))return!1;break;default:if(!super.processVisualElement(e,t,r))return!1;break}return!0}postureToAnimation(e,t){const r=this.getSizeData(e);return r?r.postureToAnimation(t):zl.DEFAULT}getGestureDisabled(e,t){const r=this.getSizeData(e);return r?r.getGestureDisabled(t):!1}gestureToAnimation(e,t){const r=this.getSizeData(e);return r?r.gestureToAnimation(t):zl.DEFAULT}animationToPosture(e,t,r){const i=this.getSizeData(e);return i?i.animationToPosture(t,r):null}animationToGesture(e,t){const r=this.getSizeData(e);return r?r.animationToGesture(t):null}getGestureForAnimationId(e,t){const r=this.getSizeData(e);return r?r.getGestureForAnimationId(t):null}totalPostures(e){const t=this.getSizeData(e);return t?t.totalPostures:0}totalGestures(e){const t=this.getSizeData(e);return t?t.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const br=class extends Vs{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<br.ANIMATION_INDEX_COUNT;)this._animationStates.push(new tL)}initialize(s){if(!(s instanceof _L))return!1;const e=this.getPetAdditionAsset(br.PET_EXPERIENCE_BUBBLE);return e&&(this._experienceData=new r6(e)),super.initialize(s)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const s=this._animationStates[0];s&&s.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(s){return s.animationId}update(s,e,t,r){super.update(s,e,t,r),this.updateExperienceBubble(e)}updateExperienceBubble(s){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const e=s-this._experienceTimestamp;e<br.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(e/br.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const t=this.getSprite(this.totalSprites-1);if(t){if(this._experienceData.alpha>0){const r=this._experienceData.renderBubble(this._experience);if(r){t.texture=r,t.offsetX=-20,t.offsetY=-80,t.alpha=this._experienceData.alpha,t.visible=!0,t.relativeDepth=-.2;return}}t.texture=null,t.visible=!1}}}updateModel(s){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;const t=e.getValue(b.FIGURE_POSTURE),r=e.getValue(b.FIGURE_GESTURE);this.setPostureAndGesture(t,r);let i=e.getValue(b.FURNITURE_ALPHA_MULTIPLIER)||null;(i===null||isNaN(i))&&(i=1),this._alphaMultiplier!==i&&(this._alphaMultiplier=i,this._alphaChanged=!0),this._isSleeping=e.getValue(b.FIGURE_SLEEP)>0;const n=e.getValue(b.HEAD_DIRECTION);!isNaN(n)&&this.data.isAllowedToTurnHead?this._headDirection=n:this._headDirection=this.object.getDirection().x,this._experience=e.getValue(b.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=e.getValue(b.FIGURE_EXPERIENCE_TIMESTAMP);const o=e.getValue(b.PET_PALETTE_INDEX),l=e.getValue(b.PET_CUSTOM_LAYER_IDS),c=e.getValue(b.PET_CUSTOM_PARTS_IDS),h=e.getValue(b.PET_CUSTOM_PALETTE_IDS),u=e.getValue(b.PET_IS_RIDING),g=e.getValue(b.PET_HEAD_ONLY),m=e.getValue(b.PET_COLOR);return o!==this._paletteIndex&&(this._paletteIndex=o,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=l||[],this._customPartIds=c||[],this._customPaletteIds=h||[],this._isRiding=!isNaN(u)&&u>0,this._headOnly=!isNaN(g)&&g>0,!isNaN(m)&&this._color!==m&&(this._color=m),this.updateModelCounter=e.updateCounter,!0}updateAnimation(s){if(this.object){const e=this.object.getDirection().x;e!==this._previousAnimationDirection&&(this._previousAnimationDirection=e,this.resetAllAnimationFrames())}return super.updateAnimation(s)}setPostureAndGesture(s,e){this.data&&(s!==this._posture&&(this._posture=s,this.setAnimationForIndex(br.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,s))),this.data.getGestureDisabled(this._scale,s)&&(e=null),e!==this._gesture&&(this._gesture=e,this.setAnimationForIndex(br.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,e))))}getAnimationStateData(s){return s>=0&&s<this._animationStates.length?this._animationStates[s]:null}setAnimationForIndex(s,e){const t=this.getAnimationStateData(s);t&&this.setSubAnimation(t,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let s=this._animationStates.length-1;for(;s>=0;){const e=this._animationStates[s];e&&e.setLayerCount(this.animatedLayerCount),s--}}updateAnimations(s){if(this._animationOver)return 0;let e=!0,t=0,r=0;for(;r<this._animationStates.length;){const i=this._animationStates[r];if(i&&!i.animationOver){const n=this.updateFramesForAnimation(i,s);t=t|n,i.animationOver?(Js.isTransitionFromAnimation(i.animationId)||Js.isTransitionToAnimation(i.animationId))&&(this.setAnimationForIndex(r,i.animationAfterTransitionId),e=!1):e=!1}r++}return this._animationOver=e,t}getSpriteAssetName(s,e){if(this._headOnly&&this.isNonHeadSprite(e)||this._isRiding&&this._parser3(e))return null;const t=this.totalSprites;if(e<t-br.ADDITIONAL_SPRITE_COUNT){const r=this.getValidSize(s);if(e<t-(1+br.ADDITIONAL_SPRITE_COUNT)){if(e>=Ua.LAYER_LETTERS.length)return null;const i=Ua.LAYER_LETTERS[e];return r===1?this._type+"_icon_"+i:this._type+"_"+r+"_"+i+"_"+this.getDirection(s,e)+"_"+this.getFrameNumber(r,e)}return this._type+"_"+r+"_sd_"+this.getDirection(s,e)+"_0"}return null}getLayerColor(s,e,t){return e<this.totalSprites-br.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(s,e,t){let r=super.getLayerXOffset(s,e,t),i=this._animationStates.length-1;for(;i>=0;){const n=this._animationStates[i];if(n){const o=n.getFrame(t);o&&(r+=o.x)}i--}return r}getLayerYOffset(s,e,t){let r=super.getLayerYOffset(s,e,t),i=this._animationStates.length-1;for(;i>=0;){const n=this._animationStates[i];if(n){const o=n.getFrame(t);o&&(r+=o.y)}i--}return r}getLayerZOffset(s,e,t){return this.data?this.data.getLayerZOffset(s,this.getDirection(s,t),t):At.DEFAULT_ZOFFSET}getDirection(s,e){return this.isHeadSprite(e)?this.data.getValidDirection(s,this._headDirection):this._direction}getFrameNumber(s,e){let t=this._animationStates.length-1;for(;t>=0;){const r=this._animationStates[t];if(r){const i=r.getFrame(e);if(i)return i.id}t--}return super.getFrameNumber(s,e)}isHeadSprite(s){if(this._headSprites[s]===void 0){const e=this.data.getLayerTag(this._scale,rl.USE_DEFAULT_DIRECTION,s)===br.HEAD,t=this.data.getLayerTag(this._scale,rl.USE_DEFAULT_DIRECTION,s)===br.HAIR;e||t?this._headSprites[s]=!0:this._headSprites[s]=!1}return this._headSprites[s]}isNonHeadSprite(s){if(this._nonHeadSprites[s]===void 0)if(s<this.totalSprites-(1+br.ADDITIONAL_SPRITE_COUNT)){const e=this.data.getLayerTag(this._scale,rl.USE_DEFAULT_DIRECTION,s);e&&e.length>0&&e!==br.HEAD&&e!==br.HAIR?this._nonHeadSprites[s]=!0:this._nonHeadSprites[s]=!1}else this._nonHeadSprites[s]=!0;return this._nonHeadSprites[s]}_parser3(s){return this._saddleSprites[s]===void 0&&(this.data.getLayerTag(this._scale,rl.USE_DEFAULT_DIRECTION,s)===br.SADDLE?this._saddleSprites[s]=!0:this._saddleSprites[s]=!1),this._saddleSprites[s]}getAsset(s,e=-1){if(!this.asset)return null;const t=this._customLayerIds.indexOf(e);let r=this._paletteName,i=-1,n=-1;return t>-1&&(i=this._customPartIds[t],n=this._customPaletteIds[t],r=n>-1?n.toString():this._paletteName),!isNaN(i)&&i>-1&&(s=s+"_"+i),this.asset.getAssetWithPalette(s,r)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+br.ADDITIONAL_SPRITE_COUNT}setLayerCount(s){super.setLayerCount(s),this._headSprites=[]}getPostureForAsset(s,e){const t=e.split("_");let r=t.length,i=0;for(;i<t.length;){if(t[i]==="64"||t[i]==="32"){r=i+3;break}i++}let n=null;if(r<t.length){let o=t[r];o=o.split("@")[0],n=this.data.animationToPosture(s,parseInt(o)/100,!1),n||(n=this.data.getGestureForAnimationId(s,parseInt(o)/100))}return n}getPetAdditionAsset(s){return di().getTexture(s)}get data(){return this._data}};let Un=br;Un.TYPE=pe.PET_ANIMATED;Un.HEAD="head";Un.SADDLE="saddle";Un.HAIR="hair";Un.ADDITIONAL_SPRITE_COUNT=1;Un.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3;Un.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble";Un.POSTURE_ANIMATION_INDEX=0;Un.GESTURE_ANIMATION_INDEX=1;Un.ANIMATION_INDEX_COUNT=2;class tI{constructor(e,t=-1,r=1,i=-1,n=1){this._normalMinX=t,this._normalMaxX=r,this._normalMinY=i,this._normalMaxY=n,this._asset=e}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}tI.MIN_NORMAL_COORDINATE_VALUE=-1;tI.MAX_NORMAL_COORDINATE_VALUE=1;class il{constructor(){this._bitmaps=[]}dispose(){for(const e of this._bitmaps)e&&e.dispose();this._bitmaps=null}addBitmap(e,t=-1,r=1,i=-1,n=1){this._bitmaps.push(new tI(e,t,r,i,n))}getAsset(e){if(!e)return null;for(const t of this._bitmaps)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t.asset;return null}}il.MIN_NORMAL_COORDINATE_VALUE=-1;il.MAX_NORMAL_COORDINATE_VALUE=1;class i6{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const e of this._maskVisualizations.values())e&&e.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(e){if(this._maskVisualizations.get(e))return null;const r=new il;return this._maskVisualizations.set(e,r),this._sizes.push(e),this._sizes.sort(),r}getSizeIndex(e){let t=0,r=1;for(;r<this._sizes.length;){if(this._sizes[r]>e){this._sizes[r]-e<e-this._sizes[r-1]&&(t=r);break}t=r,r++}return t}getMaskVisualization(e){if(e===this._lastSize)return this._lastMaskVisualization;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[t]):this._lastMaskVisualization=null,this._lastSize=e,this._lastMaskVisualization}getGraphicAsset(e,t){const r=this.getMaskVisualization(e);return r?r.getAsset(t):null}getAssetName(e){return this._assetNames&&this._assetNames.get(e)||null}setAssetName(e,t){this._assetNames&&this._assetNames.set(e,t)}}class n6{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const e of this._masks.values())e&&e.dispose();this._masks.clear()}}initialize(e){this._data=e}initializeAssetCollection(e){this.data&&(this._assetCollection=e,this.parseMasks(this.data,e))}parseMasks(e,t){if(!(!e||!t)&&e.masks&&e.masks.length){let r=0;for(;r<e.masks.length;){const i=e.masks[r];if(i){const n=i.id;if(this._masks.get(n))continue;const l=new i6;if(i.visualizations&&i.visualizations.length){let c=0;for(;c<i.visualizations.length;){const h=i.visualizations[c];if(h){const u=h.size,g=l.createMaskVisualization(u);if(g){const m=this.parseMaskBitmaps(h.bitmaps,g,t);l.setAssetName(u,m)}}c++}}this._masks.set(n,l)}r++}}}parseMaskBitmaps(e,t,r){if(!e||!e.length)return null;let i=null;for(const n of e){if(!n)continue;const o=n.assetName,l=r.getAsset(o);if(!l)continue;let c=il.MIN_NORMAL_COORDINATE_VALUE,h=il.MAX_NORMAL_COORDINATE_VALUE,u=il.MIN_NORMAL_COORDINATE_VALUE,g=il.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(c=n.normalMinX),n.normalMaxX!==void 0&&(h=n.normalMaxX),n.normalMinY!==void 0&&(u=n.normalMinY),n.normalMaxY!==void 0&&(g=n.normalMaxY),l.flipH||(i=o),t.addBitmap(l,c,h,u,g)}return i}updateMask(e,t,r,i,n,o){const l=this._masks.get(t);if(!l)return!0;const c=l.getGraphicAsset(r,i);if(!c)return!0;const h=c.texture;if(!h)return!0;const u=new it(n+c.offsetX,o+c.offsetY),g=new Zr;let m=1,p=1,f=0,T=0,I=u.x+f,O=u.y+T;return c.flipH&&(m=-1,f=h.width,I=u.x+f-h.width),c.flipV&&(p=-1,T=h.height,O=u.y+T-h.height),g.scale(m,p),g.translate(I,O),sr.instance.renderer.render(new bs(h),{renderTexture:e,clear:!1,transform:g}),!0}getMask(e){return!this._masks||!this._masks.size?null:this._masks.get(e)||null}}class Eu{constructor(e=null,t=0,r=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],e!=null&&(this._maskAssetNames=e._maskAssetNames,this._maskAssetLocations=e._maskAssetLocations,this._maskAssetFlipHs=e._maskAssetFlipHs,this._maskAssetFlipVs=e._maskAssetFlipVs),this._color=t,this._alignBottom=r}addMask(e,t,r,i){this._maskAssetNames.push(e),this._maskAssetLocations.push(t),this._maskAssetFlipHs.push(r),this._maskAssetFlipVs.push(i)}addAssetColumn(e){this._assetNames.push(e)}set z(e){this._z=e}get z(){return this._z}set cornerPoints(e){this._points=e}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class a6{constructor(e,t,r,i,n){this._x=e,this._y=t,this._speedX=r,this._speedY=i,this._asset=n,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(e,t,r,i,n){let o=this._x,l=this._y;r>0&&(o=o+this._speedX/r*n/1e3),i>0&&(l=l+this._speedY/i*n/1e3);const c=Math.trunc(o%1*e),h=Math.trunc(l%1*t);return new it(c,h)}}const sI=class{constructor(s,e,t,r=0){this._material=s,this._offset=r,this._align=t,this._color=e,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(s,e,t,r,i,n,o,l,c){const h=this._color>>16,u=this._color>>8&255,g=this._color&255,m=h<255||u<255||g<255;if(this._material){const p=this._material.render(s,e,m?null:t,r,i,n,o,l,c+this.offset,this.align===sI.ALIGN_TOP);if(p&&m){const f=new bs(p);m&&(f.tint=this._color),e.writeToRenderTexture(f,t,!1)}}else{const p=e.createAndFillRenderTexture(r,i,s,this._color);e.writeToRenderTexture(new bs(p),t,!1)}return t}getMaterial(){return this._material}getColor(){return this._color}};let gi=sI;gi.DEFAULT_OFFSET=0;gi.ALIGN_TOP=1;gi.ALIGN_BOTTOM=2;gi.ALIGN_DEFAULT=sI.ALIGN_TOP;class o6{constructor(e,t,r){this._layers=[],this._geometry=r,this._cachedBitmapNormal=new G,this._isCached=!1,this._hasAnimationLayers=!1,t<0&&(t=0);let i=0;for(;i<t;)this._layers.push(null),i++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const e of this._layers)e&&e.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new G),this._layers&&this._layers.length)for(const e of this._layers){if(!e)continue;e.clearCache()}this._isCached=!1}}setLayer(e,t,r,i,n=0){if(e<0||e>this._layers.length)return!1;let o=this._layers[e];return o&&o.dispose(),o=new gi(t,r,i,n),this._layers[e]=o,!0}setAnimationLayer(e,t,r){if(e<0||e>this._layers.length)return!1;let i=this._layers[e];return i&&i.dispose(),i=new rT(t,r),this._layers[e]=i,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(e,t,r,i,n,o,l,c=0,h=0,u=0,g=0,m=0,p=0,f=0){i<1&&(i=1),n<1&&(n=1),(!r||r.width!==i||r.height!==n)&&(r=null),this._isCached=!0;const T=t.createAndFillRenderTexture(i,n,e);if(this._cachedBitmapNormal.assign(o),this._layers&&this._layers.length)for(const I of this._layers)I&&(I instanceof gi?I.render(`${e}:${this._layers.indexOf(I)}`,t,T,i,n,o,l,c,h):I instanceof rT&&I.render(t,T,i,n,o,c,h,u,g,m,p,f));return T}}class rI{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(e){return!0}dispose(){for(const e of this._planeVisualizations.values())e&&e.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const e of this._planeVisualizations.values())e&&e.clearCache()}createPlaneVisualization(e,t,r){if(this._planeVisualizations.get(e.toString()))return null;const n=new o6(e,t,r);return this._planeVisualizations.set(e.toString(),n),this._sizes.push(e),this._sizes.sort(),n}getSizeIndex(e){let t=0,r=1;for(;r<this._sizes.length;){if(this._sizes[r]>e){this._sizes[r]-e<e-this._sizes[r-1]&&(t=r);break}t=r,r++}return t}getPlaneVisualization(e){if(e===this._lastSize)return this._lastPlaneVisualization;const t=this.getSizeIndex(e);return t<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[t].toString()):this._lastPlaneVisualization=null,this._lastSize=e,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}class hl extends rI{render(e,t,r,i,n,o,l,c,h,u){const g=this.getPlaneVisualization(o);if(!g||!g.geometry)return null;const m=g.geometry.getScreenPoint(new G(0,0,0)),p=g.geometry.getScreenPoint(new G(0,n/g.geometry.scale,0)),f=g.geometry.getScreenPoint(new G(i/g.geometry.scale,0,0));let T=0,I=0;if(m&&p&&f){i=Math.round(Math.abs(m.x-f.x)),n=Math.round(Math.abs(m.x-p.x));const O=m.x-g.geometry.getScreenPoint(new G(1,0,0)).x;T=h*Math.trunc(Math.abs(O)),I=u*Math.trunc(Math.abs(O))}return g.render(e,t,r,i,n,l,c,T,I)}}hl.DEFAULT_COLOR=16777215;hl.HORIZONTAL_ANGLE_DEFAULT=45;hl.VERTICAL_ANGLE_DEFAULT=30;class l_{constructor(e,t){this._texture=e,this._timeStamp=t}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}const yr=class{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(s=1){yr._randomizer||(yr._randomizer=new yr),yr._randomizer.seed=s}static setModulus(s=16777216){yr._randomizer||(yr._randomizer=new yr),yr._randomizer.modulus=s}static getValues(s,e,t){return yr._randomizer||(yr._randomizer=new yr),yr._randomizer.getRandomValues(s,e,t)}static getArray(s,e){return yr._randomizer||(yr._randomizer=new yr),yr._randomizer.getRandomArray(s,e)}set seed(s){this._seed=s}set modulus(s){s<1&&(s=1),this._modulus=s}dispose(){}getRandomValues(s,e,t){const r=[];let i=0;for(;i<s;)r.push(this.iterateScaled(e,t-e)),i++;return r}getRandomArray(s,e){if(s>e||e>1e3)return null;const t=[];let r=0;for(;r<=e;)t.push(r),r++;const i=[];let n=0;for(;n<s;){const o=this.iterateScaled(0,t.length-1);i.push(t[o]),t.splice(o,1),n++}return i}iterate(){let s=Hf(Math.trunc(this._multiplier*this._seed)+this._increment);return s<0&&(s=-s),s=s%this._modulus,this._seed=s,s}iterateScaled(s,e){let t=this.iterate();return e<1?s:(t=Math.trunc(s+t/this._modulus*e),t)}};let Fa=yr;Fa.DEFAULT_SEED=1;Fa.DEFAULT_MODULUS=16777216;Fa._randomizer=null;const io=class{constructor(s,e,t=1){if(this._cells=[],this._repeatMode=t,this._width=s<1?1:s,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,e&&e.length){let r=0;for(;r<e.length;){const i=e[r];i&&(this._cells.push(i),i.isStatic||(this._isStatic=!1)),r++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==io.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const s of this._cells)s&&s.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const s of this._cells)s&&s.clearCache();this._isCached=!1}}render(s,e,t,r,i,n){if(this._repeatMode===io.REPEAT_MODE_NONE&&(t=this.getCellsHeight(this._cells,r)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new G),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===t&&G.isEqual(this._cachedBitmapNormal,r)&&this._cachedBitmapDataOffsetX===i&&this._cachedBitmapDataOffsetY===n)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=e.createRenderTexture(this._width,t,`${s}:column`)),this._cachedBitmapNormal.assign(r),this._cachedBitmapDataOffsetX=i,this._cachedBitmapDataOffsetY=n,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case io.REPEAT_MODE_NONE:this.renderRepeatNone(r);break;case io.REPEAT_MODE_BORDERS:this.renderRepeatBorders(r);break;case io.REPEAT_MODE_CENTER:this.renderRepeatCenter(r);break;case io.REPEAT_MODE_FIRST:this.renderRepeatFirst(r);break;case io.REPEAT_MODE_LAST:this.renderRepeatLast(r);break;default:this.renderRepeatAll(r,i,n);break}return this._cachedBitmapData}getCellsHeight(s,e){if(!s||!s.length)return 0;let t=0,r=0;for(;r<s.length;){const i=s[r];i&&(t+=i.getHeight(e)),r++}return t}renderCells(s,e,t,r,i=0,n=0){if(!s||!s.length||!this._cachedBitmapData)return e;let o=0;for(;o<s.length;){let l=null;if(t?l=s[o]:l=s[s.length-1-o],l){const c=l.render(r,i,n);if(c&&(t||(e-=c.height),c.y=e,Lt.writeToRenderTexture(c,this._cachedBitmapData,!1),t&&(e=e+c.height),t&&e>=this._cachedBitmapData.height||!t&&e<=0))return e}o++}return e}renderRepeatNone(s){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,s)}renderRepeatAll(s,e,t){if(!this._cells.length||!this._cachedBitmapData)return;let r=0;for(;r<this._cachedBitmapData.height;)if(r=this.renderCells(this._cells,r,!0,s,e,t),!r)return}renderRepeatBorders(s){if(!this._cells.length||!this._cachedBitmapData)return;const e=[];let t=0,r=1;for(;r<this._cells.length-1;){const l=this._cells[r];if(l){const c=l.getHeight(s);c>0&&(t=t+c,e.push(l))}r++}if(this._cells.length==1){const l=this._cells[0];if(l){const c=l.getHeight(s);c>0&&(t=t+c,e.push(l))}}let i=this._cachedBitmapData.height-t>>1,n=this.renderCells(e,i,!0,s),o=this._cells[0];if(o){const l=[o];for(;i>=0;)i=this.renderCells(l,i,!1,s)}if(o=this._cells[this._cells.length-1],o){const l=[o];for(;n<this._cachedBitmapData.height;)n=this.renderCells(l,n,!0,s)}}renderRepeatCenter(s){if(!this._cells.length||!this._cachedBitmapData)return;const e=[],t=[];let r=0,i=0,n=0;for(;n<this._cells.length>>1;){const c=this._cells[n];if(c){const h=c.getHeight(s);h>0&&(r=r+h,e.push(c))}n++}for(n=(this._cells.length>>1)+1;n<this._cells.length;){const c=this._cells[n];if(c){const h=c.getHeight(s);h>0&&(i=i+h,t.push(c))}n++}let o=0,l=this._cachedBitmapData.height;if(r+i>this._cachedBitmapData.height&&(o=r+i-this._cachedBitmapData.height,l=l+(o-(o>>1))),o==0){const c=this._cells[this._cells.length>>1];if(c){const h=c.getHeight(s);if(h>0){const u=this._cachedBitmapData.height-(r+i),g=Math.ceil(u/h)*h;let m=r-(g-u>>1);const p=m+g,f=[c];for(;m<p;)m=this.renderCells(f,m,!0,s)}}}this.renderCells(e,0,!0,s),this.renderCells(t,l,!1,s)}renderRepeatFirst(s){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,this._cachedBitmapData.height,!1,s);const t=this._cells[0];if(!t)return;const r=[t];for(;e>=0;)e=this.renderCells(r,e,!1,s)}renderRepeatLast(s){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,0,!0,s);const t=this._cells[this._cells.length-1];if(!t)return;const r=[t];for(;e<this._cachedBitmapData.height;)e=this.renderCells(r,e,!0,s)}getCells(){return this._cells}};let ci=io;ci.REPEAT_MODE_NONE=0;ci.REPEAT_MODE_ALL=1;ci.REPEAT_MODE_BORDERS=2;ci.REPEAT_MODE_CENTER=3;ci.REPEAT_MODE_FIRST=4;ci.REPEAT_MODE_LAST=5;const Xr=class{constructor(s,e=1,t=1,r=-1,i=1,n=-1,o=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],s<1&&(s=1);let l=0;for(;l<s;)this._columns.push(null),l++;this._repeatMode=e,this._align=t,this._normalMinX=r,this._normalMaxX=i,this._normalMinY=n,this._normalMaxY=o,this._repeatMode===Xr.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(s){return Fa.getValues(1,0,s*17631)[0]%s}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===Xr.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const s of this._columns)s&&s.clearCache();this._isCached=!1}}createColumn(s,e,t,r=1){if(s<0||s>=this._columns.length)return!1;const i=new ci(e,t,r),n=this._columns[s];return n&&n.dispose(),this._columns[s]=i,i&&!i.isStatic&&(this._isStatic=!1),!0}render(s,e,t,r,i,n,o,l,c,h){if(r<1&&(r=1),i<1&&(i=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new G),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===r&&this._cachedBitmapData.height===i&&G.isEqual(this._cachedBitmapNormal,n))return t?(this.copyCachedBitmapOnCanvas(t,this._cachedBitmapHeight,c,h),t):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(n),!o)return this._cachedBitmapHeight=i,this._cachedBitmapData?e.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=e.createAndFillRenderTexture(r,i,`${s}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=i,this._cachedBitmapData=e.createRenderTexture(r,i,`${s}:matrix`),e.clearRenderTexture(this._cachedBitmapData));const u=[];let g=0;for(;g<this._columns.length;){const p=this._columns[g];if(p){const f=p.render(s,e,i,n,l,c);f&&u.push(f)}g++}if(!u.length)return t||this._cachedBitmapData;let m=0;switch(this._repeatMode){case Xr.REPEAT_MODE_BORDERS:xe.log("REPEAT_MODE_BORDERS");break;case Xr.REPEAT_MODE_CENTER:xe.log("REPEAT_MODE_CENTER");break;case Xr.REPEAT_MODE_FIRST:xe.log("REPEAT_MODE_FIRST");break;case Xr.REPEAT_MODE_LAST:xe.log("REPEAT_MODE_LAST");break;case Xr.REPEAT_MODE_RANDOM:m=this.renderRepeatRandom(this._cachedBitmapData,u);break;default:m=this.renderRepeatAll(this._cachedBitmapData,u);break}return this._cachedBitmapHeight=m,t?(this.copyCachedBitmapOnCanvas(t,m,c,h),t):this._cachedBitmapData}copyCachedBitmapOnCanvas(s,e,t,r){if(!s||!this._cachedBitmapData||s===this._cachedBitmapData)return;r||(t=s.height-e-t);let i=null;this._align===Xr.ALIGN_TOP?i=new fi(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):i=new fi(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const n=new yn(this._cachedBitmapData.baseTexture,i),o=new bs(n);o.position.set(0,t),Lt.writeToRenderTexture(o,s,!1)}getColumnsWidth(s){if(!s||!s.length)return 0;let e=0;for(const t of s)t&&(e+=t.width);return e}renderColumns(s,e,t,r){if(!s||!e||!e.length)return new it(t,0);let i=0,n=0;for(;n<e.length;){const o=r?e[n]:e[e.length-1-n];if(o){r||(t=t-o.width);let l=0;this._align==Xr.ALIGN_BOTTOM&&(l=s.height-o.height);const c=new bs(o);if(c.position.set(t,l),Lt.writeToRenderTexture(c,s,!1),o.height>i&&(i=o.height),r&&(t=t+o.width),r&&t>=s.width||!r&&t<=0)return new it(t,i)}n++}return new it(t,i)}renderRepeatAll(s,e){if(!s||!e||!e.length)return 0;this.getColumnsWidth(e);let t=0,r=0;for(;t<s.width;){const i=this.renderColumns(s,e,t,!0);if(t=i.x,i.y>r&&(r=i.y),!i.x)return r}return r}renderRepeatRandom(s,e){if(!s||!e||!e.length)return 0;let t=0,r=0;for(;r<s.width;){const i=e[Xr.nextRandomColumnIndex(e.length)];if(i!=null){const n=this.renderColumns(s,[i],r,!0);r=n.x,n.y>t&&(t=n.y)}else return t}return t}getColumns(s){if(this._repeatMode===Xr.REPEAT_MODE_RANDOM){const e=[];let t=0;for(;t<s;){const r=this._columns[Xr.nextRandomColumnIndex(this._columns.length)];if(r)if(e.push(r),r.width>1)t+=r.width;else break;else break}return e}return this._columns}};let gs=Xr;gs.REPEAT_MODE_ALL=1;gs.REPEAT_MODE_BORDERS=2;gs.REPEAT_MODE_CENTER=3;gs.REPEAT_MODE_FIRST=4;gs.REPEAT_MODE_LAST=5;gs.REPEAT_MODE_RANDOM=6;gs.REPEAT_MODE_DEFAULT=Xr.REPEAT_MODE_ALL;gs.MIN_NORMAL_COORDINATE_VALUE=-1;gs.MAX_NORMAL_COORDINATE_VALUE=1;gs.ALIGN_TOP=1;gs.ALIGN_BOTTOM=2;gs.ALIGN_DEFAULT=Xr.ALIGN_TOP;class iI{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const e of this._planeMaterialItems)e&&e.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const e of this._planeMaterialItems)e&&e.clearCache();this._isCached=!1}}addMaterialCellMatrix(e,t,r,i=-1,n=1,o=-1,l=1){const c=new gs(e,t,r,i,n,o,l);return this._planeMaterialItems.push(c),c}getMaterialCellMatrix(e){if(!e)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t}return null}render(e,t,r,i,n,o,l,c,h,u){i<1&&(i=1),n<1&&(n=1);const g=this.getMaterialCellMatrix(o);return g?(this._isCached=!0,g.render(e,t,r,i,n,o,l,c,h,u)):null}}iI.MIN_NORMAL_COORDINATE_VALUE=-1;iI.MAX_NORMAL_COORDINATE_VALUE=1;class l6{constructor(e,t=null,r=null,i=0){if(this._extraItemCount=0,this._texture=e,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,t&&t.length&&i>0){let n=0;for(;n<t.length;){const o=t[n];o&&this._extraItemAssets.push(o),n++}if(this._extraItemAssets.length){if(r){let o=0;for(;o<r.length;){const l=r[o];l&&this._extraItemOffsets.push(new it(l.x,l.y)),o++}}this._extraItemCount=i}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(e){if(this._texture){const t=this._texture.getBitmap(e);if(t)return t.height}return 0}render(e,t,r){if(!this._texture)return null;const i=this._texture.getBitmap(e);if(!i)return null;const n=new IU(i,i.width,i.height);if(t!==0||r!==0){for(;t<0;)t+=i.width;for(;r<0;)r+=i.height;n.tilePosition.set(t%i.width,r%i.height),n.uvRespectAnchor=!0,t&&(n.anchor.x=1,n.scale.x=-1),r&&(n.anchor.y=1,n.scale.y=-1)}if(!this.isStatic){const o=Math.min(this._extraItemCount,this._extraItemOffsets.length),l=Math.max(this._extraItemCount,this._extraItemOffsets.length),c=Fa.getArray(this._extraItemCount,l);let h=0;for(;h<o;){const u=this._extraItemOffsets[c[h]],g=this._extraItemAssets[h%this._extraItemAssets.length];if(u&&g){const m=g.texture;if(m){let p=g.offsetX,f=g.offsetY,T=1,I=1,O=0,A=0;g.flipH&&(T=-1,O=m.width,p=-(g.width+g.x)),g.flipV&&(I=-1,A=m.height,f=-(g.height+g.y));const N=new it(u.x+p,u.y+f),P=new Zr;let y=N.x+O;y=y>>1<<1,P.scale(T,I),P.translate(y,N.y+A);const D=new bs(m);D.transform.setFromMatrix(P),n.addChild(D)}}h++}}return n}getAssetName(e){return this._texture==null?null:this._texture.getAssetName(e)}}class nI{constructor(e,t=-1,r=1,i=-1,n=1,o=null){this._bitmap=e,this._normalMinX=t,this._normalMaxX=r,this._normalMinY=i,this._normalMaxY=n,this._assetName=o}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}nI.MIN_NORMAL_COORDINATE_VALUE=-1;nI.MAX_NORMAL_COORDINATE_VALUE=1;class el{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const e of this._bitmaps)e&&e.dispose();this._bitmaps=null}}addBitmap(e,t=-1,r=1,i=-1,n=1,o=null){this._bitmaps.push(new nI(e,t,r,i,n,o))}getBitmap(e){const t=this.getPlaneTextureBitmap(e);return t?t.bitmap:null}getPlaneTextureBitmap(e){if(!e)return null;for(const t of this._bitmaps)if(t&&e.x>=t.normalMinX&&e.x<=t.normalMaxX&&e.y>=t.normalMinY&&e.y<=t.normalMaxY)return t;return null}getAssetName(e){const t=this.getPlaneTextureBitmap(e);return t?t.assetName:null}}el.MIN_NORMAL_COORDINATE_VALUE=-1;el.MAX_NORMAL_COORDINATE_VALUE=1;const gL=class{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(s,e){return!0}dispose(){if(this._planes){for(const s of this._planes.values())s&&s.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const s of this._geometries.values())s&&s.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const s of this._planes.values())s&&s.clearCache();for(const s of this._materials.values())s&&s.clearCache()}initialize(s){this._data=s}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const s of this._materials.values())s&&s.dispose();this._materials.clear()}resetTextures(){for(const s of this._textures.values())s&&s.dispose();this._textures.clear()}getTexture(s){return this._textures.get(s)}getMaterial(s){return this._materials.get(s)}getPlane(s){return this._planes.get(s)}addPlane(s,e){return e?this._planes.get(s)?!1:(this._planes.set(s,e),!0):!1}initializeAssetCollection(s){this._data&&(this._assetCollection=s,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(s,e){if(!(!s||!e)&&s.length)for(const t of s){if(!t)continue;const r=t.id;if(!this._textures.get(r)){const i=new el;if(t.bitmaps&&t.bitmaps.length)for(const n of t.bitmaps){if(!n)continue;const o=n.assetName;let l=el.MIN_NORMAL_COORDINATE_VALUE,c=el.MAX_NORMAL_COORDINATE_VALUE,h=el.MIN_NORMAL_COORDINATE_VALUE,u=el.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(l=n.normalMinX),n.normalMaxX!==void 0&&(c=n.normalMaxX),n.normalMinY!==void 0&&(h=n.normalMinY),n.normalMaxY!==void 0&&(u=n.normalMaxY);const g=e.getAsset(o);if(g){const m=g.texture;if(m){let p=m;g.flipH?p=Wx.getFlipHBitmapData(m):p=p.clone(),i.addBitmap(p,l,c,h,u,o)}}}this._textures.set(r,i)}}}parsePlaneMaterials(s){if(!(!s||!s.length))for(const e of s){if(!e)continue;const t=e.id,r=new iI;if(e.matrices&&e.matrices.length)for(const i of e.matrices){if(!i)continue;let n=gs.REPEAT_MODE_DEFAULT,o=gs.ALIGN_DEFAULT,l=gs.MIN_NORMAL_COORDINATE_VALUE,c=gs.MAX_NORMAL_COORDINATE_VALUE,h=gs.MIN_NORMAL_COORDINATE_VALUE,u=gs.MAX_NORMAL_COORDINATE_VALUE;switch(i.normalMinX!==void 0&&(l=i.normalMinX),i.normalMaxX!==void 0&&(c=i.normalMaxX),i.normalMinY!==void 0&&(h=i.normalMinY),i.normalMaxY!==void 0&&(u=i.normalMaxY),i.repeatMode){case"borders":n=gs.REPEAT_MODE_BORDERS;break;case"center":n=gs.REPEAT_MODE_CENTER;break;case"first":n=gs.REPEAT_MODE_FIRST;break;case"last":n=gs.REPEAT_MODE_LAST;break;case"random":n=gs.REPEAT_MODE_RANDOM;break;default:n=gs.REPEAT_MODE_DEFAULT;break}switch(i.align){case"top":o=gs.ALIGN_TOP;break;case"bottom":o=gs.ALIGN_BOTTOM;break;default:o=gs.ALIGN_DEFAULT;break}if(i.columns&&i.columns.length){const g=r.addMaterialCellMatrix(i.columns.length,n,o,l,c,h,u);let m=0;for(;m<i.columns.length;){const p=i.columns[m];p&&this.parsePlaneMaterialCellColumn(p,g,m),m++}}}this._materials.set(t,r)}}parsePlaneMaterialCellColumn(s,e,t){if(!s||!e)return;let r=ci.REPEAT_MODE_ALL;const i=s.width,n=this.parsePlaneMaterialCells(s);switch(s.repeatMode){case"borders":r=ci.REPEAT_MODE_BORDERS;break;case"center":r=ci.REPEAT_MODE_CENTER;break;case"first":r=ci.REPEAT_MODE_FIRST;break;case"last":r=ci.REPEAT_MODE_LAST;break;case"none":r=ci.REPEAT_MODE_NONE;break;default:r=ci.REPEAT_MODE_ALL;break}e.createColumn(t,i,n,r)}parsePlaneMaterialCells(s){if(!s||!s.cells||!s.cells.length)return null;const e=[];let t=0;for(;t<s.cells.length;){const r=s.cells[t];if(r){const i=r.textureId;let n=null,o=null,l=null,c=0;if(r.extraData){const g=r.extraData.extraItemTypes,m=r.extraData.offsets;g&&m&&g.length&&m.length&&(n=this.parseExtraItemTypes(g),o=this.parseExtraItemOffsets(m),c=o.length,r.extraData.limitMax!==void 0&&(c=r.extraData.limitMax))}if(n&&n.length){l=[];for(const g of n){if(!g)continue;const m=this._assetCollection.getAsset(g);m&&l.push(m)}}const h=this.getTexture(i),u=new l6(h,l,o,c);e.push(u)}t++}return!e||!e.length?null:e}parseExtraItemTypes(s){const e=[];if(s&&s.length){let t=0;for(;t<s.length;){const r=s[t];r&&e.push(r),t++}}return e}parseExtraItemOffsets(s){const e=[];if(s&&s.length){let t=0;for(;t<s.length;){const[r,i]=s[t];e.push(new it(r,i)),t++}}return e}getGeometry(s,e,t){e=Math.abs(e),e>90&&(e=90),t=Math.abs(t),t>90&&(t=90);const r=`${s}_${Math.round(e)}_${Math.round(t)}`;let i=this._geometries.get(r);return i||(i=new No(s,new G(e,t),new G(-10,0,0)),this._geometries.set(r,i),i)}parseVisualizations(s,e){if(!(!s||!e)&&e&&e.length)for(const t of e){if(!t)continue;const r=t.size;let i=hl.HORIZONTAL_ANGLE_DEFAULT,n=hl.VERTICAL_ANGLE_DEFAULT;t.horizontalAngle!==void 0&&(i=t.horizontalAngle),t.verticalAngle!==void 0&&(n=t.verticalAngle);const o=t.allLayers,l=s.createPlaneVisualization(r,o&&o.length||0,this.getGeometry(r,i,n));if(l&&o&&o.length){let c=0;for(;c<o.length;){const h=o[c];if(h){let u=null,g=gi.ALIGN_DEFAULT,m=hl.DEFAULT_COLOR,p=gi.DEFAULT_OFFSET;h.materialId&&(u=this.getMaterial(h.materialId)),h.color&&(m=h.color),h.offset&&(p=h.offset),h.align&&(h.align==="bottom"?g=gi.ALIGN_BOTTOM:h.align=="top"&&(g=gi.ALIGN_TOP)),l.setLayer(c,u,m,g,p)}c++}}}}render(s,e,t,r,i,n,o,l,c,h=0,u=0,g=0,m=0,p=0){return null}getTextureIdentifier(s,e){return s.toString()}getLayers(s){let e=this.getPlane(s);return e||(e=this.getPlane(gL.DEFAULT)),e.getLayers()}};let Ac=gL;Ac.DEFAULT="default";class c6 extends Ac{initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseFloors(e)}parseFloors(e){if(e)for(const t in e){const r=e[t];if(!r)continue;const i=r.id,n=r.visualizations,o=new hl;this.parseVisualizations(o,n),this.addPlane(i,o)||o.dispose()}}render(e,t,r,i,n,o,l,c,h,u=0,g=0,m=0,p=0,f=0){let T=this.getPlane(i);if(T||(T=this.getPlane(Ac.DEFAULT)),!T)return null;r&&t.clearAndFillRenderTexture(r);let I=T.render(e,t,r,n,o,l,c,h,u,g);return I&&I!==r&&(I=new yn(I.baseTexture),!I)?null:new l_(I,-1)}}class lg extends rI{render(e,t,r,i,n,o,l,c){const h=this.getPlaneVisualization(o);if(!h||!h.geometry)return null;const u=h.geometry.getScreenPoint(new G(0,0,0)),g=h.geometry.getScreenPoint(new G(0,0,n/h.geometry.scale)),m=h.geometry.getScreenPoint(new G(0,i/h.geometry.scale,0));return u&&g&&m&&(i=Math.round(Math.abs(u.x-m.x)),n=Math.round(Math.abs(u.y-g.y))),h.render(e,t,r,i,n,l,c)}}lg.DEFAULT_COLOR=16777215;lg.HORIZONTAL_ANGLE_DEFAULT=45;lg.VERTICAL_ANGLE_DEFAULT=30;class u6 extends Ac{initializePlanes(){if(!this.data)return;const e=this.data.planes;e&&e.length&&this.parseWalls(e)}parseWalls(e){if(e)for(const t in e){const r=e[t];if(!r)continue;const i=r.id,n=r.visualizations,o=new lg;this.parseVisualizations(o,n),this.addPlane(i,o)||o.dispose()}}render(e,t,r,i,n,o,l,c,h,u=0,g=0,m=0,p=0,f=0){let T=this.getPlane(i);if(T||(T=this.getPlane(Ac.DEFAULT)),!T)return null;r&&t.clearAndFillRenderTexture(r);let I=T.render(e,t,r,n,o,l,c,h);return I&&I!==r&&(I=new yn(I.baseTexture),!I)?null:new l_(I,-1)}getTextureIdentifier(e,t){return t?`${e}_${t.x}_${t.y}_${t.z}`:super.getTextureIdentifier(e,t)}}class nl extends rI{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(e){const t=this.getPlaneVisualization(e);return t?!t.hasAnimationLayers:super.isStatic(e)}initializeDimensions(e,t){e<0&&(e=0),t<0&&(t=0),(e!==this._width||t!==this._height)&&(this._width=e,this._height=t)}render(e,t,r,i,n,o,l,c,h,u,g,m,p){const f=this.getPlaneVisualization(o);if(!f||!f.geometry)return null;const T=f.geometry.getScreenPoint(new G(0,0,0)),I=f.geometry.getScreenPoint(new G(0,0,1)),O=f.geometry.getScreenPoint(new G(0,1,0));if(T&&I&&O){i=Math.round(Math.abs((T.x-O.x)*i/f.geometry.scale)),n=Math.round(Math.abs((T.y-I.y)*n/f.geometry.scale));const A=Math.trunc(h*Math.abs(T.x-O.x)),N=Math.trunc(u*Math.abs(T.y-I.y)),P=Math.trunc(g*Math.abs(T.x-O.x)),y=Math.trunc(m*Math.abs(T.y-I.y));return f.render(e,t,r,i,n,l,c,A,N,P,y,g,m,p)}return null}}nl.DEFAULT_COLOR=16777215;nl.HORIZONTAL_ANGLE_DEFAULT=45;nl.VERTICAL_ANGLE_DEFAULT=30;const Xl=class extends Ac{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(s,e){return s<0&&(s=0),e<0&&(e=0),this._landscapeWidth=s,this._landscapeHeight=e,!0}initializePlanes(){if(!this.data)return;const s=this.data.planes;s&&s.length&&this.parseLandscapes(s)}parseLandscapes(s){if(!s)return;const e=Math.trunc(Math.random()*654321);for(const t in s){const r=s[t];if(!r)continue;const i=r.id,n=r.animatedVisualization,o=new nl;for(const l of n){if(!l)continue;const c=l.size;let h=nl.HORIZONTAL_ANGLE_DEFAULT,u=nl.VERTICAL_ANGLE_DEFAULT;l.horizontalAngle!==void 0&&(h=l.horizontalAngle),l.verticalAngle!==void 0&&(u=l.verticalAngle);const g=l.allLayers.length??0,m=o.createPlaneVisualization(c,g||0,this.getGeometry(c,h,u));if(m){Fa.setSeed(e);let p=0;for(;p<g;){const f=l.allLayers[p];if(f){if(f.items===void 0){const T=f;let I=null,O=gi.ALIGN_DEFAULT,A=nl.DEFAULT_COLOR,N=gi.DEFAULT_OFFSET;T.materialId&&(I=this.getMaterial(T.materialId)),T.color&&(A=T.color),T.offset&&(N=T.offset),T.align&&(T.align==="bottom"?O=gi.ALIGN_BOTTOM:T.align==="top"&&(O=gi.ALIGN_TOP)),m.setLayer(p,I,A,O,N)}else{const I=f.items,O=[];if(I&&I.length){for(const A of I)if(A){A.id;const N=A.assetId,P=this.getCoordinateValue(A.x||"",A.randomX||""),y=this.getCoordinateValue(A.y||"",A.randomY||""),D=A.speedX,x=A.speedY;O.push({asset:N,x:P,y,speedX:D,speedY:x})}}m.setAnimationLayer(p,O,this.assetCollection)}p++}}}}this.addPlane(i,o)||o.dispose()}}getCoordinateValue(s,e){let t=0;if(s.length>0&&s.charAt(s.length-1)==="%"&&(s=s.substr(0,s.length-1),t=parseFloat(s)/100),e.length>0){const n=Fa.getValues(1,0,1e4)[0]/1e4;e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),t=t+n*parseFloat(e)/100)}return t}render(s,e,t,r,i,n,o,l,c,h=0,u=0,g=0,m=0,p=0){let f=this.getPlane(r);if(f||(f=this.getPlane(Xl.DEFAULT)),!f)return null;t&&e.clearRenderTexture(t);let T=f.render(s,e,t,i,n,o,l,c,h,u,g,m,p);if(T&&T!==t&&(T=new yn(T.baseTexture),!T))return null;let I=null;return!f.isStatic(o)&&Xl.UPDATE_INTERVAL>0?I=new l_(T,Math.round(p/Xl.UPDATE_INTERVAL)*Xl.UPDATE_INTERVAL+Xl.UPDATE_INTERVAL):I=new l_(T,-1),I}getTextureIdentifier(s,e){return e?e.x<0?s+"_0":s+"_1":super.getTextureIdentifier(s,e)}};let gh=Xl;gh.LANDSCAPES_ENABLED=!0;gh.LANDSCAPE_DEFAULT_COLOR=8828617;gh.UPDATE_INTERVAL=500;class rT{constructor(e,t){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],e&&t)for(const r of e){if(!r)continue;const i=r.asset;if(i){const n=t.getAsset(i);n&&this._items.push(new a6(r.x,r.y,r.speedX,r.speedY,n))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const e of this._items)e&&e.dispose();this._items=[]}}clearCache(){}render(e,t,r,i,n,o,l,c,h,u,g,m){if(c>0&&h>0){let p=0;for(;p<this._items.length;){const f=this._items[p];if(f){const T=f.getPosition(c,h,u,g,m);if(T.x=Math.trunc(T.x-o),T.y=Math.trunc(T.y-l),f.bitmapData){if(T.x>-f.bitmapData.width&&T.x<t.width&&T.y>-f.bitmapData.height&&T.y<t.height){const I=new bs(f.bitmapData.texture);I.position.set(T.x,T.y),e.writeToRenderTexture(I,t,!1)}if(T.x-c>-f.bitmapData.width&&T.x-c<t.width&&T.y>-f.bitmapData.height&&T.y<t.height){const I=new bs(f.bitmapData.texture);I.position.set(T.x-c,T.y),e.writeToRenderTexture(I,t,!1)}if(T.x>-f.bitmapData.width&&T.x<t.width&&T.y-h>-f.bitmapData.height&&T.y-h<t.height){const I=new bs(f.bitmapData.texture);I.position.set(T.x,T.y-h),e.writeToRenderTexture(I,t,!1)}if(T.x-c>-f.bitmapData.width&&T.x-c<t.width&&T.y-h>-f.bitmapData.height&&T.y-h<t.height){const I=new bs(f.bitmapData.texture);I.position.set(T.x-c,T.y-h),e.writeToRenderTexture(I,t,!1)}}}p++}}return t}}class iT{constructor(e,t,r){this._type=e,this._leftSideLoc=t,this._rightSideLoc=r}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class nT{constructor(e,t,r,i){this._leftSideLoc=e,this._rightSideLoc=t,this._leftSideLength=r,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const no=class{constructor(s,e,t,r,i,n,o,l,c,h=0,u=0,g=0,m=0){if(this._maskManager=null,this._width=0,this._height=0,this._extraDepth=0,this._isHighlighter=!1,this._textureCache=s,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=c,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new G,this._origin.assign(e),this._location=new G,this._location.assign(t),this._leftSide=new G,this._leftSide.assign(r),this._rightSide=new G,this._rightSide.assign(i),this._normal=G.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),l!=null)for(const p of l){if(!p)continue;const f=new G;f.assign(p),this._secondaryNormals.push(f)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new it,this._relativeDepth=0,this._type=n,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new G,this._cornerB=new G,this._cornerC=new G,this._cornerD=new G,this._width=0,this._height=0,this._textureOffsetX=h,this._textureOffsetY=u,this._textureMaxX=g,this._textureMaxY=m,this._useMask=o,this._uniqueId=++no._uniqueIdCounter}static blend(s,e){return Sr.colorize(e,s|4278190080)&16777215}set canBeVisible(s){s!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=s)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(s){this._color=s}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(s){this._hasTexture=s}set rasterizer(s){this._rasterizer=s}set maskManager(s){this._maskManager=s}set id(s){s!==this._id&&(this.resetTextureCache(),this._id=s)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(s){return!this.visible||!this._bitmapData||!s||this._bitmapData.width!==s.width||this._bitmapData.height!==s.height?null:s}resetTextureCache(s=null){this._activeTexture=null}getTextureIdentifier(s){return this._rasterizer?this._rasterizer.getTextureIdentifier(s,this.normal):s.toString()}needsNewTexture(s,e){if(!s)return!1;const t=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!t||t.timeStamp>=0&&e>t.timeStamp||this._maskChanged))}getTexture(s,e){if(!s)return null;if(!this._rasterizer)return console.warn(`Rasterizer no inicializado para el plano ${this._id}`),null;let t=null;if(this.needsNewTexture(s,e)){this.getTextureIdentifier(s.scale);const r=this._leftSide.length*s.scale,i=this._rightSide.length*s.scale,n=s.getCoordinatePosition(this._normal);try{t=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,r,i,s.scale,n,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,e)}catch(o){return console.error(`Error al renderizar textura: ${o}`),null}t?this.updateMask(t.texture,s):console.warn(`No se pudo generar bitmapData para ${this._id}`)}else this._activeTexture&&(t=this._activeTexture);return(t==null?void 0:t.texture)||null}resolveMasks(s){if(!this._useMask)return null;const e=new Eu,t=0;for(;t<this._bitmapMasks.length;){const r=this._bitmapMasks[t];if(r){const i=this._maskManager.getMask(r.type);if(i){const n=i.getAssetName(s.scale);if(n){const o=s.getCoordinatePosition(this._normal),l=i.getGraphicAsset(s.scale,o);if(l){const c=this._maskBitmapData.width*(1-r.leftSideLoc/this._leftSide.length),h=this._maskBitmapData.height*(1-r.rightSideLoc/this._rightSide.length);e.addMask(n,new it(c+l.offsetX,h+l.offsetY),l.flipH,l.flipV)}}}}}return e}screenWidth(s){const e=s.getScreenPoint(new G(0,0,0)),t=s.getScreenPoint(new G(0,1,0));return Math.round(this._leftSide.length*Math.abs(e.x-t.x))}getDrawingDatas(s){const e=[];if(this._isVisible){const t=this.resolveMasks(s),r=this._rasterizer.getLayers(this._id);for(const i of r)if(this._hasTexture&&i.getMaterial()){const n=s.getCoordinatePosition(this._normal),o=i.getMaterial().getMaterialCellMatrix(n),l=new Eu(t,no.blend(this._color,i.getColor()),o.isBottomAligned());Fa.setSeed(this._randomSeed);for(const c of o.getColumns(this.screenWidth(s))){const h=[];for(const u of c.getCells()){const g=u.getAssetName(n);g&&h.push(g)}h.length>0&&(c.isRepeated()||h.push(""),l.addAssetColumn(h))}l.assetNameColumns.length>0&&e.push(l)}else{const n=new Eu(t,no.blend(this._color,i.getColor()));e.push(n)}e.length||e.push(new Eu(t,this._color))}return e}update(s,e){if(!s||this._disposed)return!1;let t=!1;if(this._geometryUpdateId!=s.updateId&&(t=!0),(!t||!this._canBeVisible)&&!this.visible)return!1;if(t){this._activeTexture=null;let r=0;if(r=G.cosAngle(s.directionAxis,this.normal),r>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let i=0;for(;i<this._secondaryNormals.length;){if(r=G.cosAngle(s.directionAxis,this._secondaryNormals[i]),r>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;i++}this.updateCorners(s);const o=s.getScreenPosition(this._origin).z;let l=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-o;this._type===no.TYPE_FLOOR&&(l=l-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===no.TYPE_LANDSCAPE&&(l=l+.02),l-=this._extraDepth,this._relativeDepth=l,this._isVisible=!0,this._geometryUpdateId=s.updateId}if(t||this.needsNewTexture(s,e)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);Fa.setSeed(this._randomSeed);const r=this.getTexture(s,e);if(r)this.renderTexture(s,r);else return this.dispose(),!1;return r!==null||t}return!1}updateCorners(s){this._cornerA.assign(s.getScreenPosition(this._location)),this._cornerB.assign(s.getScreenPosition(G.sum(this._location,this._rightSide))),this._cornerC.assign(s.getScreenPosition(G.sum(G.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(s.getScreenPosition(G.sum(this._location,this._leftSide))),this._offset=s.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),t=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-e,r=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),i=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-r;this._offset.x=this._offset.x-e,this._cornerA.x=this._cornerA.x-e,this._cornerB.x=this._cornerB.x-e,this._cornerC.x=this._cornerC.x-e,this._cornerD.x=this._cornerD.x-e,this._offset.y=this._offset.y-r,this._cornerA.y=this._cornerA.y-r,this._cornerB.y=this._cornerB.y-r,this._cornerC.y=this._cornerC.y-r,this._cornerD.y=this._cornerD.y-r,this._width=t,this._height=i}getMatrixForDimensions(s,e){let t=this._cornerD.x-this._cornerC.x,r=this._cornerD.y-this._cornerC.y,i=this._cornerB.x-this._cornerC.x,n=this._cornerB.y-this._cornerC.y;(this._type===no.TYPE_WALL||this._type===no.TYPE_LANDSCAPE)&&(Math.abs(i-s)<=1&&(i=s),Math.abs(n-s)<=1&&(n=s),Math.abs(t-e)<=1&&(t=e),Math.abs(r-e)<=1&&(r=e));const o=i/s,l=n/s,c=t/e,h=r/e,u=new Zr(o,l,c,h);return u.translate(this._cornerC.x,this._cornerC.y),u}renderTexture(s,e){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||e==null||this._bitmapData==null||this.draw(e,this.getMatrixForDimensions(e.width,e.height))}draw(s,e){this._textureCache.writeToRenderTexture(new bs(s),this._bitmapData,!0,e)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(s,e,t){if(!this._useMask)return!1;for(const i of this._bitmapMasks)if(i&&i.type===s&&i.leftSideLoc===e&&i.rightSideLoc===t)return!1;const r=new iT(s,e,t);return this._bitmapMasks.push(r),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(s,e,t,r){if(this._useMask){for(const n of this._rectangleMasks)if(n&&n.leftSideLoc===s&&n.rightSideLoc===e&&n.leftSideLength===t&&n.rightSideLength===r)return!1;const i=new nT(s,e,t,r);return this._rectangleMasks.push(i),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let s=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const e of this._bitmapMasks){if(!e)continue;let t=!1;for(const r of this._bitmapMasksOld)if(r&&r.type===e.type&&r.leftSideLoc===e.leftSideLoc&&r.rightSideLoc===e.rightSideLoc){t=!0;break}if(!t){s=!1;break}}else s=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(s=!1),s&&(this._maskChanged=!1)}updateMask(s,e){if(!s||!e||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const t=s.width,r=s.height;if(this.updateMaskChangeStatus(),(!this._maskBitmapData||this._maskBitmapData.width!==t||this._maskBitmapData.height!==r)&&(this._maskBitmapData=this._textureCache.createAndFillRenderTexture(t,r,"mask"),this._maskChanged=!0),this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(s);const i=e.getCoordinatePosition(this._normal);let n=null,o=0,l=0,c=0;for(;c<this._bitmapMasks.length;){const h=this._bitmapMasks[c];h&&(n=h.type,o=this._maskBitmapData.width-this._maskBitmapData.width*h.leftSideLoc/this._leftSide.length,l=this._maskBitmapData.height-this._maskBitmapData.height*h.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,n,e.scale,i,o,l),this._bitmapMasksOld.push(new iT(n,h.leftSideLoc,h.rightSideLoc))),c++}for(c=0;c<this._rectangleMasks.length;){const h=this._rectangleMasks[c];if(h){o=this._maskBitmapData.width-this._maskBitmapData.width*h.leftSideLoc/this._leftSide.length,l=this._maskBitmapData.height-this._maskBitmapData.height*h.rightSideLoc/this._rightSide.length;const u=this._maskBitmapData.width*h.leftSideLength/this._leftSide.length,g=this._maskBitmapData.height*h.rightSideLength/this._rightSide.length,m=new bs(ys.WHITE);m.tint=0,m.width=u,m.height=g,m.position.set(o-u,l-g),this._textureCache.writeToRenderTexture(m,this._maskBitmapData,!1),this._rectangleMasksOld.push(new nT(h.leftSideLength,h.rightSideLoc,h.leftSideLength,h.rightSideLength))}c++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(s,this._maskPixels)}combineTextureMask(s,e){var n,o;if(!s||!e)return;const t=this._textureCache.getPixels(s);for(let l=0;l<t.length;l+=4){const c=e[l],h=e[l+1],u=e[l+2];e[l+3],!c&&!h&&!u&&(t[l+3]=0)}const r=(n=s.baseTexture._glTextures[1])==null?void 0:n.texture,i=(o=sr.instance.renderer)==null?void 0:o.gl;!r||!i||(i.bindTexture(i.TEXTURE_2D,r),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,s.width,s.height,0,i.RGBA,i.UNSIGNED_BYTE,t),i.bindTexture(i.TEXTURE_2D,null))}set extraDepth(s){this._extraDepth=s}get isHighlighter(){return this._isHighlighter}set isHighlighter(s){this._isHighlighter=s}};let Et=no;Et.ZERO_POINT=new it(0,0);Et.TYPE_UNDEFINED=0;Et.TYPE_WALL=1;Et.TYPE_FLOOR=2;Et.TYPE_LANDSCAPE=3;Et._uniqueIdCounter=1;class mL extends Ti{constructor(){super(),this._wallRasterizer=new u6,this._floorRasterizer=new c6,this._landscapeRasterizer=new gh,this._maskManager=new n6,this._initialized=!1}initialize(e){if(!e.roomVisualization)return!1;const t=e.roomVisualization.wallData;t&&this._wallRasterizer.initialize(t);const r=e.roomVisualization.floorData;r&&this._floorRasterizer.initialize(r);const i=e.roomVisualization.landscapeData;i&&this._landscapeRasterizer.initialize(i);const n=e.roomVisualization.maskData;return n&&this._maskManager.initialize(n),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(e){this._initialized||(this._wallRasterizer.initializeAssetCollection(e),this._floorRasterizer.initializeAssetCollection(e),this._landscapeRasterizer.initializeAssetCollection(e),this._maskManager.initializeAssetCollection(e),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}const _s=class extends $u{constructor(){super(),this._highlightAreaX=0,this._highlightAreaY=0,this._highlightAreaWidth=0,this._highlightAreaHeight=0,this._highlightFilter=null,this._highlightPlaneOffsets=[],this._data=null,this._roomPlaneParser=new Ps,this._roomPlaneBitmapMaskParser=new $P,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new dS,this._typeVisibility[Et.TYPE_UNDEFINED]=!1,this._typeVisibility[Et.TYPE_FLOOR]=!0,this._typeVisibility[Et.TYPE_WALL]=!0,this._typeVisibility[Et.TYPE_LANDSCAPE]=!0}initialize(s){return s instanceof mL?(this._data=s,super.initialize(s),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(s,e,t,r){if(!this.object||!s)return;const i=this.updateGeometry(s),n=this.object.model;let o=!1;if(this.updateThickness(n)&&(o=!0),this.updateHole(n)&&(o=!0),this.initializeRoomPlanes(),o=this.updateMasks(n),!(e<this._lastUpdateTime+this._updateIntervalTime&&!i&&!o)){if(this.updatePlaneTexturesAndVisibilities(n)&&(o=!0),this.updatePlanes(s,i,e)&&(o=!0),o){let l=0;for(;l<this._visiblePlanes.length;){const c=this._visiblePlaneSpriteNumbers[l],h=this.getSprite(c),u=this._visiblePlanes[l];if(h&&u&&u.type!==Et.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let g=u.color;const m=(g&255)*this._redColor/255,p=(g>>8&255)*this._greenColor/255,f=(g>>16&255)*this._blueColor/255;g=(g>>24<<24)+(f<<16)+(p<<8)+m,h.color=g}else h.color=u.color;l++}this.updateSpriteCounter++}this.updateModelCounter=n.updateCounter,this._lastUpdateTime=e}}updateGeometry(s){if(!s||this._geometryUpdateId===s.updateId)return!1;this._geometryUpdateId=s.updateId,this._boundingRectangle=null;const e=s.direction;return e&&(e.x!==this._directionX||e.y!==this._directionY||e.z!==this._directionZ||s.scale!==this._roomScale)?(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=s.scale,!0):!1}updateThickness(s){if(this.updateModelCounter===s.updateCounter)return!1;const e=s.getValue(b.ROOM_FLOOR_THICKNESS),t=s.getValue(b.ROOM_WALL_THICKNESS);return!isNaN(e)&&!isNaN(t)&&(e!==this._floorThickness||t!==this._wallThickness)?(this._floorThickness=e,this._wallThickness=t,this.clearPlanes(),!0):!1}updateHole(s){if(this.updateModelCounter===s.updateCounter)return!1;const e=s.getValue(b.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime?(this._holeUpdateTime=e,this.clearPlanes(),!0):!1}updateMasks(s){if(this.updateModelCounter===s.updateCounter)return!1;let e=!1;const t=s.getValue(b.ROOM_PLANE_MASK_XML);t!==this._maskData&&(this.updatePlaneMasks(t),this._maskData=t,e=!0);const r=s.getValue(b.ROOM_BACKGROUND_COLOR);r!==this._color&&(this._color=r,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const i=s.getValue(b.ROOM_COLORIZE_BG_ONLY)||!1;return i!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=i,e=!0),e}updatePlaneTexturesAndVisibilities(s){if(this.updateModelCounter===s.updateCounter)return!1;const e=s.getValue(b.ROOM_FLOOR_TYPE),t=s.getValue(b.ROOM_WALL_TYPE),r=s.getValue(b.ROOM_LANDSCAPE_TYPE),i=s.getValue(b.ROOM_FLOOR_VISIBILITY)===1,n=s.getValue(b.ROOM_WALL_VISIBILITY)===1,o=s.getValue(b.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(e,t,r)||this.updatePlaneVisibility(i,n,o)}clearPlanes(){if(this._planes){for(;this._planes.length;){const s=this._planes[0];s&&s.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const s=this.object.model.getValue(b.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(s))return;const e=this.getLandscapeWidth(),t=this.getLandscapeHeight();let r=0,i=this.object.model.getValue(b.ROOM_RANDOM_SEED),n=0;for(;n<this._roomPlaneParser.planeCount;){const o=this._roomPlaneParser.getPlaneLocation(n),l=this._roomPlaneParser.getPlaneLeftSide(n),c=this._roomPlaneParser.getPlaneRightSide(n),h=this._roomPlaneParser.getPlaneSecondaryNormals(n),u=this._roomPlaneParser.getPlaneType(n);let g=null;if(o&&l&&c){const m=G.crossProduct(l,c);if(i=Hf(Math.trunc(i*7613+517)>>>0),g=null,u===ns.PLANE_FLOOR){const p=o.x+l.x+.5,f=o.y+c.y+.5,T=Math.trunc(p)-p,I=Math.trunc(f)-f;g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_FLOOR,!0,h,i,-T,-I),m.z!==0?g.color=_s.FLOOR_COLOR:g.color=m.x!==0?_s.FLOOR_COLOR_RIGHT:_s.FLOOR_COLOR_LEFT,this._data&&(g.rasterizer=this._data.floorRasterizer)}else u===ns.PLANE_WALL?(g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_WALL,!0,h,i),(l.length<1||c.length<1)&&(g.hasTexture=!1),m.x===0&&m.y===0?g.color=_s.WALL_COLOR_BORDER:m.y>0?g.color=_s.WALL_COLOR_TOP:m.y===0?g.color=_s.WALL_COLOR_SIDE:g.color=_s.WALL_COLOR_BOTTOM,this._data&&(g.rasterizer=this._data.wallRasterizer)):u===ns.PLANE_LANDSCAPE?(g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_LANDSCAPE,!0,h,i,r,0,e,t),m.y>0?g.color=_s.LANDSCAPE_COLOR_TOP:m.y==0?g.color=_s.LANDSCAPE_COLOR_SIDE:g.color=_s.LANDSCAPE_COLOR_BOTTOM,this._data&&(g.rasterizer=this._data.landscapeRasterizer),r=r+l.length):u==ns.PLANE_BILLBOARD&&(g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_WALL,!0,h,i),(l.length<1||c.length<1)&&(g.hasTexture=!1),m.x==0&&m.y==0?g.color=_s.WALL_COLOR_BORDER:m.y>0?g.color=_s.WALL_COLOR_TOP:m.y==0?g.color=_s.WALL_COLOR_SIDE:g.color=_s.WALL_COLOR_BOTTOM);if(g){g.maskManager=this._data.maskManager;let p=0;for(;p<this._roomPlaneParser.getPlaneMaskCount(n);){const f=this._roomPlaneParser.getPlaneMaskLeftSideLoc(n,p),T=this._roomPlaneParser.getPlaneMaskRightSideLoc(n,p),I=this._roomPlaneParser.getPlaneMaskLeftSideLength(n,p),O=this._roomPlaneParser.getPlaneMaskRightSideLength(n,p);g.addRectangleMask(f,T,I,O),p++}this._planes.push(g)}}else return;n++}this._isPlaneSet=!0,this.defineSprites()}initializeHighlightArea(s,e,t,r,i){this.clearHighlightArea(),this._highlightAreaX=s,this._highlightAreaY=e,this._highlightAreaWidth=t,this._highlightAreaHeight=r,this._highlightFilter=i,this._roomPlaneParser.initializeHighlightArea(s,e,t,r),this.createPlanesAndSprites(this._planes.length),this.reset()}createPlanesAndSprites(s=0){const e=this.getLandscapeWidth(),t=this.getLandscapeHeight();let r=0,i=this.object.model.getValue(b.ROOM_RANDOM_SEED),n=s;for(;n<this._roomPlaneParser.planeCount;){this._highlightPlaneOffsets[n]=-1;const o=this._roomPlaneParser.getPlaneLocation(n),l=this._roomPlaneParser.getPlaneLeftSide(n),c=this._roomPlaneParser.getPlaneRightSide(n),h=this._roomPlaneParser.getPlaneSecondaryNormals(n),u=this._roomPlaneParser.getPlaneType(n);let g=null;if(o&&l&&c){const m=G.crossProduct(l,c);if(i=Hf(Math.trunc(i*7613+517)>>>0),g=null,u===ns.PLANE_FLOOR){const p=o.x+l.x+.5,f=o.y+c.y+.5,T=Math.trunc(p)-p,I=Math.trunc(f)-f;g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_FLOOR,!0,h,i,-T,-I),this._data&&(g.rasterizer=this._data.floorRasterizer),g.color=m.z!==0?_s.FLOOR_COLOR:m.x!==0?_s.FLOOR_COLOR_RIGHT:_s.FLOOR_COLOR_LEFT}else u===ns.PLANE_WALL?(g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_WALL,!0,h,i),this._data&&(g.rasterizer=this._data.wallRasterizer),(l.length<1||c.length<1)&&(g.hasTexture=!1),g.color=m.x===0&&m.y===0?_s.WALL_COLOR_BORDER:m.y>0?_s.WALL_COLOR_TOP:m.y===0?_s.WALL_COLOR_SIDE:_s.WALL_COLOR_BOTTOM):u===ns.PLANE_LANDSCAPE&&(g=new Et(this._textureCache,this.object.getLocation(),o,l,c,Et.TYPE_LANDSCAPE,!0,h,i,r,0,e,t),this._data&&(g.rasterizer=this._data.landscapeRasterizer),(l.length<1||c.length<1)&&(g.hasTexture=!1),g.color=m.y>0?_s.LANDSCAPE_COLOR_TOP:m.y===0?_s.LANDSCAPE_COLOR_SIDE:_s.LANDSCAPE_COLOR_BOTTOM,r=r+l.length);if(g){g.maskManager=this._data.maskManager;let p=0;for(;p<this._roomPlaneParser.getPlaneMaskCount(n);){const f=this._roomPlaneParser.getPlaneMaskLeftSideLoc(n,p),T=this._roomPlaneParser.getPlaneMaskRightSideLoc(n,p),I=this._roomPlaneParser.getPlaneMaskLeftSideLength(n,p),O=this._roomPlaneParser.getPlaneMaskRightSideLength(n,p);g.addRectangleMask(f,T,I,O),p++}this._highlightPlaneOffsets[n]=this._planes.length,this._planes.push(g)}}else return;n++}this._isPlaneSet=!0,this.defineSprites()}clearHighlightArea(){this._highlightAreaX=0,this._highlightAreaY=0,this._highlightAreaWidth=0,this._highlightAreaHeight=0;const s=this._roomPlaneParser.clearHighlightArea();let e=0,t=this._roomPlaneParser.planeCount;for(;t<this._roomPlaneParser.planeCount+s;)this._highlightPlaneOffsets[t]!==-1&&(e=e+1,this._highlightPlaneOffsets[t]=-1),t=t+1;this._planes=this._planes.slice(0,this._planes.length-e),this.createSprites(this._planes.length),this.reset()}defineSprites(){this.createSprites(this._planes.length);let s=0;for(;s<this._planes.length;){const e=this._planes[s],t=this.getSprite(s);e&&t&&e.leftSide&&e.rightSide&&(e.type===Et.TYPE_WALL&&(e.leftSide.length<1||e.rightSide.length<1)?t.alphaTolerance=vi.MATCH_NOTHING:t.alphaTolerance=vi.MATCH_OPAQUE_PIXELS,e.type===Et.TYPE_WALL?t.tag="plane.wall@"+(s+1):e.type===Et.TYPE_FLOOR?t.tag="plane.floor@"+(s+1):t.tag="plane@"+(s+1),t.spriteType=$r.ROOM_PLANE,this._roomPlaneParser.isPlaneTemporaryHighlighter(s)?(this._highlightFilter&&(t.filters=[this._highlightFilter]),t.skipMouseHandling=!1,e.extraDepth=100,e.isHighlighter=!0,t.alphaTolerance=vi.MATCH_NOTHING):(t.filters=[],t.skipMouseHandling=!1,e.extraDepth=0,e.isHighlighter=!1)),s++}}getLandscapeWidth(){let s=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===ns.PLANE_LANDSCAPE){const r=this._roomPlaneParser.getPlaneLeftSide(e);s+=r.length}e++}return s}getLandscapeHeight(){let s=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===ns.PLANE_LANDSCAPE){const r=this._roomPlaneParser.getPlaneRightSide(e);r.length>s&&(s=r.length)}e++}return s>5&&(s=5),s}updatePlaneTypes(s,e,t){if(s!==this._floorType?this._floorType=s:s=null,e!==this._wallType?this._wallType=e:e=null,t!==this._landscapeType?this._landscapeType=t:t=null,!s&&!e&&!t)return!1;let r=0;for(;r<this._planes.length;){const i=this._planes[r];i&&(i.type===Et.TYPE_FLOOR&&s?i.id=s:i.type===Et.TYPE_WALL&&e?i.id=e:i.type===Et.TYPE_LANDSCAPE&&t&&(i.id=t)),r++}return!0}updatePlaneVisibility(s,e,t){return s===this._typeVisibility[Et.TYPE_FLOOR]&&e===this._typeVisibility[Et.TYPE_WALL]&&t===this._typeVisibility[Et.TYPE_LANDSCAPE]?!1:(this._typeVisibility[Et.TYPE_FLOOR]=s,this._typeVisibility[Et.TYPE_WALL]=e,this._typeVisibility[Et.TYPE_LANDSCAPE]=t,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(s,e,t){if(!s||!this.object)return!1;this._assetUpdateCounter++,e&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const r=this._visiblePlanes.length>0;let i=this._visiblePlanes;this._visiblePlanes.length||(i=this._planes);let n=0,o=!1,l=0;for(;l<i.length;){let c=l;r&&(c=this._visiblePlaneSpriteNumbers[l]);const h=this.getSprite(c);if(h){const u=i[l];u?(h.id=u.uniqueId,u.update(s,t)&&(u.visible&&(n=u.relativeDepth+this.floorRelativeDepth+c/1e3,u.type!==Et.TYPE_FLOOR&&(n=u.relativeDepth+this.wallRelativeDepth+c/1e3,(u.leftSide.length<1||u.rightSide.length<1)&&(n=n+_s.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(h,s,u,`plane ${c} ${s.scale}`,n)),o=!0),h.visible!=(u.visible&&this._typeVisibility[u.type])&&(h.visible=!h.visible,o=!0),h.visible&&(r||(this._visiblePlanes.push(u),this._visiblePlaneSpriteNumbers.push(l)))):(h.id=0,h.visible&&(h.visible=!1,o=!0))}l++}return o}updatePlaneMasks(s){if(!s)return;this._roomPlaneBitmapMaskParser.initialize(s);const e=[],t=[];let r=!1,i=0;for(;i<this._planes.length;){const n=this._planes[i];n&&(n.resetBitmapMasks(),n.type===Et.TYPE_LANDSCAPE&&e.push(i)),i++}for(const n of this._roomPlaneBitmapMaskParser.masks.values()){const o=this._roomPlaneBitmapMaskParser.getMaskType(n),l=this._roomPlaneBitmapMaskParser.getMaskLocation(n),c=this._roomPlaneBitmapMaskParser.getMaskCategory(n);if(l){let h=0;for(;h<this._planes.length;){const u=this._planes[h];if((u.type===Et.TYPE_WALL||u.type===Et.TYPE_LANDSCAPE)&&u&&u.location&&u.normal){const g=G.dif(l,u.location);if(Math.abs(G.scalarProjection(g,u.normal))<.01&&u.leftSide&&u.rightSide){const p=G.scalarProjection(g,u.leftSide),f=G.scalarProjection(g,u.rightSide);u.type===Et.TYPE_WALL||u.type===Et.TYPE_LANDSCAPE&&c===ml.HOLE?u.addBitmapMask(o,p,f):u.type===Et.TYPE_LANDSCAPE&&(u.canBeVisible||(r=!0),u.canBeVisible=!0,t.push(h))}}h++}}}for(i=0;i<e.length;){const n=e[i];if(t.indexOf(n)<0){const o=this._planes[n];o.canBeVisible=!1,r=!0}i++}r&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(s,e,t,r,i){const n=t.offset;s.offsetX=-n.x,s.offsetY=-n.y,s.relativeDepth=i,s.color=t.color,s.texture=t.bitmapData,s.name=r+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new fi(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const s=[];for(const e of this._visiblePlanes)s.push(e);return s}get floorRelativeDepth(){return _s.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return _s.ROOM_DEPTH_OFFSET+.5}};let cn=_s;cn.FLOOR_COLOR=16777215;cn.FLOOR_COLOR_LEFT=14540253;cn.FLOOR_COLOR_RIGHT=12303291;cn.WALL_COLOR_TOP=16777215;cn.WALL_COLOR_SIDE=13421772;cn.WALL_COLOR_BOTTOM=10066329;cn.WALL_COLOR_BORDER=10066329;cn.LANDSCAPE_COLOR_TOP=16777215;cn.LANDSCAPE_COLOR_SIDE=13421772;cn.LANDSCAPE_COLOR_BOTTOM=10066329;cn.ROOM_DEPTH_OFFSET=1e3;class h6 extends Vs{constructor(){super(),this._tileHeight=0}getLayerYOffset(e,t,r){return r===1?(this._tileHeight=this.object.model.getValue(b.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(e,t,r)}}const fL=class{constructor(){this._visualizationDatas=new Map}getVisualization(s){const e=this.getVisualizationType(s);return e?new e:null}getVisualizationType(s){if(!s)return null;let e=null;switch(s){case pe.ROOM:e=cn;break;case pe.TILE_CURSOR:e=h6;break;case pe.USER:case pe.BOT:case pe.RENTABLE_BOT:e=Us;break;case pe.PET_ANIMATED:e=Un;break;case pe.FURNITURE_STATIC:e=la;break;case pe.FURNITURE_ANIMATED:e=Vs;break;case pe.FURNITURE_RESETTING_ANIMATED:e=JK;break;case pe.FURNITURE_BADGE_DISPLAY:e=iL;break;case pe.FURNITURE_BG:e=ZK;break;case pe.FURNITURE_BB:e=nL;break;case pe.FURNITURE_ISOMETRIC_BB:e=XK;break;case pe.FURNITURE_BOTTLE:e=ng;break;case pe.FURNITURE_BUILDER_PLACEHOLDER:e=jK;break;case pe.FURNITURE_COUNTER_CLOCK:e=lh;break;case pe.FURNITURE_CUBOID:e=YK;break;case pe.FURNITURE_EXTERNAL_IMAGE:e=zK;break;case pe.FURNITURE_FIREWORKS:e=oL;break;case pe.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=og;break;case pe.FURNITURE_GIFT_WRAPPED:e=qK;break;case pe.FURNITURE_GUILD_CUSTOMIZED:e=Yc;break;case pe.FURNITURE_GUILD_ISOMETRIC_BADGE:e=ch;break;case pe.FURNITURE_HABBOWHEEL:e=uh;break;case pe.FURNITURE_MANNEQUIN:e=lL;break;case pe.FURNITURE_PARTY_BEAMER:e=zc;break;case pe.FURNITURE_PLANET_SYSTEM:e=QK;break;case pe.FURNITURE_POSTER:e=$K;break;case pe.FURNITURE_QUEUE_TILE:e=hh;break;case pe.FURNITURE_SCORE_BOARD:e=dh;break;case pe.FURNITURE_SOUNDBLOCK:e=e6;break;case pe.FURNITURE_STICKIE:e=t6;break;case pe.FURNITURE_VAL_RANDOMIZER:e=Kc;break;case pe.FURNITURE_VOTE_COUNTER:e=_h;break;case pe.FURNITURE_VOTE_MAJORITY:e=qc;break;case pe.FURNITURE_WATER_AREA:e=s6;break;case pe.FURNITURE_YOUTUBE:e=dL;break}return e||(xe.log("Unknown Visualization",s),null)}getVisualizationData(s,e,t){const r=this._visualizationDatas.get(s);if(r)return r;let i=null;switch(e){case pe.FURNITURE_STATIC:case pe.FURNITURE_GIFT_WRAPPED:case pe.FURNITURE_BB:case pe.FURNITURE_ISOMETRIC_BB:case pe.FURNITURE_BG:case pe.FURNITURE_STICKIE:case pe.FURNITURE_BUILDER_PLACEHOLDER:i=new Ua;break;case pe.FURNITURE_ANIMATED:case pe.FURNITURE_RESETTING_ANIMATED:case pe.FURNITURE_POSTER:case pe.FURNITURE_HABBOWHEEL:case pe.FURNITURE_VAL_RANDOMIZER:case pe.FURNITURE_BOTTLE:case pe.FURNITURE_PLANET_SYSTEM:case pe.FURNITURE_QUEUE_TILE:case pe.FURNITURE_PARTY_BEAMER:case pe.FURNITURE_COUNTER_CLOCK:case pe.FURNITURE_WATER_AREA:case pe.FURNITURE_SCORE_BOARD:case pe.FURNITURE_FIREWORKS:case pe.FURNITURE_GIFT_WRAPPED_FIREWORKS:case pe.FURNITURE_GUILD_CUSTOMIZED:case pe.FURNITURE_GUILD_ISOMETRIC_BADGE:case pe.FURNITURE_VOTE_COUNTER:case pe.FURNITURE_VOTE_MAJORITY:case pe.FURNITURE_SOUNDBLOCK:case pe.FURNITURE_BADGE_DISPLAY:case pe.FURNITURE_EXTERNAL_IMAGE:case pe.FURNITURE_YOUTUBE:case pe.TILE_CURSOR:i=new ZE;break;case pe.FURNITURE_MANNEQUIN:i=new Ff;break;case pe.ROOM:i=new mL;break;case pe.USER:case pe.BOT:case pe.RENTABLE_BOT:i=new a_;break;case pe.PET_ANIMATED:i=new _L;break}return i?i.initialize(t)?((i instanceof a_||i instanceof Ff)&&(i.avatarManager=ke.instance.avatar),fL.CACHING_ENABLED&&this._visualizationDatas.set(s,i),i):(i.dispose(),null):null}};let pL=fL;pL.CACHING_ENABLED=!0;class Ht{}Ht.ROOM_MIN_X="room_min_x";Ht.ROOM_MAX_X="room_max_x";Ht.ROOM_MIN_Y="room_min_y";Ht.ROOM_MAX_Y="room_max_y";Ht.ROOM_IS_PUBLIC="room_is_public";Ht.ROOM_Z_SCALE="room_z_scale";Ht.AD_DISPLAY_DELAY="ad_display_delay";Ht.IS_PLAYING_GAME="is_playing_game";Ht.RESTRICTS_DRAGGING="restricts_dragging";Ht.RESTRICTS_SCALING="restricts_scaling";Ht.RESTRICTED_SCALE="room_scale";class d6{constructor(e,t){this._width=e,this._height=t,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let r=e*t;for(;r>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),r--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(e,t){return e>=0&&e<this._width&&t>=0&&t<this._height}getTileHeight(e,t){return this.validPosition(e,t)?this._heights[t*this._width+e]:0}setTileHeight(e,t,r){this.validPosition(e,t)&&(this._heights[t*this._width+e]=r)}setStackingBlocked(e,t,r){this.validPosition(e,t)&&(this._isNotStackable[t*this._width+e]=r)}setIsRoomTile(e,t,r){this.validPosition(e,t)&&(this._isRoomTile[t*this._width+e]=r)}validateLocation(e,t,r,i,n,o,l,c,h,u=-1){let g=0,m=0;if(!this.validPosition(e,t)||!this.validPosition(e+r-1,t+i-1))return!1;(n<0||n>=this._width)&&(n=0),(o<0||o>=this._height)&&(o=0),l=Math.min(l,this._width-n),c=Math.min(c,this._height-o),u===-1&&(u=this.getTileHeight(e,t));let p=t;for(;p<t+i;){for(g=e;g<e+r;){if(g<n||g>=n+l||p<o||p>=o+c){if(m=p*this._width+g,h){if(!this._isRoomTile[m])return!1}else if(this._isNotStackable[m]||!this._isRoomTile[m]||Math.abs(this._heights[m]-u)>.01)return!1}g++}p++}return!0}get width(){return this._width}get height(){return this._height}}const Ea=class{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(s){this._scale=s}dispose(){this.reset(),this._isDisposed=!0}initialize(s,e,t){if(s<=this._width&&e<=this._height){this._width=s,this._height=e,this._floorHeight=t;return}this.reset();let r=0;for(;r<e;){const i=[];this._heightMap.push(i);let n=0;for(;n<s;)i.push(0),n++;r++}this._width=s,this._height=e,this._floorHeight=t}reset(){this._heightMap=[]}setHeight(s,e,t){if(s<0||s>=this._width||e<0||e>=this._height)return!1;const r=this._heightMap[e];return r?(r[s]=t,!0):!1}getHeight(s,e){if(s<0||s>=this._width||e<0||e>=this._height)return 0;const t=this._heightMap[e];return t?t[s]:0}getLocation(s,e,t,r,i){if(s==0&&e==0){s=this._width,e=this._height;const h=Math.round(this.scale/10);if(i==Ea.R){let u=this._width-1;for(;u>=0;){let g=1;for(;g<this._height;){if(this.getHeight(u,g)<=this._floorHeight){g-1<e&&(s=u,e=g-1);break}g++}u--}r=r+(this.scale/4-h/2),t=t+this.scale/2}else{let u=this._height-1;for(;u>=0;){let g=1;for(;g<this._width;){if(this.getHeight(g,u)<=this._floorHeight){g-1<s&&(s=g-1,e=u);break}g++}u--}r=r+(this.scale/4-h/2),t=t-h}}let n=s,o=e,l=this.getHeight(s,e);return i==Ea.R?(n=n+(t/(this._scale/2)-.5),o=o+.5,l=l-(r-t/2)/(this._scale/2)):(o=o+((this._scale/2-t)/(this._scale/2)-.5),n=n+.5,l=l-(r-(this._scale/2-t)/2)/(this._scale/2)),new G(n,o,l)}getLocationOldFormat(s,e,t){let r,i,n=0,o=0;i=Math.ceil(s),n=i-s;let l,c,h,u=0;for(r=0;r<this._width;){if(i>=0&&i<this._height){if(this.getHeight(r,i)<=this._floorHeight){l=r-1,c=i,o=r,t=Ea.L;break}if(this.getHeight(r,i+1)<=this._floorHeight){l=r,c=i,o=c-s,t=Ea.R;break}}i++,r++}const g=this.scale/2*n;let m=-o*this.scale/2;return m=m+-e*18/32*this.scale/2,u=this.getHeight(l,c),h=u*this.scale/2+m,t==Ea.R?h=h+n*this.scale/4:h=h+(1-n)*this.scale/4,this.getLocation(l,c,g,h,t)}getOldLocation(s,e){if(s==null)return null;let t=0,r=0,i=0,n=0,o="",l=0;if(e==90)t=Math.floor(s.x-.5),r=Math.floor(s.y+.5),l=this.getHeight(t,r),i=this._scale/2-(s.y-r+.5)*(this._scale/2),n=(l-s.z)*(this._scale/2)+(this._scale/2-i)/2,o=Ea.L;else if(e==180)t=Math.floor(s.x+.5),r=Math.floor(s.y-.5),l=this.getHeight(t,r),i=(s.x+.5-t)*(this._scale/2),n=(l-s.z)*(this._scale/2)+i/2,o=Ea.R;else return null;return[t,r,i,n,o]}getOldLocationString(s,e){const t=this.getOldLocation(s,e);if(t==null)return null;const r=Math.trunc(t[0]),i=Math.trunc(t[1]),n=Math.trunc(t[2]),o=Math.trunc(t[3]),l=t[4];return":w="+r+","+i+" l="+n+","+o+" "+l}getDirection(s){return s==Ea.R?180:90}getFloorAltitude(s,e){const t=this.getHeight(s,e),r=t+1;return t+(Math.trunc(this.getHeight(s-1,e-1))==r||Math.trunc(this.getHeight(s,e-1))==r||Math.trunc(this.getHeight(s+1,e-1))==r||Math.trunc(this.getHeight(s-1,e))==r||Math.trunc(this.getHeight(s+1,e))==r||Math.trunc(this.getHeight(s-1,e+1))==r||Math.trunc(this.getHeight(s,e+1))==r||Math.trunc(this.getHeight(s+1,e+1))==r?.5:0)}isRoomTile(s,e){return s>=0&&s<this._width&&e>=0&&e<this._height&&this._heightMap[e][s]>=0}};let Xc=Ea;Xc.DEFAULT_SCALE=32;Xc.L="l";Xc.R="r";const Rs=class{constructor(s){this._state=Rs.NOT_ACTIVE,this._tileXInit=0,this._tileYInit=0,this._tileXEnd=0,this._tileYEnd=0,this._highlightRootX=0,this._highlightRootY=0,this._highlightWidth=0,this._highlightHeight=0,this._highlightType=Rs.HIGHLIGHT_BRIGHTEN,this._roomEngine=s,this._roomEngine&&this._roomEngine.events?this._roomEngine.events.addEventListener(ye.ADDED,i=>{if(this._state===Rs.NOT_ACTIVE||i.roomId!==this._roomEngine.activeRoomId||i.category!==10&&i.category!==20)return;const n=this._roomEngine.getRoomObject(i.roomId,i.objectId,i.category);n&&n.visualization instanceof la&&(n.visualization.lookThrough=!0)}):console.warn("Room engine o su propiedad events no estn disponibles.");const e=new Ru;e.matrix=[1.5,0,0,0,0,1.5,0,0,0,0,1.5,0,0,0,0,1,0,.0784,.0784,0];const t=new Ru;t.matrix=[1.05,0,0,0,0,1.3,0,0,0,0,1.8,0,0,0,0,1,0,.0314,.0784,0];const r=new Ru;r.matrix=[.55,0,0,0,0,.55,0,0,0,0,.55,0,0,0,0,1,-.0392,-.0392,-.0392,0],Rs.HIGHLIGHT_FILTERS[Rs.HIGHLIGHT_DARKEN]=r,Rs.HIGHLIGHT_FILTERS[Rs.HIGHLIGHT_BRIGHTEN]=e,Rs.HIGHLIGHT_FILTERS[Rs.HIGHLIGHT_BLUE]=t}getAllFurniture(){return this._roomEngine.getRoomObjects(this._roomEngine.activeRoomId,20).concat(this._roomEngine.getRoomObjects(this._roomEngine.activeRoomId,10))}startSelecting(){this._state===Rs.NOT_SELECTING_AREA&&(this.clearHighlightSilent(),this._state=Rs.AWAITING_MOUSE_DOWN,this._roomEngine.moveBlocked=!0)}handleTileMouseEvent(s){let e=this._state===Rs.AWAITING_MOUSE_DOWN&&s.type==$e.MOUSE_DOWN;if(s.shiftKey&&this._state===Rs.NOT_SELECTING_AREA&&s.type==$e.MOUSE_DOWN&&(this.startSelecting(),e=!0),e){this._state=Rs.SELECTING,this._tileXInit=s.tileXAsInt,this._tileYInit=s.tileYAsInt,this._tileXEnd=s.tileXAsInt,this._tileYEnd=s.tileYAsInt,this.setHighlight(this._tileXInit,this._tileYInit,1,1);return}if(this._state===Rs.SELECTING&&s.type===$e.MOUSE_MOVE&&(s.tileXAsInt!==this._tileXEnd||s.tileYAsInt!==this._tileYEnd)){this._tileXEnd=s.tileXAsInt,this._tileYEnd=s.tileYAsInt;let t=this._tileXInit<this._tileXEnd?this._tileXInit:this._tileXEnd,r=Math.abs(this._tileXEnd-this._tileXInit)+1,i=this._tileYInit<this._tileYEnd?this._tileYInit:this._tileYEnd,n=Math.abs(this._tileYEnd-this._tileYInit)+1;this.setHighlight(t,i,r,n)}}finishSelecting(){return this._state!==Rs.SELECTING?!1:(this._state=Rs.NOT_SELECTING_AREA,this._roomEngine.moveBlocked=!1,this._callback&&this._callback(this._highlightRootX,this._highlightRootY,this._highlightWidth,this._highlightHeight),!0)}clearHighlightSilent(){var e;const s=this._roomEngine.getRoomObject(this._roomEngine.activeRoomId,-1,0);s&&((e=s.visualization)==null||e.clearHighlightArea())}clearHighlight(){this._state!==Rs.NOT_ACTIVE&&(this.clearHighlightSilent(),this._state=Rs.NOT_SELECTING_AREA,this._roomEngine.moveBlocked=!1,this._callback&&this._callback(0,0,0,0))}setHighlight(s,e,t,r){var n;if(this._state===Rs.NOT_ACTIVE)return;this._highlightRootX=s,this._highlightRootY=e,this._highlightWidth=t,this._highlightHeight=r;const i=this._roomEngine.getRoomObject(this._roomEngine.activeRoomId,-1,0);i&&((n=i.visualization)==null||n.initializeHighlightArea(s,e,t,r,Rs.HIGHLIGHT_FILTERS[this._highlightType]))}activate(s,e){if(this._state!==Rs.NOT_ACTIVE)return!1;this._callback=s,this._highlightType=e;for(const t of this.getAllFurniture()){const r=t.visualization;r&&(r.lookThrough=!0)}return this._state=Rs.NOT_SELECTING_AREA,!0}deactivate(){if(this._state!==Rs.NOT_ACTIVE){this._callback=null;for(const s of this.getAllFurniture()){const e=s.visualization;e&&(e.lookThrough=!1)}this.clearHighlight(),this._state=Rs.NOT_ACTIVE}}get areaSelectionState(){return this._state}};let Di=Rs;Di.NOT_ACTIVE=0;Di.NOT_SELECTING_AREA=1;Di.AWAITING_MOUSE_DOWN=2;Di.SELECTING=3;Di.HIGHLIGHT_DARKEN="highlight_darken";Di.HIGHLIGHT_BRIGHTEN="highlight_brighten";Di.HIGHLIGHT_BLUE="highlight_blue";Di.HIGHLIGHT_FILTERS={};const EL=class{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new G}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(s){this._targetId=s}get targetCategory(){return this._targetCategory}set targetCategory(s){this._targetCategory=s}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(s){this._targetObjectLoc.assign(s)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(s){this._limitedLocX=s}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(s){this._limitedLocY=s}get centeredLocX(){return this._centeredLocX}set centeredLocX(s){this._centeredLocX=s}get centeredLocY(){return this._centeredLocY}set centeredLocY(s){this._centeredLocY=s}get screenWd(){return this._screenWd}set screenWd(s){this._screenWd=s}get screenHt(){return this._screenHt}set screenHt(s){this._screenHt=s}get scale(){return this._scale}set scale(s){this._scale!=s&&(this._scale=s,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(s){this._roomWd=s}get roomHt(){return this._roomHt}set roomHt(s){this._roomHt=s}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(s){this._geometryUpdateId=s}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(s){let e;this._targetLoc==null&&(this._targetLoc=new G),(this._targetLoc.x!=s.x||this._targetLoc.y!=s.y||this._targetLoc.z!=s.z)&&(this._targetLoc.assign(s),e=G.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(s){this._currentLoc==null&&(this._currentLoc=new G,this._currentLoc.assign(s))}resetLocation(s){this._currentLoc==null&&(this._currentLoc=new G),this._currentLoc.assign(s)}update(s,e){let t,r,i,n,o;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}t=G.dif(this._targetLoc,this._currentLoc),t.length>this._moveDistance&&(this._moveDistance=t.length),t.length<=e?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(r=Math.sin(Math.PI*t.length/this._moveDistance),i=e*.5,n=this._moveDistance/EL.MOVE_SPEED_DENOMINATOR,o=i+(n-i)*r,this._maintainPreviousMoveSpeed&&(o<this._previousMoveSpeed?(o=this._previousMoveSpeed,o>t.length&&(o=t.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=o,t.divide(t.length),t.multiply(o),this._currentLoc=G.sum(this._currentLoc,t))}}reset(){this._geometryUpdateId=-1}activateFollowing(s){this._followDuration=s}};let IL=EL;IL.MOVE_SPEED_DENOMINATOR=12;class aT{constructor(e,t){this._roomId=e,this._data=t,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(e){this._floorType=e}get wallType(){return this._wallType}set wallType(e){this._wallType=e}get landscapeType(){return this._landscapeType}set landscapeType(e){this._landscapeType=e}}class Ug{constructor(e,t,r,i,n,o,l,c=NaN,h=-1,u=0,g=0,m="",p=!0,f=!0,T=-1){this._id=e,this._typeId=t,this._type=r,this._state=o,this._data=l,this._extra=c,this._expiryTime=h,this._usagePolicy=u,this._ownerId=g,this._ownerName=m,this._synchronized=p,this._realRoomObject=f,this._sizeZ=T,this._location=new G,this._direction=new G,this._location.assign(i),this._direction.assign(n)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class _6{constructor(e,t){this._tileObjectMap=new Map;let r=0;for(;r<t;)this._tileObjectMap.set(r,new Map),r++;this._width=e,this._height=t}clear(){for(const e of this._tileObjectMap.values())e&&e.clear();this._tileObjectMap.clear()}populate(e){this.clear();for(const t of e)this.addRoomObject(t)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(e,t){if(e>=0&&e<this._width&&t>=0&&t<this._height){const r=this._tileObjectMap.get(t);if(r)return r.get(e)}return null}setObjectInTile(e,t,r){if(!r.isReady){xe.log("Assigning non initialized object to tile object map!");return}if(e>=0&&e<this._width&&t>=0&&t<this._height){const i=this._tileObjectMap.get(t);i&&i.set(e,r)}}addRoomObject(e){if(!e||!e.model||!e.isReady)return;const t=e.getLocation(),r=e.getDirection();if(!t||!r)return;let i=e.model.getValue(b.FURNITURE_SIZE_X),n=e.model.getValue(b.FURNITURE_SIZE_Y);i<1&&(i=1),n<1&&(n=1);const o=Math.trunc(r.x+45)%360/90;(o===1||o===3)&&([i,n]=[n,i]);let l=t.y;for(;l<t.y+n;){let c=t.x;for(;c<t.x+i;){const h=this.getObjectIntTile(c,l);(!h||h!==e&&h.getLocation().z<=t.z)&&this.setObjectInTile(c,l,e),c++}l++}}}class g6{constructor(e){this._roomId=e,this._modelName=null,this._legacyGeometry=new Xc,this._tileObjectMap=null,this._roomCamera=new IL,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[],this._userFocusAlpha=new Map}dispose(){}setModelName(e){this._modelName=e}setSelectedObject(e){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=e}setPlacedObject(e){this._placedObject&&this._placedObject.dispose(),this._placedObject=e}setFurnitureStackingHeightMap(e){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=e,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new _6(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(e){e&&(this._floorStack.delete(e.id),this._floorStack.set(e.id,e))}removePendingFunitureFloor(e){const t=this._floorStack.get(e);return t?(this._floorStack.delete(e),t):null}getPendingFurnitureFloor(e){const t=this._floorStack.get(e);return t?(this._floorStack.delete(e),t):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const e=this._floorStack.keys();return this.getPendingFurnitureFloor(e.next().value)}addPendingFurnitureWall(e){e&&(this._wallStack.delete(e.id),this._wallStack.set(e.id,e))}removePendingFurnitureWall(e){const t=this._wallStack.get(e);return t?(this._wallStack.delete(e),t):null}getPendingFurnitureWall(e){const t=this._wallStack.get(e);return t?(this._wallStack.delete(e),t):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const e=this._wallStack.keys();return this.getPendingFurnitureWall(e.next().value)}setUserFocusAlpha(e,t){this._userFocusAlpha.set(e,t)}getUserFocusAlpha(e){const t=this._userFocusAlpha.get(e);return t===void 0?null:t}clearUserFocusAlpha(e){this._userFocusAlpha.delete(e)}clearAllUserFocusAlpha(){this._userFocusAlpha.clear()}addButtonMouseCursorOwner(e){return this._mouseButtonCursorOwners.indexOf(e)===-1?(this._mouseButtonCursorOwners.push(e),!0):!1}removeButtonMouseCursorOwner(e){const t=this._mouseButtonCursorOwners.indexOf(e);return t>-1?(this._mouseButtonCursorOwners.splice(t,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class m6{constructor(e,t){this._object=e,this._groupBadge=t}get object(){return this._object}get groupBadge(){return this._groupBadge}}class xg{constructor(e,t,r,i,n,o=0,l=null,c=null,h=-1,u=-1,g=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=e,this._category=t,this._operation=r,this._loc=new G,this._loc.assign(i),this._dir=new G,this._dir.assign(n),this._typeId=o,this._instanceData=l,this._stuffData=c,this._state=h,this._animFrame=u,this._posture=g}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}const Vn=class{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(s,e){const t=[];for(const r of s)if(r)if(r.type==="boutique_mannequin1"&&r.name.indexOf("mannequin_")===0){const i=e.getRoomObject(e.activeRoomId,r.objectId,z.FLOOR);if(i){const n=i.visualization.getSpriteList();if(n)for(const o of n)o.x=o.x+(r.x+r.width/2+Vn.MANNEQUIN_MAGIC_X_OFFSET),o.y=o.y+(r.y+r.height+Vn.MANNEQUIN_MAGIC_Y_OFFSET),o.z=o.z+r.z,t.push(o)}}else t.push(r);return t}static sortSpriteDataObjects(s,e){return s.z<e.z?1:(s.z>e.z,-1)}static isSpriteInViewPort(s,e,t){return!0}static sortQuadPoints(s,e,t,r){const i=[];if(s.x==e.x?i.push(s,t,e,r):s.x==t.x?i.push(s,e,t,r):e.x<s.x&&e.y>s.y||e.x>s.x&&e.y<s.y?i.push(s,t,e,r):i.push(s,e,t,r),i[0].x<i[1].x){let n=i[0];i[0]=i[1],i[1]=n,n=i[2],i[2]=i[3],i[3]=n}if(i[0].y<i[2].y){let n=i[0];i[0]=i[2],i[2]=n,n=i[1],i[1]=i[3],i[3]=n}return i}getFurniData(s,e,t,r){const i=[];let n=e.getSortableSpriteList();const o=t.getRoomObjects(t.activeRoomId,z.UNIT);for(const l of o)if(l.id!==r){const c=l.visualization.getSpriteList();if(c){let h=0,u=0;for(const m of n)if(m.name==="avatar_"+l.id){h=m.z,u=m.y+m.height-e.geometry.scale/4;break}const g=t.getRoomObjectScreenLocation(t.activeRoomId,l.id,z.UNIT,e.id);if(g){u===0&&(u=g.y);for(const m of c)m.x=m.x+(g.x-e.screenOffsetX),m.y=m.y+u,m.z=m.z+h,(m.name.indexOf("h_std_fx29_")===0||m.name.indexOf("h_std_fx185_")===0)&&(m.y=m.y+Vn.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),n.push(m)}}}n=Vn.addMannequinSprites(n,t),n.sort(Vn.sortSpriteDataObjects);for(const l of n)l.name!==null&&l.name.length>0&&l.name.indexOf("tile_cursor_")!==0&&Vn.isSpriteInViewPort(l,s,e)&&(r<0||l.objectId!=r)&&(i.push(this.getSpriteDataObject(l,s,e,t)),this.maxZ||(this.maxZ=l.z),this.spriteCount++);return JSON.stringify(i)}getRoomRenderingModifiers(s){return JSON.stringify(new Object)}getSpriteDataObject(s,e,t,r){let i=[];const n={};let o=s.name;return s.name.indexOf("@")!==-1&&(i=s.name.split("@"),o=i[0],i[1]),n.name=o,n.x=s.x-e.x,n.y=s.y-e.y,n.x=n.x+t.screenOffsetX,n.y=n.y+t.screenOffsetY,n.z=s.z,s.alpha&&s.alpha.toString()!=="255"&&(n.alpha=s.alpha),s.flipH&&(n.flipH=s.flipH),s.skew&&(n.skew=s.skew),s.frame&&(n.frame=s.frame),s.color&&s.color.length>0&&(n.color=parseInt(s.color)),s.blendMode&&s.blendMode!=="normal"&&(n.blendMode=s.blendMode),o.indexOf("http")===0&&(n.width=s.width,n.height=s.height,this.externalImageCount++,this.externalImageCount>Vn.MAX_EXTERNAL_IMAGE_COUNT&&(n.name="box")),s.posture&&(n.posture=s.posture),n}makeBackgroundPlane(s,e,t){const r=new it(0,0),i=new it(s.width,0),n=new it(0,s.height),o=new it(s.width,s.height),l=Vn.sortQuadPoints(r,i,n,o);let c=0;t.length>0?(c=t[0].z,this.maxZ&&(c=Math.max(this.maxZ,c))):c=this.maxZ?this.maxZ:0,c=c+(this.spriteCount*1.776104+t.length*2.31743);const h=new Eu(null,e);return h.cornerPoints=l,h.z=c,h}sortRoomPlanes(s,e,t){const r=new Map;let i=1;this.maxZ&&(i=i+this.maxZ);for(const l of s){const c={plane:l,z:i};r.set(l.uniqueId,c)}const n=e.getPlaneSortableSprites();n.sort((l,c)=>c.z-l.z),n.reverse();let o=[];for(const l of n){const c=l.sprite;if(c){const h=r.get(c.id);h&&(r.delete(c.id),h.z=l.z,o.push(h))}}return o=o.concat(Array.from(r.values())),o}getRoomPlanes(s,e,t,r){const i=[],o=t.getRoomObject(t.activeRoomId,wi.ROOM_OBJECT_ID,z.ROOM).visualization;if(o){const l=e.geometry,c=this.sortRoomPlanes(o.planes,e,t),h=sr.instance.stage;for(const u of c){const g=u.plane,m=[],p=G.sum(g.location,g.leftSide),f=l.getScreenPoint(g.location),T=l.getScreenPoint(p),I=l.getScreenPoint(G.sum(g.location,g.rightSide)),O=l.getScreenPoint(G.sum(p,g.rightSide));m.push(f,T,I,O);let A=0,N=0;for(const P of m)P.x+=h.width/2,P.y+=h.height/2,P.x+=e.screenOffsetX,P.y+=e.screenOffsetY,P.x+=-s.x,P.y+=-s.y,P.x<0?A--:P.x>=s.width&&A++,P.y<0?N--:P.y>=s.height&&N++;if(!(Math.abs(A)===4||Math.abs(N)===4)){const P=Vn.sortQuadPoints(f,T,I,O);for(const y of g.getDrawingDatas(l))y.cornerPoints=P,y.z=u.z,i.push(y)}}i.unshift(this.makeBackgroundPlane(s,r,i))}return i}};let mh=Vn;mh.MANNEQUIN_MAGIC_X_OFFSET=1;mh.MANNEQUIN_MAGIC_Y_OFFSET=-16;mh.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52;mh.MAX_EXTERNAL_IMAGE_COUNT=30;class f6 extends Ti{constructor(e){super(),this._connection=null,this._roomCreator=e,this._planeParser=new Ps,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(e){this._connection||!e||(this._connection=e,this._connection.addMessageEvent(new Tc(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new Ic(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new ef(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new jd(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new Jm(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new Zm(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new tf(this.onBulkHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new zd(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new Yd(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new Fm(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new wm(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new jm(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new Bm(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new Vm(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new Hm(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new Wm(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new Gm(this.onBulkUpdateFloorItemsEvent.bind(this))),this._connection.addMessageEvent(new Um(this.onBulkSlideItemsEvent.bind(this))),this._connection.addMessageEvent(new xm(this.onBulkSlideUsersAndItemsEvent.bind(this))),this._connection.addMessageEvent(new qm(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new Xm(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new Qm(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new $m(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new Ym(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new zm(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new Km(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new Qd(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new rf(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new $d(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new lf(this.onRoomUnitFocusEvent.bind(this))),this._connection.addMessageEvent(new nf(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new af(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new of(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new Jd(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new cf(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new Zd(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new uf(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new cE(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new qd(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Xd(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new sf(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new Kd(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new ZN(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new sb(this.onPlayerOnClickThroughEvent.bind(this))),this._connection.addMessageEvent(new ib(this.onPlayerWalkKeysEvent.bind(this))),this._connection.addMessageEvent(new rb(this.onPlayerVimKeysEvent.bind(this))),this._connection.addMessageEvent(new nb(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new km(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new mE(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new tE(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new Zp(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new eE(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(e){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=e,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(e){if(!(e instanceof Tc)||!e.connection)return;const t=e.getParser();t&&(this._ownUserId=t.userInfo.userId)}onRoomReadyMessageEvent(e){const t=e.getParser();if(this._currentRoomId!==t.roomId&&this.setRoomId(t.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(t.roomId,t.name),this._initialConnection){e.connection.send(new eD),this._initialConnection=!1;return}e.connection.send(new Af)}onRoomPaintEvent(e){if(!(e instanceof ef))return;const t=e.getParser();if(!t)return;const r=t.floorType,i=t.wallType,n=t.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,r,i,n)}onPlayerOnClickThroughEvent(e){if(!e)return;const t=e.getParser();t&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,t.isPlaying)}onPlayerWalkKeysEvent(e){if(!e)return;const t=e.getParser();t&&(window.walkKeysEnabled=t.isEnabled)}onPlayerVimKeysEvent(e){if(!e)return;const t=e.getParser();t&&(window.vimKeysEnabled=t.isEnabled)}onRoomModelEvent(e){if(!(e instanceof jd)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!r)return;this._planeParser.reset();const i=t.width,n=t.height;this._planeParser.initializeTileMap(i,n);let o=null;this._latestEntryTileEvent&&(o=this._latestEntryTileEvent.getParser());let l=-1,c=-1,h=0,u=0,g=0;for(;g<n;){let f=0;for(;f<i;){const T=t.getHeight(f,g);(g>0&&g<n-1||f>0&&f<i-1)&&T!=Ps.TILE_BLOCKED&&(o==null||f==o.x&&g==o.y)&&(t.getHeight(f,g-1)==Ps.TILE_BLOCKED&&t.getHeight(f-1,g)==Ps.TILE_BLOCKED&&t.getHeight(f,g+1)==Ps.TILE_BLOCKED&&(l=f+.5,c=g,h=T,u=90),t.getHeight(f,g-1)==Ps.TILE_BLOCKED&&t.getHeight(f-1,g)==Ps.TILE_BLOCKED&&t.getHeight(f+1,g)==Ps.TILE_BLOCKED&&(l=f,c=g+.5,h=T,u=180)),this._planeParser.setTileHeight(f,g,T),f++}g++}this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),h),this._planeParser.initializeFromTileData(t.wallHeight),this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),h+this._planeParser.wallHeight),t.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),r.scale=Xc.DEFAULT_SCALE,r.initialize(i,n,this._planeParser.floorHeight);let m=t.height-1;for(;m>=0;){let f=t.width-1;for(;f>=0;)r.setHeight(f,m,this._planeParser.getTileHeight(f,m)),f--;m--}const p=this._planeParser.getMapData();p.doors.push({x:l,y:c,z:h,dir:u}),this._roomCreator.createRoomInstance(this._currentRoomId,p)}onRoomHeightMapEvent(e){if(!(e instanceof Jm)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=t.width,i=t.height,n=new d6(r,i);let o=0;for(;o<i;){let l=0;for(;l<r;)n.setTileHeight(l,o,t.getTileHeight(l,o)),n.setStackingBlocked(l,o,t.getStackingBlocked(l,o)),n.setIsRoomTile(l,o,t.isRoomTile(l,o)),l++;o++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(e){if(!(e instanceof Zm)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(r){for(;t.next();)r.setTileHeight(t.x,t.y,t.tileHeight()),r.setStackingBlocked(t.x,t.y,t.isStackingBlocked()),r.setIsRoomTile(t.x,t.y,t.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onBulkHeightMapUpdateEvent(e){if(!(e instanceof tf)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(r){for(const i of t.items)i&&r.setTileHeight(i.x,i.y,i.height);this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onBulkHeightMapUpdateEvent()")}}onRoomThicknessEvent(e){if(!(e instanceof zd))return;const t=e.getParser();if(!t)return;const r=!t.hideWalls,i=!0,n=t.thicknessWall,o=t.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,r,i),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,n,o))}onRoomDoorEvent(e){e instanceof Yd&&(this._latestEntryTileEvent=e)}onRoomRollingEvent(e){if(!(e instanceof Fm)||!e.connection||!this._roomCreator)return;const t=e.getParser(),r=t.animationTime;this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.rollerId,null,null,2,null);const i=t.itemsRolling;if(i&&i.length)for(const o of i)o&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,o.id,o.location,o.targetLocation,r);const n=t.unitRolling;if(n){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,n.location,n.targetLocation,!1,0,null,NaN,r);const o=this._roomCreator.getRoomObjectUser(this._currentRoomId,n.id);if(o&&o.type!==gt.MONSTER_PLANT){let l="std";switch(n.movementType){case Oa.MOVE:l="mv";break;case Oa.SLIDE:l="std";break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,l)}}}onObjectsDataUpdateEvent(e){if(!(e instanceof wm)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(t)for(const r of t.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,r.id,null,null,r.state,r.data)}onFurnitureAliasesEvent(e){!(e instanceof jm)||!e.connection||!this._roomCreator||(e.getParser().aliases,this._connection.send(new Af))}onFurnitureFloorAddEvent(e){if(!(e instanceof Bm)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;t&&this.addRoomObjectFurnitureFloor(this._currentRoomId,t)}onFurnitureFloorEvent(e){if(!(e instanceof Vm)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=t.items.length;let i=0;for(;i<r;){const n=t.items[i];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),i++}}onFurnitureFloorRemoveEvent(e){if(!(e instanceof Hm)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&(t.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,t.itemId,t.isExpired?-1:t.userId,!0)},t.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,t.itemId,t.isExpired?-1:t.userId,!0))}onFurnitureFloorUpdateEvent(e){if(!(e instanceof Wm)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;if(!t)return;const r=new G(t.x,t.y,t.z),i=new G(t.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,r,i,t.data.state,t.data,t.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,t.itemId,t.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,t.itemId,t.expires)}onBulkUpdateFloorItemsEvent(e){if(!(e instanceof Gm)||!e.connection||!this._roomCreator)return;const t=e.getParser().items;if(!(!t||t.length===0))for(const r of t){if(!r)continue;const i=new G(r.x,r.y,r.z),n=new G(r.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,r.itemId,i,n,r.data.state,r.data,r.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,r.itemId,r.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,r.itemId,r.expires)}}onBulkSlideItemsEvent(e){if(!(e instanceof Um)||!e.connection||!this._roomCreator)return;const t=e.getParser(),r=t.itemSlides,i=t.animationTime;if(!(!r||r.length===0))for(const n of r){if(!n)continue;const o=new G(n.fromX,n.fromY,parseFloat(n.fromZ)),l=new G(n.toX,n.toY,parseFloat(n.toZ));if(this._roomCreator.rollRoomObjectFloor(this._currentRoomId,n.virtualId,o,l,i),n.fromRotation!==n.toRotation){const c=new G(n.toRotation);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,n.virtualId,null,c,null,null)}}}onBulkSlideUsersAndItemsEvent(e){if(!(e instanceof xm)||!e.connection||!this._roomCreator)return;const t=e.getParser(),r=t.itemSlides,i=t.userSlides,n=t.animationTime;if(r&&r.length>0)for(const o of r){if(!o)continue;const l=new G(o.fromX,o.fromY,parseFloat(o.fromZ)),c=new G(o.toX,o.toY,parseFloat(o.toZ));if(this._roomCreator.rollRoomObjectFloor(this._currentRoomId,o.virtualId,l,c,n),o.fromRotation!==o.toRotation){const h=new G(o.toRotation);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,o.virtualId,null,h,null,null)}}if(i&&i.length>0)for(const o of i){if(!o)continue;const l=new G(o.fromX,o.fromY,parseFloat(o.fromZ)),c=new G(o.toX,o.toY,parseFloat(o.toZ));this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,o.roomIndex,l,c,!0,0,null,NaN,n)}}onFurnitureWallAddEvent(e){if(!(e instanceof qm)||!e.connection||!this._roomCreator)return;const t=e.getParser().item;t&&this.addRoomObjectFurnitureWall(this._currentRoomId,t)}onFurnitureWallEvent(e){if(!(e instanceof Xm)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=t.items.length;let i=0;for(;i<r;){const n=t.items[i];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),i++}}onFurnitureWallRemoveEvent(e){if(!(e instanceof Qm)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,t.itemId,t.userId)}onFurnitureWallUpdateEvent(e){if(!(e instanceof $m)||!e.connection||!this._roomCreator)return;const t=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!t)return;const r=e.getParser().item;if(!r)return;const i=t.getLocation(r.width,r.height,r.localX,r.localY,r.direction),n=new G(t.getDirection(r.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,r.itemId,i,n,r.state,r.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,r.itemId,r.secondsToExpiration)}onFurnitureDataEvent(e){if(!(e instanceof Ym)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.furnitureId,null,null,t.objectData.state,t.objectData)}onItemDataUpdateMessageEvent(e){if(!(e instanceof zm)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,t.furnitureId,t.data)}onOneWayDoorStatusMessageEvent(e){if(!(e instanceof Km)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,null,null,t.state,new ei)}onDiceValueMessageEvent(e){if(!(e instanceof km)||!e.connection||!this._roomCreator)return;const t=e.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,t.itemId,null,null,t.value,new ei)}onRoomUnitDanceEvent(e){!(e instanceof Qd)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,b.FIGURE_DANCE,e.getParser().danceId)}onRoomUnitEffectEvent(e){!(e instanceof rf)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,e.getParser().unitId,e.getParser().effectId,e.getParser().delay)}onRoomUnitEvent(e){if(!(e instanceof $d)||!e.connection||!this._roomCreator)return;const t=e.getParser().users;if(!(!t||!t.length)){for(const r of t){if(!r)continue;const i=new G(r.x,r.y,r.z),n=new G(r.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,r.roomIndex,i,n,r.dir,r.userType,r.figure),r.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,r.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,r.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,r.roomIndex,r.figure,r.sex,r.subType,r.isRiding),gt.getTypeString(r.userType)===gt.PET&&this._roomCreator.getPetTypeId(r.figure)===ht.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.roomIndex,r.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.roomIndex,b.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(r.name)?1:0)}this.updateGuideMarker()}}onRoomUnitFocusEvent(e){if(!(e instanceof lf)||!e.connection||!this._roomCreator)return;const t=e.getParser();if(!t)return;const r=Math.max(0,Math.min(255,t.alpha));this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.unitId,b.FIGURE_FOCUS_ALPHA,r)}onRoomUnitExpressionEvent(e){!(e instanceof nf)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,b.FIGURE_EXPRESSION,e.getParser().expression)}onRoomUnitHandItemEvent(e){!(e instanceof af)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,b.FIGURE_CARRY_OBJECT,e.getParser().handId)}onRoomUnitIdleEvent(e){!(e instanceof of)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,b.FIGURE_SLEEP,e.getParser().isIdle?1:0)}onRoomUnitInfoEvent(e){!(e instanceof Jd)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.getParser().unitId,e.getParser().figure,e.getParser().gender)}onRoomUnitNumberEvent(e){if(!(e instanceof cf)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.unitId,b.FIGURE_NUMBER_VALUE,t.value)}onRoomUnitRemoveEvent(e){!(e instanceof Zd)||!e.connection||!this._roomCreator||(this._roomCreator.removeRoomObjectUser(this._currentRoomId,e.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(e){if(!(e instanceof uf)||!e.connection||!this._roomCreator)return;const t=e.getParser().statuses;if(!t||!t.length)return;const r=this._roomCreator.getRoomInstance(this._currentRoomId);if(!r)return;const i=r.model.getValue(Ht.ROOM_Z_SCALE)||1;for(const n of t){if(!n)continue;let o=n.height;o&&(o=o/i);const l=new G(n.x,n.y,n.z+o),c=new G(n.direction);let h=null;n.didMove&&(h=new G(n.targetX,n.targetY,n.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,l,h,n.canStandUp,o,c,n.headDirection,n.animationTime),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let u=!0,g=!1,m=b.STD,p="";if(n.actions&&n.actions.length){for(const f of n.actions)if(f)switch(f.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,f.value);break;case"sign":n.actions.length===1&&(u=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.id,b.FIGURE_SIGN,parseInt(f.value));break;case"gst":n.actions.length===1&&(u=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,f.value);break;case"wav":case"mv":g=!0,m=f.action,p=f.value;break;case"trd":break;default:g=!0,m=f.action,p=f.value;break}}g?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,m,p):u&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,b.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(e){if(!e.connection||!this._roomCreator)return;const t=e.getParser();t&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,t.roomIndex,t.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,b.FIGURE_TALK,t.message.length/10))}onRoomUnitTypingEvent(e){!(e instanceof sf)||!e.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.getParser().unitId,b.FIGURE_IS_TYPING,e.getParser().isTyping?1:0)}onPetFigureUpdateEvent(e){if(!(e instanceof Kd)||!e.connection||!this._roomCreator)return;const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.roomIndex,t.figureData.figuredata,"","",t.isRiding)}onPetExperienceEvent(e){const t=e.getParser();t&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.roomIndex,b.FIGURE_GAINED_EXPERIENCE,t.gainedExperience)}onYouArePlayingGameEvent(e){if(!e)return;const t=e.getParser();t&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,t.isPlaying)}addRoomObjectFurnitureFloor(e,t){if(!t||!this._roomCreator)return;const r=new G(t.x,t.y,t.z),i=new G(t.direction);t.spriteName?this._roomCreator.addFurnitureFloorByTypeName(e,t.itemId,t.spriteName,r,i,t.state,t.data,t.extra,t.expires,t.usagePolicy,t.userId,t.username,!0,!0,t.stackHeight):this._roomCreator.addFurnitureFloor(e,t.itemId,t.spriteId,r,i,t.state,t.data,t.extra,t.expires,t.usagePolicy,t.userId,t.username,!0,!0,t.stackHeight)}addRoomObjectFurnitureWall(e,t){if(!t||!this._roomCreator)return;const r=this._roomCreator.getLegacyWallGeometry(e);if(!r)return;let i=null;t.isOldFormat||(i=r.getLocation(t.width,t.height,t.localX,t.localY,t.direction));const n=new G(r.getDirection(t.direction));this._roomCreator.addFurnitureWall(e,t.itemId,t.spriteId,i,n,t.state,t.stuffData,t.secondsToExpiration,t.usagePolicy,t.userId,t.username)}onIgnoreResultEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const r=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!r)return;const i=r.userDataManager.getUserDataByName(t.name);if(i)switch(t.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,b.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,b.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(e){const t=e.getParser();this._guideId=t.guideUserId,this._requesterId=t.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(e){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(e){this.removeGuideMarker()}updateGuideMarker(){const e=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===e?Tn.GUIDE:Tn.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===e?Tn.REQUESTER:Tn.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,Tn.NONE),this.setUserGuideStatus(this._requesterId,Tn.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(e,t){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const r=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!r)return;const i=r.userDataManager.getDataByType(e,jt.USER);i&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,b.FIGURE_GUIDE_STATUS,t)}get currentRoomId(){return this._currentRoomId}}class p6 extends Ti{constructor(e){super(),this._roomEngine=e,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(ye.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(ye.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(e){let t=this.getSelectedRoomObjectData(e.roomId);if(t&&t.operation===Qe.OBJECT_PLACE&&t.id===e.objectId){const r=this._roomEngine.getRoomObject(e.roomId,t.id,t.category);if(r&&r.model&&t.category===z.FLOOR){const i=r.model.getValue(b.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const n=new G(i[0]);if(r.setDirection(n),this.updateSelectedObjectData(e.roomId,t.id,t.category,t.loc,n,t.operation,t.typeId,t.instanceData,t.stuffData,t.state,t.animFrame,t.posture),t=this.getSelectedRoomObjectData(e.roomId),!t)return}}this.setFurnitureAlphaMultiplier(r,.5)}}processRoomCanvasMouseEvent(e,t,r){if(!e||!t||tr.isRunning())return;const i=t.type;let n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==z.ROOM&&(!this._roomEngine.isPlayingGame()||n!==z.UNIT)&&(n=z.MINIMUM),this.getMouseEventId(n,e.type)===e.eventId){if(e.type===fe.MOUSE_CLICK||e.type===fe.DOUBLE_CLICK||e.type===fe.MOUSE_DOWN||e.type===fe.MOUSE_UP||e.type===fe.MOUSE_MOVE)return}else e.eventId&&this.setMouseEventId(n,e.type,e.eventId);t.mouseHandler&&t.mouseHandler.mouseEvent(e,r)}processRoomObjectPlacement(e,t,r,i,n,o=null,l=null,c=-1,h=-1,u=null){this._objectPlacementSource=e;const g=new G(-100,-100),m=new G(0);return this.setSelectedRoomObjectData(t,r,i,g,m,Qe.OBJECT_PLACE,n,o,l,c,h,u),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,i,!1,o,l,c,h,u),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(e){return this.resetSelectedObjectData(e),!0}getMouseEventId(e,t){const r=this._eventIds.get(e);return r&&r.get(t)||null}setMouseEventId(e,t,r){let i=this._eventIds.get(e);i||(i=new Map,this._eventIds.set(e,i)),i.delete(t),i.set(t,r)}handleRoomObjectEvent(e,t){if(e){if(e instanceof Gn&&this._roomEngine.areaSelectionManager.handleTileMouseEvent(e),e instanceof $e){this.handleRoomObjectMouseEvent(e,t);return}switch(e.type){case vt.STATE_CHANGE:case vt.STATE_RANDOM:this.onRoomObjectStateChangedEvent(e,t);return;case _c.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(e,t);return;case Vr.POSITION_CHANGED:case Vr.OBJECT_REMOVED:this.handleSelectedObjectRemove(e,t);return;case Q.OPEN_WIDGET:case Q.CLOSE_WIDGET:case Q.OPEN_FURNI_CONTEXT_MENU:case Q.CLOSE_FURNI_CONTEXT_MENU:case Q.PLACEHOLDER:case Q.CREDITFURNI:case Q.STACK_HEIGHT:case Q.EXTERNAL_IMAGE:case Q.STICKIE:case Q.PRESENT:case Q.TROPHY:case Q.TEASER:case Q.ECOTRONBOX:case Q.DIMMER:case Q.WIDGET_REMOVE_DIMMER:case Q.CLOTHING_CHANGE:case Q.JUKEBOX_PLAYLIST_EDITOR:case Q.MANNEQUIN:case Q.PET_PRODUCT_MENU:case Q.GUILD_FURNI_CONTEXT_MENU:case Q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case Q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case Q.BACKGROUND_COLOR:case Q.MYSTERYBOX_OPEN_DIALOG:case Q.EFFECTBOX_OPEN_DIALOG:case Q.MYSTERYTROPHY_OPEN_DIALOG:case Q.ACHIEVEMENT_RESOLUTION_OPEN:case Q.ACHIEVEMENT_RESOLUTION_ENGRAVING:case Q.ACHIEVEMENT_RESOLUTION_FAILED:case Q.FRIEND_FURNITURE_CONFIRM:case Q.FRIEND_FURNITURE_ENGRAVING:case Q.BADGE_DISPLAY_ENGRAVING:case Q.HIGH_SCORE_DISPLAY:case Q.HIDE_HIGH_SCORE_DISPLAY:case Q.INERNAL_LINK:case Q.ROOM_LINK:case Q.YOUTUBE:this.onRoomObjectWidgetRequestEvent(e,t);return;case Re.DICE_ACTIVATE:case Re.DICE_OFF:case Re.USE_HABBOWHEEL:case Re.STICKIE:case Re.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(e,t);return;case Re.SOUND_MACHINE_INIT:case Re.SOUND_MACHINE_START:case Re.SOUND_MACHINE_STOP:case Re.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(e,t);return;case Re.JUKEBOX_INIT:case Re.JUKEBOX_START:case Re.JUKEBOX_MACHINE_STOP:case Re.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(e,t);return;case wr.ADD_HOLE:case wr.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(e,t);return;case is.ROOM_AD_FURNI_CLICK:case is.ROOM_AD_FURNI_DOUBLE_CLICK:case is.ROOM_AD_TOOLTIP_SHOW:case is.ROOM_AD_TOOLTIP_HIDE:case is.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(e,t);return;case ea.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(e,t);return;case Re.MOUSE_ARROW:case Re.MOUSE_BUTTON:this.handleMousePointer(e,t);return;case ya.PLAY_SOUND:case ya.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(e,t);return;case Ds.ROOM_OBJECT_INITIALIZED:case Ds.ROOM_OBJECT_DISPOSED:case Ds.PLAY_SAMPLE:case Ds.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(e,t);return;case oo.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(e,t);return;case Zi.RODRE_CURRENT_USER_ID:case Zi.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(e,t);return;default:xe.warn("Unhandled Event",e.constructor.name,"Object ID",e.object.id);return}}}handleRoomObjectMouseEvent(e,t){if(!(!e||!e.type))switch(e.type){case $e.CLICK:this.handleRoomObjectMouseClickEvent(e,t);return;case $e.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(e,t);return;case $e.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(e,t);return;case $e.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(e,t);return;case $e.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(e,t);return;case $e.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(e,t);return;case $e.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(e,t);return}}handleRoomObjectMouseClickEvent(e,t){if(!e)return;this.clickRoomObject(e);let r=Qe.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(r=i.operation);let n=!1,o=!1;this._whereYouClickIsWhereYouGo&&(!r||r===Qe.OBJECT_UNDEFINED)&&(n=this.handleMoveTargetFurni(t,e));const l=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(r){case Qe.OBJECT_MOVE:l===z.ROOM?i&&this.modifyRoomObject(t,i.id,i.category,Qe.OBJECT_MOVE_TO):l===z.UNIT&&(i&&e.objectType===gt.MONSTER_PLANT&&this.modifyRoomObject(t,i.id,i.category,Qe.OBJECT_MOVE_TO),e.eventId&&this.setMouseEventId(z.ROOM,fe.MOUSE_CLICK,e.eventId),this.placeObjectOnUser(t,e.objectId,l)),o=!0,e.objectId!==-1&&this.setSelectedObject(t,e.objectId,l);break;case Qe.OBJECT_PLACE:if(l===z.ROOM)this.placeObject(t,e instanceof Gn,e instanceof Gl);else if(l===z.UNIT)switch(e.objectType){case gt.MONSTER_PLANT:case gt.RENTABLE_BOT:this.placeObject(t,e instanceof Gn,e instanceof Gl);break;default:e.eventId&&this.setMouseEventId(z.ROOM,fe.MOUSE_CLICK,e.eventId),this.placeObjectOnUser(t,e.objectId,l);break}break;case Qe.OBJECT_UNDEFINED:l===z.ROOM?!n&&e instanceof Gn&&this.onRoomObjectTileMouseEvent(t,e):(this.setSelectedObject(t,e.objectId,l),o=!1,l===z.UNIT?(e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.objectType===gt.RENTABLE_BOT?this.modifyRoomObject(t,e.objectId,l,Qe.OBJECT_PICKUP_BOT):e.ctrlKey&&!e.altKey&&!e.shiftKey&&e.objectType===gt.MONSTER_PLANT?this.modifyRoomObject(t,e.objectId,l,Qe.OBJECT_PICKUP_PET):!e.ctrlKey&&!e.altKey&&e.shiftKey&&e.objectType===gt.MONSTER_PLANT&&this.modifyRoomObject(t,e.objectId,l,Qe.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?o=!0:n=!0):(l===z.FLOOR||l===z.WALL)&&(e.altKey||e.ctrlKey||e.shiftKey)&&(!e.ctrlKey&&!e.altKey&&e.shiftKey?l===z.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.REQUEST_ROTATE,t,e.objectId,l)):e.ctrlKey&&!e.altKey&&!e.shiftKey&&this.modifyRoomObject(t,e.objectId,l,Qe.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?o=!0:n=!0),e.eventId&&(n&&this.setMouseEventId(z.ROOM,fe.MOUSE_CLICK,e.eventId),o&&this.setMouseEventId(z.MINIMUM,fe.MOUSE_CLICK,e.eventId)));break}if(l===z.ROOM){const c=this.getMouseEventId(z.MINIMUM,fe.MOUSE_CLICK),h=this.getMouseEventId(z.UNIT,fe.MOUSE_CLICK);c!==e.eventId&&h!==e.eventId&&!o&&(this.deselectObject(t),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.DESELECTED,t,-1,z.MINIMUM)),this.setSelectedAvatar(t,0,!1))}}handleRoomObjectMouseDoubleClickEvent(e,t){const r=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.DOUBLE_CLICK,t,r,n))}handleRoomObjectMouseMoveEvent(e,t){if(!e)return;let r=Qe.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(r=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);if(this._roomEngine){const o=this._roomEngine.getRoomObjectCursor(t);if(o&&o.logic){let l=null;e instanceof Gn?l=this.handleMouseOverTile(e,t):e.object&&e.object.id!==-1?this._whereYouClickIsWhereYouGo&&(l=this.handleMouseOverObject(n,t,e)):l=new Vl(null,0,!1,e.eventId),o.processUpdateMessage(l)}}switch(r){case Qe.OBJECT_MOVE:n===z.ROOM&&this.handleObjectMove(e,t);return;case Qe.OBJECT_PLACE:n===z.ROOM&&this.handleObjectPlace(e,t);return}}handleRoomObjectMouseDownEvent(e,t){if(!e)return;let r=Qe.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(r=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(r){case Qe.OBJECT_UNDEFINED:(n===z.FLOOR||n===z.WALL||e.objectType===gt.MONSTER_PLANT)&&(e.altKey&&!e.ctrlKey&&!e.shiftKey||this.decorateModeMove(e))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.REQUEST_MOVE,t,e.objectId,n));return}}handleRoomObjectMouseDownLongEvent(e,t){if(!e)return;let r=Qe.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(t);i&&(r=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(r){case Qe.OBJECT_UNDEFINED:(n===z.FLOOR||n===z.WALL||e.objectType===gt.MONSTER_PLANT)&&(!e.ctrlKey&&!e.shiftKey||this.decorateModeMove(e))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.REQUEST_MANIPULATION,t,e.objectId,n));return}}handleRoomObjectMouseEnterEvent(e,t){const r=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.MOUSE_ENTER,t,r,n))}handleRoomObjectMouseLeaveEvent(e,t){const r=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==z.ROOM&&n===z.UNIT){const o=this._roomEngine.getRoomObjectCursor(t);o&&o.processUpdateMessage(new Zt(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new ye(ye.MOUSE_LEAVE,t,r,n))}onRoomObjectStateChangedEvent(e,t){if(e)switch(e.type){case vt.STATE_CHANGE:this.changeObjectState(t,e.object.id,e.object.type,e.state,!1);return;case vt.STATE_RANDOM:this.changeObjectState(t,e.object.id,e.object.type,e.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(e,t){if(e)switch(e.type){case _c.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new Ip(t,e.state,e.presetId,e.effectId,e.color,e.brightness));return}}handleSelectedObjectRemove(e,t){if(!(!e||!this._roomEngine))switch(e.type){case Vr.POSITION_CHANGED:{const r=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),o=this._roomEngine.getRoomObject(t,r,n),l=this._roomEngine.getRoomObjectSelectionArrow(t);if(o&&l&&l.logic){const c=o.getLocation();l.logic.processUpdateMessage(new rr(c,null))}return}case Vr.OBJECT_REMOVED:this.setSelectedAvatar(t,0,!1);return}}onRoomObjectWidgetRequestEvent(e,t){if(!e||!this._roomEngine)return;const r=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),o=this._roomEngine.events;if(o&&!Zn.isRoomPreviewerId(t))switch(e.type){case Q.OPEN_WIDGET:o.dispatchEvent(new ne(ne.OPEN_WIDGET,t,r,n,e.object.logic.widget));return;case Q.CLOSE_WIDGET:o.dispatchEvent(new ne(ne.CLOSE_WIDGET,t,r,n,e.object.logic.widget));return;case Q.OPEN_FURNI_CONTEXT_MENU:o.dispatchEvent(new ne(ne.OPEN_FURNI_CONTEXT_MENU,t,r,n,e.object.logic.contextMenu));return;case Q.CLOSE_FURNI_CONTEXT_MENU:o.dispatchEvent(new ne(ne.CLOSE_FURNI_CONTEXT_MENU,t,r,n));return;case Q.PLACEHOLDER:o.dispatchEvent(new ne(ne.REQUEST_PLACEHOLDER,t,r,n));return;case Q.CREDITFURNI:o.dispatchEvent(new ne(ne.REQUEST_CREDITFURNI,t,r,n));return;case Q.STACK_HEIGHT:o.dispatchEvent(new ne(ne.REQUEST_STACK_HEIGHT,t,r,n));return;case Q.EXTERNAL_IMAGE:o.dispatchEvent(new ne(ne.REQUEST_EXTERNAL_IMAGE,t,r,n));return;case Q.STICKIE:o.dispatchEvent(new ne(ne.REQUEST_STICKIE,t,r,n));return;case Q.PRESENT:o.dispatchEvent(new ne(ne.REQUEST_PRESENT,t,r,n));return;case Q.TROPHY:o.dispatchEvent(new ne(ne.REQUEST_TROPHY,t,r,n));return;case Q.TEASER:o.dispatchEvent(new ne(ne.REQUEST_TEASER,t,r,n));return;case Q.ECOTRONBOX:o.dispatchEvent(new ne(ne.REQUEST_ECOTRONBOX,t,r,n));return;case Q.DIMMER:o.dispatchEvent(new ne(ne.REQUEST_DIMMER,t,r,n));return;case Q.WIDGET_REMOVE_DIMMER:o.dispatchEvent(new ne(ne.REMOVE_DIMMER,t,r,n));return;case Q.CLOTHING_CHANGE:o.dispatchEvent(new ne(ne.REQUEST_CLOTHING_CHANGE,t,r,n));return;case Q.JUKEBOX_PLAYLIST_EDITOR:o.dispatchEvent(new ne(ne.REQUEST_PLAYLIST_EDITOR,t,r,n));return;case Q.MANNEQUIN:o.dispatchEvent(new ne(ne.REQUEST_MANNEQUIN,t,r,n));return;case Q.PET_PRODUCT_MENU:o.dispatchEvent(new pc(pc.USE_PRODUCT_FROM_ROOM,t,r,n));return;case Q.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new tD(e.objectId,e.object.model.getValue(b.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case Q.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:o.dispatchEvent(new ne(ne.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,t,r,n));return;case Q.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:o.dispatchEvent(new ne(ne.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,t,r,n));return;case Q.BACKGROUND_COLOR:o.dispatchEvent(new ne(ne.REQUEST_BACKGROUND_COLOR,t,r,n));return;case Q.MYSTERYBOX_OPEN_DIALOG:o.dispatchEvent(new ne(ne.REQUEST_MYSTERYBOX_OPEN_DIALOG,t,r,n));return;case Q.EFFECTBOX_OPEN_DIALOG:o.dispatchEvent(new ne(ne.REQUEST_EFFECTBOX_OPEN_DIALOG,t,r,n));return;case Q.MYSTERYTROPHY_OPEN_DIALOG:o.dispatchEvent(new ne(ne.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,t,r,n));return;case Q.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new wy(e.objectId,0));return;case Q.ACHIEVEMENT_RESOLUTION_ENGRAVING:o.dispatchEvent(new ne(ne.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,t,r,n));return;case Q.ACHIEVEMENT_RESOLUTION_FAILED:o.dispatchEvent(new ne(ne.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,t,r,n));return;case Q.FRIEND_FURNITURE_CONFIRM:o.dispatchEvent(new ne(ne.REQUEST_FRIEND_FURNITURE_CONFIRM,t,r,n));return;case Q.FRIEND_FURNITURE_ENGRAVING:o.dispatchEvent(new ne(ne.REQUEST_FRIEND_FURNITURE_ENGRAVING,t,r,n));return;case Q.BADGE_DISPLAY_ENGRAVING:o.dispatchEvent(new ne(ne.REQUEST_BADGE_DISPLAY_ENGRAVING,t,r,n));return;case Q.HIGH_SCORE_DISPLAY:o.dispatchEvent(new ne(ne.REQUEST_HIGH_SCORE_DISPLAY,t,r,n));return;case Q.HIDE_HIGH_SCORE_DISPLAY:o.dispatchEvent(new ne(ne.REQUEST_HIDE_HIGH_SCORE_DISPLAY,t,r,n));return;case Q.INERNAL_LINK:o.dispatchEvent(new ne(ne.REQUEST_INTERNAL_LINK,t,r,n));return;case Q.ROOM_LINK:o.dispatchEvent(new ne(ne.REQUEST_ROOM_LINK,t,r,n));return;case Q.YOUTUBE:o.dispatchEvent(new ne(ne.REQUEST_YOUTUBE,t,r,n));return}}onRoomObjectFurnitureActionEvent(e,t){e&&this.useObject(t,e.object.id,e.object.type,e.type)}handleObjectSoundMachineEvent(e,t){if(!e)return;const r=this._roomEngine.getRoomObjectCategoryForType(e.objectType),i=this.getSelectedRoomObjectData(t);if(!(i&&i.category===r&&i.id===e.objectId&&i.operation===Qe.OBJECT_PLACE))switch(e.type){case Re.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new Jt(Jt.SOUND_MACHINE_INIT,t,e.objectId,r));return;case Re.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new Jt(Jt.SOUND_MACHINE_SWITCHED_ON,t,e.objectId,r));return;case Re.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Jt(Jt.SOUND_MACHINE_SWITCHED_OFF,t,e.objectId,r));return;case Re.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new Jt(Jt.SOUND_MACHINE_DISPOSE,t,e.objectId,r));return}}handleObjectJukeboxEvent(e,t){if(!e)return;const r=this._roomEngine.getRoomObjectCategoryForType(e.objectType),i=this.getSelectedRoomObjectData(t);if(!(i&&i.category===r&&i.id===e.objectId&&i.operation===Qe.OBJECT_PLACE))switch(e.type){case Re.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new Jt(Jt.JUKEBOX_INIT,t,e.objectId,r));return;case Re.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new Jt(Jt.JUKEBOX_SWITCHED_ON,t,e.objectId,r));return;case Re.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Jt(Jt.JUKEBOX_SWITCHED_OFF,t,e.objectId,r));return;case Re.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new Jt(Jt.JUKEBOX_DISPOSE,t,e.objectId,r));return}}onRoomObjectFloorHoleEvent(e,t){if(e)switch(e.type){case wr.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(t,e.objectId);return;case wr.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(t,e.objectId);return}}clickRoomObject(e){if(!e||e.altKey||e.ctrlKey||e.shiftKey)return;const t=e.objectId,r=e.objectType,i=this._roomEngine.getRoomObjectCategoryForType(r);if(i===z.FLOOR){this._roomEngine.connection.send(new Rf(t,i));return}if(i===z.WALL){this._roomEngine.connection.send(new Rf(-Math.abs(t),i));return}}onRoomObjectRoomAdEvent(e,t){if(!e)return;let r=null;switch(e.type){case is.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(e),e.clickUrl&&e.clickUrl.length>0&&ke.instance.createLinkEvent(e.clickUrl),r=Ji.FURNI_CLICK;break;case is.ROOM_AD_FURNI_DOUBLE_CLICK:if(e.clickUrl&&e.clickUrl.length>0){const i="CATALOG_PAGE";e.clickUrl.indexOf(i)===0&&ke.instance.createLinkEvent(e.clickUrl.substr(i.length))}r=Ji.FURNI_DOUBLE_CLICK;break;case is.ROOM_AD_TOOLTIP_SHOW:r=Ji.TOOLTIP_SHOW;break;case is.ROOM_AD_TOOLTIP_HIDE:r=Ji.TOOLTIP_HIDE;break}r&&this._roomEngine.events.dispatchEvent(new ye(r,t,e.objectId,this._roomEngine.getRoomObjectCategoryForType(e.objectType)))}onRoomObjectBadgeAssetEvent(e,t){if(!(!e||!this._roomEngine))switch(e.type){case ea.LOAD_BADGE:{const r=e.objectId,i=e.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.loadRoomObjectBadgeImage(t,r,n,e.badgeId,e.groupBadge);return}}}handleMousePointer(e,t){e&&this._roomEngine.updateMousePointer(e.type,e.objectId,e.objectType)}handleRoomObjectPlaySoundEvent(e,t){const r=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(e.type){case ya.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new rc(rc.PLAY_SOUND,t,e.objectId,r,e.soundId,e.pitch));return;case ya.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new rc(rc.PLAY_SOUND_AT_PITCH,t,e.objectId,r,e.soundId,e.pitch));return}}handleRoomObjectSamplePlaybackEvent(e,t){if(!e)return;const r=this._roomEngine.getRoomObjectCategoryForType(e.objectType);switch(e.type){case Ds.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new Qr(Qr.ROOM_OBJECT_INITIALIZED,t,e.objectId,r,e.sampleId,e.pitch));break;case Ds.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new Qr(Qr.ROOM_OBJECT_DISPOSED,t,e.objectId,r,e.sampleId,e.pitch));break;case Ds.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new Qr(Qr.PLAY_SAMPLE,t,e.objectId,r,e.sampleId,e.pitch));break;case Ds.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new Qr(Qr.CHANGE_PITCH,t,e.objectId,r,e.sampleId,e.pitch));break}}onHSLColorEnableEvent(e,t){if(!(!e||!this._roomEngine))switch(e.type){case oo.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new Pd(Pd.ROOM_BACKGROUND_COLOR,t,e.enable,e.hue,e.saturation,e.lightness));return}}onRoomObjectDataRequestEvent(e,t){if(!(!e||!this._roomEngine||!e.object))switch(e.type){case Zi.RODRE_CURRENT_USER_ID:e.object.model.setValue(b.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case Zi.RODRE_URL_PREFIX:e.object.model.setValue(b.SESSION_URL_PREFIX,Ke.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(e,t){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const r=this._roomEngine.roomSessionManager.getSession(e);!r||r.isSpectator||this._roomEngine.moveBlocked||this.sendWalkUpdate(t.tileXAsInt,t.tileYAsInt)}handleObjectMove(e,t){if(!e||!this._roomEngine||!this._roomEngine.events)return;const i=this.getSelectedRoomObjectData(t);if(!i)return;const n=this._roomEngine.getRoomObject(t,i.id,i.category);if(!n)return;let o=!0;if(i.category===z.FLOOR||i.category===z.UNIT){const l=this._roomEngine.getFurnitureStackingHeightMap(t);e instanceof Gn&&this.handleFurnitureMove(n,i,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),l)||(this.handleFurnitureMove(n,i,i.loc.x,i.loc.y,l),o=!1)}else if(i.category===z.WALL){if(o=!1,e instanceof Gl){const l=e.wallLocation,c=e.wallWidth,h=e.wallHeight,u=e.x,g=e.y,m=e.direction;this.handleWallItemMove(n,i,l,c,h,u,g,m)&&(o=!0)}o||(n.setLocation(i.loc),n.setDirection(i.dir)),this._roomEngine.updateRoomObjectMask(t,i.id,o)}o?(this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(n,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(e,t){if(!e||!this._roomEngine||!this._roomEngine.events)return;let i=this.getSelectedRoomObjectData(t);if(!i)return;let n=this._roomEngine.getRoomObject(t,i.id,i.category);if(!n){if(e instanceof Gn){if(i.category===z.FLOOR)this._roomEngine.addFurnitureFloor(t,i.id,i.typeId,i.loc,i.dir,0,i.stuffData,parseFloat(i.instanceData),-1,0,0,"",!1);else if(i.category===z.UNIT){this._roomEngine.addRoomObjectUser(t,i.id,new G,new G(180),180,i.typeId,i.instanceData);const o=this._roomEngine.getRoomObject(t,i.id,i.category);o&&i.posture&&o.model.setValue(b.FIGURE_POSTURE,i.posture)}}else e instanceof Gl&&i.category===z.WALL&&this._roomEngine.addFurnitureWall(t,i.id,i.typeId,i.loc,i.dir,0,i.instanceData,0);if(n=this._roomEngine.getRoomObject(t,i.id,i.category),n&&i.category===z.FLOOR){const o=n.model.getValue(b.FURNITURE_ALLOWED_DIRECTIONS);if(o&&o.length){const l=new G(o[0]);if(n.setDirection(l),this.updateSelectedObjectData(t,i.id,i.category,i.loc,l,i.operation,i.typeId,i.instanceData,i.stuffData,i.state,i.animFrame,i.posture),i=this.getSelectedRoomObjectData(t),!i)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let o=!0;const l=this._roomEngine.getFurnitureStackingHeightMap(t);if(i.category===z.FLOOR)e instanceof Gn&&this.handleFurnitureMove(n,i,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),l)||(this._roomEngine.removeRoomObjectFloor(t,i.id),o=!1);else if(i.category===z.WALL){if(o=!1,e instanceof Gl){const c=e.wallLocation,h=e.wallWidth,u=e.wallHeight,g=e.x,m=e.y,p=e.direction;this.handleWallItemMove(n,i,c,h,u,g,m,p)&&(o=!0)}o||this._roomEngine.removeRoomObjectWall(t,i.id),this._roomEngine.updateRoomObjectMask(t,i.id,o)}else i.category===z.UNIT&&(e instanceof Gn&&this.handleUserPlace(n,Math.trunc(e.tileX+.5),Math.trunc(e.tileY+.5),this._roomEngine.getLegacyWallGeometry(t))||(this._roomEngine.removeRoomObjectUser(t,i.id),o=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!o)}}handleFurnitureMove(e,t,r,i,n){if(!e||!t)return!1;const o=new G;o.assign(e.getDirection()),e.setDirection(t.dir);const l=new G(r,i,0),c=new G;c.assign(e.getDirection());let h=this.validateFurnitureLocation(e,l,t.loc,t.dir,n);return h||(c.x=this.getValidRoomObjectDirection(e,!0),e.setDirection(c),h=this.validateFurnitureLocation(e,l,t.loc,t.dir,n)),h?(e.setLocation(h),c&&e.setDirection(c),!0):(e.setDirection(o),!1)}handleWallItemMove(e,t,r,i,n,o,l,c){if(!e||!t)return!1;const h=new G(c),u=this.validateWallItemLocation(e,r,i,n,o,l,t);return u?(e.setLocation(u),e.setDirection(h),!0):!1}validateFurnitureLocation(e,t,r,i,n){if(!e||!e.model||!t)return null;let o=null;const l=e.getDirection();if(!l||!r||!i)return null;if(t.x===r.x&&t.y===r.y&&l.x===i.x)return o=new G,o.assign(r),o;let c=e.model.getValue(b.FURNITURE_SIZE_X),h=e.model.getValue(b.FURNITURE_SIZE_Y);c<1&&(c=1),h<1&&(h=1);const u=r.x,g=r.y;let m=c,p=h,f=0,T=Math.trunc(Math.trunc(l.x+45)%360/90);if((T===1||T===3)&&(f=c,c=h,h=f),T=Math.trunc(Math.trunc(i.x+45)%360/90),(T===1||T===3)&&(f=m,m=p,p=f),n&&t){const I=e.model.getValue(b.FURNITURE_ALWAYS_STACKABLE)===1;return n.validateLocation(t.x,t.y,c,h,u,g,m,p,I)?new G(t.x,t.y,n.getTileHeight(t.x,t.y)):null}return null}validateWallItemLocation(e,t,r,i,n,o,l){if(e==null||e.model==null||t==null||r==null||i==null||l==null)return null;const c=e.model.getValue(b.FURNITURE_SIZE_X),h=e.model.getValue(b.FURNITURE_SIZE_Z),u=e.model.getValue(b.FURNITURE_CENTER_Z);if((n<c/2||n>r.length-c/2||o<u||o>i.length-(h-u))&&(n<c/2&&n<=r.length-c/2?n=c/2:n>=c/2&&n>r.length-c/2&&(n=r.length-c/2),o<u&&o<=i.length-(h-u)?o=u:o>=u&&o>i.length-(h-u)&&(o=i.length-(h-u))),n<c/2||n>r.length-c/2||o<u||o>i.length-(h-u))return null;let g=G.sum(G.product(r,n/r.length),G.product(i,o/i.length));return g=G.sum(t,g),g}changeObjectState(e,t,r,i,n){const o=this._roomEngine.getRoomObjectCategoryForType(r);this.changeRoomObjectState(e,t,o,i,n)}useObject(e,t,r,i){if(!(!this._roomEngine||!this._roomEngine.connection))switch(i){case Re.DICE_ACTIVATE:this._roomEngine.connection.send(new nD(t));return;case Re.DICE_OFF:this._roomEngine.connection.send(new aD(t));return;case Re.USE_HABBOWHEEL:this._roomEngine.connection.send(new iD(t));return;case Re.STICKIE:this._roomEngine.connection.send(new HM(t));return;case Re.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new lD(t));return}}changeRoomObjectState(e,t,r,i,n){return!this._roomEngine||!this._roomEngine.connection||(r===z.FLOOR?n?this._roomEngine.connection.send(new cD(t,i)):this._roomEngine.connection.send(new Sc(t,i)):r===z.WALL&&this._roomEngine.connection.send(new uD(t,i))),!0}sendWalkUpdate(e,t){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new xD(e,t))}handleMouseOverObject(e,t,r){if(e!==z.FLOOR)return null;const i=this._roomEngine.getRoomObject(t,r.objectId,z.FLOOR);if(!i)return null;const n=this.getActiveSurfaceLocation(i,r);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(t))return null;const l=n.x,c=n.y,h=n.z;return new Vl(new G(l,c,i.getLocation().z),h,!0,r.eventId)}handleMoveTargetFurni(e,t){if(t.objectType===gt.USER||t.objectType===gt.PET||t.objectType===gt.BOT||t.objectType===gt.RENTABLE_BOT||t.objectType===gt.MONSTER_PLANT)return;const r=this._roomEngine.getRoomObject(e,t.objectId,z.FLOOR),i=this.getActiveSurfaceLocation(r,t);return i&&!this._roomEngine.moveBlocked?(this.sendWalkUpdate(i.x,i.y),!0):!1}getActiveSurfaceLocation(e,t){if(!e||!t)return null;const r=this._roomEngine.sessionDataManager.getFloorItemDataByName(e.type);if(!r||!r.canStandOn&&!r.canSitOn&&!r.canLayOn)return null;const i=e.model;if(!i)return null;const n=e.getLocation(),o=e.getDirection();let l=i.getValue(b.FURNITURE_SIZE_X),c=i.getValue(b.FURNITURE_SIZE_Y);const h=i.getValue(b.FURNITURE_SIZE_Z);(o.x===90||o.x===270)&&([l,c]=[c,l]),l<1&&(l=1),c<1&&(c=1);const u=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!u)return null;const g=u.geometry.scale,m=r.canSitOn?.5:0,p=(g/2+t.spriteOffsetX+t.localX)/(g/4),f=(t.spriteOffsetY+t.localY+(h-m)*g/2)/(g/4),T=(p+2*f)/4,I=(p-2*f)/4,O=Math.floor(n.x+T),A=Math.floor(n.y-I+1);let N=!1;(O<n.x||O>=n.x+l||A<n.y||A>=n.y+c)&&(N=!0);const P=r.canSitOn?h-.5:h;return N?null:new G(O,A,P)}handleMouseOverTile(e,t){if(this._whereYouClickIsWhereYouGo)return new Vl(new G(e.tileXAsInt,e.tileYAsInt,e.tileZAsInt),0,!0,e.eventId);const r=this._roomEngine.getRoomObjectCursor(t);if(r&&r.visualization){const i=e.tileXAsInt,n=e.tileYAsInt,o=e.tileZAsInt;if(this._roomEngine.getRoomInstance(t)){const c=this._roomEngine.getRoomTileObjectMap(t);if(c){const h=c.getObjectIntTile(i,n),u=this._roomEngine.getFurnitureStackingHeightMap(t);if(u){if(h&&h.model&&h.model.getValue(b.FURNITURE_IS_VARIABLE_HEIGHT)>0){const g=u.getTileHeight(i,n),m=this._roomEngine.getLegacyWallGeometry(t).getHeight(i,n);return new Vl(new G(i,n,o),g-m,!0,e.eventId)}return new Vl(new G(i,n,o),0,!0,e.eventId)}}}}return null}placeObject(e,t,r){const i=this.getSelectedRoomObjectData(e);if(!i)return;let n=null,o=i.id;const l=i.category;let c=0,h=0,u=0,g=0,m="";if(this._roomEngine&&this._roomEngine.connection&&(n=this._roomEngine.getRoomObject(e,o,l),n)){const p=n.getLocation();if(g=n.getDirection().x,l===z.FLOOR||l===z.UNIT)c=p.x,h=p.y,u=p.z;else if(l===z.WALL){c=p.x,h=p.y,u=p.z;const f=this._roomEngine.getLegacyWallGeometry(e);f&&(m=f.getOldLocationString(p,g))}g=(g/45%8+8)%8,o<0&&l===z.UNIT&&(o=o*-1),this._objectPlacementSource!==Co.CATALOG&&(l===z.UNIT?i.typeId===jt.PET?this._roomEngine.connection.send(new YM(o,Math.trunc(c),Math.trunc(h))):i.typeId===jt.RENTABLE_BOT&&this._roomEngine.connection.send(new GM(o,Math.trunc(c),Math.trunc(h))):n.model.getValue(b.FURNITURE_IS_STICKIE)!==void 0?this._roomEngine.connection.send(new rD(o,m)):this._roomEngine.connection.send(new bE(o,l,m,Math.trunc(c),Math.trunc(h),g)))}if(this._roomEngine.setPlacedRoomObjectData(e,new xg(i.id,i.category,null,i.dir,null)),this.resetSelectedObjectData(e),this._roomEngine&&this._roomEngine.events){const p=n&&n.id===i.id;this._roomEngine.events.dispatchEvent(new Im(ye.PLACED,e,o,l,m,c,h,u,g,p,t,r,i.instanceData))}}modifyRoomObject(e,t,r,i){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(e,t,r);if(!n)return!1;let o=!0;switch(i){case Qe.OBJECT_ROTATE_POSITIVE:case Qe.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let l=0;i==Qe.OBJECT_ROTATE_NEGATIVE?l=this.getValidRoomObjectDirection(n,!1):l=this.getValidRoomObjectDirection(n,!0);const c=n.getLocation().x,h=n.getLocation().y;if(this.isValidLocation(n,new G(l),this._roomEngine.getFurnitureStackingHeightMap(e)))if(l=Math.trunc(l/45),n.type===gt.MONSTER_PLANT){const u=this._roomEngine.roomSessionManager.getSession(e);if(u){const g=u.userDataManager.getUserDataByIndex(t);g&&this._roomEngine.connection.send(new Sf(g.webID,Math.trunc(c),Math.trunc(h),l))}}else this._roomEngine.connection.send(new Of(t,c,h,l))}break;case Qe.OBJECT_EJECT:case Qe.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new sD(r,t));break;case Qe.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const l=this._roomEngine.roomSessionManager.getSession(e);if(l){const c=l.userDataManager.getUserDataByIndex(t);l.pickupPet(c.webID)}}break;case Qe.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const l=this._roomEngine.roomSessionManager.getSession(e);if(l){const c=l.userDataManager.getUserDataByIndex(t);l.pickupBot(c.webID)}}break;case Qe.OBJECT_MOVE:o=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(e,n.id,r,n.getLocation(),n.getDirection(),i),this._roomEngine.setObjectMoverIconSprite(n.id,r,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case Qe.OBJECT_MOVE_TO:{const l=this.getSelectedRoomObjectData(e);if(this.updateSelectedObjectData(e,l.id,l.category,l.loc,l.dir,Qe.OBJECT_MOVE_TO,l.typeId,l.instanceData,l.stuffData,l.state,l.animFrame,l.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(r===z.FLOOR){const c=n.getDirection().x%360,h=n.getLocation(),u=c/45;this._roomEngine.connection.send(new Of(t,h.x,h.y,u))}else if(r===z.WALL){const c=n.getDirection().x%360,h=this._roomEngine.getLegacyWallGeometry(e);if(h){const u=h.getOldLocationString(n.getLocation(),c);u&&this._roomEngine.connection.send(new fD(t,u))}}else if(r===z.UNIT){const c=n.getDirection().x%360,h=n.getLocation(),u=c/45;parseInt(n.model.getValue(b.RACE));const g=this._roomEngine.roomSessionManager.getSession(e);if(g){const m=g.userDataManager.getUserDataByIndex(t);m&&this._roomEngine.connection.send(new Sf(m.webID,h.x,h.y,u))}}}break}}return o&&this.resetSelectedObjectData(e),!0}modifyRoomObjectDataWithMap(e,t,r,i,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(e,t,r))return!1;switch(i){case Qe.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new NE(t,n));break}return!0}modifyWallItemData(e,t,r,i){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new XM(t,r,i)),!0)}deleteWallItem(e,t){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new KM(t)),!0)}getValidRoomObjectDirection(e,t){if(!e||!e.model)return 0;let r=0,i=0,n=[];e.type===gt.MONSTER_PLANT?n=e.model.getValue(b.PET_ALLOWED_DIRECTIONS):n=e.model.getValue(b.FURNITURE_ALLOWED_DIRECTIONS);let o=e.getDirection().x;if(n&&n.length){if(r=n.indexOf(o),r<0){for(r=0,i=0;i<n.length&&!(o<=n[i]);)r++,i++;r=r%n.length}t?r=(r+1)%n.length:r=(r-1+n.length)%n.length,o=n[r]}return o}isValidLocation(e,t,r){if(!e||!e.model||!t)return!1;const i=e.getDirection(),n=e.getLocation();if(!i||!n)return!1;if(i.x%180===t.x%180)return!0;let o=e.model.getValue(b.FURNITURE_SIZE_X),l=e.model.getValue(b.FURNITURE_SIZE_Y);o<1&&(o=1),l<1&&(l=1);let c=o,h=l,u=Math.trunc(Math.trunc(t.x+45)%360/90);if((u===1||u===3)&&([o,l]=[l,o]),u=Math.trunc(Math.trunc(i.x+45)%360/90),(u===1||u===3)&&([c,h]=[h,c]),r&&n){const g=e.model.getValue(b.FURNITURE_ALWAYS_STACKABLE)===1;if(r.validateLocation(n.x,n.y,o,l,n.x,n.y,c,h,g,n.z))return!0}return!1}placeObjectOnUser(e,t,r){const i=this.getSelectedRoomObjectData(e);!i||!this._roomEngine.getRoomObject(e,t,r)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new ax(ye.PLACED_ON_USER,e,t,r,i.id,i.category))}setSelectedObject(e,t,r){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(r){case z.UNIT:case z.FLOOR:case z.WALL:if(r===z.UNIT)this.deselectObject(e),this.setSelectedAvatar(e,t,!0);else if(this.setSelectedAvatar(e,0,!1),t!==this._selectedObjectId){this.deselectObject(e);const n=this._roomEngine.getRoomObject(e,t,r);n&&n.logic&&(n.logic.processUpdateMessage(new Vu(!0)),this._selectedObjectId=t,this._selectedObjectCategory=r)}i.dispatchEvent(new ye(ye.SELECTED,e,t,r));return}}deselectObject(e){if(this._selectedObjectId===-1)return;const t=this._roomEngine.getRoomObject(e,this._selectedObjectId,this._selectedObjectCategory);t&&t.logic&&(t.logic.processUpdateMessage(new Vu(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=z.MINIMUM)}setSelectedAvatar(e,t,r){if(!this._roomEngine)return;const i=z.UNIT,n=this._roomEngine.getRoomObject(e,this._selectedAvatarId,i);n&&n.logic&&(n.logic.processUpdateMessage(new r_(!1)),this._selectedAvatarId=-1);let o=!1;if(r){const c=this._roomEngine.getRoomObject(e,t,i);if(c&&c.logic){c.logic.processUpdateMessage(new r_(!0)),o=!0,this._selectedAvatarId=t;const h=c.getLocation();h&&this._roomEngine.connection.send(new PD(~~h.x,~~h.y))}}const l=this._roomEngine.getRoomObjectSelectionArrow(e);l&&l.logic&&(o&&!this._roomEngine.isPlayingGame()?l.logic.processUpdateMessage(new La(La.ENABLED)):l.logic.processUpdateMessage(new La(La.DISABLED)))}resetSelectedObjectData(e){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const t=this.getSelectedRoomObjectData(e);if(t){if(t.operation===Qe.OBJECT_MOVE||t.operation===Qe.OBJECT_MOVE_TO){const r=this._roomEngine.getRoomObject(e,t.id,t.category);r&&t.operation!==Qe.OBJECT_MOVE_TO&&(r.setLocation(t.loc),r.setDirection(t.dir)),this.setFurnitureAlphaMultiplier(r,1),t.category===z.WALL&&this._roomEngine.updateRoomObjectMask(e,t.id,!0),this.updateSelectedObjectData(e,t.id,t.category,t.loc,t.dir,Qe.OBJECT_MOVE,t.typeId,t.instanceData,t.stuffData,t.state,t.animFrame,t.posture)}else if(t.operation===Qe.OBJECT_PLACE){const r=t.id;switch(t.category){case z.FLOOR:this._roomEngine.removeRoomObjectFloor(e,r);break;case z.WALL:this._roomEngine.removeRoomObjectWall(e,r);break;case z.UNIT:this._roomEngine.removeRoomObjectUser(e,r);break}}this._roomEngine.setSelectedRoomObjectData(e,null)}}getSelectedRoomObjectData(e){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(e):null}setFurnitureAlphaMultiplier(e,t){!e||!e.model||e.model.setValue(b.FURNITURE_ALPHA_MULTIPLIER,t)}decorateModeMove(e){return this._roomEngine.isDecorating&&!(e.ctrlKey||e.shiftKey)}cancelRoomObjectPlacement(e){return this.resetSelectedObjectData(e),!0}setSelectedRoomObjectData(e,t,r,i,n,o,l=0,c=null,h=null,u=-1,g=-1,m=null){if(this.resetSelectedObjectData(e),!this._roomEngine)return;const p=new xg(t,r,o,i,n,l,c,h,u,g,m);this._roomEngine.setSelectedRoomObjectData(e,p)}updateSelectedObjectData(e,t,r,i,n,o,l=0,c=null,h=null,u=-1,g=-1,m=null){if(!this._roomEngine)return null;const p=new xg(t,r,o,i,n,l,c,h,u,g,m);this._roomEngine.setSelectedRoomObjectData(e,p)}handleUserPlace(e,t,r,i){return i.isRoomTile(t,r)?(e.setLocation(new G(t,r,i.getHeight(t,r))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class E6{constructor(){this._events=new Ri,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(e){const t=this.getLogicType(e);if(!t)return null;const r=new t;if(!r)return null;if(r.eventDispatcher=this._events,!this._cachedEvents.get(e)){this._cachedEvents.set(e,!0);const i=r.getEventTypes();for(const n of i)n&&this.registerEventType(n)}return r}registerEventType(e){if(!this._registeredEvents.get(e)){this._registeredEvents.set(e,!0);for(const t of this._functions)t&&this._events.addEventListener(e,t)}}registerEventFunction(e){if(e&&!(this._functions.indexOf(e)>=0)){this._functions.push(e);for(const t of this._registeredEvents.keys())t&&this._events.addEventListener(t,e)}}removeEventFunction(e){if(!e)return;const t=this._functions.indexOf(e);if(t!==-1){this._functions.splice(t,1);for(const r of this._registeredEvents.keys())r&&this._events.removeEventListener(r,e)}}getLogicType(e){if(!e)return null;let t=null;switch(e){case le.ROOM:t=xK;break;case le.TILE_CURSOR:t=ig;break;case le.SELECTION_ARROW:t=wK;break;case le.USER:case le.BOT:case le.RENTABLE_BOT:t=Lo;break;case le.PET:t=DK;break;case le.FURNITURE_BASIC:t=wt;break;case le.FURNITURE_BADGE_DISPLAY:t=jP;break;case le.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:t=G4;break;case le.FURNITURE_COUNTER_CLOCK:t=V4;break;case le.FURNITURE_CRACKABLE:t=H4;break;case le.FURNITURE_CREDIT:t=j4;break;case le.FURNITURE_CUSTOM_STACK_HEIGHT:t=z4;break;case le.FURNITURE_DICE:t=K4;break;case le.FURNITURE_EDITABLE_INTERNAL_LINK:t=X4;break;case le.FURNITURE_EDITABLE_ROOM_LINK:t=Q4;break;case le.FURNITURE_EXTERNAL_IMAGE_WALLITEM:t=J4;break;case le.FURNITURE_FIREWORKS:t=Z4;break;case le.FURNITURE_FLOOR_HOLE:t=YP;break;case le.FURNITURE_GUILD_CUSTOMIZED:t=Bc;break;case le.FURNITURE_HIGH_SCORE:t=KP;break;case le.FURNITURE_HOCKEY_SCORE:t=sK;break;case le.FURNITURE_ES:t=iK;break;case le.FURNITURE_MANNEQUIN:t=tg;break;case le.FURNITURE_MULTIHEIGHT:t=cK;break;case le.FURNITURE_MULTISTATE:t=Bs;break;case le.FURNITURE_ONE_WAY_DOOR:t=dK;break;case le.FURNITURE_PET_CUSTOMIZATION:t=_K;break;case le.FURNITURE_PRESENT:t=Vc;break;case le.FURNITURE_PURCHASABLE_CLOTHING:t=fK;break;case le.FURNITURE_PUSHABLE:t=sg;break;case le.FURNITURE_BACKGROUND_COLOR:t=TK;break;case le.FURNITURE_BG:t=RK;break;case le.FURNITURE_BB:t=SK;break;case le.FURNITURE_ROOMDIMMER:t=OK;break;case le.FURNITURE_SCORE:t=QE;break;case le.FURNITURE_SOUNDBLOCK:t=rg;break;case le.FURNITURE_STICKIE:t=XP;break;case le.FURNITURE_TROPHY:t=NK;break;case le.FURNITURE_VOTE_COUNTER:t=$E;break;case le.FURNITURE_VOTE_MAJORITY:t=bK;break;case le.FURNITURE_WINDOW:t=vK;break;case le.FURNITURE_LOVELOCK:t=oK;break;case le.FURNITURE_YOUTUBE:t=MK;break;case le.FURNITURE_CRAFTING_GIZMO:t=W4;break;case le.FURNITURE_RENTABLE_SPACE:t=IK;break;case le.FURNITURE_EFFECTBOX:t=$4;break;case le.FURNITURE_MONSTERPLANT_SEED:t=lK;break;case le.FURNITURE_MYSTERYBOX:t=uK;break;case le.FURNITURE_MYSTERYTROPHY:t=hK;break;case le.FURNITURE_RANDOM_TELEPORT:t=EK;break;case le.FURNITURE_CLOTHING_CHANGE:t=B4;break;case le.FURNITURE_CUCKOO_CLOCK:t=Y4;break;case le.FURNITURE_ECOTRON_BOX:t=q4;break;case le.FURNITURE_GROUP_FORUM_TERMINAL:t=eK;break;case le.FURNITURE_HWEEN_LOVELOCK:t=rK;break;case le.FURNITURE_INTERNAL_LINK:t=nK;break;case le.FURNITURE_JUKEBOX:t=aK;break;case le.FURNITURE_PLACEHOLDER:t=gK;break;case le.FURNITURE_PLANET_SYSTEM:t=mK;break;case le.FURNITURE_RANDOMSTATE:t=pK;break;case le.FURNITURE_SONG_DISK:t=CK;break;case le.FURNITURE_SOUND_MACHINE:t=AK;break;case le.FURNITURE_WELCOME_GIFT:t=yK;break;case le.FURNITURE_ACHIEVEMENT_RESOLUTION:t=Cl;break;case le.FURNITURE_HABBOWHEEL:t=tK;break;default:t=wt;break}return t||(xe.warn("Unknown Logic",e),null)}get events(){return this._events}}const rs=class extends aa{constructor(s){super(),this._communication=s,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new p6(this),this._roomMessageHandler=new f6(this),this._roomContentLoader=new Mi,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new qx,this._visualizationFactory=new pL,this._logicFactory=new E6,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._moveBlocked=!1,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this._areaSelectionManager=new Di(this),this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new $I(1e3),this._thumbnailObjectIdBank=new $I(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(z.FLOOR),this._roomManager.addUpdateCategory(z.WALL),this._roomManager.addUpdateCategory(z.UNIT),this._roomManager.addUpdateCategory(z.CURSOR),this._roomManager.addUpdateCategory(z.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(Ve.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(Ve.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(Mi.LOADER_READY,this.onRoomContentLoaderReadyEvent),Rr().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[s,e]of this._roomInstanceDatas)this.removeRoomInstance(s);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),Rr().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(Mi.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(Ve.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(Ve.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(s){if(s instanceof Ve)switch(s.type){case Ve.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(s.session.roomId);return;case Ve.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(s.session.roomId));return}}onRoomContentLoaderReadyEvent(s){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(s){this._activeRoomId=s}destroyRoom(s){this.removeRoomInstance(s)}getRoomInstance(s){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(s))||null}removeRoomInstance(s){this.getRoomInstance(s)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(s));const t=this._roomInstanceDatas.get(s);t&&(this._roomInstanceDatas.delete(t.roomId),t.dispose()),this.events.dispatchEvent(new lt(lt.DISPOSED,s))}createRoomInstance(s,e){let t="111",r="201",i="1";if(!this._ready){let l=this._roomDatas.get(s);l&&(this._roomDatas.delete(s),t=l.floorType,r=l.wallType,i=l.landscapeType),l=new aT(s,e),l.floorType=t,l.wallType=r,l.landscapeType=i,this._roomDatas.set(s,l),xe.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!e){xe.warn("Room property messages");return}const n=this._roomDatas.get(s);n&&(this._roomDatas.delete(s),n.floorType&&(t=n.floorType),n.wallType&&(r=n.wallType),n.landscapeType&&(i=n.landscapeType)),this.setupRoomInstance(s,e,t,r,i,this.getRoomInstanceModelName(s))&&(e.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new lt(lt.INITIALIZED,s)))}setupRoomInstance(s,e,t,r,i,n){if(!this._ready||!this._roomManager)return;const o=this._roomManager.createRoomInstance(this.getRoomId(s));if(!o)return null;const l=z.ROOM,c=o.createRoomObjectAndInitalize(rs.ROOM_OBJECT_ID,rs.ROOM_OBJECT_TYPE,l);if(o.model.setValue(Ht.ROOM_IS_PUBLIC,0),o.model.setValue(Ht.ROOM_Z_SCALE,1),e&&(o.model.setValue(Ht.RESTRICTS_DRAGGING,e.restrictsDragging),o.model.setValue(Ht.RESTRICTS_SCALING,e.restrictsScaling),o.model.setValue(Ht.RESTRICTED_SCALE,e.restrictedScale),e.dimensions)){const g=e.dimensions.minX,m=e.dimensions.maxX,p=e.dimensions.minY,f=e.dimensions.maxY;o.model.setValue(Ht.ROOM_MIN_X,g),o.model.setValue(Ht.ROOM_MAX_X,m),o.model.setValue(Ht.ROOM_MIN_Y,p),o.model.setValue(Ht.ROOM_MAX_Y,f);const T=Math.trunc(g*423+m*671+p*913+f*7509);c&&c.model&&c.model.setValue(b.ROOM_RANDOM_SEED,T)}const h=c&&c.logic||null;if(h&&(h.initialize(e),t&&(h.processUpdateMessage(new _r(_r.ROOM_FLOOR_UPDATE,t)),o.model.setValue(b.ROOM_FLOOR_TYPE,t)),r&&(h.processUpdateMessage(new _r(_r.ROOM_WALL_UPDATE,r)),o.model.setValue(b.ROOM_WALL_TYPE,r)),i&&(h.processUpdateMessage(new _r(_r.ROOM_LANDSCAPE_UPDATE,i)),o.model.setValue(b.ROOM_LANDSCAPE_TYPE,i))),e&&e.doors.length){let u=0;for(;u<e.doors.length;){const g=e.doors[u];if(g){const m=g.x,p=g.y,f=g.z,T=g.dir,I=gr.DOOR,O="door_"+u,A=new G(m,p,f);h.processUpdateMessage(new gr(gr.ADD_MASK,O,I,A,gr.HOLE)),(T===90||T===180)&&(T===90&&(o.model.setValue(b.ROOM_DOOR_X,m-.5),o.model.setValue(b.ROOM_DOOR_Y,p)),T===180&&(o.model.setValue(b.ROOM_DOOR_X,m),o.model.setValue(b.ROOM_DOOR_Y,p-.5)),o.model.setValue(b.ROOM_DOOR_Z,f),o.model.setValue(b.ROOM_DOOR_DIR,T))}u++}}return o.createRoomObjectAndInitalize(rs.CURSOR_OBJECT_ID,rs.CURSOR_OBJECT_TYPE,z.CURSOR),Ke.getValue("enable.avatar.arrow",!1)&&o.createRoomObjectAndInitalize(rs.ARROW_OBJECT_ID,rs.ARROW_OBJECT_TYPE,z.CURSOR),o}getRoomInstanceDisplay(s,e,t,r,i){const n=this.getRoomInstance(s);if(!n)return null;let o=n.renderer;if(!o&&(o=this._roomRendererFactory.createRenderer(),!o))return null;o.roomObjectVariableAccurateZ=b.OBJECT_ACCURATE_Z_VALUE,n.setRenderer(o);const l=o.createCanvas(e,t,r,i);if(!l)return null;if(n.model.getValue(Ht.RESTRICTS_SCALING)){let h=n.model.getValue(Ht.RESTRICTED_SCALE);h||(h=1),l.setScale(h),l.restrictsScaling=!0}else l.restrictsScaling=!1;if(l.setMouseListener(this._roomObjectEventHandler),l.geometry){l.geometry.z_scale=n.model.getValue(Ht.ROOM_Z_SCALE);const h=n.model.getValue(b.ROOM_DOOR_X),u=n.model.getValue(b.ROOM_DOOR_Y),g=n.model.getValue(b.ROOM_DOOR_Z),m=n.model.getValue(b.ROOM_DOOR_DIR),p=new G(h,u,g);let f=null;m===90&&(f=new G(-2e3,0,0)),m===180&&(f=new G(0,-2e3,0)),l.geometry.setDisplacement(p,f);const T=l.master;if(T){const I=new ds(ys.EMPTY);I.name=rs.OVERLAY,I.interactive=!1,T.addChild(I)}}return l.master}setRoomInstanceRenderingCanvasMask(s,e,t){const r=this.getRoomInstanceRenderingCanvas(s,e);r&&r.setMask(t)}setRoomInstanceRenderingCanvasScale(s,e,t,r=null,i=null,n=!1,o=!1){const l=this.getRoomInstanceRenderingCanvas(s,e);if(l){if(l.restrictsScaling&&!n)return;l.setScale(t,r,i,n,o),this.events.dispatchEvent(new lt(lt.ROOM_ZOOMED,s))}}getRoomInstanceRenderingCanvas(s,e=-1){const t=this.getRoomInstance(s);if(!t)return null;const r=t.renderer;if(!r)return null;e===-1&&(e=this._activeRoomActiveCanvas);const i=r.getCanvas(e);return i||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(s,e=-1){e===-1&&(e=this._activeRoomActiveCanvas);const t=this.getRoomInstanceRenderingCanvas(s,e);return t?new it(t.screenOffsetX,t.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(s,e,t){const r=this.getRoomInstanceRenderingCanvas(s,e);if(!r||!t)return!1;const i=~~t.x,n=~~t.y;if(!(r.screenOffsetX===i&&r.screenOffsetY===n))return this.events.dispatchEvent(new Ep(s,-(r.screenOffsetX-i),-(r.screenOffsetY-n))),r.screenOffsetX=i,r.screenOffsetY=n,!0}getRoomInstanceRenderingCanvasScale(s=-1e3,e=-1){s===-1e3&&(s=this._activeRoomId),e===-1&&(e=this._activeRoomActiveCanvas);const t=this.getRoomInstanceRenderingCanvas(s,e);return t?t.scale:1}initializeRoomInstanceRenderingCanvas(s,e,t,r){const i=this.getRoomInstanceRenderingCanvas(s,e);i&&i.initialize(t,r)}getRoomInstanceGeometry(s,e=-1){const t=this.getRoomInstance(s);if(!t)return null;const r=t.renderer;if(!r)return null;e===-1&&(e=this._activeRoomActiveCanvas);const i=r.getCanvas(e);return i?i.geometry:null}getRoomInstanceVariable(s,e){const t=this.getRoomInstance(s);return t&&t.model&&t.model.getValue(e)||null}updateRoomInstancePlaneVisibility(s,e,t=!0){const r=this.getRoomOwnObject(s);return r?(r.processUpdateMessage(new Pa(Pa.WALL_VISIBILITY,e)),r.processUpdateMessage(new Pa(Pa.FLOOR_VISIBILITY,t)),!0):!1}updateRoomInstancePlaneThickness(s,e,t){const r=this.getRoomOwnObject(s);return r?(r.processUpdateMessage(new Da(Da.WALL_THICKNESS,e)),r.processUpdateMessage(new Da(Da.FLOOR_THICKNESS,t)),!0):!1}updateRoomInstancePlaneType(s,e=null,t=null,r=null,i=!1){const n=this.getRoomOwnObject(s),o=this.getRoomInstance(s);if(!n){let l=this._roomDatas.get(s);return l||(l=new aT(s,null),this._roomDatas.set(s,l)),e&&(l.floorType=e),t&&(l.wallType=t),r&&(l.landscapeType=r),!0}return e&&(o&&!i&&o.model.setValue(b.ROOM_FLOOR_TYPE,e),n.processUpdateMessage(new _r(_r.ROOM_FLOOR_UPDATE,e))),t&&(o&&!i&&o.model.setValue(b.ROOM_WALL_TYPE,t),n.processUpdateMessage(new _r(_r.ROOM_WALL_UPDATE,t))),r&&(o&&!i&&o.model.setValue(b.ROOM_LANDSCAPE_TYPE,r),n.processUpdateMessage(new _r(_r.ROOM_LANDSCAPE_UPDATE,r))),!0}updateObjectRoomColor(s,e,t,r){const i=this.getRoomOwnObject(s);if(!i||!i.logic)return!1;const n=new n_(n_.BACKGROUND_COLOR,e,t,r);return i.logic.processUpdateMessage(n),this.events.dispatchEvent(new pp(s,e,t,r)),!0}addRoomInstanceFloorHole(s,e){if(e<0)return;const t=this.getRoomOwnObject(s),r=this.getRoomObjectFloor(s,e);if(t&&t.logic&&r&&r.model){const i=r.getLocation(),n=r.model.getValue(b.FURNITURE_SIZE_X),o=r.model.getValue(b.FURNITURE_SIZE_Y);t.processUpdateMessage(new Ma(Ma.ADD,e,i.x,i.y,n,o))}}removeRoomInstanceFloorHole(s,e){if(e<0)return;const t=this.getRoomOwnObject(s);t&&t.processUpdateMessage(new Ma(Ma.REMOVE,e))}setRoomEngineGameMode(s,e){const t=this.getRoomInstance(s);if(!t)return;const r=e?1:0;t.model.setValue(Ht.IS_PLAYING_GAME,r),r===0?this.events.dispatchEvent(new lt(lt.NORMAL_MODE,s)):this.events.dispatchEvent(new lt(lt.GAME_MODE,s))}isRoomIdPlayingGame(s){const e=this.getRoomInstance(s);return e?e.model.getValue(Ht.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(s){s?Rr().remove(this.update,this):(Rr().remove(this.update,this),Rr().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(s,e=!1){this._roomManager&&(s=tt(),tr.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(s,e),this.updateRoomCameras(s),this._mouseCursorUpdate&&this.setPointer(),tr.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const s=this.getRoomInstanceData(this._activeRoomId);s&&s.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const s=new Date().valueOf(),e=5;for(const t of this._roomInstanceDatas.values()){if(!t)continue;let r=null,i=0,n=!1;for(;r=t.getNextPendingFurnitureFloor();)if(n=this.processPendingFurnitureFloor(t.roomId,r.id,r),!(++i%e)&&new Date().valueOf()-s>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(r=t.getNextPendingFurnitureWall());)if(n=this.processPendingFurnitureWall(t.roomId,r.id,r),!(++i%e)&&new Date().valueOf()-s>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(n&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(t.roomId)).hasUninitializedObjects()||this.objectsInitialized(t.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(s){if(s){this._ready=!0,this.events.dispatchEvent(new lt(lt.ENGINE_INITIALIZED,0));for(const e of this._roomDatas.values())e&&this.createRoomInstance(e.roomId,e.data)}}processPendingFurnitureFloor(s,e,t){if(!t){const l=this.getRoomInstanceData(s);if(l&&(t=l.getPendingFurnitureFloor(e)),!t)return!1}let r=t.type;r||(r=this.getFurnitureFloorName(t.typeId));const i=this.createRoomObjectFloor(s,e,r);if(!i)return!1;const n=i.model;if(n&&(n.setValue(b.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(t.typeId)),n.setValue(b.FURNITURE_TYPE_ID,t.typeId),n.setValue(b.FURNITURE_AD_URL,this.getRoomObjectAdUrl(t.type)),n.setValue(b.FURNITURE_REAL_ROOM_OBJECT,t.realRoomObject?1:0),n.setValue(b.FURNITURE_EXPIRY_TIME,t.expiryTime),n.setValue(b.FURNITURE_EXPIRTY_TIMESTAMP,tt()),n.setValue(b.FURNITURE_USAGE_POLICY,t.usagePolicy),n.setValue(b.FURNITURE_OWNER_ID,t.ownerId),n.setValue(b.FURNITURE_OWNER_NAME,t.ownerName)),!this.updateRoomObjectFloor(s,e,t.location,t.direction,t.state,t.data,t.extra)||t.sizeZ>=0&&!this.updateRoomObjectFloorHeight(s,e,t.sizeZ))return!1;this.events&&this.events.dispatchEvent(new ye(ye.ADDED,s,e,z.FLOOR));const o=this.getPlacedRoomObjectData(s);return o&&o.id===e&&o.category===z.FLOOR&&this.selectRoomObject(s,e,z.FLOOR),i.isReady&&t.synchronized&&this.addObjectToTileMap(s,i),!0}processPendingFurnitureWall(s,e,t){if(!t){const c=this.getRoomInstanceData(s);if(c&&(t=c.getPendingFurnitureWall(e)),!t)return!1}let r="";t.data&&(r=t.data.getLegacyString());let i=this.getFurnitureWallName(t.typeId,r);i||(i="");const n=this.createRoomObjectWall(s,e,i);if(!n)return!1;const o=n.model;if(o&&(o.setValue(b.FURNITURE_COLOR,this.getFurnitureWallColorIndex(t.typeId)),o.setValue(b.FURNITURE_TYPE_ID,t.typeId),o.setValue(b.FURNITURE_AD_URL,this.getRoomObjectAdUrl(t.type)),o.setValue(b.FURNITURE_REAL_ROOM_OBJECT,t.realRoomObject?1:0),o.setValue(b.OBJECT_ACCURATE_Z_VALUE,1),o.setValue(b.FURNITURE_EXPIRY_TIME,t.expiryTime),o.setValue(b.FURNITURE_EXPIRTY_TIMESTAMP,tt()),o.setValue(b.FURNITURE_USAGE_POLICY,t.usagePolicy),o.setValue(b.FURNITURE_OWNER_ID,t.ownerId),o.setValue(b.FURNITURE_OWNER_NAME,t.ownerName)),!this.updateRoomObjectWall(s,e,t.location,t.direction,t.state,r))return!1;this.events&&this.events.dispatchEvent(new ye(ye.ADDED,s,e,z.WALL));const l=this.getPlacedRoomObjectData(s);return l&&Math.abs(l.id)===e&&l.category===z.WALL&&this.selectRoomObject(s,e,z.WALL),!0}setRoomSessionOwnUser(s,e){if(!this._roomSessionManager)return;const t=this._roomSessionManager.getSession(s);t&&t.setOwnRoomIndex(e);const r=this.getRoomCamera(s);r&&(r.targetId=e,r.targetCategory=z.UNIT,r.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(s){for(const e of this._roomInstanceDatas.values()){if(!e)continue;const t=e.roomCamera;if(!t)continue;let r=null;const i=this.getRoomObject(e.roomId,t.targetId,t.targetCategory);i&&(r=i.getLocation()),r&&(e.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(e.roomId,1,r,s)}if(this._activeRoomWasDragged){const e=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);e&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new it(e.screenOffsetX+this._activeRoomDragX,e.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(s,e,t,r){const i=this.getRoomInstanceRenderingCanvas(s,e),n=this.getRoomInstanceData(s);if(!i||!n||i.scale!==1)return;const o=i.geometry,l=n.roomCamera,c=this.getRoomInstance(s);if(!o||!l||!c)return;const h=this.getRoomCanvasRectangle(s,e);if(!h)return;let u=Math.floor(t.z)+1;const g=Math.round(h.width),m=Math.round(h.height),p=this.getCanvasBoundingRectangle(e);if(p&&(p.right<0||p.bottom<0||p.left>=g||p.top>=m)&&l.reset(),l.screenWd!==g||l.screenHt!==m||l.scale!==o.scale||l.geometryUpdateId!==o.updateId||!G.isEqual(t,l.targetObjectLoc)||l.isMoving){l.targetObjectLoc=t;const f=new G;f.assign(t),f.x=Math.round(f.x),f.y=Math.round(f.y);const T=c.model.getValue(Ht.ROOM_MIN_X)-.5,I=c.model.getValue(Ht.ROOM_MIN_Y)-.5,O=c.model.getValue(Ht.ROOM_MAX_X)+.5,A=c.model.getValue(Ht.ROOM_MAX_Y)+.5,N=Math.round((T+O)/2),P=Math.round((I+A)/2),y=2;let D=new it(f.x-N,f.y-P);const x=o.scale/Math.sqrt(2),w=x/2,k=new Zr;k.rotate(-(o.direction.x+90)/180*Math.PI),D=k.apply(D),D.y=D.y*(w/x);const F=h.width/2/x-1,L=h.height/2/w-1;let B=0,V=0,q=0,Z=0,H=o.getScreenPoint(new G(N,P,y));if(!H)return;if(H.x=H.x+Math.round(h.width/2),H.y=H.y+Math.round(h.height/2),p)if(p.x+=-i.screenOffsetX,p.y+=-i.screenOffsetY,p.width>1&&p.height>1)B=(p.left-H.x-o.scale*.25)/x,q=(p.right-H.x+o.scale*.25)/x,V=(p.top-H.y-o.scale*.5)/w,Z=(p.bottom-H.y+o.scale*.5)/w;else{o.adjustLocation(new G(-30,-30),25);return}else{o.adjustLocation(new G(0,0),25);return}let X=!1,ee=!1,Oe=!1,de=!1;Math.round((q-B)*x)<h.width?(u=2,D.x=(q+B)/2,Oe=!0):(D.x>q-F&&(D.x=q-F,X=!0),D.x<B+F&&(D.x=B+F,X=!0)),Math.round((Z-V)*w)<h.height?(u=2,D.y=(Z+V)/2,de=!0):(D.y>Z-L&&(D.y=Z-L,ee=!0),D.y<V+L&&(D.y=V+L,ee=!0),ee&&(D.y=D.y/(w/x))),k.invert(),D=k.apply(D),D.x=D.x+N,D.y=D.y+P;let ce=.35,ue=.2,$=.2;const re=10,me=10;if($*g>100&&($=100/g),ce*m>150&&(ce=150/m),ue*m>150&&(ue=150/m),l.limitedLocationX&&l.screenWd==g&&l.screenHt==m&&($=0),l.limitedLocationY&&l.screenWd==g&&l.screenHt==m&&(ce=0,ue=0),h.width=h.width*(1-$*2),h.height=h.height*(1-(ce+ue)),h.width<re&&(h.width=re),h.height<me&&(h.height=me),ce+ue>0?(h.x+=-h.width/2,h.y+=-h.height*(ue/(ce+ue))):(h.x+=-h.width/2,h.y+=-h.height/2),H=o.getScreenPoint(f),!H)return;if(H){H.x=H.x+i.screenOffsetX,H.y=H.y+i.screenOffsetY,f.z=u,f.x=Math.round(D.x*2)/2,f.y=Math.round(D.y*2)/2,l.location||(o.location=f,this.useOffsetScrolling?l.initializeLocation(new G(0,0,0)):l.initializeLocation(f));const ge=o.getScreenPoint(f),Ae=new G(0,0,0);ge&&(Ae.x=ge.x,Ae.y=ge.y),(H.x<h.left||H.x>h.right)&&!l.centeredLocX||(H.y<h.top||H.y>h.bottom)&&!l.centeredLocY||Oe&&!l.centeredLocX&&l.screenWd!=g||de&&!l.centeredLocY&&l.screenHt!=m||l.roomWd!=p.width||l.roomHt!=p.height||l.screenWd!=g||l.screenHt!=m?(l.limitedLocationX=X,l.limitedLocationY=ee,this.useOffsetScrolling?l.target=Ae:l.target=f):(X||(l.limitedLocationX=!1),ee||(l.limitedLocationY=!1))}l.centeredLocX=Oe,l.centeredLocY=de,l.screenWd=g,l.screenHt=m,l.scale=o.scale,l.geometryUpdateId=o.updateId,l.roomWd=p.width,l.roomHt=p.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?l.update(r,8):l.update(r,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new it(-l.location.x,-l.location.y)):o.adjustLocation(l.location,25)}else l.limitedLocationX=!1,l.limitedLocationY=!1,l.centeredLocX=!1,l.centeredLocY=!1}getRoomCanvasRectangle(s,e){const t=this.getRoomInstanceRenderingCanvas(s,e);return t?new fi(0,0,t.width,t.height):null}getRoomObjectBoundingRectangle(s,e,t,r){const i=this.getRoomInstanceGeometry(s,r);if(!i)return null;const n=this.getRoomObject(s,e,t);if(!n)return null;const o=n.visualization;if(!o)return null;const l=o.getBoundingRectangle(),c=this.getRoomInstanceRenderingCanvas(s,r),h=c?c.scale:1,u=i.getScreenPoint(n.getLocation());return!u||(u.x=Math.round(u.x),u.y=Math.round(u.y),l.x=l.x*h,l.y=l.y*h,l.width=l.width*h,l.height=l.height*h,u.x=u.x*h,u.y=u.y*h,l.x+=u.x,l.y+=u.y,!c)?null:(l.x+=Math.round(c.width/2)+c.screenOffsetX,l.y+=Math.round(c.height/2)+c.screenOffsetY,l)}getCanvasBoundingRectangle(s){return this.getRoomObjectBoundingRectangle(this._activeRoomId,rs.ROOM_OBJECT_ID,z.ROOM,s)}getFurnitureFloorName(s){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(s):null}getFurnitureWallName(s,e=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(s,e):null}getFurnitureFloorColorIndex(s){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(s):null}getFurnitureWallColorIndex(s){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(s):null}getRoomInstanceData(s){const e=this._roomInstanceDatas.get(s);if(e)return e;const t=new g6(s);return this._roomInstanceDatas.set(t.roomId,t),t}getRoomInstanceModelName(s){const e=this.getRoomInstanceData(s);return e?e.modelName:null}setRoomInstanceModelName(s,e){const t=this.getRoomInstanceData(s);t&&t.setModelName(e)}getRoomTileObjectMap(s){const e=this.getRoomInstanceData(s);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(s){const e=this.getRoomInstanceData(s);return e?e.roomCamera:null}getSelectedRoomObjectData(s){const e=this.getRoomInstanceData(s);return e?e.selectedObject:null}setSelectedRoomObjectData(s,e){const t=this.getRoomInstanceData(s);if(!t)return null;t.setSelectedObject(e),e&&t.setPlacedObject(null)}getPlacedRoomObjectData(s){const e=this.getRoomInstanceData(s);return e?e.placedObject:null}setPlacedRoomObjectData(s,e){const t=this.getRoomInstanceData(s);if(!t)return null;t.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(s){const e=this.getRoomInstanceData(s);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(s,e){const t=this.getRoomInstanceData(s);if(!t)return null;t.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(s){const e=this.getRoomInstanceData(s);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(s,e,t,r){const i=this.getRoomInstance(s);return i?i.createRoomObjectAndInitalize(e,t,r):null}getTotalObjectsForManager(s,e){const t=this.getRoomInstance(s);return t?t.getTotalObjectsForManager(e):0}getRoomObject(s,e,t){if(!this._ready)return null;let r=this.getRoomId(s);return s===0&&(r=rs.TEMPORARY_ROOM),this.getObject(r,e,t)}getObject(s,e,t){let r=null;if(this._roomManager&&(r=this._roomManager.getRoomInstance(s)),!r)return null;let i=r.getRoomObject(e,t);if(!i)switch(t){case z.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(s),e,null),i=r.getRoomObject(e,t);break;case z.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(s),e,null),i=r.getRoomObject(e,t);break}return i}getRoomObjectByIndex(s,e,t){const r=this.getRoomInstance(s);return r?r.getRoomObjectByIndex(e,t):null}getRoomObjectCategoryForType(s){return!s||!this._roomContentLoader?z.MINIMUM:this._roomContentLoader.getCategoryForType(s)}getRoomObjectCursor(s){return this.getObject(this.getRoomId(s),rs.CURSOR_OBJECT_ID,z.CURSOR)}getRoomObjectSelectionArrow(s){return this.getObject(this.getRoomId(s),rs.ARROW_OBJECT_ID,z.CURSOR)}getRoomOwnObject(s){return this.getObject(this.getRoomId(s),rs.ROOM_OBJECT_ID,z.ROOM)}getRoomObjectUser(s,e){return this.getObject(this.getRoomId(s),e,z.UNIT)}removeRoomObjectUser(s,e){const t=this._roomInstanceDatas.get(s);t&&t.clearUserFocusAlpha(e),this.removeRoomObject(s,e,z.UNIT)}createRoomObjectUser(s,e,t){return this.createRoomObjectAndInitialize(s,e,t,z.UNIT)}getRoomObjectFloor(s,e){return this.getObject(this.getRoomId(s),e,z.FLOOR)}createRoomObjectFloor(s,e,t){return this.createRoomObjectAndInitialize(s,e,t,z.FLOOR)}removeRoomObjectFloor(s,e,t=-1,r=!1){const i=this.getRoomInstanceData(s);if(i&&i.removePendingFunitureFloor(e),this._sessionDataManager&&t===this._sessionDataManager.userId&&!Vf.isBuilderClubId(e)){const n=this.getRoomObject(s,e,z.FLOOR);if(n){const o=this.getRoomObjectScreenLocation(s,e,z.FLOOR,this._activeRoomActiveCanvas);if(o&&!(n.model.getValue(b.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const c=n.model.getValue(b.FURNITURE_TYPE_ID),h=n.model.getValue(b.FURNITURE_EXTRAS),u=n.model.getValue(b.FURNITURE_DATA_FORMAT),g=$n.getData(u),m=this.getFurnitureFloorIcon(c,null,h,g).data;if(m){const p=Lt.generateImage(m);if(this.events){const f=new Dd(p,o.x,o.y);f.iconName=xa.INVENTORY,this.events.dispatchEvent(f)}}}}}this.removeRoomObject(s,e,z.FLOOR),this.setMouseDefault(s,z.FLOOR,e),r&&this.refreshTileObjectMap(s,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(s,e){return this.getObject(this.getRoomId(s),e,z.WALL)}removeRoomObjectWall(s,e,t=-1){if(this._sessionDataManager&&t===this._sessionDataManager.userId&&!Vf.isBuilderClubId(e)){const r=this.getRoomObject(s,e,z.WALL);if(r&&r.type.indexOf("post_it")===-1&&r.type.indexOf("external_image_wallitem")===-1){const i=this.getRoomObjectScreenLocation(s,e,z.WALL,this._activeRoomActiveCanvas);if(i){const n=r.model.getValue(b.FURNITURE_TYPE_ID),o=r.model.getValue(b.FURNITURE_DATA),l=this.getFurnitureWallIcon(n,null,o).data;if(l){const c=Lt.generateImage(l);if(this.events){const h=new Dd(c,i.x,i.y);h.iconName=xa.INVENTORY,this.events.dispatchEvent(h)}}}}}this.removeRoomObject(s,e,z.WALL),this.updateRoomObjectMask(s,e,!1),this.setMouseDefault(s,z.WALL,e)}createRoomObjectWall(s,e,t){return this.createRoomObjectAndInitialize(s,e,t,z.WALL)}removeRoomObject(s,e,t){const r=this.getRoomInstance(s);if(!r)return null;r.removeRoomObject(e,t),this.events&&this.events.dispatchEvent(new ye(ye.REMOVED,s,e,t))}addFurnitureFloor(s,e,t,r,i,n,o,l=NaN,c=-1,h=0,u=0,g="",m=!0,p=!0,f=-1){const T=this.getRoomInstanceData(s);if(!T)return!1;const I=new Ug(e,t,null,r,i,n,o,l,c,h,u,g,m,p,f);return T.addPendingFurnitureFloor(I),!0}addFurnitureFloorByTypeName(s,e,t,r,i,n,o,l=NaN,c=-1,h=0,u=0,g="",m=!0,p=!0,f=-1){const T=this.getRoomInstanceData(s);if(!T)return!1;const I=new Ug(e,0,t,r,i,n,o,l,c,h,u,g,m,p,f);return T.addPendingFurnitureFloor(I),!0}addFurnitureWall(s,e,t,r,i,n,o,l=-1,c=0,h=0,u="",g=!0){const m=this.getRoomInstanceData(s);if(!m)return!1;const p=new ei;p.setString(o);const f=new Ug(e,t,null,r,i,n,p,NaN,l,c,h,u,!0,g);return m.addPendingFurnitureWall(f),!0}updateRoomObjectFloor(s,e,t,r,i,n,o=null){const l=this.getRoomObjectFloor(s,e);return l?(l.processUpdateMessage(new rr(t,r)),l.processUpdateMessage(new Zt(i,n,o)),!0):!1}updateRoomObjectWall(s,e,t,r,i,n=null){const o=this.getRoomObjectWall(s,e);if(!o||!o.logic)return!1;const l=new rr(t,r),c=new ei,h=new Zt(i,c);return c.setString(n),o.logic.processUpdateMessage(l),o.logic.processUpdateMessage(h),this.updateRoomObjectMask(s,e),!0}updateRoomObjectWallItemData(s,e,t){const r=this.getRoomObjectWall(s,e);return!r||!r.logic?!1:(r.logic.processUpdateMessage(new qE(t)),!0)}updateRoomObjectFloorHeight(s,e,t){const r=this.getRoomObjectFloor(s,e);return r?(r.processUpdateMessage(new VP(null,null,t)),!0):!1}updateRoomObjectFloorExpiration(s,e,t){const r=this.getRoomObjectFloor(s,e);return r?(r.model.setValue(b.FURNITURE_EXPIRY_TIME,t),r.model.setValue(b.FURNITURE_EXPIRTY_TIMESTAMP,tt()),!0):!1}updateRoomObjectWallExpiration(s,e,t){const r=this.getRoomObjectWall(s,e);return r?(r.model.setValue(b.FURNITURE_EXPIRY_TIME,t),r.model.setValue(b.FURNITURE_EXPIRTY_TIMESTAMP,tt()),!0):!1}updateRoomObjectMask(s,e,t=!0){const r=z.WALL+"_"+e,i=this.getRoomObjectWall(s,e);let n=null;if(i&&i.model){if(i.model.getValue(b.FURNITURE_USES_PLANE_MASK)>0){const l=i.model.getValue(b.FURNITURE_PLANE_MASK_TYPE),c=i.getLocation();t?n=new gr(gr.ADD_MASK,r,l,c):n=new gr(gr.REMOVE_MASK,r)}}else n=new gr(gr.REMOVE_MASK,r);const o=this.getRoomOwnObject(s);o&&o.logic&&n&&o.logic.processUpdateMessage(n)}rollRoomObjectFloor(s,e,t,r,i){const n=this.getRoomObjectFloor(s,e);n&&n.processUpdateMessage(new To(t,r,null,!!r,i))}updateRoomObjectWallLocation(s,e,t){const r=this.getRoomObjectWall(s,e);return r?(r.logic&&r.logic.processUpdateMessage(new To(t,null,null)),this.updateRoomObjectMask(s,e),!0):!1}addRoomObjectUser(s,e,t,r,i,n,o){if(this.getRoomObjectUser(s,e))return!1;let c=gt.getTypeString(n);c===gt.PET&&(c=this.getPetType(o));const h=this.createRoomObjectUser(s,e,c);if(!h)return!1;const u=this.getRoomInstanceData(s);let g=255;if(u){const m=u.getUserFocusAlpha(e);m!=null&&(g=m)}return h.model&&(h.model.setValue(b.FIGURE_FOCUS_ALPHA,g),u&&u.setUserFocusAlpha(e,g)),h.processUpdateMessage(new i_(this.fixedUserLocation(s,t),null,r,i,!1,0)),o&&h.processUpdateMessage(new s_(o)),this.events&&this.events.dispatchEvent(new ye(ye.ADDED,s,e,z.UNIT)),!0}updateRoomObjectUserLocation(s,e,t,r,i=!1,n=0,o=null,l=NaN,c=500){const h=this.getRoomObjectUser(s,e);if(!h)return!1;t||(t=h.getLocation()),o||(o=h.getDirection()),isNaN(l)&&(l=h.model.getValue(b.HEAD_DIRECTION)),h.processUpdateMessage(new i_(this.fixedUserLocation(s,t),this.fixedUserLocation(s,r),o,l,i,n,c));const u=this._roomSessionManager&&this._roomSessionManager.getSession(s)||null;return u&&u.ownRoomIndex===e&&this._logicFactory.events.dispatchEvent(new xu(xu.ROAME_MOVE_TO,r)),!0}fixedUserLocation(s,e){if(!e)return null;const t=this.getFurnitureStackingHeightMap(s),r=this.getLegacyWallGeometry(s);if(!t||!r)return e;let i=e.z;const n=t.getTileHeight(e.x,e.y),o=r.getHeight(e.x,e.y);return Math.abs(i-n)<.1&&Math.abs(n-o)<.1&&(i=r.getFloorAltitude(e.x,e.y)),new G(e.x,e.y,i)}updateRoomObjectUserAction(s,e,t,r,i=null){const n=this.getRoomInstanceData(s),o=this.getRoomObjectUser(s,e);if(!o){if(t===b.FIGURE_FOCUS_ALPHA){const c=Math.max(0,Math.min(255,r));return n&&n.setUserFocusAlpha(e,c),!0}return!1}let l=null;switch(t){case b.FIGURE_TALK:l=new YE(r);break;case b.FIGURE_SLEEP:l=new KE(r===1);break;case b.FIGURE_IS_TYPING:l=new GP(r===1);break;case b.FIGURE_IS_MUTED:l=new LP(r===1);break;case b.FIGURE_CARRY_OBJECT:l=new NP(r,i);break;case b.FIGURE_USE_OBJECT:l=new BP(r);break;case b.FIGURE_DANCE:l=new bP(r);break;case b.FIGURE_GAINED_EXPERIENCE:l=new vP(r);break;case b.FIGURE_NUMBER_VALUE:l=new wP(r);break;case b.FIGURE_SIGN:l=new kP(r);break;case b.FIGURE_EXPRESSION:l=new MP(r);break;case b.FIGURE_IS_PLAYING_GAME:l=new FP(r===1);break;case b.FIGURE_FOCUS_ALPHA:if(o.model){const c=Math.max(0,Math.min(255,r));o.model.setValue(b.FIGURE_FOCUS_ALPHA,c),n&&n.setUserFocusAlpha(e,c)}return!0;case b.FIGURE_GUIDE_STATUS:l=new k4(r);break}return l?(o.processUpdateMessage(l),!0):!1}updateRoomObjectUserFigure(s,e,t,r=null,i=null,n=!1){const o=this.getRoomObjectUser(s,e);return o?(o.processUpdateMessage(new s_(t,r,i,n)),!0):!1}updateRoomObjectUserFlatControl(s,e,t){const r=this.getRoomObjectUser(s,e);return r?(r.processUpdateMessage(new DP(parseInt(t))),!0):!1}updateRoomObjectUserEffect(s,e,t,r=0){const i=this.getRoomObjectUser(s,e);return i?(i.processUpdateMessage(new yP(t,r)),!0):!1}updateRoomObjectUserGesture(s,e,t){const r=this.getRoomObjectUser(s,e);return r?(r.processUpdateMessage(new PP(t)),!0):!1}updateRoomObjectUserPetGesture(s,e,t){const r=this.getRoomObjectUser(s,e);return r?(r.processUpdateMessage(new xP(t)),!0):!1}updateRoomObjectUserPosture(s,e,t,r=null){const i=this.getRoomObjectUser(s,e);return i?(i.processUpdateMessage(new zE(t,r)),!0):!1}updateRoomObjectUserOwn(s,e){const t=this.getRoomObjectUser(s,e);t&&t.processUpdateMessage(new UP)}useRoomObject(s,e){const t=this.getRoomObject(this._activeRoomId,s,e);if(t){const r=t.logic;if(r)return r.useObject(),!0}return!1}objectInitialized(s,e,t){const r=this.getRoomIdFromString(s);t===z.WALL&&this.updateRoomObjectMask(r,e);const i=this.getRoomObject(r,e,t);if(i&&i.model&&i.logic){const n=i.model.getValue(b.FURNITURE_DATA_FORMAT);if(!isNaN(n)){const o=$n.getData(n);o.initializeFromRoomObjectModel(i.model),i.processUpdateMessage(new Zt(i.getState(0),o))}this.events.dispatchEvent(new ye(ye.CONTENT_UPDATED,r,e,t))}s!==rs.TEMPORARY_ROOM&&this.addObjectToTileMap(r,i)}changeObjectModelData(s,e,t,r,i){const n=this.getObject(this.getRoomId(s),e,t);if(!n||!n.logic)return!1;const o=new HP(r,i);return n.processUpdateMessage(o),!0}changeObjectState(s,e,t){const r=this.getObject(this.getRoomId(s),e,t);if(!r||!r.model)return;let i=r.model.getValue(b.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(i)?i=1:i=i+1,r.model.setValue(b.FURNITURE_AUTOMATIC_STATE_INDEX,i);const n=r.model.getValue(b.FURNITURE_DATA_FORMAT),o=$n.getData(n);o.initializeFromRoomObjectModel(r.model),r.logic&&r.logic.processUpdateMessage(new Zt(i,o))}loadRoomObjectBadgeImage(s,e,t,r,i=!0){if(!this._sessionDataManager)return;let n=null;if(s===0){const l=this._roomManager.getRoomInstance(rs.TEMPORARY_ROOM);l&&(n=l.getRoomObject(e,t))}else n=this.getRoomObjectFloor(s,e);if(!n||!n.logic)return;let o=i?this._sessionDataManager.loadGroupBadgeImage(r):this._sessionDataManager.loadBadgeImage(r);if(o)this.putBadgeInObjectAssets(n,r,i);else{o="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(mo.IMAGE_READY,this.onBadgeImageReadyEvent);let l=this._badgeListenerObjects.get(r);l||(l=[]),l.push(new m6(n,i)),this._badgeListenerObjects.set(r,l)}n.logic.processUpdateMessage(new Oc(r,o))}onBadgeImageReadyEvent(s){if(!this._sessionDataManager)return;const e=this._badgeListenerObjects&&this._badgeListenerObjects.get(s.badgeId);if(e){for(const t of e){if(!t)continue;this.putBadgeInObjectAssets(t.object,s.badgeId,t.groupBadge);const r=t.groupBadge?this._sessionDataManager.loadGroupBadgeImage(s.badgeId):this._sessionDataManager.loadBadgeImage(s.badgeId);t.object&&t.object.logic&&t.object.logic.processUpdateMessage(new Oc(s.badgeId,r))}this._badgeListenerObjects.delete(s.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(mo.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(s,e,t=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const r=t?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),i=t?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);i&&this._roomContentLoader.addAssetToCollection(s.type,r,i,!1)}dispatchMouseEvent(s,e,t,r,i,n,o,l){const c=this.getRoomInstanceRenderingCanvas(this._activeRoomId,s);if(!c)return;const h=this.getRenderingCanvasOverlay(c),u=this.getOverlayIconSprite(h,rs.OBJECT_ICON_SPRITE);if(u){const g=u.getLocalBounds();u.x=e-g.width/2,u.y=t-g.height/2}if(r===fe.MOUSE_CLICK&&this._areaSelectionManager.finishSelecting())this._areaSelectionManager.finishSelecting();else if(!this.handleRoomDragging(c,e,t,r,i,n,o)&&!c.handleMouseEvent(e,t,r,i,n,o,l)){let g=null;r===fe.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new ye(ye.DESELECTED,this._activeRoomId,-1,z.MINIMUM)),g=$e.CLICK):r===fe.MOUSE_MOVE?g=$e.MOUSE_MOVE:r===fe.MOUSE_DOWN?g=$e.MOUSE_DOWN:r===fe.MOUSE_DOWN_LONG?g=$e.MOUSE_DOWN_LONG:r===fe.MOUSE_UP&&(g=$e.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new $e(g,this.getRoomObject(this._activeRoomId,rs.ROOM_OBJECT_ID,z.ROOM),null,i),this._activeRoomId)}this._activeRoomActiveCanvas=s,this._activeRoomActiveCanvasMouseX=e,this._activeRoomActiveCanvasMouseY=t}handleRoomDragging(s,e,t,r,i,n,o){if(this._areaSelectionManager.areaSelectionState===Di.SELECTING)return this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,!1;let l=e-this._activeRoomActiveCanvasMouseX,c=t-this._activeRoomActiveCanvasMouseY;if(r===fe.MOUSE_DOWN)!i&&!n&&!o&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(r===fe.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const h=this.getRoomInstanceData(this._activeRoomId);if(h){const u=h.roomCamera;u&&(this.useOffsetScrolling&&(u.isMoving||(u.centeredLocX=!1,u.centeredLocY=!1),u.resetLocation(new G(-s.screenOffsetX,-s.screenOffsetY))),this._roomDraggingAlwaysCenters&&u.reset())}}}else if(r===fe.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(l=e-this._activeRoomDragStartX,c=t-this._activeRoomDragStartY,(l<=-rs.DRAG_THRESHOLD||l>=rs.DRAG_THRESHOLD||c<=-rs.DRAG_THRESHOLD||c>=rs.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),l=0,c=0),(l!=0||c!=0)&&(this._activeRoomDragX+=l,this._activeRoomDragY+=c,this._activeRoomWasDragged=!0));else if((r===fe.MOUSE_CLICK||r===fe.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(s,e,t){const r=this.getRoomObjectCategoryForType(t);switch(s){case Re.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,r,e);return;default:this.setMouseDefault(this._activeRoomId,r,e);return}}setMouseButton(s,e,t){if(!this._roomSessionManager)return;const r=this._roomSessionManager.getSession(s);if(r&&(e!==z.FLOOR&&e!==z.WALL||r.controllerLevel>=Rt.GUEST)){const i=this.getRoomInstanceData(s);i&&i.addButtonMouseCursorOwner(e+"_"+t)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(s,e,t){if(!this._roomSessionManager)return;const r=this.getRoomInstanceData(s);r&&r.removeButtonMouseCursorOwner(e+"_"+t)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(s,e,t){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,s,e,t)}modifyRoomObjectDataWithMap(s,e,t,r){if(!this._roomObjectEventHandler)return!1;e===z.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,s,e,t,r)}modifyRoomObjectData(s,e,t,r){if(!this._roomObjectEventHandler)return!1;e===z.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,s,t,r)}processRoomObjectEvent(s){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(s.object);if(!e)return;const t=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(s,t)}processRoomObjectPlacement(s,e,t,r,i=null,n=null,o=-1,l=-1,c=null){const h=this.getRoomInstance(this._activeRoomId);return!h||h.model.getValue(Ht.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(s,this._activeRoomId,e,t,r,i,n,o,l,c)}getRoomObjectScreenLocation(s,e,t,r=-1){r==-1&&(r=this._activeRoomActiveCanvas);const i=this.getRoomInstanceGeometry(s,r);if(!i)return null;const n=this.getRoomObject(s,e,t);if(!n)return null;const o=i.getScreenPoint(n.getLocation());if(!o)return null;const l=this.getRoomInstanceRenderingCanvas(s,r);return l?(o.x=o.x*l.scale,o.y=o.y*l.scale,o.x+=l.width/2+l.screenOffsetX,o.y+=l.height/2+l.screenOffsetY,o.x=Math.round(o.x),o.y=Math.round(o.y),o):null}selectRoomObject(s,e,t){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(s,e,t)}setSelectedAvatar(s,e){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(s,e,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(s,e,t,r=1){if(!s||!t)return;let i=this.getOverlayIconSprite(s,e);return i?null:(i=new ds(t),i.name=e,i.scale.set(r),s.addChild(i),i)}onRoomContentLoaded(s,e,t){if(!this._roomContentLoader||s===-1)return;this._thumbnailObjectIdBank.freeNumber(s-1);const r=this._thumbnailCallbacks.get(e);if(r){this._thumbnailCallbacks.delete(e);const i=this._roomContentLoader.getImage(e);if(i)for(const n of r)n&&n.imageReady(s,null,i)}}setObjectMoverIconSprite(s,e,t,r=null,i=null,n=-1,o=-1,l=null){let c=null,h=0,u=null;const g=1;if(t)u=this.getRoomObjectImage(this._activeRoomId,s,e,new G,1,null);else if(this._roomContentLoader)if(e===z.FLOOR?(c=this._roomContentLoader.getFurnitureFloorNameForTypeId(s),h=this._roomContentLoader.getFurnitureFloorColorIndex(s)):e===z.WALL&&(c=this._roomContentLoader.getFurnitureWallNameForTypeId(s,r),h=this._roomContentLoader.getFurnitureWallColorIndex(s)),e===z.UNIT)if(c=gt.getTypeString(s),c==="pet"){c=this.getPetType(r);const T=new ra(r);u=this.getRoomObjectPetImage(T.typeId,T.paletteId,T.color,new G(180),64,null,!0,0,T.customParts,l)}else u=this.getGenericRoomObjectImage(c,r,new G(180),64,null,0,null,i,n,o,l);else u=this.getGenericRoomObjectImage(c,h.toString(),new G,1,null,0,r,i,n,o,l);if(!u||!u.data)return;const m=this.getActiveRoomInstanceRenderingCanvas();if(!m)return;const p=this.getRenderingCanvasOverlay(m);this.removeOverlayIconSprite(p,rs.OBJECT_ICON_SPRITE);const f=this.addOverlayIconSprite(p,rs.OBJECT_ICON_SPRITE,u.data,g);f&&(f.x=this._activeRoomActiveCanvasMouseX-u.data.width/2,f.y=this._activeRoomActiveCanvasMouseY-u.data.height/2)}getRoomObjectImage(s,e,t,r,i,n,o=0){if(!this._roomManager)return null;let l=-1,c=null,h=null,u="",g=null;const m=this.getRoomId(s),p=this._roomManager.getRoomInstance(m);if(p){const f=p.getRoomObject(e,t);if(f&&f.model)switch(l=f.id,c=f.type,t){case z.FLOOR:case z.WALL:{u=f.model.getValue(b.FURNITURE_COLOR).toString(),g=f.model.getValue(b.FURNITURE_EXTRAS);const T=f.model.getValue(b.FURNITURE_DATA_FORMAT);T!==ei.FORMAT_KEY&&(h=$n.getData(T),h.initializeFromRoomObjectModel(f.model));break}case z.UNIT:u=f.model.getValue(b.FIGURE);break}}return this.getGenericRoomObjectImage(c,u,r,i,n,o,g,h,-1,-1,null,l)}getFurnitureFloorIconUrl(s){let e=null,t="";return this._roomContentLoader?(e=this._roomContentLoader.getFurnitureFloorNameForTypeId(s),t=this._roomContentLoader.getFurnitureFloorColorIndex(s).toString(),this._roomContentLoader.getAssetIconUrl(e,t)):null}getFurnitureFloorIcon(s,e,t=null,r=null){return this.getFurnitureFloorImage(s,new G,1,e,0,t,-1,-1,r)}getFurnitureWallIconUrl(s,e=null){let t=null,r="";return this._roomContentLoader?(t=this._roomContentLoader.getFurnitureWallNameForTypeId(s,e),r=this._roomContentLoader.getFurnitureWallColorIndex(s).toString(),this._roomContentLoader.getAssetIconUrl(t,r)):null}getFurnitureWallIcon(s,e,t=null){return this.getFurnitureWallImage(s,new G,1,e,0,t)}getFurnitureFloorImage(s,e,t,r,i=0,n=null,o=-1,l=-1,c=null){let h=null,u="";return this._roomContentLoader&&(h=this._roomContentLoader.getFurnitureFloorNameForTypeId(s),u=this._roomContentLoader.getFurnitureFloorColorIndex(s).toString()),t===1&&r?this.getGenericRoomObjectThumbnail(h,u,r,n,c):this.getGenericRoomObjectImage(h,u,e,t,r,i,n,c,o,l)}getFurnitureWallImage(s,e,t,r,i=0,n=null,o=-1,l=-1){let c=null,h="";return this._roomContentLoader&&(c=this._roomContentLoader.getFurnitureWallNameForTypeId(s),h=this._roomContentLoader.getFurnitureWallColorIndex(s).toString()),t===1&&r?this.getGenericRoomObjectThumbnail(c,h,r,n,null):this.getGenericRoomObjectImage(c,h,e,t,r,i,n,null,o,l)}getRoomObjectPetImage(s,e,t,r,i,n,o=!1,l=0,c=null,h=null){let u=null,g=s+" "+e+" "+t.toString(16);if(o&&(g=g+" head"),c){g=g+(" "+c.length);for(const m of c)g=g+(" "+m.layerId+" "+m.partId+" "+m.paletteId)}return this._roomContentLoader&&(u=this._roomContentLoader.getPetNameForType(s)),this.getGenericRoomObjectImage(u,g,r,i,n,l,null,null,-1,-1,h)}getGenericRoomObjectImage(s,e,t,r,i,n=0,o=null,l=null,c=-1,h=-1,u=null,g=-1){if(!this._roomManager)return null;const m=new tT;if(m.id=-1,!this._ready||!s)return m;let p=this._roomManager.getRoomInstance(rs.TEMPORARY_ROOM);if(!p&&(p=this._roomManager.createRoomInstance(rs.TEMPORARY_ROOM),!p))return m;let f=this._imageObjectIdBank.reserveNumber();const T=this.getRoomObjectCategoryForType(s);if(f<0)return m;f++;const I=p.createRoomObjectAndInitalize(f,s,T);if(!I||!I.model||!I.logic)return m;const O=I.model;switch(T){case z.FLOOR:case z.WALL:O.setValue(b.FURNITURE_COLOR,parseInt(e)),O.setValue(b.FURNITURE_EXTRAS,o);break;case z.UNIT:if(s===gt.USER||s===gt.BOT||s===gt.RENTABLE_BOT||s===gt.PET)O.setValue(b.FIGURE,e);else{const y=new ra(e);O.setValue(b.PET_PALETTE_INDEX,y.paletteId),O.setValue(b.PET_COLOR,y.color),y.headOnly&&O.setValue(b.PET_HEAD_ONLY,1),y.hasCustomParts&&(O.setValue(b.PET_CUSTOM_LAYER_IDS,y.customLayerIds),O.setValue(b.PET_CUSTOM_PARTS_IDS,y.customPartIds),O.setValue(b.PET_CUSTOM_PALETTE_IDS,y.customPaletteIds)),u&&O.setValue(b.FIGURE_POSTURE,u)}break}I.setDirection(t);const A=I.visualization;if(!A)return p.removeRoomObject(f,T),m;(c>-1||l)&&(l&&l.getLegacyString()!==""?I.logic.processUpdateMessage(new Zt(parseInt(l.getLegacyString()),l)):I.logic.processUpdateMessage(new Zt(c,l)));const N=new No(r,new G(-135,30,0),new G(11,11,5));if(A.update(N,0,!0,!1),h>0){let y=0;for(;y<h;)A.update(N,0,!0,!1),y++}const P=A.getImage(n,g);if(m.data=P,m.id=f,!this.isRoomContentTypeLoaded(s)&&i){let y=this._imageCallbacks.get(f.toString());y||(y=[],this._imageCallbacks.set(f.toString(),y)),y.push(i),O.setValue(b.IMAGE_QUERY_SCALE,r)}else p.removeRoomObject(f,T),this._imageObjectIdBank.freeNumber(f-1),m.id=0;return N.dispose(),m}getGenericRoomObjectThumbnail(s,e,t,r=null,i=null){if(!this._roomManager)return null;const n=new tT;if(n.id=-1,!this._ready||!s)return n;let o=this._roomManager.getRoomInstance(rs.TEMPORARY_ROOM);if(!o&&(o=this._roomManager.createRoomInstance(rs.TEMPORARY_ROOM),!o))return n;let l=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(s),l<0)return n;l++,n.id=l,n.data=null,n.image=null;const c=[s,e].join("_"),h=this._roomContentLoader.getImage(c);if(!h&&t){let u=this._thumbnailCallbacks.get(c);u||(u=[],this._thumbnailCallbacks.set(c,u),this._roomContentLoader.downloadImage(l,s,e,null)),u.push(t)}else h&&(n.image=h),this._thumbnailObjectIdBank.freeNumber(l-1),n.id=0;return n}initalizeTemporaryObjectsByType(s,e){const t=this._roomManager.getRoomInstance(rs.TEMPORARY_ROOM);if(!t||!this._roomContentLoader)return;const r=this._roomContentLoader.getCategoryForType(s),i=t.getManager(r);let n=null,o=0;if(i&&i.objects.length){for(const l of i.objects.getValues())if(l&&l.model&&l.type===s){const c=l.id,h=l.visualization;let u=null;if(h){const m=l.model.getValue(b.IMAGE_QUERY_SCALE);n&&o!==m&&(n.dispose(),n=null),n||(o=m,n=new No(m,new G(-135,30,0),new G(11,11,5))),h.update(n,0,!0,!1),u=h.image}t.removeRoomObject(c,r),this._imageObjectIdBank.freeNumber(c-1);const g=this._imageCallbacks.get(c.toString());if(g){this._imageCallbacks.delete(c.toString());for(const m of g)m&&(u?m.imageReady(c,u):m.imageFailed(c))}}}n&&n.dispose()}setObjectMoverIconSpriteVisible(s){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const t=this.getRenderingCanvasOverlay(e),r=this.getOverlayIconSprite(t,rs.OBJECT_ICON_SPRITE);r&&(r.visible=s)}removeObjectMoverIconSprite(){const s=this.getActiveRoomInstanceRenderingCanvas();if(!s)return;const e=this.getRenderingCanvasOverlay(s);this.removeOverlayIconSprite(e,rs.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(s){if(!s)return null;const e=s.master;return e&&e.getChildByName(rs.OVERLAY)||null}removeOverlayIconSprite(s,e){if(!s)return!1;let t=s.children.length-1;for(;t>=0;){const r=s.getChildAt(t);if(r&&r.name===e){if(s.removeChildAt(t),r.children.length){const i=r.getChildAt(0);i.parent.removeChild(i),i.destroy()}return!0}t--}return!1}getOverlayIconSprite(s,e){if(!s)return null;let t=s.children.length-1;for(;t>=0;){const r=s.getChildAt(t);if(r&&r.name===e)return r;t--}return null}getRoomObjects(s,e){if(this._ready){const t=this.getRoomId(s),r=this._roomManager.getRoomInstance(t);if(r)return r.getRoomObjectsForCategory(e)}return[]}addObjectToTileMap(s,e){const t=this.getRoomInstanceData(s).tileObjectMap;t&&t.addRoomObject(e)}refreshTileObjectMap(s,e){const t=this.getRoomInstanceData(s).tileObjectMap;t&&t.populate(this.getRoomObjects(s,z.FLOOR))}getRenderRoomMessage(s,e,t=!1,r=!0,i=!1,n=-1){let o=null;if(n>-1?o=this.getRoomInstanceRenderingCanvas(this._activeRoomId,n):o=this.getActiveRoomInstanceRenderingCanvas(),!o)return null;i&&o.skipSpriteVisibilityChecking();let l=-1;!r&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(l=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const c=new mh,h=c.getFurniData(s,o,this,l),u=c.getRoomRenderingModifiers(this),g=c.getRoomPlanes(s,o,this,e);return i&&o.resumeSpriteVisibilityChecking(),xe.log(h,u,g),null}createTextureFromRoom(s,e=-1,t=null){let r=null;e>-1?r=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e):r=this.getActiveRoomInstanceRenderingCanvas();let i=null;return t?i=Lt.generateTexture(r.master,t):i=r.getDisplayAsTexture(),i}saveTextureAsScreenshot(s,e=!1){let t=null;e?t=new hf:t=new e_,t.assignBitmap(s),this._communication.connection.send(t)}saveBase64AsScreenshot(s,e=!1){let t=null;e?t=new hf:t=new e_,t.assignBase64(s),this._communication.connection.send(t)}objectsInitialized(s){const e=this.getRoomIdFromString(s);this.events.dispatchEvent(new lt(lt.OBJECTS_INITIALIZED,e))}getRoomId(s){return s.toString()}getRoomIdFromString(s){if(!s)return-1;const e=s.split("_");return e.length<=0?-1:parseInt(e[0])||0}getRoomObjectRoomId(s){return!s||!s.model?null:s.model.getValue(b.OBJECT_ROOM_ID)}getRoomObjectAdUrl(s){return this._roomContentLoader.getRoomObjectAdUrl(s)}getPetTypeId(s){let e=-1;if(s){const t=s.split(" ");t.length>1&&(e=parseInt(t[0]))}return e}getPetType(s){if(!s)return null;const e=s.split(" ");if(e.length>1){const t=parseInt(e[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(t):"pet"}return null}isRoomContentTypeLoaded(s){return this._roomContentLoader?this._roomContentLoader.getCollection(s)!==null:!1}getPetColorResult(s,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(s,e):null}getPetColorResultsForTag(s,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(s,e):null}deleteRoomObject(s,e){return!this._roomObjectEventHandler||e!==z.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,s)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(s){this._sessionDataManager=s}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(s){this._roomSessionManager=s}get roomManager(){return this._roomManager}set roomManager(s){this._roomManager=s}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const s=this._roomSessionManager.getSession(this._activeRoomId);return s&&s.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(s,e){return this._roomManager==null?0:this._roomManager.getRoomInstance(s.toString()).getRoomObjectsForCategory(e).length}get moveBlocked(){return this._moveBlocked}set moveBlocked(s){this._moveBlocked=s}get areaSelectionManager(){return this._areaSelectionManager}isAreaSelectionMode(){return this._areaSelectionManager.areaSelectionState!==Di.NOT_ACTIVE}whereYouClickIsWhereYouGo(){return!this.isAreaSelectionMode()}};let wi=rs;wi.ROOM_OBJECT_ID=-1;wi.ROOM_OBJECT_TYPE="room";wi.CURSOR_OBJECT_ID=-2;wi.CURSOR_OBJECT_TYPE="tile_cursor";wi.ARROW_OBJECT_ID=-3;wi.ARROW_OBJECT_TYPE="selection_arrow";wi.OVERLAY="overlay";wi.OBJECT_ICON_SPRITE="object_icon_sprite";wi.DRAG_THRESHOLD=15;wi.TEMPORARY_ROOM="temporary_room";const Fe=class{constructor(s,e=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=s,this._planeParser=new Ps,this._previewRoomId=Zn.makeRoomPreviewerId(e),this._addViewOffset=new it(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(ye.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(ye.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(lt.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(ye.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(ye.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(lt.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const e=new Ps;e.initializeTileMap(7+2,7+2);let t=1;for(;t<1+7;){let r=1;for(;r<1+7;)e.setTileHeight(r,t,0),r++;t++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(s){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,Fe.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,Fe.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,Fe.PREVIEW_OBJECT_ID),s||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=z.MINIMUM}updatePreviewModel(s,e,t=!0){const r=new Pp;r.flush(),r.parseModel(s,e,t);const i=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!i)return;this._planeParser.reset();const n=r.width,o=r.height;this._planeParser.initializeTileMap(n,o);const l=null;let c=-1,h=-1,u=0,g=0,m=0;for(;m<o;){let I=0;for(;I<n;){const O=r.getHeight(I,m);(m>0&&m<o-1||I>0&&I<n-1)&&O!=Ps.TILE_BLOCKED&&l==null&&(r.getHeight(I,m-1)==Ps.TILE_BLOCKED&&r.getHeight(I-1,m)==Ps.TILE_BLOCKED&&r.getHeight(I,m+1)==Ps.TILE_BLOCKED&&(c=I+.5,h=m,u=O,g=90),r.getHeight(I,m-1)==Ps.TILE_BLOCKED&&r.getHeight(I-1,m)==Ps.TILE_BLOCKED&&r.getHeight(I+1,m)==Ps.TILE_BLOCKED&&(c=I,h=m+.5,u=O,g=180)),this._planeParser.setTileHeight(I,m,O),I++}m++}this._planeParser.setTileHeight(Math.floor(c),Math.floor(h),u),this._planeParser.initializeFromTileData(r.wallHeight),this._planeParser.setTileHeight(Math.floor(c),Math.floor(h),u+this._planeParser.wallHeight),i.scale=Xc.DEFAULT_SCALE,i.initialize(n,o,this._planeParser.floorHeight);let p=r.height-1;for(;p>=0;){let I=r.width-1;for(;I>=0;)i.setHeight(I,p,this._planeParser.getTileHeight(I,p)),I--;p--}const f=this._planeParser.getMapData();f.doors.push({x:c,y:h,z:u,dir:g});const T=this.getRoomPreviewOwnRoomObject();T&&T.processUpdateMessage(new XE(f))}addFurnitureIntoRoom(s,e,t=null,r=null){if(t||(t=new ei),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=s,this._currentPreviewObjectCategory=z.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s,new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y,0),e,0,t,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=tt(),this._automaticStateChange=!0;const i=this._roomEngine.getRoomObject(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return i&&r&&i.model.setValue(b.FURNITURE_EXTRAS,r),this.updatePreviewRoomView(),Fe.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(s,e,t){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===z.WALL&&this._currentPreviewObjectType===s&&this._currentPreviewObjectData===t)return Fe.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=s,this._currentPreviewObjectCategory=z.WALL,this._currentPreviewObjectData=t,this._roomEngine.addFurnitureWall(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s,new G(.5,2.3,1.8),e,0,t,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=tt(),this._automaticStateChange=!0,this.updatePreviewRoomView(),Fe.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(s,e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=z.UNIT,this._currentPreviewObjectData=s,this._roomEngine.addRoomObjectUser(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y,0),new G(90,0,0),135,gt.getTypeNumber(gt.USER),s)&&(this._previousAutomaticStateChangeTime=tt(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(e),this.updateUserPosture("std")),this.updatePreviewRoomView(),Fe.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(s){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=z.UNIT,this._currentPreviewObjectData=s,this._roomEngine.addRoomObjectUser(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y,0),new G(90,0,0),90,gt.getTypeNumber(gt.PET),s)&&(this._previousAutomaticStateChangeTime=tt(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),Fe.PREVIEW_OBJECT_ID):-1}updateUserPosture(s,e=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s,e)}updateUserGesture(s){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s)}updateUserEffect(s){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s)}updateObjectUserFigure(s,e=null,t=null,r=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s,e,t,r):!1}updateObjectUserAction(s,e,t=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,s,e,t)}updateObjectStuffData(s){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,null,null,s.state,s)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==z.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomObject(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!s)return;const e=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(s,!0);switch(this._currentPreviewObjectCategory){case z.FLOOR:{const t=new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y),r=new G(e,e,e);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,t,r,null,null);return}case z.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const s=tt();s>this._previousAutomaticStateChangeTime+Fe.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=s,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(s,e){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,s,e,this._currentPreviewScale);if(t&&this._backgroundColor!==null){let i=this._backgroundSprite;i||(i=new ds(ys.WHITE),t.addChildAt(i,0)),i.width=s,i.height=e,i.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,!0);const r=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,Fe.PREVIEW_CANVAS_ID);return r&&r.adjustLocation(new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=s,this._currentPreviewCanvasHeight=e,t}return null}modifyRoomCanvas(s,e){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=s,this._currentPreviewCanvasHeight=e,this._backgroundSprite&&(this._backgroundSprite.width=s,this._backgroundSprite.height=e),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,s,e))}set addViewOffset(s){this._addViewOffset=s}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(s){const e=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,Fe.PREVIEW_CANVAS_ID);if(e&&s)if(e.x+=-(this._currentPreviewCanvasWidth>>1),e.y+=-(this._currentPreviewCanvasHeight>>1),e.x+=-s.x,e.y+=-s.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=e;else{const t=this._currentPreviewRectangle.clone().enlarge(e);(t.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||t.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=t)}}validatePreviewSize(s){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return s;if(this.isRoomEngineReady){const e=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,Fe.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+Fe.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+Fe.ALLOWED_IMAGE_CUT)?Fe.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,Fe.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=Fe.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,s.x=s.x>>1,s.y=s.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):e.isZoomedIn()&&(e.performZoomOut(),this._currentPreviewScale=Fe.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(Fe.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,Fe.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=Fe.SCALE_NORMAL):e.isZoomedIn()||(e.performZoomIn(),this._currentPreviewScale=Fe.SCALE_NORMAL))}return s}zoomIn(){this.isRoomEngineReady&&(Fe.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,Fe.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=Fe.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(Fe.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,Fe.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=Fe.SCALE_SMALL}updateAvatarDirection(s,e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y,0),new G(Fe.PREVIEW_OBJECT_LOCATION_X,Fe.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new G(s*45,0,0),e*45)}updateObjectRoom(s=null,e=null,t=null,r=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,s,e,t,r):!1}updateRoomWallsAndFloorVisibility(s,e=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,s,e)}getCanvasOffset(s){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return s;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,t=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const r=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;r>10?t=t+Math.min(15,r-10):this._currentPreviewObjectCategory!==z.UNIT?t=t+(5-Math.max(0,r/2)):t=t-(5-Math.min(0,r/2)),t=t+this._addViewOffset.y,e=e+this._addViewOffset.x;const i=e-s.x,n=t-s.y;if(i!==0||n!==0){const o=Math.sqrt(i*i+n*n);return o>10&&(e=s.x+i*10/o,t=s.y+n*10/o),new it(e,t)}return null}updatePreviewRoomView(s=!1){if(!(this._disableUpdate&&!s)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let e=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,Fe.PREVIEW_CANVAS_ID);if(e&&(this.updatePreviewObjectBoundingRectangle(e),this._currentPreviewRectangle)){const t=this._currentPreviewScale;e=this.validatePreviewSize(e);const r=this.getCanvasOffset(e);r&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,Fe.PREVIEW_CANVAS_ID,r),this._currentPreviewScale!==t&&(this._currentPreviewRectangle=null)}}}set disableUpdate(s){this._disableUpdate=s}set disableRoomEngineUpdate(s){this.isRoomEngineReady&&this._roomEngine.disableUpdate(s)}onRoomInitializedonRoomInitialized(s){if(s)switch(s.type){case lt.INITIALIZED:s.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(s){if(s.roomId===this._previewRoomId&&s.objectId===Fe.PREVIEW_OBJECT_ID&&s.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const e=this._roomEngine.getRoomObject(s.roomId,s.objectId,s.category);if(e&&e.model&&s.category===z.WALL){const t=e.model.getValue(b.FURNITURE_SIZE_Z),r=e.model.getValue(b.FURNITURE_CENTER_Z);(t!==null||r!==null)&&this._roomEngine.updateRoomObjectWallLocation(s.roomId,s.objectId,new G(.5,2.3,(3.6-t)/2+r))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const s=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,Fe.PREVIEW_CANVAS_ID);return s||null}getGenericRoomObjectImage(s,e,t,r,i,n=0,o=null,l=null,c=-1,h=-1,u=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(s,e,t,r,i,n,o,l,c,h,u):null}getRoomObjectImage(s,e,t,r=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,s,e,t,r):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomObject(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(s&&s.visualization)return s.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomObject(this._previewRoomId,Fe.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(s)return s}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomObject(this._previewRoomId,wi.ROOM_OBJECT_ID,z.ROOM);if(s)return s}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(s){this._backgroundColor=s}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};let Yr=Fe;Yr.SCALE_NORMAL=64;Yr.SCALE_SMALL=32;Yr.PREVIEW_COUNTER=0;Yr.PREVIEW_CANVAS_ID=1;Yr.PREVIEW_OBJECT_ID=1;Yr.PREVIEW_OBJECT_LOCATION_X=2;Yr.PREVIEW_OBJECT_LOCATION_Y=2;Yr.ALLOWED_IMAGE_CUT=.25;Yr.AUTOMATIC_STATE_CHANGE_INTERVAL=2500;Yr.ZOOM_ENABLED=!0;class oT{constructor(e,t){this._image=e,this._placeHolder=t}get image(){return this._image}get placeHolder(){return this._placeHolder}}class I6{constructor(e){this._code=e,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}const oi=class{constructor(e,t=0,r=0,i=0){this.type=e,this.key=t,this.color=r,this.position=i}get code(){return this.key===0?null:oi.getCode(this.type,this.key,this.color,this.position)}static getCode(e,t,r,i){return(e===oi.BASE?e:t>=100?oi.SYMBOL_ALT:oi.SYMBOL)+(t<10?"0":"")+(e===oi.BASE?t:t>=100?t-100:t)+(r<10?"0":"")+r+i}calculatePosition(e){const t=this.calculateGridPos(this.position);let r=oi.CELL_WIDTH*t.x+oi.CELL_WIDTH/2-e.width/2,i=oi.CELL_HEIGHT*t.y+oi.CELL_HEIGHT/2-e.height/2;return r<0&&(r=0),r+e.width>oi.IMAGE_WIDTH&&(r=oi.IMAGE_WIDTH-e.width),i<0&&(i=0),i+e.height>oi.IMAGE_HEIGHT&&(i=oi.IMAGE_HEIGHT-e.height),new vr(Math.floor(r),Math.floor(i))}calculateGridPos(e){const t=new vr;return t.x=Math.floor(e%3),t.y=Math.floor(e/3),t}};let ti=oi;ti.BASE="b";ti.SYMBOL="s";ti.SYMBOL_ALT="t";ti.BASE_PART=0;ti.LAYER_PART=1;ti.IMAGE_WIDTH=39;ti.IMAGE_HEIGHT=39;ti.CELL_WIDTH=13;ti.CELL_HEIGHT=13;const Ia=class{constructor(s,e){this._assets=s,this._sessionDataManager=e,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Jp(this.onGroupBadgePartsEvent.bind(this))];for(const s of this._messages)this._sessionDataManager.communication.registerMessageEvent(s)}}dispose(){if(this._messages&&this._messages.length){for(const s of this._messages)this._sessionDataManager.communication.removeMessageEvent(s);this._messages=null}this._sessionDataManager=null}getBadgeImage(s,e=Ia.NORMAL_BADGE,t=!0){let r=this.getBadgeTexture(s,e);return!r&&t&&(r=this.getBadgePlaceholder()),r}getBadgeInfo(s){const e=this.getBadgeTexture(s);return e?new oT(e,!1):new oT(this.getBadgePlaceholder(),!0)}loadBadgeImage(s,e=Ia.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(s,e))?s:(this.getBadgeTexture(s,e),null)}getBadgeTexture(s,e=Ia.NORMAL_BADGE){const t=this.getBadgeUrl(s,e);if(!t||!t.length)return null;const r=this._assets.getTexture(t);if(r)return r.clone();if(e===Ia.NORMAL_BADGE){if(this._requestedBadges.get(s))return null;this._requestedBadges.set(s,!0),this._assets.downloadAsset(t).then(i=>{if(!i)return;this._requestedBadges.delete(s);const n=this._assets.getTexture(t);n&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new mo(s,n.clone()))}).catch(i=>{})}else if(e===Ia.GROUP_BADGE){if(this._groupBadgesQueue.get(s))return;this._groupBadgesQueue.set(s,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(s)}return null}getBadgePlaceholder(){const s=Ke.getValue("images.url")+"/loading_icon.png",e=this._assets.getTexture(s);return e?e.clone():null}getBadgeUrl(s,e=Ia.NORMAL_BADGE){let t=null;switch(e){case Ia.NORMAL_BADGE:t=Ke.getValue("badge.asset.url").replace("%badgename%",s);break;case Ia.GROUP_BADGE:t=s;break}return t}loadGroupBadge(s){const e=new I6(s),t=[...s.matchAll(/[b|s][0-9]{4,6}/g)];for(const r of t){const i=r[0],n=i.length===6,o=i[0],l=parseInt(i.slice(1,n?3:4)),c=parseInt(i.slice(n?3:4,n?5:6)),h=i.length<6?0:parseInt(i.slice(n?5:6,n?6:7)),u=new ti(o,l,c,h);e.parts.push(u)}this.renderGroupBadge(e)}renderGroupBadge(s){const e=new Qi,t=new ds(dp.EMPTY);t.width=ti.IMAGE_WIDTH,t.height=ti.IMAGE_HEIGHT,e.addChild(t);for(const i of s.parts){let n=!0;const o=i.type==="b"?this._groupBases.get(i.key):this._groupSymbols.get(i.key);if(o)for(const l of o){if(!l||!l.length)continue;const c=this._assets.getTexture(`badgepart_${l}`);if(!c)continue;const{x:h,y:u}=i.calculatePosition(c),g=new ds(c);g.position.set(h,u),n&&(g.tint=parseInt(this._groupPartColors.get(i.color),16)),n=!1,e.addChild(g)}}this._requestedBadges.delete(s.code),this._groupBadgesQueue.delete(s.code);const r=Lt.generateTexture(e);this._assets.setTexture(s.code,r),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new mo(s.code,r))}onGroupBadgePartsEvent(s){if(!s)return;const e=s.getParser();if(e){e.bases.forEach((t,r)=>this._groupBases.set(r,t.map(i=>i.replace(".png","").replace(".gif","")))),e.symbols.forEach((t,r)=>this._groupSymbols.set(r,t.map(i=>i.replace(".png","").replace(".gif","")))),this._groupPartColors=e.partColors,this._readyToGenerateGroupBadges=!0;for(const t of this._groupBadgesQueue.keys())this.loadGroupBadge(t)}}get disposed(){return!!this._sessionDataManager}};let oc=Ia;oc.GROUP_BADGE="group_badge";oc.NORMAL_BADGE="normal_badge";class lT{constructor(e,t,r,i,n,o,l,c,h,u,g,m,p,f,T,I,O,A,N,P,y,D,x,w,k,F,L,B,V){this._type=e,this._id=t,this._fullName=r,this._className=i,this._category=n,this._revision=c,this._tileSizeX=h,this._tileSizeY=u,this._tileSizeZ=g,this._colors=m,this._hasIndexedColor=p,this._colourIndex=f,this._localizedName=o,this._description=l,this._adUrl=T,this._purchaseOfferId=I,this._purchaseCouldBeUsedForBuyout=O,this._rentOfferId=A,this._rentCouldBeUsedForBuyout=N,this._customParams=y,this._specialType=D,this._availableForBuildersClub=P,this._canStandOn=x,this._canSitOn=w,this._canLayOn=k,this._excludedFromDynamic=F,this._furniLine=L,this._environment=B,this._rare=V}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(e){this._className=e}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}const kf=class extends Ri{constructor(s,e,t){super(),this._floorItems=s,this._wallItems=e,this._localization=t}loadFurnitureData(s){s&&fetch(s).then(e=>e.json()).then(e=>this.onFurnitureDataLoaded(e)).catch(e=>this.onFurnitureDataError(e))}onFurnitureDataLoaded(s){s&&((typeof s.roomitemtypes>"u"||typeof s.wallitemtypes>"u")&&xe.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),s.roomitemtypes&&this.parseFloorItems(s.roomitemtypes),s.wallitemtypes&&this.parseWallItems(s.wallitemtypes),this.dispatchEvent(new ct(kf.FURNITURE_DATA_READY)))}onFurnitureDataError(s){s&&(xe.error(s),this.dispatchEvent(new ct(kf.FURNITURE_DATA_ERROR)))}parseFloorItems(s){if(!(!s||!s.furnitype))for(const e of s.furnitype){if(!e)continue;const t=[];if(e.partcolors)for(const c of e.partcolors.color){let h=c;h.charAt(0)==="#"&&(h=h.replace("#","")),t.push(parseInt(h,16))}const r=e.classname.split("*"),i=r[0],n=r.length>1?parseInt(r[1]):0,o=r.length>1,l=new lT(sl.FLOOR,e.id,e.classname,i,e.category,e.name,e.description,e.revision,e.xdim,e.ydim,0,t,o,n,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,e.customparams,e.specialtype,e.canstandon,e.cansiton,e.canlayon,e.excludeddynamic,e.furniline,e.environment,e.rare);this._floorItems.set(l.id,l),this.updateLocalizations(l)}}parseWallItems(s){if(!(!s||!s.furnitype))for(const e of s.furnitype){if(!e)continue;const t=new lT(sl.WALL,e.id,e.classname,e.classname,e.category,e.name,e.description,e.revision,0,0,0,null,!1,0,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,null,e.specialtype,!1,!1,!1,e.excludeddynamic,e.furniline,e.environment,e.rare);this._wallItems.set(t.id,t),this.updateLocalizations(t)}}updateLocalizations(s){if(this._localization)switch(s.type){case sl.FLOOR:this._localization.setValue("roomItem.name."+s.id,s.name),this._localization.setValue("roomItem.desc."+s.id,s.description);return;case sl.WALL:this._localization.setValue("wallItem.name."+s.id,s.name),this._localization.setValue("wallItem.desc."+s.id,s.description);return}}};let Cu=kf;Cu.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY";Cu.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";class T6{constructor(e){this._sessionDataManager=e,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Ic(this.onRoomReadyMessageEvent.bind(this)),new Fb(this.onGroupBadgesEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(e){this._sessionDataManager.send(new iP)}onGroupBadgesEvent(e){const t=e.getParser();for(const[r,i]of t.badges.entries())this._groupBadges.set(r,i)}getGroupBadge(e){return this._groupBadges.get(e)}get disposed(){return!!this._sessionDataManager}}class Lr{}Lr.NO_CLUB=0;Lr.CLUB=1;Lr.VIP=2;class xn extends Ti{constructor(e,t){super(),this._connection=e,this._listener=t,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(e){this._roomId=e}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class R6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new kd(this.onRoomGenericError.bind(this)))}onRoomGenericError(e){if(!(e instanceof kd))return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;let i=null;switch(t.errorCode){case mp.KICKED_OUT_OF_ROOM:i=ot.RSEME_KICKED;break;default:return}!i||i.length==0||this.listener.events.dispatchEvent(new ot(i,r))}}class S6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new IN(this.onOpenPetPackageRequested.bind(this))),e.addMessageEvent(new TN(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new ho(ho.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,r,t.objectId,t.figureData,0,null))}onOpenPetPackageResult(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new ho(ho.RSOPPE_OPEN_PET_PACKAGE_RESULT,r,t.objectId,null,t.nameValidationStatus,t.nameValidationInfo))}}class O6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new CN(this.onPollContentsEvent.bind(this))),e.addMessageEvent(new NN(this.onPollOfferEvent.bind(this))),e.addMessageEvent(new AN(this.onPollErrorEvent.bind(this))),e.addMessageEvent(new DN(this.onStartRoomPollEvent.bind(this))),e.addMessageEvent(new MN(this.onRoomPollResultEvent.bind(this)))}onPollContentsEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new qi(qi.CONTENT,t,r.id);i.startMessage=r.startMessage,i.endMessage=r.endMessage,i.numQuestions=r.numQuestions,i.questionArray=r.questionArray,i.npsPoll=r.npsPoll,this.listener.events.dispatchEvent(i)}onPollOfferEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new qi(qi.OFFER,t,r.id);i.summary=r.headline,i.summary=r.summary,this.listener.events.dispatchEvent(i)}onPollErrorEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t||!e.getParser())return;const i=new qi(qi.ERROR,t,-1);i.headline="???",i.summary="???",this.listener.events.dispatchEvent(i)}onStartRoomPollEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new ic(ic.VOTE_QUESTION,t,r.question,r.choices);this.listener.events.dispatchEvent(i)}onRoomPollResultEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new ic(ic.VOTE_RESULT,t,r.question,r.choices,r.SafeStr_7651,r.SafeStr_7654);this.listener.events.dispatchEvent(i)}}class C6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new cE(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new qd(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new Xd(this.onRoomUnitChatEvent.bind(this))),e.addMessageEvent(new cb(this.onRoomUnitHandItemReceivedEvent.bind(this))),e.addMessageEvent(new fE(this.onRespectReceivedEvent.bind(this))),e.addMessageEvent(new Wb(this.onPetRespectNoficationEvent.bind(this))),e.addMessageEvent(new jb(this.onPetSupplementedNotificationEvent.bind(this))),e.addMessageEvent(new ob(this.onFloodControlEvent.bind(this))),e.addMessageEvent(new lb(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;let i=at.CHAT_TYPE_SPEAK;e instanceof qd?i=at.CHAT_TYPE_SHOUT:e instanceof Xd&&(i=at.CHAT_TYPE_WHISPER);const n=new at(at.CHAT_EVENT,t,r.roomIndex,r.message,i,r.bubble);this.listener.events.dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();r&&this.listener.events.dispatchEvent(new at(at.CHAT_EVENT,t,r.giverUserId,"",at.CHAT_TYPE_HAND_ITEM_RECEIVED,Ca.GENERIC,null,r.handItemType))}onRespectReceivedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=t.userDataManager.getUserData(r.userId);i&&this.listener.events.dispatchEvent(new at(at.CHAT_EVENT,t,i.roomIndex,"",at.CHAT_TYPE_RESPECT,Ca.GENERIC))}onPetRespectNoficationEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=t.userDataManager.getPetData(r.petData.id);if(!i)return;let n=at.CHAT_TYPE_PETRESPECT;r.isTreat&&(n=at.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new at(at.CHAT_EVENT,t,i.roomIndex,"",n,Ca.GENERIC))}onPetSupplementedNotificationEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=t.userDataManager.getPetData(r.petId);if(!i)return;let n=-1;const o=t.userDataManager.getUserData(r.userId);o&&(n=o.roomIndex);let l=at.CHAT_TYPE_PETREVIVE;switch(r.supplementType){case Eo.REVIVE:l=at.CHAT_TYPE_PETREVIVE;break;case Eo.REBREED_FERTILIZER:l=at.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case Eo.SPEED_FERTILIZER:l=at.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new at(at.CHAT_EVENT,t,i.roomIndex,"",l,Ca.GENERIC,null,n))}onFloodControlEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=r.seconds;this.listener.events.dispatchEvent(new at(at.FLOOD_EVENT,t,-1,i.toString(),0,0))}onRemainingMuteEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();r&&this.listener.events.dispatchEvent(new at(at.CHAT_EVENT,t,t.ownRoomIndex,"",at.CHAT_TYPE_MUTE_REMAINING,Ca.GENERIC,null,r.seconds))}}class A6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new wa(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(e){if(!(e instanceof wa))return;const t=e.getParser();if(!t||t.roomForward)return;const r=this.listener.getSession(this.roomId);if(!r)return;const i=t.data;r.tradeMode=i.tradeMode,r.isGuildRoom=i.habboGroupId!==0,r.doorMode=i.doorMode,r.allowPets=i.allowPets,r.moderationSettings=t.moderation,this.listener.events.dispatchEvent(new Tm(Tm.RSDUE_ALLOW_PETS,r)),this.listener.events.dispatchEvent(new Ve(Ve.ROOM_DATA,r))}}class N6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new KN(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(e){if(!e)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;const i=new Ud(Ud.ROOM_DIMMER_PRESETS,r);i.selectedPresetId=t.selectedPresetId;let n=0;for(;n<t.presetCount;){const o=t.getPreset(n);o&&i.storePreset(o.id,o.type,o.color,o.brightness),n++}this.listener&&this.listener.events.dispatchEvent(i)}}class b6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new Gu(this.onRoomRightsEvent.bind(this))),e.addMessageEvent(new ku(this.onRoomRightsClearEvent.bind(this))),e.addMessageEvent(new Hd(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(e){if(!(e instanceof Gu))return;const t=this.listener.getSession(this.roomId);t&&t.setControllerLevel(e.getParser().controllerLevel)}onRoomRightsClearEvent(e){if(!(e instanceof ku))return;const t=this.listener.getSession(this.roomId);t&&t.setControllerLevel(Rt.NONE)}onRoomRightsOwnerEvent(e){if(!(e instanceof Hd))return;const t=this.listener.getSession(this.roomId);t&&t.setRoomOwner()}}class y6 extends xn{constructor(e,t){super(e,t),e&&e.addMessageEvent(new cA(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new xd(xd.RSPE_PRESENT_OPENED,r,t.classId,t.itemType,t.productCode,t.placedItemId,t.placedItemType,t.placedInRoom,t.petFigureString))}}const Iu=class extends xn{constructor(s,e){super(s,e),s.addMessageEvent(new Wd(this.onRoomEnterEvent.bind(this))),s.addMessageEvent(new Ic(this.onRoomReadyMessageEvent.bind(this))),s.addMessageEvent(new Fu(this.onDesktopViewEvent.bind(this))),s.addMessageEvent(new Vd(this.onRoomDoorbellAcceptedEvent.bind(this))),s.addMessageEvent(new Bd(this.onRoomDoorbellRejectedEvent.bind(this))),s.addMessageEvent(new ab(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(s){s instanceof Wd&&this.listener&&this.listener.sessionUpdate(this.roomId,Iu.RS_CONNECTED)}onRoomReadyMessageEvent(s){if(!(s instanceof Ic))return;const e=this.roomId,t=s.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(e,t),this.listener.sessionUpdate(this.roomId,Iu.RS_READY))}onDesktopViewEvent(s){s instanceof Fu&&this.listener&&this.listener.sessionUpdate(this.roomId,Iu.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(s){if(!(s instanceof Vd)||!this.listener)return;const e=s.getParser();if(!e)return;const t=e.userName;if(!t||!t.length)this.connection.send(new SD(this.roomId));else if(this.listener.events){const r=this.listener.getSession(this.roomId);if(!r)return;this.listener.events.dispatchEvent(new en(en.RSDE_ACCEPTED,r,t))}}onRoomDoorbellRejectedEvent(s){if(!(s instanceof Bd)||!this.listener)return;const e=s.getParser();if(!e)return;const t=e.userName;if(!t||!t.length)this.listener.sessionUpdate(this.roomId,Iu.RS_DISCONNECTED);else if(this.listener.events){const r=this.listener.getSession(this.roomId);if(!r)return;this.listener.events.dispatchEvent(new en(en.RSDE_REJECTED,r,t))}}onYouAreSpectatorMessageEvent(s){if(this.listener){const e=this.listener.getSession(this.roomId);if(!e)return;e.isSpectator=!0,this.listener.events.dispatchEvent(new Rm(Rm.SPECTATOR_MODE,e))}}};let al=Iu;al.RS_CONNECTED="RS_CONNECTED";al.RS_READY="RS_READY";al.RS_DISCONNECTED="RS_DISCONNECTED";class v6{constructor(){this._adultLevel=7}get id(){return this._id}set id(e){this._id=e}get level(){return this._level}set level(e){this._level=e}get maximumLevel(){return this._maximumLevel}set maximumLevel(e){this._maximumLevel=e}get experience(){return this._experience}set experience(e){this._experience=e}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(e){this._levelExperienceGoal=e}get energy(){return this._energy}set energy(e){this._energy=e}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(e){this._maximumEnergy=e}get happyness(){return this._happyness}set happyness(e){this._happyness=e}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(e){this._maximumHappyness=e}get ownerId(){return this._ownerId}set ownerId(e){this._ownerId=e}get ownerName(){return this._ownerName}set ownerName(e){this._ownerName=e}get respect(){return this._respect}set respect(e){this._respect=e}get age(){return this._age}set age(e){this._age=e}get unknownRarity(){return this._unknownRarity}set unknownRarity(e){this._unknownRarity=e}get saddle(){return this._saddle}set saddle(e){this._saddle=e}get rider(){return this._rider}set rider(e){this._rider=e}get skillTresholds(){return this._skillThresholds}set skillTresholds(e){this._skillThresholds=e}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(e){this._publiclyRideable=e}get breedable(){return this._breedable}set breedable(e){this._breedable=e}get fullyGrown(){return this._fullyGrown}set fullyGrown(e){this._fullyGrown=e}get dead(){return this._dead}set dead(e){this._dead=e}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._rarityLevel=e}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(e){this._maximumTimeToLive=e}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(e){this._remainingTimeToLive=e}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(e){this._remainingGrowTime=e}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(e){this._publiclyBreedable=e}get adultLevel(){return this._adultLevel}}class TL{constructor(e){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=e}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(e){this._activityPoints=e}get name(){return this._name}set name(e){this._name=e}get type(){return this._type}set type(e){this._type=e}get sex(){return this._sex}set sex(e){this._sex=e}get figure(){return this._figure}set figure(e){this._figure=e}get custom(){return this._custom}set custom(e){this._custom=e}get webID(){return this._webID}set webID(e){this._webID=e}get groupId(){return this._groupID}set groupId(e){this._groupID=e}get groupName(){return this._groupName}set groupName(e){this._groupName=e}get groupStatus(){return this._groupStatus}set groupStatus(e){this._groupStatus=e}get ownerId(){return this._ownerId}set ownerId(e){this._ownerId=e}get ownerName(){return this._ownerName}set ownerName(e){this._ownerName=e}get rarityLevel(){return this._rarityLevel}set rarityLevel(e){this._rarityLevel=e}get hasSaddle(){return this._hasSaddle}set hasSaddle(e){this._hasSaddle=e}get isRiding(){return this._isRiding}set isRiding(e){this._isRiding=e}get canBreed(){return this._canBreed}set canBreed(e){this._canBreed=e}get canHarvest(){return this._canHarvest}set canHarvest(e){this._canHarvest=e}get canRevive(){return this._canRevive}set canRevive(e){this._canRevive=e}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(e){this._hasBreedingPermission=e}get petLevel(){return this._petLevel}set petLevel(e){this._petLevel=e}get botSkills(){return this._botSkills}set botSkills(e){this._botSkills=e}get isModerator(){return this._isModerator}set isModerator(e){this._isModerator=e}}class M6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new $d(this.onRoomUnitEvent.bind(this))),e.addMessageEvent(new Jd(this.onRoomUnitInfoEvent.bind(this))),e.addMessageEvent(new Zd(this.onRoomUnitRemoveEvent.bind(this))),e.addMessageEvent(new Qd(this.onRoomUnitDanceEvent.bind(this))),e.addMessageEvent(new _E(this.onUserCurrentBadgesEvent.bind(this))),e.addMessageEvent(new iE(this.onRoomDoorbellEvent.bind(this))),e.addMessageEvent(new K_(this.onUserNameChangeMessageEvent.bind(this))),e.addMessageEvent(new Xp(this.onNewFriendRequestEvent.bind(this))),e.addMessageEvent(new eb(this.onPetInfoEvent.bind(this))),e.addMessageEvent(new tb(this.onPetStatusUpdateEvent.bind(this))),e.addMessageEvent(new fY(this.onPetBreedingMessageEvent.bind(this))),e.addMessageEvent(new RN(this.onPetLevelUpdateMessageEvent.bind(this))),e.addMessageEvent(new Bj(this.onConfirmBreedingResultEvent.bind(this))),e.addMessageEvent(new Vj(this.onNestBreedingSuccessEvent.bind(this))),e.addMessageEvent(new Gj(this.onConfirmBreedingRequestEvent.bind(this))),e.addMessageEvent(new Kd(this.onPetFigureUpdateEvent.bind(this))),e.addMessageEvent(new JN(this.onPetBreedingResultEvent.bind(this))),e.addMessageEvent(new fN(this.onPetPlacingError.bind(this))),e.addMessageEvent(new lN(this.onBotError.bind(this))),e.addMessageEvent(new kN(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser().users,i=[];if(r&&r.length)for(const n of r){if(!n)continue;const o=new TL(n.roomIndex);o.name=n.name,o.custom=n.custom,o.activityPoints=n.activityPoints,o.figure=n.figure,o.type=n.userType,o.webID=n.webID,o.groupId=n.groupID,o.groupName=n.groupName,o.groupStatus=n.groupStatus,o.sex=n.sex,o.ownerId=n.ownerId,o.ownerName=n.ownerName,o.rarityLevel=n.rarityLevel,o.hasSaddle=n.hasSaddle,o.isRiding=n.isRiding,o.canBreed=n.canBreed,o.canHarvest=n.canHarvest,o.canRevive=n.canRevive,o.hasBreedingPermission=n.hasBreedingPermission,o.petLevel=n.petLevel,o.botSkills=n.botSkills,o.isModerator=n.isModerator,t.userDataManager.getUserData(n.roomIndex)||i.push(o),t.userDataManager.updateUserData(o)}this.listener.events.dispatchEvent(new Np(t,i))}onRoomUnitInfoEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();r&&(t.userDataManager.updateFigure(r.unitId,r.figure,r.gender,!1,!1),t.userDataManager.updateMotto(r.unitId,r.motto),t.userDataManager.updateAchievementScore(r.unitId,r.achievementScore),this.listener.events.dispatchEvent(new bp(t,r.unitId,r.figure,r.gender,r.motto,r.achievementScore)))}onRoomUnitRemoveEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);t&&t.userDataManager.removeUserData(e.getParser().unitId)}onRoomUnitDanceEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new Rp(r,t.unitId,t.danceId))}onUserCurrentBadgesEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&(r.userDataManager.setUserBadges(t.userId,t.badges),this.listener.events.dispatchEvent(new Ap(r,t.userId,t.badges)))}onRoomDoorbellEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=t.userName;if(!r||!r.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new en(en.DOORBELL,i,r))}onUserNameChangeMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&r.userDataManager.updateName(t.id,t.newName)}onNewFriendRequestEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;const i=t.request;this.listener.events.dispatchEvent(new GS(r,i.requestId,i.requesterUserId,i.requesterName))}onPetInfoEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;const i=new v6;i.id=t.id,i.level=t.level,i.maximumLevel=t.maximumLevel,i.experience=t.experience,i.levelExperienceGoal=t.levelExperienceGoal,i.energy=t.energy,i.maximumEnergy=t.maximumEnergy,i.happyness=t.happyness,i.maximumHappyness=t.maximumHappyness,i.ownerId=t.ownerId,i.ownerName=t.ownerName,i.respect=t.respect,i.age=t.age,i.unknownRarity=t.unknownRarity,i.saddle=t.saddle,i.rider=t.rider,i.breedable=t.breedable,i.fullyGrown=t.fullyGrown,i.rarityLevel=t.rarityLevel,i.dead=t.dead,i.skillTresholds=t.skillTresholds,i.publiclyRideable=t.publiclyRideable,i.maximumTimeToLive=t.maximumTimeToLive,i.remainingTimeToLive=t.remainingTimeToLive,i.remainingGrowTime=t.remainingGrowTime,i.publiclyBreedable=t.publiclyBreedable,this.listener.events.dispatchEvent(new Op(r,i))}onPetStatusUpdateEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&(r.userDataManager.updatePetBreedingStatus(t.roomIndex,t.canBreed,t.canHarvest,t.canRevive,t.hasBreedingPermission),this.listener.events.dispatchEvent(new Cp(r,t.petId,t.canBreed,t.canHarvest,t.canRevive,t.hasBreedingPermission)))}onPetBreedingMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new WS(r,t.state,t.ownPetId,t.otherPetId))}onPetLevelUpdateMessageEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&(r.userDataManager.updatePetLevel(t.roomIndex,t.level),this.listener.events.dispatchEvent(new $S(r,t.petId,t.level)))}onConfirmBreedingResultEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new xS(r,t.breedingNestStuffId,t.result))}onNestBreedingSuccessEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new VS(r,t.petId,t.rarityCategory))}onConfirmBreedingRequestEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new LS(r,t.nestId,t.pet1,t.pet2,t.rarityCategories,t.resultPetType))}onPetFigureUpdateEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;const i=t.figureData.figuredata;r.userDataManager.updateFigure(t.roomIndex,i,"",t.hasSaddle,t.isRiding),this.listener.events.dispatchEvent(new qS(r,t.petId,i))}onPetBreedingResultEvent(e){if(!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);r&&this.listener.events.dispatchEvent(new YS(r,t.resultData,t.otherResultData))}onPetPlacingError(e){if(!e||!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;let i=null;switch(t.errorCode){case 0:i=ot.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:i=ot.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:i=ot.RSEME_MAX_PETS;break;case 3:i=ot.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:i=ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:i=ot.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!i||i.length==0||this.listener.events.dispatchEvent(new ot(i,r))}onBotError(e){if(!e||!this.listener)return;const t=e.getParser();if(!t)return;const r=this.listener.getSession(this.roomId);if(!r)return;let i=null;switch(t.errorCode){case 0:i=ot.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:i=ot.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:i=ot.RSEME_BOT_LIMIT_REACHED;break;case 3:i=ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:i=ot.RSEME_BOT_NAME_NOT_ACCEPTED;break}!i||i.length==0||this.listener.events.dispatchEvent(new ot(i,r))}onFavoriteMembershipUpdateMessageEvent(e){if(!this.listener)return;const t=e.getParser(),r=this.listener.getSession(this.roomId);if(!r)return;const i=r.userDataManager.getUserDataByIndex(t.roomIndex);i&&(i.groupId=t.groupId,i.groupName=t.groupName,this.listener.events.dispatchEvent(new Sp(r,t.roomIndex,t.groupId,t.status,t.groupName)))}}class D6 extends xn{constructor(e,t){super(e,t),e.addMessageEvent(new yN(this.onQuestionEvent.bind(this))),e.addMessageEvent(new bN(this.onQuestionAnsweredEvent.bind(this))),e.addMessageEvent(new vN(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new Xi(Xi.QUESTION,t,r.pollId);i.question=r.question,i.duration=r.duration,i.pollType=r.pollType,i.questionId=r.questionId,i.pollId=r.pollId,this.listener.events.dispatchEvent(i)}onQuestionAnsweredEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new Xi(Xi.ANSWERED,t,r.userId);i.value=r.value,i.userId=r.userId,i.answerCounts=r.answerCounts,this.listener.events.dispatchEvent(i)}onQuestionFinishedEvent(e){if(!this.listener)return;const t=this.listener.getSession(this.roomId);if(!t)return;const r=e.getParser();if(!r)return;const i=new Xi(Xi.FINISHED,t);i.questionId=r.questionId,i.answerCounts=r.answerCounts,this.listener.events.dispatchEvent(i)}}class P6{constructor(e){this._sessionDataManager=e,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new kb(this.onIgnoredUsersEvent.bind(this)),new mE(this.onIgnoreResultEvent.bind(this))];for(const e of this._messages)this._sessionDataManager.communication.registerMessageEvent(e)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const e of this._messages)this._sessionDataManager.communication.removeMessageEvent(e);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new $D(this._sessionDataManager.userName))}onIgnoredUsersEvent(e){if(!e)return;const t=e.getParser();t&&(this._ignoredUsers=t.ignoredUsers)}onIgnoreResultEvent(e){if(!e)return;const t=e.getParser();if(!t)return;const r=t.name;switch(t.result){case 0:return;case 1:this.addUserToIgnoreList(r);return;case 2:this.addUserToIgnoreList(r),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(r);return}}addUserToIgnoreList(e){this._ignoredUsers.indexOf(e)<0&&this._ignoredUsers.push(e)}removeUserFromIgnoreList(e){const t=this._ignoredUsers.indexOf(e);t>=0&&this._ignoredUsers.splice(t,1)}ignoreUserId(e){this._sessionDataManager.send(new eP(e))}ignoreUser(e){this._sessionDataManager.send(new ZD(e))}unignoreUser(e){this._sessionDataManager.send(new tP(e))}isIgnored(e){return this._ignoredUsers.indexOf(e)>=0}get disposed(){return!!this._sessionDataManager}}class L6{constructor(e,t,r){this._type=e,this._name=t,this._description=r}get type(){return this._type}get name(){return this._name}get description(){return this._description}}const Gf=class extends Ri{constructor(s){super(),this._products=s}dispose(){this._products=null}loadProductData(s){s&&fetch(s).then(e=>e.json()).then(e=>this.onProductDataLoadedEvent(e)).catch(e=>this.onProductDataError(e))}onProductDataLoadedEvent(s){s&&(this.parseProducts(s.productdata),this.dispatchEvent(new ct(Gf.PDP_PRODUCT_DATA_READY)))}onProductDataError(s){s&&this.dispatchEvent(new ct(Gf.PDP_PRODUCT_DATA_FAILED))}parseProducts(s){if(s)for(const e of s.product)e&&this._products.set(e.code,new L6(e.code,e.name,e.description))}};let Au=Gf;Au.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY";Au.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";const Tu=class extends Ti{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(s){this._connection=s}getUserData(s){return this.getDataByType(s,Tu.TYPE_USER)}getPetData(s){return this.getDataByType(s,Tu.TYPE_PET)}getBotData(s){return this.getDataByType(s,Tu.TYPE_BOT)}getRentableBotData(s){return this.getDataByType(s,Tu.TYPE_RENTABLE_BOT)}getDataByType(s,e){const t=this._userDataByType.get(e);if(!t)return null;const r=t.get(s);return r||null}getUserDataByIndex(s){const e=this._userDataByRoomIndex.get(s);return e||null}getUserDataByName(s){for(const e of this._userDataByRoomIndex.values())if(!(!e||e.name!==s))return e;return null}updateUserData(s){if(!s)return;this.removeUserData(s.roomIndex);let e=this._userDataByType.get(s.type);e||(e=new Map,this._userDataByType.set(s.type,e)),e.set(s.webID,s),this._userDataByRoomIndex.set(s.roomIndex,s)}removeUserData(s){const e=this.getUserDataByIndex(s);if(!e)return;this._userDataByRoomIndex.delete(s);const t=this._userDataByType.get(e.type);t&&t.delete(e.webID)}getUserBadges(s){this._connection&&this._connection.send(new UE(s));const e=this._userBadges.get(s);return e||[]}setUserBadges(s,e){this._userBadges.set(s,e)}updateFigure(s,e,t,r,i){const n=this.getUserDataByIndex(s);n&&(n.figure=e,n.sex=t,n.hasSaddle=r,n.isRiding=i)}updateName(s,e){const t=this.getUserDataByIndex(s);t&&(t.name=e)}updateMotto(s,e){const t=this.getUserDataByIndex(s);t&&(t.custom=e)}updateAchievementScore(s,e){const t=this.getUserDataByIndex(s);t&&(t.activityPoints=e)}updatePetLevel(s,e){const t=this.getUserDataByIndex(s);t&&(t.petLevel=e)}updatePetBreedingStatus(s,e,t,r,i){const n=this.getUserDataByIndex(s);n&&(n.canBreed=e,n.canHarvest=t,n.canRevive=r,n.hasBreedingPermission=i)}requestPetInfo(s){!this._connection||!this.getPetData(s)||this._connection.send(new fM(s))}get connection(){return this._connection}};let fh=Tu;fh.TYPE_USER=1;fh.TYPE_PET=2;fh.TYPE_BOT=3;fh.TYPE_RENTABLE_BOT=4;class U6 extends Ti{constructor(){super(),this._connection=null,this._userData=new fh,this._roomId=0,this._password=null,this._state=Ve.CREATED,this._tradeMode=cl.NO_TRADING,this._doorMode=0,this._controllerLevel=Rt.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(e){this._connection||!e||(this._connection=e,this._userData&&this._userData.setConnection(e))}setControllerLevel(e){if(e>=Rt.NONE&&e<=Rt.MODERATOR){this._controllerLevel=e;return}this._controllerLevel=Rt.NONE}setOwnRoomIndex(e){this._ownRoomIndex=e}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==Ve.CREATED||!this._connection?!1:(this._state=Ve.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new NM(this._roomId,this._password)),!0):!1}reset(e){e!==this._roomId&&(this._roomId=e)}sendChatMessage(e,t){this._connection.send(new ME(e,t))}sendShoutMessage(e,t){this._connection.send(new OD(e,t))}sendWhisperMessage(e,t,r){this._connection.send(new AD(e,t,r))}sendChatTypingMessage(e){e?this._connection.send(new ND):this._connection.send(new bD)}sendMottoMessage(e){this._connection.send(new sP(e))}sendDanceMessage(e){this._connection.send(new vD(e))}sendExpressionMessage(e){this._connection.send(new yD(e))}sendSignMessage(e){e<0||e>17||this._connection.send(new UD(e))}sendPostureMessage(e){this._connection.send(new LD(e))}sendDoorbellApprovalMessage(e,t){this._connection.send(new AM(e,t))}sendAmbassadorAlertMessage(e){this._connection.send(new yM(e))}sendKickMessage(e){this._connection.send(new PM(e))}sendMuteMessage(e,t){this._connection.send(new LM(e,t,this._roomId))}sendBanMessage(e,t){this._connection.send(new vM(e,this._roomId,t))}sendGiveRightsMessage(e){this._connection.send(new DM(e))}sendTakeRightsMessage(e){this._connection.send(new OE(e))}sendPollStartMessage(e){this._connection.send(new SM(e))}sendPollRejectMessage(e){this._connection.send(new RM(e))}sendPollAnswerMessage(e,t,r){this._connection.send(new TM(e,t,r))}sendPeerUsersClassificationMessage(e){this._connection.send(new dP(e))}sendOpenPetPackageMessage(e,t){this._connection.send(new yE(e,t))}sendRoomUsersClassificationMessage(e){this._connection.send(new _P(e))}updateMoodlightData(e,t,r,i,n){let o="000000"+r.toString(16).toUpperCase();o="#"+o.substring(o.length-6),this.connection.send(new JM(e,t,o,i,n))}toggleMoodlightState(){this.connection.send(new ZM)}pickupPet(e){this._connection&&this._connection.send(new zM(e))}pickupBot(e){this._connection&&this._connection.send(new $_(e))}requestMoodlightSettings(){this._connection&&this._connection.send(new $M)}openGift(e){this._connection.send(new gD(e))}mountPet(e){this._connection.send(new Tf(e,!0))}dismountPet(e){this._connection.send(new Tf(e,!1))}usePetProduct(e,t){this._connection.send(new IM(e,t))}removePetSaddle(e){this._connection.send(new mM(e))}togglePetBreeding(e){this._connection.send(new pM(e))}togglePetRiding(e){this._connection.send(new EM(e))}useMultistateItem(e){this._connection.send(new Sc(e))}harvestPet(e){this._connection.send(new WM(e))}compostPlant(e){this._connection.send(new VM(e))}requestPetCommands(e){this._connection.send(new gM(e))}sendScriptProceed(){this._connection.send(new _M)}sendUpdateClothingChangeFurniture(e,t,r){this._connection.send(new qM(e,t,r))}changeQueue(e){this._connection.send(new RD(e))}votePoll(e){this._connection.send(new OM(e))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(e){this._roomId=e}get password(){return this._password}set password(e){this._password=e}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(e){this._tradeMode=e}get doorMode(){return this._doorMode}set doorMode(e){this._doorMode=e}get allowPets(){return this._allowPets}set allowPets(e){this._allowPets=e}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(e){this._isGuildRoom=e}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(e){this._isDecorating=e}get isSpectator(){return this._isSpectator}set isSpectator(e){this._isSpectator=e}get moderationSettings(){return this._moderationSettings}set moderationSettings(e){this._moderationSettings=e}}class x6 extends aa{constructor(e,t){super(),this._communication=e,this._roomEngine=t,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(lt.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(lt.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const e=this._communication&&this._communication.connection;e&&this._handlers.push(new C6(e,this),new A6(e,this),new N6(e,this),new b6(e,this),new al(e,this),new M6(e,this),new y6(e,this),new R6(e,this),new D6(e,this),new O6(e,this),new S6(e,this))}setHandlers(e){if(!(!this._handlers||!this._handlers.length))for(const t of this._handlers)t&&t.setRoomId(e.roomId)}onRoomEngineEvent(e){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(e){const t=this._sessions.get(this.getRoomId(e));return t||null}createSession(e,t=null){const r=new U6;return r.roomId=e,r.password=t,this.addSession(r)}addSession(e){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(e.roomId))&&this.removeSession(e.roomId,!1),e.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(e.roomId),e),this.events.dispatchEvent(new Ve(Ve.CREATED,e)),this._viewerSession=e,this.startSession(this._viewerSession),!0):(this._pendingSession=e,!1)}startSession(e){return e.state===Ve.STARTED?!1:(this._sessionStarting=!1,e.start()?(this.events.dispatchEvent(new Ve(Ve.STARTED,e)),this.setHandlers(e),!0):(this.removeSession(e.roomId),!1))}removeSession(e,t=!0){const r=this.getSession(e);r&&(this._sessions.delete(this.getRoomId(e)),this.events.dispatchEvent(new Ve(Ve.ENDED,r,t)),r.dispose())}sessionUpdate(e,t){if(this.getSession(e))switch(t){case al.RS_CONNECTED:return;case al.RS_READY:return;case al.RS_DISCONNECTED:this.removeSession(e);return}}sessionReinitialize(e,t){const r=this.getSession(e);r&&(this._sessions.delete(this.getRoomId(e)),r.reset(t),this._sessions.set(this.getRoomId(t),r),this.setHandlers(r))}getRoomId(e){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}const RL=class{static logEventLog(s){try{It.available&&It.call("logEventLog",s)}catch{xe.log("External interface not working, failed to log event log.")}}static openPage(s){try{It.available&&It.call("openPage",s)}catch{xe.log("Failed to open web page",s)}}static openWebPage(s){window.open(s)}static sendHeartBeat(){try{It.available&&It.call("heartBeat")}catch{xe.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(s){try{It.available&&RL.openPage(s)}catch{xe.log("Failed to open web page",s)}}static closeWebPageAndRestoreClient(){try{It.available&&It.call("closeWebPageAndRestoreClient")}catch{xe.log("Failed to close web page and restore client!")}}static openHabblet(s,e=null){try{It.available&&It.call("openHabblet",s,e)}catch{xe.log("Failed to open Habblet",s)}}static closeHabblet(s,e=null){try{It.available&&It.call("closeHabblet",s,e)}catch{xe.log("Failed to close Habblet",s)}}static send(s,e){try{It.available&&It.call("disconnect",s,e)}catch{xe.log("Failed to close send ")}}static showGame(s){try{It.available&&It.callGame("showGame",s)}catch(e){xe.log("Failed to open game",e)}}static hideGame(){try{It.available&&It.callGame("hideGame")}catch{xe.log("Failed to hide game")}}static open(s){try{It.available&&It.call("openExternalLink",escape(s))}catch{xe.log("External interface not working. Could not request to open: "+s)}}static roomVisited(s){try{It.available&&It.call("roomVisited",s)}catch{xe.log("External interface not working. Could not store last room visit.")}}static openMinimail(s){try{It.available&&It.call("openMinimail",s)}catch{xe.log("External interface not working. Could not open minimail.")}}static openNews(){try{It.available&&It.call("openNews")}catch{xe.log("External interface not working. Could not open news.")}}static closeNews(){try{It.available&&It.call("closeNews")}catch{xe.log("External interface not working. Could not close news.")}}static openAvatars(){try{It.available&&It.call("openAvatars")}catch{xe.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{It.available&&It.call("openRoomEnterAd")}catch{xe.log("External interface not working. Could not open roomenterad.")}}static updateFigure(s){try{It.available&&It.call("updateFigure",s)}catch{xe.log("External interface not working. Could not update figure.")}}};let an=RL;an.ADVERTISEMENT="advertisement";an.OPENLINK="openlink";an.OPENROOM="openroom";class w6 extends aa{constructor(e){super(),this._communication=e,this.resetUserInfo(),this._ignoredUsersManager=new P6(this),this._groupInformationManager=new T6(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new zp(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new Tc(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new hE(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new FO(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new SN(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new Mn(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new K_(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Lb(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new Ic(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new Gb(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new qA(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new VC(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new Mb(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Ub(this.onEmailStatus.bind(this))),ke.instance.events.addEventListener(ul.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),ke.instance.events.removeEventListener(ul.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new Cu(this._floorItems,this._wallItems,ke.instance.localization),this._furnitureData.addEventListener(Cu.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(Ke.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new Au(this._products),this._productData.addEventListener(Au.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(Ke.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new oc(di(),this),this._badgeImageManager.init())}hasProductData(e){return this._productsReady?!0:(e&&this._pendingProductListeners.indexOf(e)===-1&&this._pendingProductListeners.push(e),!1)}getAllFurnitureData(e){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(e)===-1&&this._pendingFurnitureListeners.push(e),null;const t=[];for(const r of this._floorItems.values())r&&t.push(r);for(const r of this._wallItems.values())r&&t.push(r);return t}removePendingFurniDataListener(e){if(!this._pendingFurnitureListeners)return;const t=this._pendingFurnitureListeners.indexOf(e);t!==-1&&this._pendingFurnitureListeners.splice(t,1)}onUserFigureEvent(e){!e||!e.connection||(this._figure=e.getParser().figure,this._gender=e.getParser().gender,an.updateFigure(this._figure))}onUserInfoEvent(e){if(!e||!e.connection)return;this.resetUserInfo();const t=e.getParser().userInfo;t&&(this._userId=t.userId,this._name=t.username,this._figure=t.figure,this._gender=t.gender,this._realName=t.realName,this._respectsReceived=t.respectsReceived,this._respectsLeft=t.respectsRemaining,this._respectsPetLeft=t.respectsPetRemaining,this._canChangeName=t.canChangeName,this._safetyLocked=t.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(e){!e||!e.connection||(this._clubLevel=e.getParser().clubLevel,this._securityLevel=e.getParser().securityLevel,this._isAmbassador=e.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&(this._systemOpen=t.isOpen,this._systemShutdown=t.onShutdown,this._isAuthenticHabbo=t.isAuthenticUser)}onPetRespectFailed(e){!e||!e.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&t.resultCode===Mn.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new Sm(t.name)))}onUserNameChangeMessageEvent(e){if(!e||!e.connection)return;const t=e.getParser();t&&t.webId===this.userId&&(this._name=t.newName,this._canChangeName=!1,this.events.dispatchEvent(new Sm(this._name)))}onUserTags(e){if(!e||!e.connection)return;const t=e.getParser();t&&(this._tags=t.tags)}onRoomModelNameEvent(e){if(!e)return;const t=e.getParser();t&&an.roomVisited(t.roomId)}onFurnitureDataReadyEvent(e){if(this._furnitureData.removeEventListener(Cu.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const t of this._pendingFurnitureListeners)t&&t.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(e){this._productData.removeEventListener(Au.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const t of this._pendingProductListeners)t&&t.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(e){if(!e)return;const t=e.getParser();t&&ke.instance.createLinkEvent(t.link)}onMysteryBoxKeysEvent(e){if(!e)return;const t=e.getParser();t&&this.events.dispatchEvent(new Tp(t.boxColor,t.keyColor))}onNoobnessLevelMessageEvent(e){this._noobnessLevel=e.getParser().noobnessLevel,this._noobnessLevel!==hc.OLD_IDENTITY&&Ke.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(e){if(!e)return;const t=e.getParser();t&&(this._safetyLocked=t.status==L_.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(e){if(!e)return;const t=e.getParser();t&&(this._isEmailVerified=t.isVerified)}onNitroSettingsEvent(e){this._isRoomCameraFollowDisabled=e.cameraFollow,this._uiFlags=e.flags,this.events.dispatchEvent(new nO(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(e){const t=this._floorItems.get(e);return t||null}getFloorItemDataByName(e){if(!e||!this._floorItems||!this._floorItems.size)return null;for(const t of this._floorItems.values())if(!(!t||t.className!==e))return t}getWallItemData(e){const t=this._wallItems.get(e);return t||null}getWallItemDataByName(e){if(!e||!this._wallItems||!this._wallItems.size)return null;for(const t of this._wallItems.values())if(!(!t||t.className!==e))return t}getProductData(e){return this._productsReady||this.loadProductData(),this._products.get(e)}getBadgeUrl(e){return this._badgeImageManager.getBadgeUrl(e)}getGroupBadgeUrl(e){return this._badgeImageManager.getBadgeUrl(e,oc.GROUP_BADGE)}getBadgeImage(e){return this._badgeImageManager.getBadgeImage(e)}getGroupBadgeImage(e){return this._badgeImageManager.getBadgeImage(e,oc.GROUP_BADGE)}getUserTags(e){e<0||this.send(new JD(e))}loadBadgeImage(e){return this._badgeImageManager.loadBadgeImage(e)}loadGroupBadgeImage(e){return this._badgeImageManager.loadBadgeImage(e,oc.GROUP_BADGE)}hasSecurity(e){return this._securityLevel>=e}giveRespect(e){e<0||this._respectsLeft<=0||(this.send(new hP(e)),this._respectsLeft--)}givePetRespect(e){e<0||this._respectsPetLeft<=0||(this.send(new Q_(e)),this._respectsPetLeft--)}sendSpecialCommandMessage(e,t=0){this.send(new ME(e))}ignoreUser(e){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(e)}unignoreUser(e){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(e)}isUserIgnored(e){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(e)}getGroupBadge(e){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(e)}send(e){this._communication.connection.send(e)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==hc.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===hc.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=ii.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}class SL extends j_{constructor(e,t,r,i,n=""){super(e,t,r,i),this._jukeboxDiskId=-1,this._songData=n}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(e){this._songData=e}get diskId(){return this._jukeboxDiskId}set diskId(e){this._jukeboxDiskId=e}}class F6{constructor(e,t,r,i,n){this._songId=e,this._startPos=t,this._playLength=r,this._fadeInSeconds=i,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}const OL=class extends ct{constructor(s,e){super(OL.NOTIFY_PLAYED_SONG),this._name=s,this._creator=e}get name(){return this._name}get creator(){return this._creator}};let aI=OL;aI.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";class An extends ct{constructor(e,t,r,i){super(e),this._id=r,this._position=i,this._priority=t}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}}An.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG";An.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG";An.NPE_SONG_CHANGED="NPE_SONG_CHANGED";class Xn extends ct{constructor(e){super(e)}}Xn.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED";Xn.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";class lc extends ct{constructor(e){super(e)}}lc.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";class Nc extends ct{constructor(e,t){super(e),this._id=t}get id(){return this._id}}Nc.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";class Hu extends ct{constructor(e,t){super(e),this._id=t}get id(){return this._id}}Hu.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";class er{}er.PRIORITY_ROOM_PLAYLIST=0;er.PRIORITY_USER_PLAYLIST=1;er.PRIORITY_SONG_PLAY=2;er.PRIORITY_PURCHASE_PREVIEW=3;er.PRIORITY_COUNT=4;class k6{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new Nb(this.onNowPlayingMessageEvent.bind(this)),new Ab(this.onJukeboxSongDisksMessageEvent.bind(this)),new Cb(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(e=>ke.instance.communication.connection.addMessageEvent(e)),ke.instance.soundManager.events.addEventListener(Nc.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return er.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(e){const t=e.getParser();this._isPlaying=t.currentSongId!==-1,t.currentSongId>=0?(ke.instance.soundManager.musicController.playSong(t.currentSongId,er.PRIORITY_ROOM_PLAYLIST,t.syncCount/1e3,0,1,1),this._currentEntryId=t.currentSongId):this.stopPlaying(),t.nextSongId>=0&&ke.instance.soundManager.musicController.addSongInfoRequest(t.nextSongId),this._playPosition=t.currentPosition,ke.instance.soundManager.events.dispatchEvent(new An(An.NPE_SONG_CHANGED,er.PRIORITY_ROOM_PLAYLIST,t.currentSongId,t.currentPosition))}onJukeboxSongDisksMessageEvent(e){const t=e.getParser();this._entries=[];for(let r=0;r<t.songDisks.length;r++){const i=t.songDisks.getWithIndex(r),n=t.songDisks.getKey(r);let o=ke.instance.soundManager.musicController.getSongInfo(i);o==null&&(o=new SL(i,-1,null,null,null),this._missingSongInfo.indexOf(i)<0&&(this._missingSongInfo.push(i),ke.instance.soundManager.musicController.requestSongInfoWithoutSamples(i))),o.diskId=n,this._entries.push(o)}this._missingSongInfo.length==0&&ke.instance.soundManager.events.dispatchEvent(new Xn(Xn.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(e){ke.instance.soundManager.events.dispatchEvent(new Xn(Xn.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(e){for(let r=0;r<this.length;r++){const i=this._entries[r];if(i.id===e.id){const n=i.diskId,o=ke.instance.soundManager.musicController.getSongInfo(e.id);o!=null&&(o.diskId=n,this._entries[r]=o);break}}const t=this._missingSongInfo.indexOf(e.id);t>=0&&this._missingSongInfo.splice(t,1),this._missingSongInfo.length==0&&ke.instance.soundManager.events.dispatchEvent(new Xn(Xn.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){ke.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(e){return e<0||e>=this._entries.length?null:this._entries[e]}requestPlayList(){ke.instance.communication.connection.send(new jD)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),ke.instance.soundManager.events&&ke.instance.soundManager.events.removeEventListener(Nc.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(e=>ke.instance.communication.connection.removeMessageEvent(e)),this._messageEvents=null)}}class G6{constructor(e){this._id=e,this._items=[]}addChannelItem(e){this._items.push(e)}get items(){return this._items}}class B6{constructor(e,t){this._id=e,this._length=t}get id(){return this._id}get length(){return this._length}}class Bf{constructor(e){this._channels=[],this._metaData=new Map;let t=[];const r=e.split(":"),i=r[r.length-1];if(i.indexOf("meta")>-1){const n=i.split(";");for(const o of n){const l=o.split(",");this._metaData.set(l[0],l[1])}t=r.slice(0,r.length-1)}else t=r;for(let n=0;n<t.length/2;n++)if(t[n*2].length>0){const o=parseInt(t[n*2]),l=t[n*2+1].split(";"),c=new G6(o);for(const h of l){const u=h.split(",");if(u.length!==2)return;c.addChannelItem(new B6(parseInt(u[0]),parseInt(u[1])))}this._channels.push(c)}}get channels(){return this._channels}getSampleIds(){const e=[];for(const t of this._channels)for(const r of t.items)e.indexOf(r.id)===-1&&e.push(r.id);return e}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const e=this._metaData.get("t");return e?parseInt(e):null}}class V6{constructor(e){this._sampleUrl=e,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(e,t,r=0,i=-1){this.reset(),this._currentSong=new Bf(e),this._startPos=Math.trunc(r),this._playLength=i,this._currentPos=this._startPos,this._currentSongId=t,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),Dl.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,Dl.Howler.stop()}resume(){this._isPlaying=!0}stop(){const e=this._currentSongId;this.reset(),ke.instance.soundManager.events.dispatchEvent(new Hu(Hu.TRAX_SONG_COMPLETE,e))}setVolume(e){Dl.Howler.volume(e)}getVolume(){return Dl.Howler.volume()}async getSample(e){let t=this._cache.get(e);return t||(t=await this.loadSong(e)),Promise.resolve(t)}async preload(){if(this._sequence=[],!!this._currentSong){for(const e of this._currentSong.channels){const t=[];for(const r of e.items){const i=await this.getSample(r.id),n=Math.ceil(r.length*2/Math.ceil(i.duration()));for(let o=0;o<n;o++)for(let l=0;l<Math.ceil(i.duration());l++)t.push({sampleId:r.id,offset:l})}this._sequence.push(t)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(e=>e.length)))}}async preloadSamplesForSong(e){const t=new Bf(e);await Promise.all(t.getSampleIds().map(r=>this.getSample(r)))}async loadSong(e){return new Promise((t,r)=>{const i=new Dl.Howl({src:[this._sampleUrl.replace("%sample%",e.toString())],preload:!0});i.once("load",()=>{this._cache.set(e,i),t(i)}),i.once("loaderror",()=>{xe.error("failed to load sample "+e),r("failed to load sample "+e)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(e){if(!(!this._currentSong||!this._sequence)&&Dl.Howler._audioUnlocked)for(const t of this._sequence){const r=t[e];if(!r||r.sampleId===-1||r.sampleId===0)continue;const i=this._cache.get(r.sampleId);i&&(r.offset===0?i.play():i.playing()||(i.seek(r.offset),i.play()))}}}const Od=class{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new As,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new yb(this.onTraxSongInfoMessageEvent.bind(this)),new vb(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new V6(ke.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(s=>ke.instance.communication.connection.addMessageEvent(s)),ke.instance.roomEngine.events.addEventListener(Jt.JUKEBOX_INIT,this.onJukeboxInit),ke.instance.roomEngine.events.addEventListener(Jt.JUKEBOX_DISPOSE,this.onJukeboxDispose),ke.instance.roomEngine.events.addEventListener(Jt.SOUND_MACHINE_INIT,this.onSoundMachineInit),ke.instance.roomEngine.events.addEventListener(Jt.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),ke.instance.soundManager.events.addEventListener(Hu.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(s){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(s){return s>=0&&s<this._songDiskInventory.length?this._songDiskInventory.getKey(s):-1}getSongDiskInventorySongId(s){return s>=0&&s<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(s):-1}getSongInfo(s){const e=this.getSongDataEntry(s);return e||this.requestSongInfoWithoutSamples(s),e}getSongIdPlayingAtPriority(s){return s!==this._priorityPlaying?-1:this._songIdPlaying}stop(s){const e=s===this._priorityPlaying,t=this.getTopRequestPriority()===s;e?(this.resetSongStartRequest(s),this.stopSongAtPriority(s)):(this.resetSongStartRequest(s),t&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(s){this.requestSong(s,!0)}requestSongInfoWithoutSamples(s){this.requestSong(s,!1)}requestUserSongDisks(){ke.instance.communication.connection.send(new qD)}updateVolume(s){this._musicPlayer.setVolume(s)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(s=>ke.instance.communication.connection.removeMessageEvent(s)),ke.instance.roomEngine.events.removeEventListener(Jt.JUKEBOX_INIT,this.onJukeboxInit),ke.instance.roomEngine.events.removeEventListener(Jt.JUKEBOX_DISPOSE,this.onJukeboxDispose),ke.instance.roomEngine.events.removeEventListener(Jt.SOUND_MACHINE_INIT,this.onSoundMachineInit),ke.instance.roomEngine.events.removeEventListener(Jt.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),ke.instance.soundManager.events.removeEventListener(Hu.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let s,e,t=[];for(let r=0;r<this._songRequestsPerPriority.length;r++)if(this._songRequestsPerPriority[r]&&(s=this._songRequestsPerPriority[r],e=this._availableSongs.get(s.songId),e)){const i=e.songData;if(i.length>0){const n=new Bf(i);t=t.concat(n.getSampleIds())}}return t}onSongLoaded(s){const e=this.getTopRequestPriority();if(e>=0){const t=this.getSongIdRequestedAtPriority(e);s===t&&this.playSongObject(e,s)}}samplesUnloaded(s){throw new Error("Method not implemented.")}onTraxSongComplete(s){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===s.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const e=this._priorityPlaying;this.playSongWithHighestPriority(),e>=er.PRIORITY_SONG_PLAY&&ke.instance.soundManager.events.dispatchEvent(new An(An.NPW_USER_STOP_SONG,e,s.id,-1))}}onTraxSongInfoMessageEvent(s){const e=s.getParser();for(const t of e.songs){const r=!!this.getSongDataEntry(t.id);if(this.areSamplesRequested(t.id),!r){const i=new SL(t.id,t.length,t.name,t.creator,t.data);this._availableSongs.set(t.id,i);const n=this.getTopRequestPriority(),o=this.getSongIdRequestedAtPriority(n);for(t.id===o&&this.playSongObject(n,o),ke.instance.soundManager.events.dispatchEvent(new Nc(Nc.SIR_TRAX_SONG_INFO_RECEIVED,t.id));this._diskInventoryMissingData.indexOf(t.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(t.id),1),this._diskInventoryMissingData.length===0&&ke.instance.soundManager.events.dispatchEvent(new lc(lc.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(s){const e=s.getParser();this._songDiskInventory.reset();for(let t=0;t<e.songDiskCount;t++){const r=e.getDiskId(t),i=e.getSongId(t);this._songDiskInventory.add(r,i),this._availableSongs.get(i)||(this._diskInventoryMissingData.push(i),this.requestSongInfoWithoutSamples(i))}this._diskInventoryMissingData.length===0&&ke.instance.soundManager.events.dispatchEvent(new lc(lc.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(ke.instance.communication.connection.send(new KD(...this._songRequestList)),this._songRequestList=[])}requestSong(s,e){this._requestedSongs.get(s)===void 0&&(this._requestedSongs.set(s,e),this._songRequestList.push(s))}areSamplesRequested(s){return this._requestedSongs.get(s)?this._requestedSongs.get(s):!1}processSongEntryForPlaying(s,e=!0){return this.getSongDataEntry(s)?!0:(this.addSongInfoRequest(s),!1)}playSong(s,e,t=0,r=0,i=.5,n=.5){return!this.addSongStartRequest(e,s,t,r,i,n)||!this.processSongEntryForPlaying(s)?!1:(e>=this._priorityPlaying&&this.playSongObject(e,s),!0)}playSongObject(s,e){if(e===-1||s<0||s>=er.PRIORITY_COUNT)return!1;let t=!1;this.stopSongAtPriority(this._priorityPlaying)&&(t=!0);const r=this.getSongDataEntry(e);if(!r)return!1;if(t)return!0;this._musicPlayer.setVolume(ke.instance.soundManager.traxVolume);let i=Od.SKIP_POSITION_SET,n=0;const o=this.getSongStartRequest(s);return o&&(i=o.startPos,n=o.playLength,o.fadeInSeconds,o.fadeOutSeconds),i>=r.length/1e3?!1:(i<=Od.SKIP_POSITION_SET&&(i=0),i=Math.trunc(i),this._priorityPlaying=s,this._requestNumberPlaying=this.getSongRequestCountAtPriority(s),this._songIdPlaying=e,this._priorityPlaying<=Od.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(r),this._musicPlayer.preloadSamplesForSong(r.songData).then(()=>this._musicPlayer.play(r.songData,r.id,i,n)),s>er.PRIORITY_ROOM_PLAYLIST&&ke.instance.soundManager.events.dispatchEvent(new An(An.NPE_USER_PLAY_SONG,s,r.id,-1)),!0)}notifySongPlaying(s){const t=Date.now();s.length>=8e3&&(this._previousNotifiedSongId!=s.id||t>this._previousNotificationTime+8e3)&&(ke.instance.soundManager.events.dispatchEvent(new aI(s.name,s.creator)),this._previousNotifiedSongId=s.id,this._previousNotificationTime=t)}addSongStartRequest(s,e,t,r,i,n){if(s<0||s>=er.PRIORITY_COUNT)return!1;const o=new F6(e,t,r,i,n);return this._songRequestsPerPriority[s]=o,this._songRequestCountsPerPriority[s]=this._songRequestCountsPerPriority[s]+1,!0}getSongDataEntry(s){let e;return this._availableSongs&&(e=this._availableSongs.get(s)),e}getSongStartRequest(s){return this._songRequestsPerPriority[s]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(s){return s<0||s>=er.PRIORITY_COUNT||!this._songRequestsPerPriority[s]?-1:this._songRequestsPerPriority[s].songId}getSongRequestCountAtPriority(s){return s<0||s>=er.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[s]}playSongWithHighestPriority(){let s;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let t=this.getTopRequestPriority();for(;t>=0;){if(s=this.getSongIdRequestedAtPriority(t),s>=0&&this.playSongObject(t,s))return;t--}}resetSongStartRequest(s){s>=0&&s<er.PRIORITY_COUNT&&(this._songRequestsPerPriority[s]=void 0)}reRequestSongAtPriority(s){this._songRequestCountsPerPriority[s]=this._songRequestCountsPerPriority[s]+1}stopSongAtPriority(s){if(s===this._priorityPlaying&&this._priorityPlaying>=0){const e=this.getSongIdPlayingAtPriority(s);if(e>=0)return this.getSongDataEntry(e),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(s){this.disposeRoomPlaylist()}onSoundMachineDispose(s){this.disposeRoomPlaylist()}onJukeboxInit(s){this.disposeRoomPlaylist(),this._roomItemPlaylist=new k6,this._roomItemPlaylist.init(),ke.instance.communication.connection.send(new YD)}onJukeboxDispose(s){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};let oI=Od;oI.SKIP_POSITION_SET=-1;oI.MAXIMUM_NOTIFY_PRIORITY=er.PRIORITY_ROOM_PLAYLIST;class H6 extends aa{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new As,this._furniSamples=new As,this._furnitureBeingPlayed=new As,this._musicController=new oI,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),ke.instance.roomEngine.events.addEventListener(Qr.PLAY_SAMPLE,this.onEvent),ke.instance.roomEngine.events.addEventListener(ye.REMOVED,this.onEvent),ke.instance.roomEngine.events.addEventListener(lt.DISPOSED,this.onEvent),ke.instance.events.addEventListener(ul.SETTINGS_UPDATED,this.onEvent),ke.instance.events.addEventListener(dc.PLAY_SOUND,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),ke.instance.roomEngine.events.removeEventListener(Qr.PLAY_SAMPLE,this.onEvent),ke.instance.roomEngine.events.removeEventListener(ye.REMOVED,this.onEvent),ke.instance.roomEngine.events.removeEventListener(lt.DISPOSED,this.onEvent),ke.instance.events.removeEventListener(ul.SETTINGS_UPDATED,this.onEvent),ke.instance.events.removeEventListener(dc.PLAY_SOUND,this.onEvent)}onEvent(e){var t;switch(e.type){case Qr.PLAY_SAMPLE:{const r=e;this.playFurniSample(r.objectId,r.sampleId,r.pitch);return}case ye.REMOVED:{const r=e;this.stopFurniSample(r.objectId);return}case lt.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(r=>{this.stopFurniSample(r)});return}case ul.SETTINGS_UPDATED:{const r=e,i=r.volumeFurni!==this._volumeFurni,n=r.volumeTrax!==this._volumeTrax;this._volumeSystem=r.volumeSystem/100,this._volumeFurni=r.volumeFurni/100,this._volumeTrax=r.volumeTrax/100,i&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((t=this._musicController)==null||t.updateVolume(this._volumeTrax));return}case dc.PLAY_SOUND:{const r=e;this.playInternalSample(r.sampleCode);return}}}playSample(e,t,r=1){e.volume=t,e.currentTime=0;try{e.play()}catch(i){xe.error(i)}}playInternalSample(e){let t=this._internalSamples.getValue(e);if(!t){const r=Ke.getValue("sounds.url");t=new Audio(r.replace("%sample%",e)),this._internalSamples.add(e,t)}this.playSample(t,this._volumeSystem)}playFurniSample(e,t,r){let i=this._furniSamples.getValue(t);if(!i){const n=Ke.getValue("external.samples.url");i=new Audio(n.replace("%sample%",t.toString())),this._furniSamples.add(t,i)}this._furnitureBeingPlayed.hasKey(e)||this._furnitureBeingPlayed.add(e,t),i.onended=n=>{this.stopFurniSample(e)},i.onpause=n=>{this.stopFurniSample(e)},i.onerror=n=>{this.stopFurniSample(e)},this.playSample(i,this._volumeFurni,r)}stopInternalSample(e){const t=this._internalSamples.getValue(e);if(t)try{t.pause()}catch(r){xe.error(r)}}stopFurniSample(e){const t=this._furnitureBeingPlayed.getValue(e);if(!t)return;const r=this._furniSamples.getValue(t);if(this._furnitureBeingPlayed.remove(e),!!r)try{r.pause()}catch(i){xe.error(i)}}updateInternalSamplesVolume(e){this._internalSamples.getValues().forEach(t=>{t.volume=e})}updateFurniSamplesVolume(e){this._furniSamples.getValues().forEach(t=>{t.volume=e})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}It.available;C_.SCALE_MODE=window.devicePixelRatio%1?dm.LINEAR:dm.NEAREST;C_.ROUND_PIXELS=!0;C_.GC_MAX_IDLE=120;const Jo=class{constructor(s,e){Jo.INSTANCE||(Jo.INSTANCE=this),this._application=new sr(e),this._core=s,this._events=new Ri,this._communication=new x4(s.communication),this._localization=new F4(this._communication),this._avatar=new bL,this._roomEngine=new wi(this._communication),this._sessionDataManager=new w6(this._communication),this._roomSessionManager=new x6(this._communication,this._roomEngine),this._roomManager=new Rl(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new Jx,this._soundManager=new H6,this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener($i.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(lt.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){Jo.INSTANCE&&(Jo.INSTANCE.dispose(),Jo.INSTANCE=null);const s=document.createElement("canvas"),e=new this(new px,{autoDensity:!1,width:window.innerWidth,height:window.innerHeight,resolution:window.devicePixelRatio,view:s});s.addEventListener("webglcontextlost",()=>e.events.dispatchEvent(new ct(Jo.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new w4(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(s){Rr().maxFPS=0,xe.LOG_DEBUG=Ke.getValue("system.log.debug",!0),xe.LOG_WARN=Ke.getValue("system.log.warn",!1),xe.LOG_ERROR=Ke.getValue("system.log.error",!1),xe.LOG_EVENTS=Ke.getValue("system.log.events",!1),xe.LOG_PACKETS=Ke.getValue("system.log.packets",!1),gh.LANDSCAPES_ENABLED=Ke.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(s){this.startSendingHeartBeat()}getConfiguration(s,e=null){return Ke.getValue(s,e)}getLocalization(s){return this._localization.getValue(s)}getLocalizationWithParameter(s,e,t){return this._localization.getValueWithParameter(s,e,t)}getLocalizationWithParameters(s,e,t){return this._localization.getValueWithParameters(s,e,t)}addLinkEventTracker(s){this._linkTrackers.indexOf(s)>=0||this._linkTrackers.push(s)}removeLinkEventTracker(s){const e=this._linkTrackers.indexOf(s);e!==-1&&this._linkTrackers.splice(e,1)}createLinkEvent(s){if(!(!s||s===""))for(const e of this._linkTrackers){if(!e)continue;const t=e.eventUrlPrefix;t.length>0?s.substr(0,t.length)===t&&e.linkReceived(s):e.linkReceived(s)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){an.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}};let ke=Jo;ke.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST";ke.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE";ke.READY="NE_READY!";ke.INSTANCE=null;const Dt=class{static format(s,e="",t=3){return s>t*Dt.YEAR?Dt.getLocalization("friendlytime.years"+e,Math.round(s/Dt.YEAR)):s>t*Dt.MONTH?Dt.getLocalization("friendlytime.months"+e,Math.round(s/Dt.MONTH)):s>t*Dt.DAY?Dt.getLocalization("friendlytime.days"+e,Math.round(s/Dt.DAY)):s>t*Dt.HOUR?Dt.getLocalization("friendlytime.hours"+e,Math.round(s/Dt.HOUR)):s>t*Dt.MINUTE?Dt.getLocalization("friendlytime.minutes"+e,Math.round(s/Dt.MINUTE)):Dt.getLocalization("friendlytime.seconds"+e,Math.round(s))}static shortFormat(s,e="",t=3){return s>t*Dt.YEAR?Dt.getLocalization("friendlytime.years.short"+e,Math.round(s/Dt.YEAR)):s>t*Dt.MONTH?Dt.getLocalization("friendlytime.months.short"+e,Math.round(s/Dt.MONTH)):s>t*Dt.DAY?Dt.getLocalization("friendlytime.days.short"+e,Math.round(s/Dt.DAY)):s>t*Dt.HOUR?Dt.getLocalization("friendlytime.hours.short"+e,Math.round(s/Dt.HOUR)):s>t*Dt.MINUTE?Dt.getLocalization("friendlytime.minutes.short"+e,Math.round(s/Dt.MINUTE)):Dt.getLocalization("friendlytime.seconds.short"+e,Math.round(s))}static getLocalization(s,e){return ke.instance.getLocalizationWithParameter(s,"amount",e.toString())}};let Or=Dt;Or.MINUTE=60;Or.HOUR=60*Dt.MINUTE;Or.DAY=24*Dt.HOUR;Or.WEEK=7*Dt.DAY;Or.MONTH=30*Dt.DAY;Or.YEAR=365*Dt.DAY;const CL=class{static isBuilderClubId(s){return s>=CL.BUILDER_CLUB_FURNI_ID_BASE}};let Vf=CL;Vf.BUILDER_CLUB_FURNI_ID_BASE=2147418112;const W6=s=>s>>>0,Hf=s=>{const e=W6(s);return e>=Math.pow(2,31)?e-Math.pow(2,32):e};class lI{constructor(e){if(this._id=e.id,this._isMain=e.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],e.avatarSets&&e.avatarSets.length>0)for(const r of e.avatarSets){if(!r)continue;const i=new lI(r);this._avatarSets.set(i.id,i)}if(e.bodyParts&&e.bodyParts.length>0)for(const r of e.bodyParts)r&&this._bodyParts.push(r.id);let t=this._bodyParts.concat();for(const r of this._avatarSets.values())r&&(t=t.concat(r.getBodyParts()));this._allBodyParts=t}findAvatarSet(e){if(e===this._id)return this;for(const t of this._avatarSets.values())if(t&&t.findAvatarSet(e))return t;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const e of this._avatarSets.values())if(e&&e.isMain)return!0;return!1}}class Pi{constructor(e=0,t=0,r=0){this._x=e,this._y=t,this._z=r}static dot(e,t){return e.x*t.x+e.y*t.y+e.z*t.z}static cross(e,t){const r=new Pi;return r.x=e.y*t.z-e.z*t.y,r.y=e.z*t.x-e.x*t.z,r.z=e.x*t.y-e.y*t.x,r}static subtract(e,t){return new Pi(e.x-t.x,e.y-t.y,e.z-t.z)}dot(e){return this._x*e.x+this._y*e.y+this._z*e.z}cross(e){const t=new Pi;return t.x=this._y*e.z-this._z*e.y,t.y=this._z*e.x-this._x*e.z,t.z=this._x*e.y-this._y*e.x,t}subtract(e){this._x=this._x-e.x,this._y=this._y-e.y,this._z=this._z-e.z}add(e){this._x=this._x+e.x,this._y=this._y+e.y,this._z=this._z+e.z}normalize(){const e=1/this.length();this._x=this._x*e,this._y=this._y*e,this._z=this._z*e}scaleBy(e){this._x*=e,this._y*=e,this._z*=e}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get z(){return this._z}set z(e){this._z=e}}class AL{constructor(e,t,r){this._location=new Pi(e,t,r),this._transformedLocation=new Pi,this._needsTransformation=!1,(e!=0||t!=0||r!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(e){this._needsTransformation&&(this._transformedLocation=e.vectorMultiplication(this._location))}}class cT extends AL{constructor(e,t=!1){super(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z)),this._id=e.id,this._radius=parseFloat(e.radius),this._normal=new Pi(parseFloat(e.nx),parseFloat(e.ny),parseFloat(e.nz)),this._isDoubleSided=e.double||!1,this._isDynamic=t}getDistance(e){const t=Math.abs(e.z-this.transformedLocation.z-this._radius),r=Math.abs(e.z-this.transformedLocation.z+this._radius);return Math.min(t,r)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class j6 extends AL{constructor(e){if(super(parseFloat(e.x),parseFloat(e.y),parseFloat(e.z)),this._id=e.id,this._radius=parseFloat(e.radius),this._parts=new Map,this._dynamicParts=new Map,e.items&&e.items.length>0)for(const t of e.items){if(!t)continue;const r=new cT(t);this._parts.set(r.id,r)}}getDynamicParts(e){const t=this._dynamicParts.get(e),r=[];if(t)for(const i in t){const n=t[i];n&&r.push(n)}return r}getPartIds(e){const t=[];for(const r of this._parts.values())r&&t.push(r.id);if(e){const r=this._dynamicParts.get(e);if(r)for(const i in r){const n=r[i];n&&t.push(n.id)}}return t}removeDynamicParts(e){return this._dynamicParts.delete(e),!0}addPart(e,t){if(this.hasPart(e.id,t))return!1;let r=this._dynamicParts.get(t);return r||(r={},this._dynamicParts.set(t,r)),r[e.id]=new cT(e,!0),!0}hasPart(e,t){let r=this._parts.get(e)||null;return!r&&this._dynamicParts.get(t)!==void 0&&(r=this._dynamicParts.get(t)[e]||null),r!==null}getParts(e,t,r,i){const n=[];for(const c of this._parts.values())c&&(c.applyTransform(e),n.push([c.getDistance(t),c]));const o=this._dynamicParts.get(i);if(o)for(const c in o){const h=o[c];h&&(h.applyTransform(e),n.push([h.getDistance(t),h]))}n.sort((c,h)=>{const u=c[0],g=h[0];return u<g?-1:u>g?1:0});const l=[];for(const c of n)c&&l.push(c[1].id);return l}getDistance(e){const t=Math.abs(e.z-this.transformedLocation.z-this._radius),r=Math.abs(e.z-this.transformedLocation.z+this._radius);return Math.min(t,r)}get id(){return this._id}get radius(){return this._radius}}const zn=class{constructor(s=0,e=0,t=0,r=0,i=0,n=0,o=0,l=0,c=0){this._data=[s,e,t,r,i,n,o,l,c]}static getXRotationMatrix(s){const e=s*Math.PI/180,t=Math.cos(e),r=Math.sin(e);return new zn(1,0,0,0,t,-r,0,r,t)}static getYRotationMatrix(s){const e=s*Math.PI/180,t=Math.cos(e),r=Math.sin(e);return new zn(t,0,r,0,1,0,-r,0,t)}static getZRotationMatrix(s){const e=s*Math.PI/180,t=Math.cos(e),r=Math.sin(e);return new zn(t,-r,0,r,t,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(s){const e=s.x*this._data[0]+s.y*this._data[3]+s.z*this._data[6],t=s.x*this._data[1]+s.y*this._data[4]+s.z*this._data[7],r=s.x*this._data[2]+s.y*this._data[5]+s.z*this._data[8];return new Pi(e,t,r)}multiply(s){const e=this._data[0]*s.data[0]+this._data[1]*s.data[3]+this._data[2]*s.data[6],t=this._data[0]*s.data[1]+this._data[1]*s.data[4]+this._data[2]*s.data[7],r=this._data[0]*s.data[2]+this._data[1]*s.data[5]+this._data[2]*s.data[8],i=this._data[3]*s.data[0]+this._data[4]*s.data[3]+this._data[5]*s.data[6],n=this._data[3]*s.data[1]+this._data[4]*s.data[4]+this._data[5]*s.data[7],o=this._data[3]*s.data[2]+this._data[4]*s.data[5]+this._data[5]*s.data[8],l=this._data[6]*s.data[0]+this._data[7]*s.data[3]+this._data[8]*s.data[6],c=this._data[6]*s.data[1]+this._data[7]*s.data[4]+this._data[8]*s.data[7],h=this._data[6]*s.data[2]+this._data[7]*s.data[5]+this._data[8]*s.data[8];return new zn(e,t,r,i,n,o,l,c,h)}scalarMultiply(s){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*s,e++}rotateX(s){const e=s*Math.PI/180,t=Math.cos(e),r=Math.sin(e);return new zn(1,0,0,0,t,-r,0,r,t).multiply(this)}rotateY(s){const e=s*Math.PI/180,t=Math.cos(e),r=Math.sin(e);return new zn(t,0,r,0,1,0,-r,0,t).multiply(this)}rotateZ(s){const e=s*Math.PI/180,t=Math.cos(e),r=Math.sin(e);return new zn(t,-r,0,r,t,0,0,0,1).multiply(this)}skew(){}transpose(){return new zn(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(s){return!1}get data(){return this._data}};let Nu=zn;Nu.IDENTITY=new zn(1,0,0,0,1,0,0,0,1);Nu.TOLERANS=1e-18;class Y6{constructor(e){this._camera=new Pi(0,0,10),this._avatarSet=new lI(e.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new Nu,this._canvases=new Map;const t=e.camera;if(t&&(this._camera.x=parseFloat(t.x),this._camera.y=parseFloat(t.y),this._camera.z=parseFloat(t.z)),e.canvases&&e.canvases.length>0)for(const r of e.canvases){if(!r)continue;const i=r.scale,n=new Map;if(r.geometries&&r.geometries.length>0)for(const o of r.geometries){if(!o)continue;const l=new Lx(o,i);n.set(l.id,l)}this._canvases.set(i,n)}if(e.types&&e.types.length>0)for(const r of e.types){if(!r)continue;const i=new Map,n=new Map;if(r.bodyParts&&r.bodyParts.length>0)for(const o of r.bodyParts){if(!o)continue;const l=new j6(o);i.set(l.id,l);for(const c of l.getPartIds(null))n.set(c,l)}this._geometryTypes.set(r.id,i),this._itemIdToBodyPartMap.set(r.id,n)}}removeDynamicItems(e){for(const t of this._geometryTypes.values())if(t)for(const r of t.values())r&&r.removeDynamicParts(e)}getBodyPartIdsInAvatarSet(e){const t=this._avatarSet.findAvatarSet(e);return t?t.getBodyParts():[]}isMainAvatarSet(e){const t=this._avatarSet.findAvatarSet(e);return t?t.isMain:!1}getCanvas(e,t){const r=this._canvases.get(e);return r&&r.get(t)||null}typeExists(e){return!!this._geometryTypes.get(e)}hasBodyPart(e,t){if(this.typeExists(e)){const r=this._geometryTypes.get(e);if(r&&r.get(t))return!0}return!1}getBodyPartIDs(e){const t=this.getBodyPartsOfType(e),r=[];if(t)for(const i of t.values())i&&r.push(i.id);return r}getBodyPartsOfType(e){return this.typeExists(e)?this._geometryTypes.get(e):new Map}getBodyPart(e,t){return this.getBodyPartsOfType(e).get(t)||null}getBodyPartOfItem(e,t,r){const i=this._itemIdToBodyPartMap.get(e);if(i){const n=i.get(t);if(n)return n;const o=this.getBodyPartsOfType(e);if(o){for(const l of o.values())if(l&&l.hasPart(t,r))return l}}return null}getBodyPartsInAvatarSet(e,t){const r=this.getBodyPartIdsInAvatarSet(t),i=[];for(const n of r){if(!n)continue;const o=e.get(n);o&&i.push(o)}return i}getBodyPartsAtAngle(e,t,r){if(!r)return[];const i=this.getBodyPartsOfType(r),n=this.getBodyPartsInAvatarSet(i,e),o=[],l=[];this._transformation=Nu.getYRotationMatrix(t);for(const c of n.values())c&&(c.applyTransform(this._transformation),o.push([c.getDistance(this._camera),c]));o.sort((c,h)=>{const u=c[0],g=h[0];return u<g?-1:u>g?1:0});for(const c of o)c&&l.push(c[1].id);return l}getParts(e,t,r,i,n){if(this.hasBodyPart(e,t)){const o=this.getBodyPartsOfType(e).get(t);return this._transformation=Nu.getYRotationMatrix(r),o.getParts(this._transformation,this._camera,i,n)}return[]}}class z6 extends Ri{constructor(e){super(),this._renderManager=e,this._geometry=null,this._figureData=new Fx,this._partSetsData=new kx,this._animationData=new Px,this._animationManager=new bx,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(e){e&&(this._geometry=new Y6(e))}initActions(e,t){t&&(this._actionManager=new Tx(e,t),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(e){this._actionManager.updateActions(e),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(e){return e&&this._partSetsData.parse(e)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(e){return e?this._animationData.parse(e):!1}initFigureData(e){return e?this._figureData.parse(e):!1}injectFigureData(e){this._figureData.injectJSON(e)}registerAnimations(e,t="fx",r=200){let i=0;for(;i<r;){const n=e.getCollection(t+i);if(n){const o=n.data;this._animationManager.registerAnimation(this,o.animations)}i++}}registerAnimation(e){this._animationManager.registerAnimation(this,e)}getPartColor(e,t,r=0){const i=e.getPartColorIds(t);if(!i||i.length<r)return null;const n=this._figureData.getSetType(t);if(n==null)return null;const o=this._figureData.getPalette(n.paletteID);return o?o.getColor(i[r]):null}getBodyPartData(e,t,r){return this._animationManager.getLayerData(e,t,r)}getAnimation(e){return this._animationManager.getAnimation(e)}getActionDefinition(e){return this._actionManager.getActionDefinition(e)}getActionDefinitionWithState(e){return this._actionManager.getActionDefinitionWithState(e)}isMainAvatarSet(e){return this._geometry.isMainAvatarSet(e)}sortActions(e){return this._actionManager.sortActions(e)}maxFrames(e){let t=0;for(const r of e)t=Math.max(t,this._animationData.getFrameCount(r.definition));return t}getMandatorySetTypeIds(e,t){return this._mandatorySetTypeIds[e]||(this._mandatorySetTypeIds[e]=[]),this._mandatorySetTypeIds[e][t]?this._mandatorySetTypeIds[e][t]:(this._mandatorySetTypeIds[e][t]=this._figureData.getMandatorySetTypeIds(e,t),this._mandatorySetTypeIds[e][t])}getDefaultPartSet(e,t){return this._figureData.getDefaultPartSet(e,t)}getCanvasOffsets(e,t,r){return this._actionManager.getCanvasOffsets(e,t,r)}getCanvas(e,t){return this._geometry.getCanvas(e,t)}removeDynamicItems(e){this._geometry.removeDynamicItems(e)}getActiveBodyPartIds(e,t){let r=[];const i=[],n=e.definition.geometryType;if(e.definition.isAnimation){const o=e.definition.state+"."+e.actionParameter,l=this._animationManager.getAnimation(o);if(l&&(r=l.getAnimatedBodyPartIds(0,e.overridingAction),l.hasAddData())){const c={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},h={setType:""};for(const u of l.addData){const g=this._geometry.getBodyPart(n,u.align);if(g){c.id=u.id,g.addPart(c,t),h.setType=u.id;const m=this._partSetsData.addPartDefinition(h);m.appendToFigure=!0,u.base===""&&(m.staticId=1),i.indexOf(g.id)===-1&&i.push(g.id)}}}for(const c of r){const h=this._geometry.getBodyPart(n,c);h&&i.indexOf(h.id)===-1&&i.push(h.id)}}else{r=this._partSetsData.getActiveParts(e.definition);for(const o of r){const l=this._geometry.getBodyPartOfItem(n,o,t);l&&i.indexOf(l.id)===-1&&i.push(l.id)}}return i}getBodyPartsUnordered(e){return this._geometry.getBodyPartIdsInAvatarSet(e)}getBodyParts(e,t,r){const i=_i.DIRECTION_TO_ANGLE[r];return this._geometry.getBodyPartsAtAngle(e,i,t)}getFrameBodyPartOffset(e,t,r,i){const n=this._animationData.getAction(e.definition);return n?n.getFrameBodyPartOffset(t,r,i):wd.DEFAULT_OFFSET}getParts(e,t,r,i,n,o,l,c=null){let h=null,u=[],g=null;if(!r==null)return[];const m=this._partSetsData.getActiveParts(r.definition),p=[];let f=[0];const T=this._animationData.getAction(r.definition);if(r.definition.isAnimation){const N=r.definition.state+"."+r.actionParameter,P=this._animationManager.getAnimation(N);if(P){f=this.getPopulatedArray(P.frameCount(r.overridingAction));for(const y of P.getAnimatedBodyPartIds(0,r.overridingAction))if(y===e){const D=this._geometry.getBodyPart(i,y);if(D)for(const x of D.getDynamicParts(l))m.push(x.id)}}}const I=this._geometry.getParts(i,e,n,m,l),O=t.getPartTypeIds();for(const N of O){if(c&&c.get(N))continue;const P=t.getPartSetId(N),y=t.getPartColorIds(N),D=this._figureData.getSetType(N);if(D){const x=this._figureData.getPalette(D.paletteID);if(x){const w=D.getPartSet(P);if(w){o=o.concat(w.hiddenLayers);for(const k of w.parts)if(I.indexOf(k.type)>-1){if(T){const q=T.getPart(k.type);q?u=q.frames:u=f}else u=f;h=r.definition,m.indexOf(k.type)===-1&&(h=this._defaultAction);const F=this._partSetsData.getPartDefinition(k.type);let L=F?F.flippedSetType:k.type;(!L||L==="")&&(L=k.type),y&&y.length>k.colorLayerIndex-1&&(g=x.getColor(y[k.colorLayerIndex-1]));const B=k.colorLayerIndex>0,V=new Dg(e,k.type,k.id.toString(),g,u,h,B,k.paletteMap,L);p.push(V)}}}}}const A=[];for(const N of I){let P=null,y=!1;const D=c&&c.get(N);for(const x of p)x.partType===N&&(D?P=x.color:(y=!0,o.indexOf(N)===-1&&A.push(x)));if(!y){if(D){const x=c.get(N);let w=0,k=0;for(;k<x.length;)w=w+x.charCodeAt(k),k++;if(T){const L=T.getPart(N);L?u=L.frames:u=f}else u=f;const F=new Dg(e,N,x,P,u,r.definition,P!=null,-1,N,!1,1);A.push(F)}else if(m.indexOf(N)>-1){const x=this._geometry.getBodyPartOfItem(i,N,l);if(e===x.id){const w=this._partSetsData.getPartDefinition(N);let k=!1,F=1;if(w.appendToFigure){let L="1";if(r.actionParameter!==""&&(L=r.actionParameter),w.hasStaticId()&&(L=w.staticId.toString()),T){const V=T.getPart(N);V?u=V.frames:u=f}else u=f;const B=new Dg(e,N,L,null,u,r.definition,!1,-1,N,k,F);A.push(B)}}}}}return A}getPopulatedArray(e){const t=[];let r=0;for(;r<e;)t.push(r),r++;return t}getItemIds(){if(this._actionManager){const e=this._actionManager.getActionDefinition("CarryItem").params,t=[];for(const r of e.values())t.push(r);return t}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const K6={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},q6={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},X6={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},Ta=class extends Ri{constructor(s,e,t,r){super(),this._state=Ta.NOT_LOADED,this._libraryName=s,this._revision=e,this._downloadUrl=r,this._assets=t,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=Ta.LOADED)}async downloadAsset(){if(!this._assets||this._state===Ta.LOADING||this._state===Ta.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=Ta.LOADED,this.dispatchEvent(new tc(tc.DOWNLOAD_COMPLETE,this));return}if(this._state=Ta.LOADING,!await this._assets.downloadAsset(this._downloadUrl))return;this._state=Ta.LOADED;const t=this._assets.getCollection(this._libraryName);t&&(this._animation=t.data.animations),this.dispatchEvent(new tc(tc.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===Ta.LOADED}};let ph=Ta;ph.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE";ph.NOT_LOADED=0;ph.LOADING=1;ph.LOADED=2;const Wf=class extends Ri{constructor(s,e){super(),this._assets=s,this._structure=e,this._missingMandatoryLibs=Ke.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(M_.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const s=new XMLHttpRequest;try{s.open("GET",Ke.getValue("avatar.effectmap.url")),s.send(),s.onloadend=e=>{if(s.responseText){const t=JSON.parse(s.responseText);this.processEffectMap(t.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new ct(Wf.DOWNLOADER_READY))}},s.onerror=e=>{throw new Error("invalid_avatar_effect_map")}}catch(e){xe.error(e)}}processEffectMap(s){if(s)for(const e of s){if(!e)continue;const t=e.id,r=e.lib,i=e.revision||"";if(this._libraryNames.indexOf(r)>=0)continue;this._libraryNames.push(r);const n=new ph(r,i,this._assets,Ke.getValue("avatar.asset.effect.url"));n.addEventListener(tc.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let o=this._effectMap.get(t);o||(o=[]),o.push(n),this._effectMap.set(t,o)}}downloadAvatarEffect(s,e){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([s,e]);return}const t=this.getAvatarEffectPendingLibraries(s);if(t&&t.length){if(e&&!e.disposed){let r=this._effectListeners.get(s.toString());r||(r=[]),r.push(e),this._effectListeners.set(s.toString(),r)}this._incompleteEffects.set(s.toString(),t);for(const r of t)r&&this.downloadLibrary(r)}else e&&!e.disposed&&e.resetEffect(s)}onAvatarRenderReady(s){if(s){for(const[e,t]of this._initDownloadBuffer)this.downloadAvatarEffect(e,t);this._initDownloadBuffer=[]}}onLibraryLoaded(s){if(!s||!s.library)return;const e=[];this._structure.registerAnimation(s.library.animation);for(const[r,i]of this._incompleteEffects.entries()){let n=!0;for(const o of i)if(!(!o||o.isLoaded)){n=!1;break}if(n){e.push(r);const o=this._effectListeners.get(r);for(const l of o)!l||l.disposed||l.resetEffect(parseInt(r));this._effectListeners.delete(r),this.dispatchEvent(new ct(Wf.LIBRARY_LOADED))}}for(const r of e)this._incompleteEffects.delete(r);let t=0;for(;t<this._currentDownloads.length;){const r=this._currentDownloads[t];r&&r.libraryName===s.library.libraryName&&this._currentDownloads.splice(t,1),t++}}processMissingLibraries(){const s=this._missingMandatoryLibs.slice();for(const e of s){if(!e)continue;const t=this._effectMap.get(e);if(t)for(const r of t)r&&this.downloadLibrary(r)}}isAvatarEffectReady(s){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(s).length}getAvatarEffectPendingLibraries(s){const e=[];if(!this._structure)return e;const t=this._effectMap.get(s.toString());if(t)for(const r of t)!r||r.isLoaded||e.indexOf(r)===-1&&e.push(r);return e}downloadLibrary(s){!s||s.isLoaded||this._pendingDownloadQueue.indexOf(s)>=0||this._currentDownloads.indexOf(s)>=0||(this._pendingDownloadQueue.push(s),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};let co=Wf;co.DOWNLOADER_READY="EADM_DOWNLOADER_READY";co.LIBRARY_LOADED="EADM_LIBRARY_LOADED";co.MAX_DOWNLOADS=2;class Q6 extends Pn{constructor(e,t,r,i,n){super(e,t,r,i,n,null)}isPlaceholder(){return!0}}const NL=class extends aa{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new z6(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new Sx(this,di()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new lo(di(),this._structure),this._avatarAssetDownloadManager.addEventListener(lo.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(lo.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new co(di(),this._structure),this._effectAssetDownloadManager.addEventListener(co.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(co.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(lo.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(lo.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(co.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(co.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(q6.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(X6.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const s=Ke.getValue("avatar.default.actions");s&&this._structure.initActions(di(),s);const e=new XMLHttpRequest;try{e.open("GET",Ke.getValue("avatar.actions.url")),e.send(),e.onloadend=t=>{this._structure&&(this._structure.updateActions(JSON.parse(e.responseText)),this._actionsReady=!0,this.checkReady())},e.onerror=t=>{throw new Error("invalid_avatar_actions")}}catch(t){xe.error(t)}}loadAnimations(){this._structure&&(this._structure.initAnimation(K6.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const s=Ke.getValue("avatar.default.figuredata");if(!s||typeof s=="string"){xe.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(s),new Am(Ke.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(Am.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(s){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(s){s&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(s){s&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(s){s&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(s){s&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new ct(M_.AVATAR_RENDER_READY)))}createFigureContainer(s){return new Su(s)}isFigureContainerReady(s){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(s):!1}createAvatarImage(s,e,t,r=null,i=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const n=new Su(s);return t&&this.validateAvatarFigure(n,t),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(n)?new Pn(this._structure,this._aliasCollection,n,e,this._effectAssetDownloadManager,i):(this._placeHolderFigure||(this._placeHolderFigure=new Su(NL.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(n,r),new Q6(this._structure,this._aliasCollection,this._placeHolderFigure,e,this._effectAssetDownloadManager))}downloadAvatarFigure(s,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(s,e)}validateAvatarFigure(s,e){let t=!1;const r=this._structure.getMandatorySetTypeIds(e,2);if(r){const i=this._structure.figureData;for(const n of r)if(s.hasPartType(n)){const o=i.getSetType(n);if(o&&!o.getPartSet(s.getPartSetId(n))){const c=this._structure.getDefaultPartSet(n,e);c&&(s.updatePart(n,c.id,[0]),t=!0)}}else{const o=this._structure.getDefaultPartSet(n,e);o&&(s.updatePart(n,o.id,[0]),t=!0)}}return!t}getFigureClubLevel(s,e,t=null){if(!this._structure)return 0;const r=this._structure.figureData,i=Array.from(s.getPartTypeIds());let n=0;for(const o of i){const l=r.getSetType(o);if(!l)continue;const c=s.getPartSetId(o),h=l.getPartSet(c);if(h){n=Math.max(h.clubLevel,n);const u=r.getPalette(l.paletteID),g=s.getPartColorIds(o);for(const m of g){const p=u.getColor(m);p&&(n=Math.max(p.clubLevel,n))}}}t||(t=this._structure.getBodyPartsUnordered(lr.FULL));for(const o of t){const l=r.getSetType(o);l&&i.indexOf(o)===-1&&(n=Math.max(l.optionalFromClubLevel(e),n))}return n}isValidFigureSetForGender(s,e){const r=this.structureData.getFigurePartSet(s);return!!(r&&(r.gender.toUpperCase()==="U"||r.gender.toUpperCase()===e.toUpperCase()))}getFigureStringWithFigureIds(s,e,t){const r=new ir;r.loadAvatarData(s,e);const i=this.resolveFigureSets(t);for(const n of i)r.savePartData(n.type,n.id,r.getColourIds(n.type));return r.getFigureString()}resolveFigureSets(s){const e=this.structureData,t=[];for(const r of s){const i=e.getFigurePartSet(r);i&&t.push(i)}return t}getMandatoryAvatarPartSetIds(s,e){return this._structure?this._structure.getMandatorySetTypeIds(s,e):null}getAssetByName(s){return this._aliasCollection.getAsset(s)}get assets(){return di()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}};let bL=NL;bL.DEFAULT_FIGURE="hd-99999-99999";class Cd{constructor(e,t,r){this._layerId=e,this._partId=t,this._paletteId=r}get layerId(){return this._layerId}set layerId(e){this._layerId=e}get partId(){return this._partId}set partId(e){this._partId=e}get paletteId(){return this._paletteId}set paletteId(e){this._paletteId=e}}class ra{constructor(e){this._typeId=this.getTypeId(e),this._paletteId=this.getPaletteId(e),this._color=this.getColor(e),this._headOnly=this.getHeadOnly(e);const t=this.getCustomData(e);this._customLayerIds=this.getCustomLayerIds(t),this._customPartIds=this.getCustomPartIds(t),this._customPaletteIds=this.getCustomPaletteIds(t),this._customParts=[];let r=0;for(;r<this._customLayerIds.length;)this._customParts.push(new Cd(this._customLayerIds[r],this._customPartIds[r],this._customPaletteIds[r])),r++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(e){if(this._customParts){for(const t of this._customParts)if(t.layerId===e)return t}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let e=this.typeId+" "+this.paletteId+" "+this.color.toString(16);e=e+(" "+this.customParts.length);for(const t of this.customParts)e=e+(" "+t.layerId+" "+t.partId+" "+t.paletteId);return e}getCustomData(e){let t=[];if(e){const r=e.split(" "),i=this._headOnly?1:0,n=4+i;if(r.length>n){const o=3+i,l=parseInt(r[o]);t=r.slice(n,n+l*3)}}return t}getCustomLayerIds(e){const t=[];let r=0;for(;r<e.length;)t.push(parseInt(e[r+0])),r=r+3;return t}getCustomPartIds(e){const t=[];let r=0;for(;r<e.length;)t.push(parseInt(e[r+1])),r=r+3;return t}getCustomPaletteIds(e){const t=[];let r=0;for(;r<e.length;)t.push(parseInt(e[r+2])),r=r+3;return t}getTypeId(e){if(e){const t=e.split(" ");if(t.length>=1)return parseInt(t[0])}return 0}getPaletteId(e){if(e){const t=e.split(" ");if(t.length>=2)return parseInt(t[1])}return 0}getColor(e){if(e){const t=e.split(" ");if(t.length>=3)return parseInt(t[2],16)}return 16777215}getHeadOnly(e){if(e){const t=e.split(" ");if(t.length>=4)return t[3]==="head"}return!1}}class cg{constructor(e){this._complete=!0,this._target=e}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(e){this._target=e}get target(){return this._target}set tag(e){this._tag=e}get tag(){return this._tag}start(){this._running=!0}update(e){}stop(){this._target=null,this._running=!1}tick(e){}}class $6 extends cg{constructor(e){super(e)}tick(e){super.tick(e),this.target&&(this.target.remove(),this.target=null)}}class cI extends cg{constructor(e,t){super(e),this._complete=!1,this._duration=t}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=tt()}tick(e){super.tick(e);const t=(e-this._startTimeMs)/this._duration;t<1?this.update(t):(this.update(1),this._complete=!0)}}class J6 extends cI{constructor(e,t,r){super(e,t),this._height=r}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(e){super.update(e),this.target.style.top=this._offset-this._height+this.getBounceOffset(e)*this._height+"px"}getBounceOffset(e){return e<.364?7.5625*e*e:e<.727?(e=e-.545,7.5625*e*e+.75):e<.909?(e=e-.9091,7.5625*e*e+.9375):(e=e-.955,7.5625*e*e+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class Z6 extends cI{constructor(e){super(e.target,e.duration),this._interval=e}start(){super.start(),this._interval.start()}update(e){super.update(e),this._interval.update(e)}stop(){super.stop(),this._interval.stop()}}class eq extends Z6{constructor(e,t){super(e),this._rate=t}}class tq extends eq{constructor(e,t){super(e,t)}update(e){this._interval.update(Math.pow(e,1/this._rate))}}class sq extends cI{constructor(e,t,r,i,n,o){super(e,t),this._deltaX=r,this._deltaY=i,this._height=-n,this._numJumps=o}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(e){super.update(e),this.target.style.left=this._startX+this._deltaX*e+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(e*Math.PI*this._numJumps))+this._deltaY*e+"px"}}const pt=class{static get TIMER_TIME(){return 1e3/qU()}static runMotion(s){return pt._RUNNING_MOTIONS.indexOf(s)===-1&&pt._QUEUED_MOTIONS.indexOf(s)===-1&&(pt._IS_UPDATING?pt._QUEUED_MOTIONS.push(s):(pt._RUNNING_MOTIONS.push(s),s.start()),pt.startTimer()),s}static removeMotion(s){let e=pt._RUNNING_MOTIONS.indexOf(s);e>-1?pt._IS_UPDATING?(e=pt._REMOVED_MOTIONS.indexOf(s),e==-1&&pt._REMOVED_MOTIONS.push(s)):(pt._RUNNING_MOTIONS.splice(e,1),s.running&&s.stop(),pt._RUNNING_MOTIONS.length||pt.stopTimer()):(e=pt._QUEUED_MOTIONS.indexOf(s),e>-1&&pt._QUEUED_MOTIONS.splice(e,1))}static getMotionByTag(s){for(const e of pt._RUNNING_MOTIONS)if(e.tag==s)return e;for(const e of pt._QUEUED_MOTIONS)if(e.tag==s)return e;return null}static getMotionByTarget(s){for(const e of pt._RUNNING_MOTIONS)if(e.target==s)return e;for(const e of pt._QUEUED_MOTIONS)if(e.target==s)return e;return null}static getMotionByTagAndTarget(s,e){for(const t of pt._RUNNING_MOTIONS)if(t.tag==s&&t.target==e)return t;for(const t of pt._QUEUED_MOTIONS)if(t.tag==s&&t.target==e)return t;return null}static get isRunning(){return!!pt._TIMER}static get isUpdating(){return pt._IS_UPDATING}static onTick(){pt._IS_UPDATING=!0;const s=tt();let e=null;for(;e=pt._QUEUED_MOTIONS.pop();)pt._RUNNING_MOTIONS.push(e);for(;e=pt._REMOVED_MOTIONS.pop();)pt._RUNNING_MOTIONS.splice(pt._RUNNING_MOTIONS.indexOf(e),1),e.running&&e.stop();for(e of pt._RUNNING_MOTIONS)e.running?(e.tick(s),e.complete&&pt.removeMotion(e)):pt.removeMotion(e);pt._RUNNING_MOTIONS.length||pt.stopTimer(),pt._IS_UPDATING=!1}static startTimer(){pt._TIMER||(pt._TIMER=setInterval(pt.onTick,pt.TIMER_TIME))}static stopTimer(){pt._TIMER&&(clearInterval(pt._TIMER),pt._TIMER=null)}getNumRunningMotions(s){let e=0;for(const t of pt._RUNNING_MOTIONS)t.target===s&&e++;return e}};let So=pt;So._QUEUED_MOTIONS=[];So._RUNNING_MOTIONS=[];So._REMOVED_MOTIONS=[];So._TIMER=null;So._IS_UPDATING=!1;class uT extends cg{constructor(...e){super(e?e[0].target:null),this._queue=[];for(const t of e)this._queue.push(t);this._motion=e[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(e){super.update(e),this._motion.running&&this._motion.update(e)}stop(){super.stop(),this._motion.stop()}tick(e){if(super.tick(e),this._motion.tick(e),this._motion.complete){this._motion.stop();const t=this._queue.indexOf(this._motion);t<this._queue.length-1?(this._motion=this._queue[t+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class rq extends cg{constructor(e){super(null),this._waitTimeMs=e}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=tt()}tick(e){super.tick(e),this._complete=e-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}function mt(){return ke.instance}function xs(s){mt().addLinkEventTracker(s)}function Ks(){return mt().avatar}function hT(s){return Ks().structureData.getPalette(s)}function dT(s){return Ks().structureData.getSetType(s)}function bu(){return mt().cameraManager}function iq(){return mt().core}function nq(){return iq().configuration}function Le(s){s=s.startsWith("event:")?s.substring(6):s,mt().createLinkEvent(s)}function fl(){var s;return(s=mt())==null?void 0:s.communication}function Ee(s,e=null){return Ke.getValue(s,e)}function jf(){var s;return(s=fl())==null?void 0:s.connection}function uI(){return mt().localization}const Al=s=>{!s||!s.length||(s.startsWith("http")?an.openWebPage(s):Le(s))};function ws(s){mt().removeLinkEventTracker(s)}function te(){return mt().roomEngine}let wg=!1,yh=0,vh=0;const Mh=(s,e=1)=>{const t=s.clientX,r=s.clientY;let i=s.type;switch(i===fe.MOUSE_CLICK&&(yh&&(vh=1,yh>=Date.now()-300&&vh++),yh=Date.now(),vh===2&&(wg||(i=fe.DOUBLE_CLICK),vh=0,yh=null)),i){case fe.MOUSE_CLICK:break;case fe.DOUBLE_CLICK:break;case fe.MOUSE_MOVE:wg=!0;break;case fe.MOUSE_DOWN:wg=!1;break;case fe.MOUSE_UP:break;case fe.RIGHT_CLICK:break;default:return}te().dispatchMouseEvent(e,t,r,i,s.altKey,s.ctrlKey||s.metaKey,s.shiftKey,!1)};let Fg=!1,Dh=0,Ph=0;const Lh=(s,e=1,t=!1,r=!1,i=!1,n=!1)=>{let o=0,l=0;s.touches[0]?(o=s.touches[0].clientX,l=s.touches[0].clientY):s.changedTouches[0]&&(o=s.changedTouches[0].clientX,l=s.changedTouches[0].clientY);let c=s.type;switch(t&&(c=Ir.TOUCH_LONG),(c===fe.MOUSE_CLICK||c===Ir.TOUCH_END)&&(c=fe.MOUSE_CLICK,Dh&&(Ph=1,Dh>=Date.now()-300&&Ph++),Dh=Date.now(),Ph===2&&(Fg||(c=fe.DOUBLE_CLICK),Ph=0,Dh=null)),c){case fe.MOUSE_CLICK:break;case fe.DOUBLE_CLICK:break;case Ir.TOUCH_START:c=fe.MOUSE_DOWN,Fg=!1;break;case Ir.TOUCH_MOVE:c=fe.MOUSE_MOVE,Fg=!0;break;case Ir.TOUCH_END:c=fe.MOUSE_UP;break;case Ir.TOUCH_LONG:c=fe.MOUSE_DOWN_LONG;break;default:return}c===Ir.TOUCH_START&&te().dispatchMouseEvent(e,o,l,c,r,i,n,!1),te().dispatchMouseEvent(e,o,l,c,r,i,n,!1)};function Dr(s){if(!s||!s.model)return!1;const e=ie().userId,t=s.model.getValue(b.FURNITURE_OWNER_ID);return e===t}function Wu(s,e,t){return s?s.isRoomOwner||s.controllerLevel>=Rt.GUEST||ie().isModerator||Dr(te().getRoomObject(s.roomId,e,t)):!1}function Nl(){return mt().roomSessionManager}function ol(s,e=null){Nl().createSession(s,e)}function aq(){const s=bl();return s?s.model.getValue(b.FIGURE_CAN_STAND_UP):he.POSTURE_STAND}function kg(){const s=bl();if(!s)return!1;const t=s.model.getValue(b.FIGURE_EFFECT);return!(t===29||t===30||t===185)}function ie(){return mt().sessionDataManager}function Li(){return Ee("hc.disabled",!1)?Lr.VIP:ie().clubLevel}class ui{}ui.OKAY=0;ui.MISSING_OFFER=1;ui.FURNI_LIMIT_REACHED=2;ui.NOT_IN_ROOM=3;ui.NOT_ROOM_OWNER=4;ui.GUILD_ROOM=5;ui.VISITORS_IN_ROOM=6;class oq{constructor(e,t,r){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=t,this._parent=r,this._localization=e.localization,this._pageId=e.pageId,this._pageName=e.pageName,this._iconId=e.icon,this._children=[],this._offerIds=e.offerIds,this._isVisible=e.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(e){e&&this._children.push(e)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const yL=class{constructor(s,e,t,r,i,n=-1){this._pageId=s,this._layoutCode=e,this._localization=t,this._offers=r,this._acceptSeasonCurrencyAsCredits=i;for(const o of r)o.page=this;n===-1?this._mode=yL.MODE_NORMAL:this._mode=n}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};let hI=yL;hI.MODE_NORMAL=0;class Ms{}Ms.DUCKET_INFO="ducket_info";Ms.CREDITS="credits";Ms.AVATAR_EFFECTS="avatar_effects";Ms.HC_MEMBERSHIP="hc_membership";Ms.CLUB_GIFTS="club_gifts";Ms.LIMITED_SOLD="limited_sold";Ms.PET_ACCESSORIES="pet_accessories";Ms.TRAX_SONGS="trax_songs";Ms.NEW_ADDITIONS="new_additions";Ms.QUEST_SHELL="quest_shell";Ms.QUEST_SNOWFLAKES="quest_snowflakes";Ms.VAL_QUESTS="val_quests";Ms.GUILD_CUSTOM_FURNI="guild_custom_furni";Ms.GIFT_SHOP="gift_shop";Ms.HORSE_STYLES="horse_styles";Ms.HORSE_SHOE="horse_shoe";Ms.SET_EASTER="set_easter";Ms.ECOTRON_TRANSFORM="ecotron_transform";Ms.LOYALTY_INFO="loyalty_info";Ms.ROOM_BUNDLES="room_bundles";Ms.ROOM_BUNDLES_MOBILE="room_bundles_mobile";Ms.HABBO_CLUB_DESKTOP="habbo_club_desktop";Ms.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";class lq{constructor(e,t){this.breed=e,this.palettes=t}}class Xt{}Xt.NONE=0;Xt.CONFIRM=1;Xt.PURCHASE=2;Xt.NO_CREDITS=3;Xt.NO_POINTS=4;Xt.SOLD_OUT=5;Xt.FAILED=6;class Ki{}Ki.NORMAL="NORMAL";Ki.BUILDER="BUILDERS_CLUB";const cq=s=>"",uq=s=>"",_T=(s,e)=>{const t=s.get(e),r=[];if(t&&t.length)for(const i of t)i.isVisible&&r.push(i);return r},vL=(s,e,t,r)=>{if(t.isVisible&&t.pageId>0){let i=!1;const n=[t.pageName,t.localization].join(" ").toLowerCase().replace(/ /gi,"");if(n.indexOf(s)>-1&&(r.push(t),i=!0),!i){for(const o of e)if(n.indexOf(o)>=0){r.push(t);break}}}for(const i of t.children)vL(s,e,i,r)};function hq(s){if(!s.length)return 0;let e=s.length-1;for(;e>=0&&!isNaN(parseInt(s.charAt(e)));)e--;return e>0?parseInt(s.substring(e+1)):-1}function dq(s,e){switch(s){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const t=[];for(const r of e){const i=te().getPetColorResult(s,r.paletteId);i&&(i.primaryColor===i.secondaryColor?t.push([i.primaryColor]):t.push([i.primaryColor,i.secondaryColor]))}return t}}}class nt{}nt.WALL="i";nt.FLOOR="s";nt.EFFECT="e";nt.HABBO_CLUB="h";nt.BADGE="b";nt.GAME_TOKEN="GAME_TOKEN";nt.PET="p";nt.ROBOT="r";const ML=class{constructor(s,e,t,r,i,n,o=!1,l=0,c=0){this._productType=s.toLowerCase(),this._productClassId=e,this._extraParam=t,this._productCount=r,this._productData=i,this._furnitureData=n,this._isUniqueLimitedItem=o,this._uniqueLimitedItemSeriesSize=l,this._uniqueLimitedItemsLeft=c}static stripAddonProducts(s){return s.length===1?s:s.filter(e=>e.productType!==nt.BADGE&&e.productType!==nt.EFFECT&&e.productClassId!==ML.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(s=null,e=null){switch(this._productType){case nt.FLOOR:return te().getFurnitureFloorIconUrl(this.productClassId);case nt.WALL:{if(s&&this._furnitureData){let t="";switch(this._furnitureData.className){case"floor":t=["th",this._furnitureData.className,s.product.extraParam].join("_");break;case"wallpaper":t=["th","wall",s.product.extraParam].join("_");break;case"landscape":t=["th",this._furnitureData.className,(s.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(t!=="")return`${Ee("catalog.asset.url")}/${t}.png`}return te().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case nt.EFFECT:return cq(this.productClassId);case nt.HABBO_CLUB:return uq(this.productClassId);case nt.BADGE:return ie().getBadgeUrl(this._extraParam);case nt.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(s){this._extraParam=s}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(s){this._uniqueLimitedItemsLeft=s}};let dl=ML;dl.EFFECT_CLASSID_NINJA_DISAPPEAR=108;const Hn=class{constructor(s,e,t,r,i,n,o,l,c,h){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=s,this._localizationId=e,this._isRentOffer=t,this._priceInCredits=r,this._priceInActivityPoints=i,this._activityPointType=n,this._giftable=o,this._clubLevel=l,this._products=c,this._bundlePurchaseAllowed=h,this.setPricingModelForProducts(),this.setPricingType();for(const u of c)if(u.productType===nt.BADGE){this._badgeCode=u.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(s){this._page=s}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const s=dl.stripAddonProducts(this._products);return s.length?s[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const s=gc(this._localizationId);return s?s.name:E(this._localizationId)}get localizationDescription(){const s=gc(this._localizationId);return s?s.description:E(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const s=dl.stripAddonProducts(this._products);s.length===1?s[0].productCount===1?this._pricingModel=Hn.PRICING_MODEL_SINGLE:this._pricingModel=Hn.PRICING_MODEL_MULTI:s.length>1?this._pricingModel=Hn.PRICING_MODEL_BUNDLE:this._pricingModel=Hn.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Hn.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Hn.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Hn.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Hn.PRICE_TYPE_NONE}clone(){const s=[],e=gc(this.localizationId);for(const r of this._products){const i=c_(r.productClassId,r.productType);s.push(new dl(r.productType,r.productClassId,r.extraParam,r.productCount,e,i))}const t=new Hn(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,s,this.bundlePurchaseAllowed);return t.page=this.page,t}};let Ns=Hn;Ns.PRICING_MODEL_UNKNOWN="pricing_model_unknown";Ns.PRICING_MODEL_SINGLE="pricing_model_single";Ns.PRICING_MODEL_MULTI="pricing_model_multi";Ns.PRICING_MODEL_BUNDLE="pricing_model_bundle";Ns.PRICING_MODEL_FURNITURE="pricing_model_furniture";Ns.PRICE_TYPE_NONE="price_type_none";Ns.PRICE_TYPE_CREDITS="price_type_credits";Ns.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints";Ns.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";class _q{constructor(e){this._furniData=e,this._product=new dl(this._furniData.type,this._furniData.id,this._furniData.customParams,1,gc(this._furniData.className),this._furniData)}activate(){W(new hy(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(e){this._page=e}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return Ns.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const gq=(s,e,t=null)=>{let r=null;switch(s.toLocaleLowerCase()){case nt.FLOOR:r=te().getFurnitureFloorIconUrl(e);break;case nt.WALL:r=te().getFurnitureWallIconUrl(e,t);break}return r};class mq{constructor(e){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=e.isEnabled,this._price=e.price,this._boxTypes=e.boxTypes,this._ribbonTypes=e.ribbonTypes,this._stuffTypes=e.giftWrappers,this._defaultStuffTypes=e.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}class Eh{constructor(e,t,r,i,n,o,l,c,h=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=t,this._furniType=r,this._extraData=i,this._stuffData=n,this._price=o,this._status=l,this._averagePrice=c,this._offerCount=h}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}}Eh.TYPE_FLOOR=1;Eh.TYPE_WALL=2;class pl{}pl.ONGOING=1;pl.ONGOING_OWN=1;pl.SOLD=2;pl.EXPIRED=3;class pr{}pr.BY_ACTIVITY=1;pr.BY_VALUE=2;pr.ADVANCED=3;class DL{constructor(e,t){this._images=e,this._texts=t}getText(e){let t=this._texts[e]||"";return t&&t.length&&(t=t.replace(/\r\n|\r|\n/g,"<br />")),t}getImage(e){const t=this._images[e]||"";if(!t||!t.length)return null;let r=Ee("catalog.asset.image.url");return r=r.replace("%name%",t),r}}class fq{constructor(e,t,r,i,n,o,l,c){this.roomId=e,this.objectId=t,this.category=r,this.wallLocation=i,this.x=n,this.y=o,this.direction=l,this.offer=c}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const Ql=class{constructor(){this._requestType=Ql.REQUEST_TYPE_NONE}resetRequest(){this._requestType=Ql.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(s){this._requestType=Ql.REQUEST_TYPE_ID,this._requestById=s}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(s){this._requestType=Ql.REQUEST_TYPE_OFFER,this._requestedByOfferId=s}get requestByName(){return this._requestByName}set requestByName(s){this._requestType=Ql.REQUEST_TYPE_NAME,this._requestByName=s}};let Aa=Ql;Aa.REQUEST_TYPE_NONE=0;Aa.REQUEST_TYPE_ID=1;Aa.REQUEST_TYPE_OFFER=2;Aa.REQUEST_TYPE_NAME=3;class pq{constructor(e,t,r){this.searchValue=e,this.offers=t,this.filteredNodes=r}}function c_(s,e){let t=null;switch(e.toLowerCase()){case nt.FLOOR:t=ie().getFloorItemData(s);break;case nt.WALL:t=ie().getWallItemData(s);break}return t}function Ih(s,e,t){const r=te().getRoomObject(s,e,t);if(!r)return;const i=r.model.getValue(b.FURNITURE_TYPE_ID);switch(t){case z.FLOOR:return ie().getFloorItemData(i);case z.WALL:return ie().getWallItemData(i)}return null}function Eq(){const s=bl();return s?s.model.getValue(b.FIGURE_POSTURE):he.POSTURE_STAND}function gc(s){return s?ie().getProductData(s):null}function bt(){return Nl().getSession(-1)}function Yf(){W(new Sy)}function ll(){return ie().clubLevel>=Lr.CLUB}function Uh(){return ie().clubLevel>=Lr.VIP}function Iq(s){const e=te().getRoomObject(bt().roomId,s,z.FLOOR);if(!e||!e.model)return!1;const t=ie().userId,r=e.model.getValue(b.FURNITURE_OWNER_ID);return t===r}function Tq(){const s=bl();return s?s.model.getValue(b.FIGURE_EFFECT)===77:!1}function Rq(s){Nl().startSession(s)}const dI=()=>{bt()&&(Yf(),Nl().removeSession(-1))};function bl(){const s=ie().userId,e=te().activeRoomId,t=z.UNIT,r=te().getTotalObjectsForManager(e,t);let i=0;for(;i<r;){const n=te().getRoomObjectByIndex(e,i,t);if(n){const o=bt().userDataManager.getUserDataByIndex(n.id);if(o&&o.webID===s)return n}i++}return null}const _I=(s,e,t,r=1)=>{const i=te().getRoomObjectBoundingRectangle(s,e,t,r);return i?(i.x=Math.round(i.x),i.y=Math.round(i.y),i):null},PL=(s,e,t,r=1)=>{const i=te().getRoomObjectScreenLocation(s,e,t,r);return i?(i.x=Math.round(i.x),i.y=Math.round(i.y),i):null},Sq=(s,e,t=1)=>{const r=te(),i=r.activeRoomId;r.initializeRoomInstanceRenderingCanvas(i,t,s,e)};function Oq(s){let e=!1;const t=te().getRoomObject(s.roomId,s.objectId,s.category);return t&&t.model.getValue(b.FURNITURE_SELECTION_DISABLED)===1&&(e=!0,ie().isModerator&&(e=!1)),e}function cc(s,e,t){te().processRoomObjectOperation(s,e,t)}function gT(s){te().setActiveRoomId(s)}const W=s=>jf().send(s);class mi{static getAchievementBadgeCode(e){if(!e)return null;let t=e.badgeId;return e.finalLevel||(t=uI().getPreviousLevelBadgeId(t)),t}static getAchievementCategoryImageUrl(e,t=null,r=!1){const i=Ee("achievements.images.url");let n=r?"achicon_":"achcategory_";return n+=e.code,t!==null&&(n+=`_${t>0?"active":"inactive"}`),i.replace("%image%",n)}static getAchievementCategoryMaxProgress(e){if(!e)return 0;let t=0;for(const r of e.achievements)t+=r.levelCount;return t}static getAchievementCategoryProgress(e){if(!e)return 0;let t=0;for(const r of e.achievements)t+=r.finalLevel?r.level:r.level-1;return t}static getAchievementCategoryTotalUnseen(e){if(!e)return 0;let t=0;for(const r of e.achievements)r.unseen>0&&t++;return t}static getAchievementHasStarted(e){return e?!!(e.finalLevel||e.level-1>0):!1}static getAchievementIsIgnored(e){if(!e)return!1;const t=Ee("achievements.unseen.ignored"),r=e.badgeId.replace(/[0-9]/g,"");return t.indexOf(r)>=0}static getAchievementLevel(e){return e?e.finalLevel?e.level:e.level-1:0}}class mT{constructor(e){this._code=e,this._achievements=[]}getProgress(){return mi.getAchievementCategoryProgress(this)}getMaxProgress(){return mi.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(e){this._achievements=e}}class Ni{}Ni.ACTION_SAVE="AEA_ACTION_SAVE";Ni.ACTION_CLEAR="AEA_ACTION_CLEAR";Ni.ACTION_RESET="AEA_ACTION_RESET";Ni.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";class Cq{constructor(e,t=!1){this._partColor=e,this._isDisabled=t,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return Sr.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}}class gI{constructor(e,t,r){this._selectedPartIndex=-1,this._name=e,this._parts=t,this._palettes=r,this._selectedPartIndex=-1}static defaultColorId(e,t){if(!e||!e.length)return-1;let r=0;for(;r<e.length;){const i=e[r];if(i.partColor&&i.partColor.clubLevel<=t)return i.partColor.id;r++}return-1}init(){for(const e of this._parts)e&&e.init()}dispose(){if(this._parts){for(const e of this._parts)e.dispose();this._parts=null}if(this._palettes){for(const e of this._palettes)for(const t of e)t.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(e){if(!this._parts)return;let t=0;for(;t<this._parts.length;){if(this._parts[t].id===e){this.selectPartIndex(t);return}t++}}selectColorIds(e){if(!e||!this._palettes)return;this._paletteIndexes=new Array(e.length);let t=0;for(;t<this._palettes.length;){const r=this.getPalette(t);if(r){let i=0;if(e.length>t)i=e[t];else{const o=r[0];o&&o.partColor&&(i=o.partColor.id)}let n=0;for(;n<r.length;){const o=r[n];o.partColor.id===i?(this._paletteIndexes[t]=n,o.isSelected=!0):o.isSelected=!1,n++}}t++}this.updatePartColors()}selectPartIndex(e){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const t=this._parts[this._selectedPartIndex];t&&(t.isSelected=!1)}if(this._parts.length>e){const t=this._parts[e];if(t)return t.isSelected=!0,this._selectedPartIndex=e,t}return null}selectColorIndex(e,t){const r=this.getPalette(t);if(!r||r.length<=e)return null;this.deselectColorIndex(this._paletteIndexes[t],t),this._paletteIndexes[t]=e;const i=r[e];return i?(i.isSelected=!0,this.updatePartColors(),i):null}getCurrentColorIndex(e){return this._paletteIndexes[e]}deselectColorIndex(e,t){const r=this.getPalette(t);if(!r||r.length<=e)return;const i=r[e];i&&(i.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const e=this._palettes[0];if(!e||!e.length)return null;const t=e[0];if(!t||!t.partColor)return null;const r=t.partColor.id,i=[];let n=0;for(;n<this._paletteIndexes.length;){const l=this._palettes[n];if(!(!l||l.length<=n))if(l.length>this._paletteIndexes[n]){const c=l[this._paletteIndexes[n]];c&&c.partColor?i.push(c.partColor.id):i.push(r)}else i.push(r);n++}const o=this.getCurrentPart();return o?i.slice(0,Math.max(o.maxColorIndex,1)):null}getSelectedColors(){const e=[];let t=0;for(;t<this._paletteIndexes.length;){const r=this.getSelectedColor(t);r?e.push(r.partColor):e.push(null),t++}return e}getSelectedColor(e){const t=this.getPalette(e);return!t||t.length<=this._paletteIndexes[e]?null:t[this._paletteIndexes[e]]}getSelectedColorId(e){const t=this.getSelectedColor(e);return t&&t.partColor?t.partColor.id:0}getPalette(e){return!this._paletteIndexes||!this._palettes||this._palettes.length<=e?null:this._palettes[e]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const e=this.getSelectedColors();for(const t of this._parts)t&&(t.partColors=e)}hasClubSelectionsOverLevel(e){let t=!1;const r=this.getSelectedColors();if(r){let n=0;for(;n<r.length;){const o=r[n];o&&o.clubLevel>e&&(t=!0),n++}}const i=this.getCurrentPart();if(i&&i.partSet){const n=i.partSet;n&&n.clubLevel>e&&(t=!0)}return t}hasInvalidSelectedItems(e){const t=this.getCurrentPart();if(!t)return!1;const r=t.partSet;if(!(!r||!r.isSellable))return e.indexOf(r.id)>-1}stripClubItemsOverLevel(e){const t=this.getCurrentPart();if(t&&t.partSet&&t.partSet.clubLevel>e){const i=this.selectPartIndex(0);return i&&!i.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(e){const t=[],r=this.getSelectedColors(),i=this.getPalette(0);let n=!1;const o=gI.defaultColorId(i,e);if(o===-1)return!1;let l=0;for(;l<r.length;){const c=r[l];c?c.clubLevel>e?(t.push(o),n=!0):t.push(c.id):(t.push(o),n=!0),l++}return n&&this.selectColorIds(t),n}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}class Ls{static getGender(e){switch(e){case Je.MALE:case"m":case"M":e=Je.MALE;break;case Je.FEMALE:case"f":case"F":e=Je.FEMALE;break;default:e=Je.MALE}return e}static hasFigureSetId(e){return this.FIGURE_SET_IDS.indexOf(e)>=0}static createCategory(e,t){if(!e||!t||!this.CURRENT_FIGURE)return null;const r=[],i=[];let n=0;for(;n<this.MAX_PALETTES;)i.push([]),n++;const o=dT(t);if(!o)return null;const l=hT(o.paletteID);if(!l)return null;let c=this.CURRENT_FIGURE.getColorIds(t);c||(c=[]);const h=new Array(c.length),u=this.clubItemsDimmed,g=Li();for(const O of l.colors.getValues())if(O.isSelectable&&(u||g>=O.clubLevel)){let A=0;for(;A<this.MAX_PALETTES;){const N=g<O.clubLevel,P=new Cq(O,N);i[A].push(P),A++}if(t!==Je.FACE){let N=0;for(;N<c.length;)O.id===c[N]&&(h[N]=O),N++}}let m=[];if(u?m=Ks().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):m=Ks().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,g),m.indexOf(t)===-1){const O=new ju(null,null,!1);O.isClear=!0,r.push(O)}const f=t!==Je.FACE,T=o.partSets;for(n=T.length-1;n>=0;){const O=T.getWithIndex(n);let A=!1;if((O.gender===Je.UNISEX||O.gender===this.CURRENT_FIGURE.gender)&&(A=!0),O.isSelectable&&A&&(u||g>=O.clubLevel)){const N=g<O.clubLevel;let P=!0;O.isSellable&&(P=this.hasFigureSetId(O.id)),P&&r.push(new ju(O,h,f,N))}n--}for(r.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),n=0;n<this.MAX_PALETTES;)i[n].sort(this.colorSorter),n++;return new gI(t,r,i)}static clubSorter(e,t){const r=e.partSet?e.partSet.clubLevel:9999999999,i=t.partSet?t.partSet.clubLevel:9999999999,n=e.partSet?e.partSet.isSellable:!1,o=t.partSet?t.partSet.isSellable:!1;return n&&!o?1:o&&!n||r>i?-1:r<i?1:e.partSet.id>t.partSet.id?-1:e.partSet.id<t.partSet.id?1:0}static colorSorter(e,t){const r=e.partColor?e.partColor.clubLevel:-1,i=t.partColor?t.partColor.clubLevel:-1;return r<i?-1:r>i?1:e.partColor.index<t.partColor.index?-1:e.partColor.index>t.partColor.index?1:0}static noobSorter(e,t){const r=e.partSet?e.partSet.clubLevel:-1,i=t.partSet?t.partSet.clubLevel:-1,n=e.partSet?e.partSet.isSellable:!1,o=t.partSet?t.partSet.isSellable:!1;return n&&!o?1:o&&!n||r<i?-1:r>i?1:e.partSet.id<t.partSet.id?-1:e.partSet.id>t.partSet.id?1:0}static avatarSetFirstSelectableColor(e){const t=dT(e);if(!t)return-1;const r=hT(t.paletteID);if(!r)return-1;for(const i of r.colors.getValues())if(!(!i.isSelectable||Li()<i.clubLevel))return i.id;return-1}static get clubItemsFirst(){return Ee("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return Ee("avatareditor.show.clubitems.dimmed",!0)}}Ls.MAX_PALETTES=2;Ls.CURRENT_FIGURE=null;Ls.FIGURE_SET_IDS=[];Ls.BOUND_FURNITURE_NAMES=[];const Tt=class{constructor(){this._gender="M",this._direction=Tt.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(s,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(s),this.updateView()}parseFigureString(s){if(!s)return;const e=s.split(".");if(!(!e||!e.length))for(const t of e){const r=t.split("-");if(!r.length)continue;const i=r[0],n=parseInt(r[1]),o=[];let l=2;for(;l<r.length;)o.push(parseInt(r[l])),l++;o.length||o.push(0),this.savePartSetId(i,n,!1),this.savePartSetColourId(i,o,!1)}}getPartSetId(s){const e=this._data.get(s);return e!==void 0?e:-1}getColorIds(s){const e=this._colors.get(s);return e!==void 0?e:[Ls.avatarSetFirstSelectableColor(s)]}getFigureString(){let s="";const e=[];for(const[r,i]of this._data.entries()){const n=this._colors.get(r);let o=r+"-"+i;if(n&&n.length){let l=0;for(;l<n.length;)o=o+("-"+n[l]),l++}e.push(o)}let t=0;for(;t<e.length;)s=s+e[t],t<e.length-1&&(s=s+"."),t++;return s}savePartData(s,e,t,r=!1){this.savePartSetId(s,e,r),this.savePartSetColourId(s,t,r)}savePartSetId(s,e,t=!0){switch(s){case Tt.FACE:case Tt.HAIR:case Tt.HAT:case Tt.HEAD_ACCESSORIES:case Tt.EYE_ACCESSORIES:case Tt.FACE_ACCESSORIES:case Tt.SHIRT:case Tt.JACKET:case Tt.CHEST_ACCESSORIES:case Tt.CHEST_PRINTS:case Tt.TROUSERS:case Tt.SHOES:case Tt.TROUSER_ACCESSORIES:e>=0?this._data.set(s,e):this._data.delete(s);break}t&&this.updateView()}savePartSetColourId(s,e,t=!0){switch(s){case Tt.FACE:case Tt.HAIR:case Tt.HAT:case Tt.HEAD_ACCESSORIES:case Tt.EYE_ACCESSORIES:case Tt.FACE_ACCESSORIES:case Tt.SHIRT:case Tt.JACKET:case Tt.CHEST_ACCESSORIES:case Tt.CHEST_PRINTS:case Tt.TROUSERS:case Tt.SHOES:case Tt.TROUSER_ACCESSORIES:this._colors.set(s,e);break}t&&this.updateView()}getFigureStringWithFace(s,e=!0){let t="";const r=[Tt.FACE],i=[];for(const o of r){const l=this._colors.get(o);if(!l)continue;let c=this._data.get(o);o===Tt.FACE&&e&&(c=s);let h=o+"-"+c;if(c>=0){let u=0;for(;u<l.length;)h=h+("-"+l[u]),u++}i.push(h)}let n=0;for(;n<i.length;)t=t+i[n],n<i.length-1&&(t=t+"."),n++;return t}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(s){this._direction=s,this.updateView()}set avatarEffectType(s){this._avatarEffectType=s}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(s){this._notifier=s}};let Je=Tt;Je.DEFAULT_DIRECTION=4;Je.MALE="M";Je.FEMALE="F";Je.UNISEX="U";Je.SCALE="h";Je.STD="std";Je.DEFAULT_FRAME="0";Je.FACE="hd";Je.HAIR="hr";Je.HAT="ha";Je.HEAD_ACCESSORIES="he";Je.EYE_ACCESSORIES="ea";Je.FACE_ACCESSORIES="fa";Je.JACKET="cc";Je.SHIRT="ch";Je.CHEST_ACCESSORIES="ca";Je.CHEST_PRINTS="cp";Je.TROUSERS="lg";Je.SHOES="sh";Je.TROUSER_ACCESSORIES="wa";Je.SET_TYPES=[Tt.FACE,Tt.HAIR,Tt.HAT,Tt.HEAD_ACCESSORIES,Tt.EYE_ACCESSORIES,Tt.FACE_ACCESSORIES,Tt.JACKET,Tt.SHIRT,Tt.CHEST_ACCESSORIES,Tt.CHEST_PRINTS,Tt.TROUSERS,Tt.SHOES,Tt.TROUSERS];const $l=class{constructor(s,e,t=!0,r=!1){if(this._renderManager=Ks(),this._partSet=s,this._partColors=e,this._useColors=t,this._isDisabled=r,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,s){const i=s.parts;for(const n of i)this._maxColorIndex=Math.max(this._maxColorIndex,n.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const s=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(s)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(s,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const s=this._partSet.parts.concat().sort(this.sortByDrawOrder),e=new Qi;for(const t of s){if(!t)continue;let r=null,i=0,n=!1;for(;!n&&i<$l.THUMB_DIRECTIONS.length;){const u=Je.SCALE+"_"+Je.STD+"_"+t.type+"_"+t.id+"_"+$l.THUMB_DIRECTIONS[i]+"_"+Je.DEFAULT_FRAME;r=this._renderManager.getAssetByName(u),r&&r.texture?n=!0:i++}if(!n)continue;const o=r.offsetX,l=r.offsetY;let c=null;if(this._useColors&&t.colorLayerIndex>0){const u=this._partColors[t.colorLayerIndex-1];u&&(c=u)}const h=new ds(r.texture);h.position.set(o,l),c&&(h.tint=c.rgb),e.addChild(h)}return e}updateThumbVisualization(){if(!this._isInitalized)return;let s=this._thumbContainer;s||(s=this.renderThumb()),s&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(s,.2),this._imageUrl=Lt.generateImageUrl(s),this.notify&&this.notify())}setAlpha(s,e){return s.filters=[$l.ALPHA_FILTER],s}sortByDrawOrder(s,e){const t=$l.DRAW_ORDER.indexOf(s.type),r=$l.DRAW_ORDER.indexOf(e.type);return t<r?-1:t>r?1:s.index<e.index?-1:s.index>e.index?1:0}resetFigure(s){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(s){this._partColors=s,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(s){this._thumbContainer=s,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(s){this._isClear=s}get isSelected(){return this._isSelected}set isSelected(s){this._isSelected=s,this.notify&&this.notify()}get notify(){return this._notifier}set notify(s){this._notifier=s}};let ju=$l;ju.ALPHA_FILTER=new XU(.2);ju.THUMB_DIRECTIONS=[2,6,0,4,3,1];ju.DRAW_ORDER=[We.LEFT_HAND_ITEM,We.LEFT_HAND,We.LEFT_SLEEVE,We.LEFT_COAT_SLEEVE,We.BODY,We.SHOES,We.LEGS,We.CHEST,We.CHEST_ACCESSORY,We.COAT_CHEST,We.CHEST_PRINT,We.WAIST_ACCESSORY,We.RIGHT_HAND,We.RIGHT_SLEEVE,We.RIGHT_COAT_SLEEVE,We.HEAD,We.FACE,We.EYES,We.HAIR,We.HAIR_BIG,We.FACE_ACCESSORY,We.EYE_ACCESSORY,We.HEAD_ACCESSORY,We.HEAD_ACCESSORY_EXTRA,We.RIGHT_HAND_ITEM];class ug{constructor(){this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new Map)}reset(){if(this._isInitalized=!1,this._categories)for(const e of this._categories.values())e&&e.dispose();this._categories=new Map}addCategory(e){let t=this._categories.get(e);t||(t=Ls.createCategory(this,e),t&&(this._categories.set(e,t),this.updateSelectionsFromFigure(e)))}updateSelectionsFromFigure(e){const t=this._categories.get(e);if(!t)return;const r=Ls.CURRENT_FIGURE.getPartSetId(e);let i=Ls.CURRENT_FIGURE.getColorIds(e);i||(i=[]),t.selectPartId(r),t.selectColorIds(i)}hasClubSelectionsOverLevel(e){if(!this._categories)return!1;for(const t of this._categories.values())if(t&&t.hasClubSelectionsOverLevel(e))return!0;return!1}hasInvalidSelectedItems(e){if(!this._categories)return!1;for(const t of this._categories.values())if(t.hasInvalidSelectedItems(e))return!0;return!1}stripClubItemsOverLevel(e){if(!this._categories)return!1;let t=!1;for(const[r,i]of this._categories.entries()){let n=!1;if(i.stripClubItemsOverLevel(e)&&(n=!0),i.stripClubColorsOverLevel(e)&&(n=!0),n){const o=i.getCurrentPart();o&&Ls.CURRENT_FIGURE&&Ls.CURRENT_FIGURE.savePartData(r,o.id,i.getSelectedColorIds(),!0),t=!0}}return t}stripInvalidSellableItems(){if(!this._categories)return!1;let e=!1;for(const[t,r]of this._categories.entries());return e}selectPart(e,t){const r=this._categories.get(e);if(!r)return;const i=r.selectedPartIndex;r.selectPartIndex(t);const n=r.getCurrentPart();if(n){if(n.isDisabled){r.selectPartIndex(i);return}this._maxPaletteCount=n.maxColorIndex,Ls.CURRENT_FIGURE.savePartData(e,n.id,r.getSelectedColorIds(),!0)}}selectColor(e,t,r){const i=this._categories.get(e);if(!i)return;const n=i.getCurrentColorIndex(r);if(i.selectColorIndex(t,r),i.getSelectedColor(r).isDisabled){i.selectColorIndex(n,r);return}Ls.CURRENT_FIGURE.savePartSetColourId(e,i.getSelectedColorIds(),!0)}getCategoryData(e){return this._isInitalized||this.init(),this._categories?this._categories.get(e):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount||1}set maxPaletteCount(e){this._maxPaletteCount=e}get name(){return null}}class Aq extends ug{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(Je.FACE),this._isInitalized=!0}selectColor(e,t,r){super.selectColor(e,t,r),this.updateSelectionsFromFigure(Je.FACE)}updateSelectionsFromFigure(e){if(!this._categories||!Ls.CURRENT_FIGURE)return;const t=this._categories.get(e);if(!t)return;const r=Ls.CURRENT_FIGURE.getPartSetId(e);let i=Ls.CURRENT_FIGURE.getColorIds(e);i||(i=[]),t.selectPartId(r),t.selectColorIds(i);for(const n of t.parts){const o=l=>{const c=Ls.CURRENT_FIGURE.getFigureStringWithFace(n.id),h=Ks().createAvatarImage(c,yi.LARGE,null,{resetFigure:o,dispose:null,disposed:!1}),u=h.getImageAsSprite(lr.HEAD);u&&(u.y=10,n.thumbContainer=u,setTimeout(()=>h.dispose(),0))};o()}}get canSetGender(){return!0}get name(){return Br.GENERIC}}const Hr=s=>{if(s==null||typeof s!="object")return s;const e=new s.constructor;for(const t in s)s.hasOwnProperty(t)&&(e[t]=s[t]);return e};class si{static makeColorHex(e){return"#"+e}static makeColorNumberHex(e){return"#"+e.toString(16).padStart(6,"0")}static convertFromHex(e){return parseInt(e.replace("#",""),16)}static uintHexColor(e){const t=e>>>0;return si.makeColorHex(t.toString(16).substring(2))}static int_to_8BitVals(e){const t=e>>24&255,r=e>>16&255,i=e>>8&255,n=e&255;return[t,r,i,n]}static eight_bitVals_to_int(e,t,r,i){return(e<<24)+(t<<16)+(r<<8)+(i|0)}static int2rgb(e){e>>>=0;const t=e&255,r=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,r,t,1].join(",")+")"}}const mI=s=>{try{JSON.parse(window.localStorage.getItem(s))}catch{return null}},fI=s=>{let e=mt().localization.getBadgeDesc(s);return(!e||!e.length)&&(e=`badge_desc_${s}`),e},Th=s=>{let e=mt().localization.getBadgeName(s);return(!e||!e.length)&&(e=`badge_name_${s}`),e};function u_(s){return!s||isNaN(s)?"0":s.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function Nq(s){if(!s||isNaN(s))return"0";let e=Math.abs(s);const t=Math.pow(10,1),r=s<0;let i="";const n=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const o of n){let l=e/o.value;if(l=Math.round(l*t)/t,l>=1){e=l,i=o.key;break}}return(r?"-":"")+e+i}function E(s,e=null,t=null){return mt().getLocalizationWithParameters(s,e,t)}class Rh{}Rh.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects";Rh.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";const LL=(s,e)=>s.dispatchEvent(e),zf=s=>LL(mt().events,s),ia=new Ri,zs=s=>LL(ia,s);let UL=!1;const na=s=>{UL&&zf(new dc(dc.PLAY_SOUND,s))},fT=[fe.MOUSE_CLICK],bq=()=>{const s=()=>fT.forEach(t=>window.removeEventListener(t,e)),e=t=>(UL=!0)&&s();fT.forEach(t=>window.addEventListener(t,e))};bq();class Pe{}Pe.DEFAULT=1;Pe.WALL_PAPER=2;Pe.FLOOR=3;Pe.LANDSCAPE=4;Pe.POST_IT=5;Pe.POSTER=6;Pe.SOUND_SET=7;Pe.TRAX_SONG=8;Pe.PRESENT=9;Pe.ECOTRON_BOX=10;Pe.TROPHY=11;Pe.CREDIT_FURNI=12;Pe.PET_SHAMPOO=13;Pe.PET_CUSTOM_PART=14;Pe.PET_CUSTOM_PART_SHAMPOO=15;Pe.PET_SADDLE=16;Pe.GUILD_FURNI=17;Pe.GAME_FURNI=18;Pe.MONSTERPLANT_SEED=19;Pe.MONSTERPLANT_REVIVAL=20;Pe.MONSTERPLANT_REBREED=21;Pe.MONSTERPLANT_FERTILIZE=22;Pe.FIGURE_PURCHASABLE_SET=23;class Yu{constructor(e){e&&(this._locked=!1,this._id=e.itemId,this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(e){this._stuffData=e}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let e=-1;return this._hasRentPeriodStarted?(e=this._secondsToExpiration-(tt()-this._expirationTimeStamp)/1e3,e<0&&(e=0)):e=this._secondsToExpiration,e}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(e){this._locked=e}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(e){this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem}clone(){const e=new Yu(null);return e._expirationTimeStamp=this._expirationTimeStamp,e._isWallItem=this._isWallItem,e._songId=this._songId,e._locked=this._locked,e._id=this._id,e._ref=this._ref,e._category=this._category,e._type=this._type,e._stuffData=this._stuffData,e._extra=this._extra,e._recyclable=this._recyclable,e._tradeable=this._tradeable,e._groupable=this._groupable,e._sellable=this._sellable,e._secondsToExpiration=this._secondsToExpiration,e._hasRentPeriodStarted=this._hasRentPeriodStarted,e._creationDay=this._creationDay,e._creationMonth=this._creationMonth,e._creationYear=this._creationYear,e._slotId=this._slotId,e._isRented=this._isRented,e._flatId=this._flatId,e}}class pI{constructor(e=-1,t=-1,r=null,i=null,n=-1){this._type=e,this._category=t,this._roomEngine=r,this._stuffData=i,this._extra=n,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const e=new pI;return e._type=this._type,e._category=this._category,e._roomEngine=this._roomEngine,e._stuffData=this._stuffData,e._extra=this._extra,e._isWallItem=this._isWallItem,e._iconUrl=this._iconUrl,e._name=this._name,e._description=this._description,e._locked=this._locked,e._selected=this._selected,e._hasUnseenItems=this._hasUnseenItems,e._items=this._items,e}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(e){return this._items[e]}getItemById(e){for(const t of this._items)if(t.id===e)return t;return null}getTradeItems(e){const t=[],r=this.getLastItem();if(!r)return t;let i=0,n=0;for(;n<this._items.length&&!(i>=e);){const o=this.getItemByIndex(n);!o.locked&&o.isTradable&&o.type===r.type&&(t.push(o),i++),n++}return t}push(e){const t=[...this._items];let r=0;for(;r<t.length;){let i=t[r];if(i.id===e.id){i=i.clone(),i.locked=!1,t.splice(r,1),t.push(i),this._items=t;return}r++}t.push(e),this._items=t,this._items.length===1&&this.prepareGroup()}pop(){const e=[...this._items];let t=null;if(e.length>0){const r=e.length-1;t=e[r],e.splice(r,1)}return this._items=e,t}remove(e){const t=[...this._items];let r=0;for(;r<t.length;){let i=t[r];if(i.id===e)return t.splice(r,1),this._items=t,i;r++}return null}getTotalCount(){if(this._category===Pe.POST_IT){let e=0,t=0;for(;t<this._items.length;){const r=this.getItemByIndex(t);e=e+parseInt(r.stuffData.getLegacyString()),t++}return e}return this._items.length}getUnlockedCount(){if(this.category===Pe.POST_IT)return this.getTotalCount();let e=0,t=0;for(;t<this._items.length;)this.getItemByIndex(t).locked||e++,t++;return e}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const e=[...this._items];let t=0;for(;t<e.length;){const r=e[t];if(r.locked){const i=r.clone();i.locked=!1,e[t]=i}t++}this._items=e}lockItemIds(e){const t=[...this._items];let r=0,i=!1;for(;r<t.length;){const n=t[r],o=e.indexOf(n.ref)>=0;if(n.locked!==o){i=!0;const l=n.clone();l.locked=o,t[r]=l}r++}return this._items=t,i}setName(){const e=this.getLastItem();if(!e){this._name="";return}let t="";switch(this._category){case Pe.POSTER:t="poster_"+e.stuffData.getLegacyString()+"_name";break;case Pe.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?t="wallItem.name."+e.type:t="roomItem.name."+e.type}this._name=E(t)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let e=null;this.isWallItem?e=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):e=this._roomEngine.getFurnitureFloorIconUrl(this._type),e&&(this._iconUrl=e)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(e){this._hasUnseenItems=e}get locked(){return this._locked}set locked(e){this._locked=e}get selected(){return this._selected}set selected(e){this._selected=e}get isWallItem(){const e=this.getItemByIndex(0);return e?e.isWallItem:!1}get isGroupable(){const e=this.getItemByIndex(0);return e?e.isGroupable:!1}get isSellable(){const e=this.getItemByIndex(0);return e?e.sellable:!1}get items(){return this._items}set items(e){this._items=e}}const EI=(s,e,t,r=NaN)=>new pI(s,e,te(),t,r),yq=(s,e,t)=>{const r=[];for(const n of s)n.type===e.type&&r.push(n);for(const n of r)if(n.getItemById(e.id))return n;const i=EI(e.type,e.category,e.stuffData,e.extra);return i.push(e),t?(i.hasUnseenItems=!0,s.unshift(i)):s.push(i),i},vq=(s,e,t)=>{let r=null;for(const i of s)if(i.type===e.type&&i.isWallItem===e.isWallItem&&i.isGroupable)if(e.category===Pe.POSTER){if(i.stuffData.getLegacyString()===e.stuffData.getLegacyString()){r=i;break}}else if(e.category===Pe.GUILD_FURNI){if(e.stuffData.compare(i.stuffData)){r=i;break}}else{r=i;break}if(r){if(r.push(e),t){r.hasUnseenItems=!0;const i=s.indexOf(r);i>=0&&s.splice(i,1),s.unshift(r)}return r}return r=EI(e.type,e.category,e.stuffData,e.extra),r.push(e),t?(r.hasUnseenItems=!0,s.unshift(r)):s.push(r),r},pT=(s,e,t)=>{e.isGroupable?vq(s,e,t):yq(s,e,t)},Mq=(s,e,t,r)=>{if(e===1)return s;r[t]=s;for(const n of r)if(!n)return null;const i=new Map;for(const n of r){for(const[o,l]of n)i.set(o,l);n.clear()}return r=null,i},Dq=s=>{const e=[];for(const t of s){let r=t.getTotalCount();t.category===Pe.POST_IT&&(r=1);let i=0;for(;i<r;)e.push(t.getItemByIndex(i).id),i++}return e};let xL=!1,wL=-1;const FL=()=>xL,Qc=s=>xL=s,bc=()=>wL,hg=s=>wL=s,zu=()=>{bc()!==-1&&(te().cancelRoomObjectPlacement(),hg(-1),Qc(!1))},Kf=(s,e=!1)=>{const t=s.petData;if(!t)return!1;const r=Nl().getSession(1);return!r||!r.isRoomOwner&&!r.allowPets?!1:(Le("inventory/hide"),te().processRoomObjectPlacement(Co.INVENTORY,-t.id,z.UNIT,jt.PET,t.figureData.figuredata)&&(hg(t.id),Qc(!0)),!0)},yc=(s,e=!1)=>{if(!s||!s.getUnlockedCount())return!1;const t=s.getLastItem();if(!t)return!1;if(t.category===Pe.FLOOR||t.category===Pe.WALL_PAPER||t.category===Pe.LANDSCAPE)return e||W(new Ou(t.id)),!1;{Le("inventory/hide");let r=0,i=!1;t.isWallItem?r=z.WALL:r=z.FLOOR,t.category===Pe.POSTER?i=te().processRoomObjectPlacement(Co.INVENTORY,t.id,r,t.type,t.stuffData.getLegacyString()):i=te().processRoomObjectPlacement(Co.INVENTORY,t.id,r,t.type,t.extra.toString(),t.stuffData),i&&(hg(t.ref),Qc(!0))}return!0},qf=(s,e=!1)=>{const t=s.botData;if(!t)return!1;const r=Nl().getSession(1);return!r||!r.isRoomOwner?!1:(Le("inventory/hide"),te().processRoomObjectPlacement(Co.INVENTORY,-t.id,z.UNIT,jt.RENTABLE_BOT,t.figure)&&(hg(t.id),Qc(!0)),!0)};class os{}os.FURNI=1;os.RENTABLE=2;os.PET=3;os.BADGE=4;os.BOT=5;os.GAMES=6;const Pq=s=>s.map(e=>e.petData.id),kL=(s,e,t=!0)=>{const r={petData:s};return t?e.unshift(r):e.push(r),r},GL=(s,e)=>{let t=0;for(;t<e.length;){const r=e[t];if(r&&r.petData.id===s)return bc()===r.petData.id&&(zu(),Le("inventory/open")),e.splice(t,1),r;t++}return null},Lq=(s,e,t)=>{const r=Pq(s),i=[],n=[];for(const o of e.keys())r.indexOf(o)===-1&&i.push(o);for(const o of r)!e.get(o)&&n.push(o);r.length;for(const o of n)GL(o,s);for(const o of i){const l=e.get(o);l&&kL(l,s,t(os.PET,l.id))}return s},Uq=(s,e,t,r)=>{if(e===1)return s;r[t]=s;for(const n of r)if(!n)return null;const i=new Map;for(const n of r){for(const[o,l]of n)i.set(o,l);n.clear()}return r=null,i};class ps{}ps.TRADING_STATE_READY=0;ps.TRADING_STATE_RUNNING=1;ps.TRADING_STATE_COUNTDOWN=2;ps.TRADING_STATE_CONFIRMING=3;ps.TRADING_STATE_CONFIRMED=4;ps.TRADING_STATE_COMPLETED=5;ps.TRADING_STATE_CANCELLED=6;class ET{constructor(e=-1,t="",r=new As,i=0,n=0,o=!1,l=!1){this.userId=e,this.userName=t,this.userItems=r,this.itemCount=i,this.creditsCount=n,this.accepts=o,this.canTrade=l}}class js{}js.ALERT_SCAM=0;js.HOTEL_TRADING_DISABLED=1;js.YOU_NOT_ALLOWED=2;js.THEY_NOT_ALLOWED=4;js.ROOM_DISABLED=6;js.YOU_OPEN=7;js.THEY_OPEN=8;js.ERROR_WHILE_COMMIT=9;js.THEY_CANCELLED=10;const IT=s=>{var e;return((e=ie().getWallItemData(s))==null?void 0:e.isExternalImage)||!1},TT=s=>{const e=new As;if(s.length)for(const r of s){const i=r.spriteId,n=r.category;let o=r.furniType+i;(!r.isGroupable||IT(i))&&(o="itemid"+r.itemId),r.category===Pe.POSTER?o=r.itemId+"poster"+r.stuffData.getLegacyString():r.category===Pe.GUILD_FURNI&&(o="");let l=r.isGroupable&&!IT(r.spriteId)?e.getValue(o):null;l||(l=EI(i,n,r.stuffData),e.add(o,l)),l.push(new Yu(r))}return e},xq=(s,e)=>{let t=s.toString();if(!(e instanceof vn))return t;let r=1;for(;r<5;)t=t+(","+e.getValue(r)),r++;return t};class Ad{static getProductImageUrl(e,t,r){let i=null;switch(e){case bi.S:i=te().getFurnitureFloorIconUrl(t);break;case bi.I:this.getProductCategory(bi.I,t)===1&&(i=te().getFurnitureWallIconUrl(t,r));break}return i}static getProductCategory(e,t){if(e===bi.S)return 1;if(e===bi.I){if(t===3001)return Pe.WALL_PAPER;if(t===3002)return Pe.FLOOR;if(t===4057)return Pe.LANDSCAPE}return 1}}class h_{static getRandomNumber(e){return Math.floor(Math.random()*e)}static getRandomElement(e){return e[this.getRandomNumber(e.length)]}static getRandomElements(e,t){const r=new Array(t);let i=e.length;const n=new Array(i);for(;t--;){var o=this.getRandomNumber(i);r[t]=e[o in n?n[o]:o],n[o]=--i in n?n[i]:i}return r}}const qs=new Map;qs.set("r","red");qs.set("b","blue");qs.set("g","green");qs.set("y","yellow");qs.set("w","white");qs.set("o","orange");qs.set("c","cyan");qs.set("br","brown");qs.set("pr","purple");qs.set("pk","pink");qs.set("red","red");qs.set("blue","blue");qs.set("green","green");qs.set("yellow","yellow");qs.set("white","white");qs.set("orange","orange");qs.set("cyan","cyan");qs.set("brown","brown");qs.set("purple","purple");qs.set("pink","pink");const wq=s=>s.replace(/([\u00A0-\u9999<>&])(.|$)/g,(e,t,r)=>t!=="&"||r!=="#"?(/[\u00A0-\u9999<>&]/.test(r)&&(r="&#"+r.charCodeAt(0)+";"),"&#"+t.charCodeAt(0)+";"+r):e),Fq=s=>{let e="";if(s=wq(s),s.startsWith("@")&&s.indexOf("@",1)>-1){let t=null;for(;(t=/@[a-zA-Z]+@/g.exec(s))!==null;){const r=t[0].toString(),i=r.substr(1,r.length-2),n=s.replace(r,"");qs.has(i)?e='<span style="color: '+qs.get(i)+'">'+n+"</span>":e=n;break}}else e=s;return e},II=(s,e)=>window.localStorage.setItem(s,JSON.stringify(e));class pi{}pi.CAMERA_SHUTTER="camera_shutter";pi.CREDITS="credits";pi.DUCKETS="duckets";pi.MESSENGER_NEW_THREAD="messenger_new_thread";pi.MESSENGER_MESSAGE_RECEIVED="messenger_message_received";pi.MODTOOLS_NEW_TICKET="modtools_new_ticket";function kq(s){const e=s.parts;let t=0;for(const r of e)t=Math.max(t,r.colorLayerIndex);return t}function Gq(s,e){return e=e.filter(t=>s.indexOf(t)===-1),[...s,...h_.getRandomElements(e,h_.getRandomNumber(e.length)+1)]}function Bq(s,e,t=0,r=[]){if(!s)return null;const i=s.partSets.getValues().filter(n=>!n.isSelectable||n.gender!=="U"&&n.gender!==e||n.clubLevel>t||n.isSellable&&r.indexOf(n.id)===-1?null:n);return!i||!i.length?null:h_.getRandomElement(i)}function Vq(s,e,t=0){if(!s)return[];const r=s.colors.getValues().filter(i=>!i.isSelectable||i.clubLevel>t?null:i);return!r||!r.length?null:h_.getRandomElements(r,kq(e))}function Hq(s,e,t=0,r=[],i=[]){const n=Ks().structure,o=new Su(""),l=Gq(n.getMandatorySetTypeIds(e,t),Je.SET_TYPES);for(const c of i){const h=s.getPartSetId(c),u=s.getColorIds(c);o.updatePart(c,h,u)}for(const c of l){if(o.hasPartType(c))continue;const h=n.figureData.getSetType(c),u=Bq(h,e,t,r);if(!u)continue;let g=[];u.isColorable&&(g=Vq(n.figureData.getPalette(h.paletteID),u,t).map(m=>m.id)),o.updatePart(h.type,u.id,g)}return o.getFigureString()}class Wq extends ug{init(){super.init(),this.addCategory(Je.HAIR),this.addCategory(Je.HAT),this.addCategory(Je.HEAD_ACCESSORIES),this.addCategory(Je.EYE_ACCESSORIES),this.addCategory(Je.FACE_ACCESSORIES),this._isInitalized=!0}get name(){return Br.HEAD}}class jq extends ug{init(){super.init(),this.addCategory(Je.TROUSERS),this.addCategory(Je.SHOES),this.addCategory(Je.TROUSER_ACCESSORIES),this._isInitalized=!0}get name(){return Br.LEGS}}class Yq extends ug{init(){super.init(),this.addCategory(Je.SHIRT),this.addCategory(Je.CHEST_PRINTS),this.addCategory(Je.JACKET),this.addCategory(Je.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return Br.TORSO}}class Ku{}Ku.COLORMATRIX="colormatrix";Ku.COMPOSITE="composite";class zq{constructor(e,t){this.texture=e,this.imageUrl=t}}class Kq{constructor(e,t){this.effectName=e,this.thumbnailUrl=t}}class qq{constructor(e,t,r){this._productName=e,this._customImage=t,this._furnitureClassName=r}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class Er{}Er.STATE_UNLOCKED=1;Er.STATE_LOCKED_AVAILABLE=2;Er.STATE_LOCKED_EXPIRED=3;Er.STATE_LOCKED_FUTURE=4;class rn{}rn.TYPE_CHAT=1;rn.TYPE_ROOM_INFO=2;rn.TYPE_IM=3;const BL=()=>{const s=new Date;return`${s.getHours().toString().padStart(2,"0")}:${s.getMinutes().toString().padStart(2,"0")}`},RT=(s=0)=>{const e=s?new Date(Date.now()-s*1e3):new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},VL=s=>{if(!s||!s.length)return null;const e=s.split("/"),t=e[0],r=e[1],i=parseInt(e[2]);return{username:t,figure:r,userId:i}};class Pr{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(e){this.id=e.id,this.name=e.name,this.gender=e.gender,this.online=e.online,this.followingAllowed=e.followingAllowed,this.figure=e.figure,this.categoryId=e.categoryId,this.motto=e.motto,this.realName=e.realName,this.lastAccess=e.lastAccess,this.persistedMessageUser=e.persistedMessageUser,this.vipMember=e.vipMember,this.pocketHabboUser=e.pocketHabboUser,this.relationshipStatus=e.relationshipStatus}}Pr.RELATIONSHIP_NONE=0;Pr.RELATIONSHIP_HEART=1;Pr.RELATIONSHIP_SMILE=2;Pr.RELATIONSHIP_BOBBA=3;class _l{}_l.GROUP_CHAT=0;_l.PRIVATE_CHAT=1;class Nn{}Nn.HIDDEN=0;Nn.SHOW=1;Nn.UNREAD=2;class ST{populate(e){return e?(this._id=e.requestId,this._name=e.requesterName,this._figureString=e.figureString,this._requesterUserId=e.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class Xq{constructor(e=0,t=0,r=0,i=[]){this.userFriendLimit=e,this.normalFriendLimit=t,this.extendedFriendLimit=r,this.categories=i}}class bn{constructor(e,t,r=0,i=null,n=0){this._type=n,this._senderId=e,this._message=t,this._secondsSinceSent=r,this._extraData=i,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}}bn.CHAT=0;bn.ROOM_INVITE=1;bn.STATUS_NOTIFICATION=2;bn.SECURITY_NOTIFICATION=3;class Qq{constructor(e,t=_l.PRIVATE_CHAT){this._userId=e,this._chats=[],this._type=t}addChat(e){this._chats.push(e)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(e){this._type=e}}const HL=class{constructor(s){this._threadId=++HL.THREAD_ID,this._participant=s,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(s,e,t=0,r=null,i=0){const n=s<0&&r,o=n?VL(r).userId:s,l=this.getLastGroup(o);if(!l)return;n&&(l.type=_l.GROUP_CHAT);const c=new bn(s,e,t,r,i);return l.addChat(c),this._lastUpdated=new Date,this._unreadCount++,c}getLastGroup(s){let e=this._groups[this._groups.length-1];return e&&e.userId===s||(e=new Qq(s),this._groups.push(e)),e}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};let TI=HL;TI.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED";TI.THREAD_ID=0;function dg(s=0){Le(s===0?"friends-messenger/toggle":`friends-messenger/${s}`)}const $q=()=>Uc.RENDERER_VERSION,WL=()=>"2.1.1";function Sh(s){W(new Rc(s,!0))}function jL(s){Le(`groups/manage/${s}`)}function OT(s,e){Le(e?`group-members/${s}/${e}`:`group-members/${s}`)}const Xf=class{constructor(s,e,t,r){this.type=s,this.key=e||0,this.color=t||0,this.position=r||4}get code(){return this.key===0&&this.type!==Xf.BASE?null:Xf.getCode(this.type,this.key,this.color,this.position)}static getCode(s,e,t,r){return s+(e<10?"0":"")+e+(t<10?"0":"")+t+r}};let Fr=Xf;Fr.BASE="b";Fr.SYMBOL="s";class Zs{}Zs.NOT_MEMBER=0;Zs.MEMBER=1;Zs.REQUEST_PENDING=2;class hi{}hi.REGULAR=0;hi.EXCLUSIVE=1;hi.PRIVATE=2;const Jq=s=>{W(s.favourite?new sv(s.groupId):new Ky(s.groupId))},RI=s=>W(new qy(s));class rt{}rt.NONE="NONE";rt.ERROR="ERROR";rt.REJECTED="REJECTED";rt.USER_CREATE="USER_CREATE";rt.USER_PENDING="USER_PENDING";rt.USER_ONGOING="USER_ONGOING";rt.USER_FEEDBACK="USER_FEEDBACK";rt.USER_NO_HELPERS="USER_NO_HELPERS";rt.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG";rt.USER_THANKS="USER_THANKS";rt.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED";rt.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU";rt.GUIDE_ACCEPT="GUIDE_ACCEPT";rt.GUIDE_ONGOING="GUIDE_ONGOING";rt.GUIDE_CLOSED="GUIDE_CLOSED";rt.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT";rt.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS";rt.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE";rt.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS";rt.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";class CT{constructor(e,t){this._message=e,this._roomId=t}get message(){return this._message}get roomId(){return this._roomId}}class AT{constructor(e){this._userId=e,this._messages=[]}addChat(e){this._messages.push(e)}get userId(){return this._userId}get messages(){return this._messages}}class On{}On.ACTIVE="active";On.NONE="none";On.EXPIRED="expired";const Zq="HC1",eX=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],tX=s=>{let e=null;return eX.forEach(t=>s.indexOf(t)>-1&&(e=t)),e||Zq};class d_{}d_.TOO_MANY_PENDING_CALLS_CODE=1;d_.HAS_ABUSIVE_CALL_CODE=2;const sX=s=>s===1?"useless":s===2?"abusive":"resolved";class ur{}ur.SELECT_USER=0;ur.SELECT_CHATS=1;ur.SELECT_TOPICS=2;ur.INPUT_REPORT_MESSAGE=3;ur.REPORT_SUMMARY=4;class Qt{}Qt.EMERGENCY=1;Qt.GUIDE=2;Qt.IM=3;Qt.ROOM=4;Qt.BULLY=6;Qt.THREAD=7;Qt.MESSAGE=8;Qt.PHOTO=9;const rX=s=>{switch(s){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"};class Gt{constructor(e,t,r,i,n){this._actionId=e,this._name=t,this._actionType=r,this._sanctionTypeId=i,this._actionLengthHours=n}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}}Gt.ALERT=1;Gt.MUTE=2;Gt.BAN=3;Gt.KICK=4;Gt.TRADE_LOCK=5;Gt.MESSAGE=6;class Pt{}Pt.NONE=0;Pt.START_DOORBELL=1;Pt.START_PASSWORD=2;Pt.STATE_PENDING_SERVER=3;Pt.UPDATE_STATE=4;Pt.STATE_WAITING=5;Pt.STATE_NO_ANSWER=6;Pt.STATE_WRONG_PASSWORD=7;Pt.STATE_ACCEPTED=8;class Ra{}Ra.LIST=0;Ra.THUMBNAILS=1;Ra.FORCED_THUMBNAILS=2;const iX=()=>{const s=[];for(let e=10;e<=100;e=e+10)s.push(e);return s},NT=iX(),Pl=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function Wr(s){W(new Bu(s,!1,!0))}class Ze{}Ze.DEFAULT="default";Ze.MOTD="motd";Ze.MODERATION="moderation";Ze.EVENT="event";Ze.NITRO="nitro";Ze.SEARCH="search";Ze.ALERT="alert";Ze.ABOUT_ALERT="aboutalert";const Qf=class{constructor(s,e=Ze.DEFAULT,t=null,r=null,i=null,n=null,o=null,l=null,c=null,h=null,u=null,g=null,m=null,p=null,f=null,T=null,I=null,O=null,A=null,N=null,P=null,y=null,D=null){Qf.ITEM_ID+=1,this._id=Qf.ITEM_ID,this._messages=s,this._alertType=e,this._clickUrl=t,this._clickUrlText=r,this._title=i,this._imageUrl=n,this._roomId=o,this._roomName=l,this._username=c,this._look=h,this._message=u,this._typeGalert=g,this._version=m,this._onlineUsers=p,this._activeRooms=f,this._catalogPages=T,this._items=I,this._furnis=O,this._uptime=A,this._ramUsage=N,this._cpuCores=P,this._totalMemory=y,this._hotelName=D}get id(){return this._id}get messages(){return this._messages}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}get roomId(){return this._roomId}get roomName(){return this._roomName}get username(){return this._username}get look(){return this._look}get message(){return this._message}get typeGalert(){return this._typeGalert}get version(){return this._version}get onlineUsers(){return this._onlineUsers}get activeRooms(){return this._activeRooms}get catalogPages(){return this._catalogPages}get items(){return this._items}get furnis(){return this._furnis}get uptime(){return this._uptime}get ramUsage(){return this._ramUsage}get cpuCores(){return this._cpuCores}get totalMemory(){return this._totalMemory}get hotelName(){return this._hotelName}};let Nd=Qf;Nd.ITEM_ID=-1;class ls{}ls.FRIENDOFFLINE="friendoffline";ls.FRIENDONLINE="friendonline";ls.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline";ls.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline";ls.ACHIEVEMENT="achievement";ls.BADGE_RECEIVED="badge_received";ls.INFO="info";ls.RECYCLEROK="recyclerok";ls.RESPECT="respect";ls.CLUB="club";ls.SOUNDMACHINE="soundmachine";ls.PETLEVEL="petlevel";ls.CLUBGIFT="clubgift";ls.BUYFURNI="buyfurni";ls.VIP="vip";ls.ROOMMESSAGESPOSTED="roommessagesposted";const $f=class{constructor(s,e=ls.INFO,t=null,r=null){$f.ITEM_ID+=1,this._id=$f.ITEM_ID,this._message=s,this._notificationType=e,this._iconUrl=t,this._linkUrl=r}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};let YL=$f;YL.ITEM_ID=-1;const Jf=class{constructor(s,e,t,r,i,n,o){Jf.ITEM_ID+=1,this._id=Jf.ITEM_ID,this._confirmType=s,this._message=e,this._onConfirm=t,this._onCancel=r,this._confirmText=i,this._cancelText=n,this._title=o}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};let zL=Jf;zL.ITEM_ID=-1;class SI{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(e){const t=new SI;return t._credits=e._credits,t._activityPoints=e._activityPoints,t._clubDays=e._clubDays,t._clubPeriods=e._clubPeriods,t._isVIP=e._isVIP,t._pastClubDays=e._pastClubDays,t._pastVipDays=e._pastVipDays,t._isExpiring=e._isExpiring,t._minutesUntilExpiration=e._minutesUntilExpiration,t._minutesSinceLastModified=e._minutesSinceLastModified,t._lastUpdated=e._lastUpdated,t}get credits(){return this._credits}set credits(e){this._lastUpdated=tt(),this._credits=e}get activityPoints(){return this._activityPoints}set activityPoints(e){this._lastUpdated=tt(),this._activityPoints=e}get clubDays(){return this._clubDays}set clubDays(e){this._lastUpdated=tt(),this._clubDays=e}get clubPeriods(){return this._clubPeriods}set clubPeriods(e){this._lastUpdated=tt(),this._clubPeriods=e}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(e){this._isVIP=e}get pastClubDays(){return this._pastClubDays}set pastClubDays(e){this._lastUpdated=tt(),this._pastClubDays=e}get pastVipDays(){return this._pastVipDays}set pastVipDays(e){this._lastUpdated=tt(),this._pastVipDays=e}get isExpiring(){return this._isExpiring}set isExpiring(e){this._isExpiring=e}get minutesUntilExpiration(){var e=(tt()-this._lastUpdated)/6e4,t=this._minutesUntilExpiration-e;return t>0?t:0}set minutesUntilExpiration(e){this._lastUpdated=tt(),this._minutesUntilExpiration=e}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(e){this._lastUpdated=tt(),this._minutesSinceLastModified=e}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?Lr.NO_CLUB:this.isVip?Lr.VIP:Lr.CLUB}}class Oh extends ct{}class Sa extends Oh{constructor(e,t){super(e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=t}get id(){return this._id}get summary(){return this._summary}set summary(e){this._summary=e}get headline(){return this._headline}set headline(e){this._headline=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}}Sa.OFFER="RWPUW_OFFER";Sa.ERROR="RWPUW_ERROR";Sa.CONTENT="RWPUW_CONTENT";class go extends Oh{constructor(e,t=0,r=0,i=0){super(e),this._hue=t,this._saturation=r,this._lightness=i}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}go.PREVIEW="RWUBCPE_PREVIEW";go.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";const KL=class extends Oh{constructor(s,e){super(KL.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=s,this._userName=e}get chatMode(){return this._chatMode}get userName(){return this._userName}};let Oo=KL;Oo.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT";Oo.WHISPER="whisper";Oo.SHOUT="shout";const qL=class extends Oh{constructor(s,e,t,r,i,n,o){super(qL.UPDATE_CHAT),this._objectId=s,this._category=e,this._botId=t,this._chat=r,this._automaticChat=i,this._chatDelay=n,this._mixSentences=o}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};let OI=qL;OI.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";class Ct extends Oh{constructor(e,t,r,i){super(e),this._id=t,this._category=r,this._roomId=i}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}}Ct.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED";Ct.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED";Ct.USER_REMOVED="RWUROE_USER_REMOVED";Ct.FURNI_REMOVED="RWUROE_FURNI_REMOVED";Ct.FURNI_ADDED="RWUROE_FURNI_ADDED";Ct.USER_ADDED="RWUROE_USER_ADDED";Ct.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER";Ct.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT";Ct.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION";Ct.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";class vc{constructor(e){this.type=e,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1}}vc.FURNI="IFI_FURNI";class XL{constructor(e,t,r,i,n,o=!1){this.roomIndex=e,this.category=t,this.id=r,this.name=i,this.userType=n,this.isFriend=o}}class Mc{constructor(e){this.type=e,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}}Mc.PET_INFO="IPI_PET_INFO";class Dc{constructor(e){this.type=e,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}}Dc.RENTABLE_BOT="IRBI_RENTABLE_BOT";const QL=class{constructor(s){this.type=s,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===QL.OWN_USER}};let fs=QL;fs.OWN_USER="IUI_OWN_USER";fs.PEER="IUI_PEER";fs.BOT="IUI_BOT";fs.TRADE_REASON_OK=0;fs.TRADE_REASON_SHUTDOWN=2;fs.TRADE_REASON_NO_TRADING=3;fs.DEFAULT_BOT_BADGE_ID="BOT";class Ll{static getObjectName(e,t){const r=bt();let i=-1,n=null,o=0;switch(t){case z.FLOOR:case z.WALL:{const l=te().getRoomObject(r.roomId,e,t);if(!l)break;if(l.type.indexOf("poster")===0)n=E("${poster_"+parseInt(l.type.replace("poster",""))+"_name}");else{let c=null;const h=l.model.getValue(b.FURNITURE_TYPE_ID);if(t===z.FLOOR?c=ie().getFloorItemData(h):t===z.WALL&&(c=ie().getWallItemData(h)),!c)break;i=c.id,n=c.name}break}case z.UNIT:{const l=r.userDataManager.getUserDataByIndex(e);if(!l)break;i=l.webID,n=l.name,o=l.type;break}}return!n||!n.length?null:new XL(e,t,i,n,o)}static getFurniInfo(e,t){const r=bt(),i=new vc(vc.FURNI);i.id=e,i.category=t;const n=te().getRoomObject(r.roomId,e,t);if(!n)return;const o=n.model;o.getValue(ms.INFOSTAND_EXTRA_PARAM)&&(i.extraParam=o.getValue(ms.INFOSTAND_EXTRA_PARAM));const l=o.getValue(b.FURNITURE_DATA_FORMAT),c=$n.getData(l);c.initializeFromRoomObjectModel(o),i.stuffData=c;const h=n.type;if(h.indexOf("poster")===0){const f=parseInt(h.replace("poster",""));i.name=E("${poster_"+f+"_name}"),i.description=E("${poster_"+f+"_desc}")}else{const f=o.getValue(b.FURNITURE_TYPE_ID);let T=null;t===z.FLOOR?T=ie().getFloorItemData(f):t===z.WALL&&(T=ie().getWallItemData(f)),T&&(i.name=T.name,i.description=T.description,i.purchaseOfferId=T.purchaseOfferId,i.purchaseCouldBeUsedForBuyout=T.purchaseCouldBeUsedForBuyout,i.rentOfferId=T.rentOfferId,i.rentCouldBeUsedForBuyout=T.rentCouldBeUsedForBuyout,i.availableForBuildersClub=T.availableForBuildersClub,i.tileSizeX=T.tileSizeX,i.tileSizeY=T.tileSizeY)}h.indexOf("post_it")>-1&&(i.isStickie=!0);const u=o.getValue(b.FURNITURE_EXPIRY_TIME),g=o.getValue(b.FURNITURE_EXPIRTY_TIMESTAMP);i.expiration=u<0?u:Math.max(0,u-(tt()-g)/1e3);let m=te().getRoomObjectImage(r.roomId,e,t,new G(180),64,null);(!m.data||m.data.width>140||m.data.height>200)&&(m=te().getRoomObjectImage(r.roomId,e,t,new G(180),1,null)),i.image=m.getImage(),i.isWallItem=t===z.WALL,i.isRoomOwner=r.isRoomOwner,i.roomControllerLevel=r.controllerLevel,i.isAnyRoomController=ie().isModerator,i.ownerId=o.getValue(b.FURNITURE_OWNER_ID),i.ownerName=o.getValue(b.FURNITURE_OWNER_NAME),i.usagePolicy=o.getValue(b.FURNITURE_USAGE_POLICY);const p=o.getValue(b.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return p!==0&&(i.groupId=p),Dr(n)&&(i.isOwner=!0),i}static getUserInfo(e,t){const r=bt();let i=fs.OWN_USER;t.webID!==ie().userId&&(i=fs.PEER);const n=new fs(i);n.isSpectatorMode=r.isSpectator,n.name=t.name,n.motto=t.custom,n.achievementScore=t.activityPoints,n.webID=t.webID,n.roomIndex=t.roomIndex,n.userType=jt.USER;const o=te().getRoomObject(r.roomId,t.roomIndex,e);if(o&&(n.carryItem=o.model.getValue(b.FIGURE_CARRY_OBJECT)||0),i===fs.OWN_USER&&(n.allowNameChange=ie().canChangeName),n.amIOwner=r.isRoomOwner,n.isGuildRoom=r.isGuildRoom,n.roomControllerLevel=r.controllerLevel,n.amIAnyRoomController=ie().isModerator,n.isAmbassador=ie().isAmbassador,i===fs.PEER){if(o){const h=o.model.getValue(b.FIGURE_FLAT_CONTROL);h!==null&&(n.targetRoomControllerLevel=h),n.canBeMuted=this.canBeMuted(n),n.canBeKicked=this.canBeKicked(n),n.canBeBanned=this.canBeBanned(n)}n.isIgnored=ie().isUserIgnored(t.name),n.respectLeft=ie().respectsLeft;const l=ie().isSystemShutdown,c=r.tradeMode;if(l)n.canTrade=!1;else switch(c){case cl.ROOM_CONTROLLER_REQUIRED:{const h=n.roomControllerLevel!==Rt.NONE&&n.roomControllerLevel!==Rt.GUILD_MEMBER,u=n.targetRoomControllerLevel!==Rt.NONE&&n.targetRoomControllerLevel!==Rt.GUILD_MEMBER;n.canTrade=h||u;break}case cl.NO_TRADING:n.canTrade=!0;break;default:n.canTrade=!1;break}n.canTradeReason=fs.TRADE_REASON_OK,l&&(n.canTradeReason=fs.TRADE_REASON_SHUTDOWN),c!==cl.FREE_TRADING&&(n.canTradeReason=fs.TRADE_REASON_NO_TRADING)}return n.groupId=t.groupId,n.groupBadgeId=ie().getGroupBadge(n.groupId),n.groupName=t.groupName,n.badges=r.userDataManager.getUserBadges(t.webID),n.figure=t.figure,n}static getBotInfo(e,t){const r=bt(),i=new fs(fs.BOT);i.name=t.name,i.motto=t.custom,i.webID=t.webID,i.roomIndex=t.roomIndex,i.userType=t.type;const n=te().getRoomObject(r.roomId,t.roomIndex,e);return n&&(i.carryItem=n.model.getValue(b.FIGURE_CARRY_OBJECT)||0),i.amIOwner=r.isRoomOwner,i.isGuildRoom=r.isGuildRoom,i.roomControllerLevel=r.controllerLevel,i.amIAnyRoomController=ie().isModerator,i.isAmbassador=ie().isAmbassador,i.badges=[fs.DEFAULT_BOT_BADGE_ID],i.figure=t.figure,i}static getRentableBotInfo(e,t){const r=bt(),i=new Dc(Dc.RENTABLE_BOT);i.name=t.name,i.motto=t.custom,i.webID=t.webID,i.roomIndex=t.roomIndex,i.ownerId=t.ownerId,i.ownerName=t.ownerName,i.botSkills=t.botSkills;const n=te().getRoomObject(r.roomId,t.roomIndex,e);return n&&(i.carryItem=n.model.getValue(b.FIGURE_CARRY_OBJECT)||0),i.amIOwner=r.isRoomOwner,i.roomControllerLevel=r.controllerLevel,i.amIAnyRoomController=ie().isModerator,i.badges=[fs.DEFAULT_BOT_BADGE_ID],i.figure=t.figure,i}static getPetInfo(e){const t=bt(),r=t.userDataManager.getPetData(e.id);if(!r)return;const i=new ra(r.figure);let n=null;i.typeId===ht.MONSTERPLANT&&(e.level>=e.adultLevel?n="std":n="grw"+e.level);const o=e.ownerId===ie().userId,l=new Mc(Mc.PET_INFO);return l.name=r.name,l.id=e.id,l.ownerId=e.ownerId,l.ownerName=e.ownerName,l.rarityLevel=e.rarityLevel,l.petType=i.typeId,l.petBreed=i.paletteId,l.petFigure=r.figure,l.posture=n,l.isOwner=o,l.roomIndex=r.roomIndex,l.level=e.level,l.maximumLevel=e.maximumLevel,l.experience=e.experience,l.levelExperienceGoal=e.levelExperienceGoal,l.energy=e.energy,l.maximumEnergy=e.maximumEnergy,l.happyness=e.happyness,l.maximumHappyness=e.maximumHappyness,l.respect=e.respect,l.respectsPetLeft=ie().respectsPetLeft,l.age=e.age,l.saddle=e.saddle,l.rider=e.rider,l.breedable=e.breedable,l.fullyGrown=e.fullyGrown,l.dead=e.dead,l.rarityLevel=e.rarityLevel,l.skillTresholds=e.skillTresholds,l.canRemovePet=!1,l.publiclyRideable=e.publiclyRideable,l.maximumTimeToLive=e.maximumTimeToLive,l.remainingTimeToLive=e.remainingTimeToLive,l.remainingGrowTime=e.remainingGrowTime,l.publiclyBreedable=e.publiclyBreedable,(o||t.isRoomOwner||ie().isModerator||t.controllerLevel>=Rt.GUEST)&&(l.canRemovePet=!0),l}static checkGuildSetting(e){return e.isGuildRoom?e.roomControllerLevel>=Rt.GUILD_ADMIN:e.roomControllerLevel>=Rt.GUEST}static isValidSetting(e,t){const r=bt();if(!r.isPrivateRoom)return!1;const i=r.moderationSettings;let n=!1;return i&&(n=t(e,i)),n&&e.targetRoomControllerLevel<Rt.ROOM_OWNER}static canBeMuted(e){const t=(r,i)=>{switch(i.allowMute){case kr.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=Rt.ROOM_OWNER}};return this.isValidSetting(e,t)}static canBeKicked(e){const t=(r,i)=>{switch(i.allowKick){case kr.MODERATION_LEVEL_ALL:return!0;case kr.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=Rt.ROOM_OWNER}};return this.isValidSetting(e,t)}static canBeBanned(e){const t=(r,i)=>{switch(i.allowBan){case kr.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=Rt.ROOM_OWNER}};return this.isValidSetting(e,t)}}class St{}St.GENERIC_SKILL=0;St.DRESS_UP=1;St.SETUP_CHAT=2;St.RANDOM_WALK=3;St.DANCE=4;St.CHANGE_BOT_NAME=5;St.SERVE_BEVERAGE=6;St.INCLIENT_LINK=7;St.NUX_PROCEED=8;St.CHANGE_BOT_MOTTO=9;St.NUX_TAKE_TOUR=10;St.NO_PICK_UP=12;St.NAVIGATOR_SEARCH=14;St.DONATE_TO_USER=24;St.DONATE_TO_ALL=25;const $L=class{constructor(s=-1,e=-1,t=-1,r="",i="",n="",o=null,l=0,c=0,h=null,u=null){this.senderId=s,this.senderCategory=e,this.roomId=t,this.text=r,this.formattedText=i,this.username=n,this.location=o,this.type=l,this.styleId=c,this.imageUrl=h,this.color=u,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++$L.BUBBLE_COUNTER}get top(){return this._top}set top(s){this._top=s,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(s){this._left=s,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};let JL=$L;JL.BUBBLE_COUNTER=0;class Cn{}Cn.CHAT_DEFAULT=0;Cn.CHAT_WHISPER=1;Cn.CHAT_SHOUT=2;class bT{constructor(e=0,t=0,r=0,i=0){this.id=e,this.type=t,this.color=r,this.light=i}}const nX=(s,e,t,r=0)=>!(s.left+r+s.width<e.left+r||s.left+r>e.left+r+e.width||s.top+s.height<e.top+t||s.top>e.top+t+e.height);class li{static savePreset(e,t,r,i,n){bt().updateMoodlightData(e,t,r,i,n)}static changeState(){bt().toggleMoodlightState()}static previewDimmer(e,t,r){te().updateObjectRoomColor(bt().roomId,e,t,r)}static scaleBrightness(e){return~~((e-this.MIN_BRIGHTNESS)*(100-0)/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}}li.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0];li.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"];li.MIN_BRIGHTNESS=76;li.MAX_BRIGHTNESS=255;const aX=130,oX=100,lX=130,cX=100,uX=130,hX=100,ZL=s=>{let e=0,t=0,r=0,i=0;for(;i<s.length;){switch(i%3){case 0:e=e+s.charCodeAt(i)*37;break;case 1:t=t+s.charCodeAt(i)*37;break;case 2:r=r+s.charCodeAt(i)*37;break}i++}return e=e%oX+aX,t=t%cX+lX,r=r%hX+uX,`rgb(${e},${t},${r})`};class mc{static getMergedMannequinFigureContainer(e,t){const r=Ks().createFigureContainer(e),i=Ks().createFigureContainer(t);for(const n of this.MANNEQUIN_CLOTHING_PART_TYPES)r.removePart(n);for(const n of i.getPartTypeIds())r.updatePart(n,i.getPartSetId(n),i.getPartColorIds(n));return r}static transformAsMannequinFigure(e){for(const t of e.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(t)>=0||e.removePart(t);e.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}}mc.MANNEQUIN_FIGURE=["hd",99999,[99998]];mc.MANNEQUIN_CLOTHING_PART_TYPES=[We.CHEST_ACCESSORY,We.COAT_CHEST,We.CHEST,We.LEGS,We.SHOES,We.WAIST_ACCESSORY];class __{}__.POSTURE_STAND=0;__.POSTURE_SIT=1;class uc{constructor(e,t,r){this._id=e,this._category=t,this._name=r}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class dX{constructor(e,t,r,i,n,o,l){this.id=e,this.category=t,this.name=r,this.requestRoomObjectId=i,this.targetRoomObjectId=n,this.requestInventoryStripId=o,this.replace=l}}const g_="0",e0="1";class tn{}tn.UNSTARTED=-1;tn.ENDED=0;tn.PLAYING=1;tn.PAUSED=2;tn.BUFFERING=3;tn.CUED=5;function ri(s){W(new rP(s))}const $c=s=>{const e=Math.floor(s/2);return s%2?(e+.5).toString():e.toString()};class we{}we.TOGGLE_FURNI_STATE=0;we.RESET=1;we.SET_FURNI_STATE=3;we.MOVE_FURNI=4;we.GIVE_SCORE=6;we.CHAT=7;we.TELEPORT=8;we.JOIN_TEAM=9;we.LEAVE_TEAM=10;we.CHASE=11;we.FLEE=12;we.MOVE_AND_ROTATE_FURNI=13;we.GIVE_SCORE_TO_PREDEFINED_TEAM=14;we.TOGGLE_TO_RANDOM_STATE=15;we.MOVE_FURNI_TO=16;we.GIVE_REWARD=17;we.CALL_ANOTHER_STACK=18;we.KICK_FROM_ROOM=19;we.MUTE_USER=20;we.BOT_TELEPORT=21;we.BOT_MOVE=22;we.BOT_TALK=23;we.BOT_GIVE_HAND_ITEM=24;we.BOT_FOLLOW_AVATAR=25;we.BOT_CHANGE_FIGURE=26;we.BOT_TALK_DIRECT_TO_AVTR=27;we.WALK_TO_FURNI=28;we.SET_ADD_POINTS=29;we.RESET_SUBSTRACT_POINTS=30;we.RELATIVE_MOVES=31;we.CLOSE_DICE=32;we.FURNI_TO_FURNI=33;we.TIMER_CONTROL=34;we.SET_HEIGHT=35;we.SEND_SIGNAL=36;we.SPEED_USER=37;we.GIVE_VARIABLE=38;we.REMOVE_VARIABLE=39;we.CHANGE_VARIABLE_VALUE=40;class Os{}Os.ANIMATION_TIME=0;Os.CARRY_USERS=1;Os.CANCEL_ANIMATION=2;Os.MOVEMENT_PHYSICS=3;Os.FURNI_VARIABLE=4;Os.USER_VARIABLE=5;Os.GLOBAL_VARIABLE=6;Os.USER_FILTER=7;Os.FURNI_FILTER_BY_VAR=8;Os.USERS_FILTER_BY_VAR=9;Os.VARIABLE_TEXT=10;Os.TEXT_OUTPUT_USERNAME=11;Os.TEXT_OUTPUT_VARIABLE=12;class ze{}ze.STATES_MATCH=0;ze.FURNIS_HAVE_AVATARS=1;ze.ACTOR_IS_ON_FURNI=2;ze.TIME_ELAPSED_MORE=3;ze.TIME_ELAPSED_LESS=4;ze.USER_COUNT_IN=5;ze.ACTOR_IS_IN_TEAM=6;ze.HAS_STACKED_FURNIS=7;ze.STUFF_TYPE_MATCHES=8;ze.STUFFS_IN_FORMATION=9;ze.ACTOR_IS_GROUP_MEMBER=10;ze.ACTOR_IS_WEARING_BADGE=11;ze.ACTOR_IS_WEARING_EFFECT=12;ze.NOT_STATES_MATCH=13;ze.FURNI_NOT_HAVE_HABBO=14;ze.NOT_ACTOR_ON_FURNI=15;ze.NOT_USER_COUNT_IN=16;ze.NOT_ACTOR_IN_TEAM=17;ze.NOT_HAS_STACKED_FURNIS=18;ze.NOT_FURNI_IS_OF_TYPE=19;ze.NOT_STUFFS_IN_FORMATION=20;ze.NOT_ACTOR_IN_GROUP=21;ze.NOT_ACTOR_WEARS_BADGE=22;ze.NOT_ACTOR_WEARING_EFFECT=23;ze.DATE_RANGE_ACTIVE=24;ze.ACTOR_HAS_HANDITEM=25;ze.ACTIVATOR_MATCH=26;ze.SELECT_QUANTITY=27;ze.HEIGHT=28;ze.HAS_VARIABLE=29;ze.HAS_VAR=30;ze.NEG_HAS_VAR=31;ze.VAR_VALUE_MATCH=32;ze.VAR_AGE_MATCH=33;const yT=s=>`${s.getFullYear()}/${("0"+(s.getMonth()+1)).slice(-2)}/${("0"+s.getDate()).slice(-2)} ${("0"+s.getHours()).slice(-2)}:${("0"+s.getMinutes()).slice(-2)}`;class Se{}Se.STUFF_SELECTION_OPTION_NONE=0;Se.STUFF_SELECTION_OPTION_BY_ID=1;Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2;Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;const _X=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,gX=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
uniform float alpha;
uniform float lineAlpha;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    // Mix the overlay color with the current texture color, preserving original alpha
    vec3 colorLine = lineColor;
    vec3 colorOverlay = color;

    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
        // For outlines, render the lineColor as-is but with configurable alpha multiplier so border can be more visible
        float outlineAlpha = clamp(lineAlpha, 0.0, 1.0);
        gl_FragColor = vec4(lineColor, currentColor.a * outlineAlpha);
    } else if(currentColor.a > 0.0) {
        // For the fill, blend the overlay with the underlying color so details remain visible
        vec3 mixed = mix(currentColor.rgb, colorOverlay, alpha);
        gl_FragColor = vec4(mixed, currentColor.a);
    }
}`;class CI extends cS{constructor(e,t,r=.35,i=.95){super(_X,gX),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.uniforms.alpha=r,this.uniforms.lineAlpha=i,this.lineColor=e,this.color=t,this._alpha=r,this._lineAlpha=i}get lineColor(){return this._lineColor}set lineColor(e){const t=this.uniforms.lineColor;typeof e=="number"?(Sr.hex2rgb(e,t),this._lineColor=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._lineColor=Sr.rgb2hex(t))}get color(){return this._color}set color(e){const t=this.uniforms.color;typeof e=="number"?(Sr.hex2rgb(e,t),this._color=e):(t[0]=e[0],t[1]=e[1],t[2]=e[2],this._color=Sr.rgb2hex(t))}get alpha(){return this._alpha}set alpha(e){e!==void 0&&(this.uniforms.alpha=e,this._alpha=e)}get lineAlpha(){return this._lineAlpha}set lineAlpha(e){e!==void 0&&(this.uniforms.lineAlpha=e,this._lineAlpha=e)}}const Ws=class{static hideSelectedWired(s){const e=Ws.getRoomObject(s);if(!e)return;const t=e.visualization;t&&(t.lookThroughCustom=!1)}static showSelectedWired(s){const e=Ws.getRoomObject(s);if(!e)return;const t=e.visualization;t&&(t.lookThroughCustom=!0)}static show(s){Ws.applySelectionShader(Ws.getRoomObject(s))}static hide(s){Ws.clearSelectionShader(Ws.getRoomObject(s))}static clearSelectionShaderFromFurni(s){for(const e of s)Ws.clearSelectionShader(Ws.getRoomObject(e))}static applySelectionShaderToFurni(s){for(const e of s)Ws.applySelectionShader(Ws.getRoomObject(e))}static applySelectionShaderToFurniYellow(s){for(const e of s)Ws.applySelectionShaderWithFilter(Ws.getRoomObject(e),Ws._selectionYellowShader)}static clearSelectionShaderFromFurniYellow(s){for(const e of s)Ws.clearSelectionShader(Ws.getRoomObject(e))}static applySelectionShaderToFurniBlue(s){for(const e of s)Ws.applySelectionShaderWithFilter(Ws.getRoomObject(e),Ws._selectionBlueShader)}static clearSelectionShaderFromFurniBlue(s){for(const e of s)Ws.clearSelectionShader(Ws.getRoomObject(e))}static getRoomObject(s){const e=te();return e.getRoomObject(e.activeRoomId,s,z.FLOOR)}static applySelectionShader(s){if(!s)return;const e=s.visualization;if(e)for(const t of e.sprites)t.blendMode!==1&&(t.filters=[Ws._selectionShader])}static applySelectionShaderWithFilter(s,e){if(!s)return;const t=s.visualization;if(t)for(const r of t.sprites)r.blendMode!==1&&(r.filters=[e])}static clearSelectionShader(s){if(!s)return;const e=s.visualization;if(e)for(const t of e.sprites)t.filters=[]}};let qt=Ws;qt._selectionShader=new CI([1,1,1],[.6,.6,.6],.75,.95);qt._selectionYellowShader=new CI([1,.85,.4],[.8,.7,.3],.35,.95);qt._selectionBlueShader=new CI([.4,.6,1],[.25,.45,.9],.35,.95);class Kt{}Kt.FURNI_AREA=0;Kt.USERS_NEIGHBOR=1;Kt.FURNI_NEIGHBOR=2;Kt.FURNI_BY_TYPE=3;Kt.FURNI_FILTER=4;Kt.USER_FILTER=5;Kt.USER_BY_NAME=6;Kt.FURNI_BY_HEIGHT=7;Kt.FURNI_ON_FURNI=8;Kt.USER_ON_FURNI=9;Kt.USER_ON_TEAM=10;Kt.USER_HAVE_HANDITEM=11;Kt.FURNI_PICKS=12;Kt.USERS_BY_TYPE=13;Kt.USERS_BY_ACTION=14;Kt.USER_SIGNALS=15;Kt.FURNI_WITH_VAR=16;Kt.USERS_WITH_VAR=17;const on="	";class Nt{}Nt.AVATAR_SAYS_SOMETHING=0;Nt.AVATAR_WALKS_ON_FURNI=1;Nt.AVATAR_WALKS_OFF_FURNI=2;Nt.EXECUTE_ONCE=3;Nt.TOGGLE_FURNI=4;Nt.EXECUTE_PERIODICALLY=6;Nt.AVATAR_ENTERS_ROOM=7;Nt.GAME_STARTS=8;Nt.GAME_ENDS=9;Nt.SCORE_ACHIEVED=10;Nt.COLLISION=11;Nt.EXECUTE_PERIODICALLY_LONG=12;Nt.BOT_REACHED_STUFF=13;Nt.BOT_REACHED_AVATAR=14;Nt.STATE_MODIFIED=15;Nt.BY_ACTION=16;Nt.AVATAR_CLICKED=17;Nt.COMMAND_EXEC=18;Nt.KEYBOARD_INPUT=19;Nt.VARIABLE_EVENT=20;const K=s=>{const{ref:e=null,innerRef:t=null,display:r=null,fit:i=!1,fitV:n=!1,grow:o=!1,shrink:l=!1,fullWidth:c=!1,fullHeight:h=!1,overflow:u=null,position:g=null,float:m=null,pointer:p=!1,visible:f=null,textColor:T=null,classNames:I=[],className:O="",style:A={},children:N=null,...P}=s,y=d.exports.useMemo(()=>{const w=[];return r&&r.length&&w.push("d-"+r),(i||c)&&w.push("w-100"),(i||h)&&w.push("h-100"),n&&w.push("vw-100","vh-100"),o&&w.push("flex-grow-1"),l&&w.push("flex-shrink-0"),u&&w.push("overflow-"+u),g&&w.push("position-"+g),m&&w.push("float-"+m),p&&w.push("cursor-pointer"),f!==null&&w.push(f?"visible":"invisible"),T&&w.push("text-"+T),I.length&&w.push(...I),w},[r,i,n,o,l,c,h,u,g,m,p,f,T,I]),D=d.exports.useMemo(()=>{let w=y.join(" ");return O.length&&(w+=" "+O),w.trim()},[y,O]),x=d.exports.useMemo(()=>{let w={};return Object.keys(A).length&&(w={...w,...A}),w},[A]);return a("div",{ref:t,className:D,style:x,...P,children:N})},t0=d.exports.createContext({isCssGrid:!1}),mX=s=>a(t0.Provider,{value:s.value,children:s.children}),fX=()=>d.exports.useContext(t0),qe=s=>{const{inline:e=!1,gap:t=2,maxContent:r=!1,columnCount:i=0,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,fullHeight:h=!0,classNames:u=[],style:g={},...m}=s,p=d.exports.useMemo(()=>{const T=[];return e?T.push("inline-grid"):T.push("grid"),t?T.push("gap-"+t):t===0&&T.push("gap-0"),r&&T.push("flex-basis-max-content"),o&&T.push("align-self-"+o),l&&T.push("align-items-"+l),c&&T.push("justify-content-"+c),!l&&!c&&n&&T.push("align-items-center","justify-content-center"),u.length&&T.push(...u),T},[e,t,r,o,l,c,n,u]),f=d.exports.useMemo(()=>{let T={};return i&&(T["--bs-columns"]=i.toString()),Object.keys(g).length&&(T={...T,...g}),T},[i,g]);return a(mX,{value:{isCssGrid:!0},children:a(K,{fullHeight:h,classNames:p,style:f,...m})})},Bt=s=>{const{columnMinWidth:e=40,columnMinHeight:t=40,columnCount:r=0,fullHeight:i=!1,maxContent:n=!0,overflow:o="auto",style:l={},...c}=s,h=d.exports.useMemo(()=>{let u={};return u["--nitro-grid-column-min-height"]=t+"px",r>1&&(u.gridTemplateColumns=`repeat(auto-fill, minmax(${e}px, 1fr))`),Object.keys(l).length&&(u={...u,...l}),u},[e,t,r,l]);return a(qe,{columnCount:r,fullHeight:i,overflow:o,style:h,...c})},M=s=>{const{display:e="flex",column:t=void 0,reverse:r=!1,gap:i=null,center:n=!1,alignSelf:o=null,alignItems:l=null,justifyContent:c=null,classNames:h=[],...u}=s,g=d.exports.useMemo(()=>{const m=[];return t?r?m.push("flex-column-reverse"):m.push("flex-column"):r&&m.push("flex-row-reverse"),i&&m.push("gap-"+i),o&&m.push("align-self-"+o),l&&m.push("align-items-"+l),c&&m.push("justify-content-"+c),!l&&!c&&n&&m.push("align-items-center","justify-content-center"),h.length&&m.push(...h),m},[t,r,i,n,o,l,c,h]);return a(K,{display:e,classNames:g,...u})},Y=s=>{const{variant:e="primary",size:t="",active:r=!1,disabled:i=!1,classNames:n=[],...o}=s,l=d.exports.useMemo(()=>{const c=["btn"];return e&&c.push("btn-"+e),t&&c.push("btn-"+t),r&&c.push("active"),i&&c.push("disabled"),n.length&&c.push(...n),c},[e,t,r,i,n]);return a(M,{center:!0,classNames:l,...o})},sa=s=>{const{classNames:e=[],...t}=s,r=d.exports.useMemo(()=>{const i=["btn-group"];return e.length&&i.push(...e),i},[e]);return a(K,{classNames:r,...t})},s0=d.exports.createContext({closers:null,setClosers:null,closeAll:null}),pX=s=>a(s0.Provider,{...s}),r0=()=>d.exports.useContext(s0),m_=s=>{const{alignItems:e="center",gap:t=1,children:r=null,...i}=s;return a(M,{alignItems:e,gap:t,...i,children:r})},AI=s=>{const{headerText:e="",isExpanded:t=!1,gap:r=0,classNames:i=[],children:n=null,...o}=s,[l,c]=d.exports.useState(!1),{setClosers:h=null,closeAll:u=null}=r0(),g=()=>{u(),c(f=>!f)},m=d.exports.useCallback(()=>c(!1),[]),p=d.exports.useMemo(()=>{const f=["nitro-card-accordion-set"];return l&&f.push("active"),i&&i.length&&f.push(...i),f},[l,i]);return d.exports.useEffect(()=>{c(t)},[t]),d.exports.useEffect(()=>{const f=m;return h(T=>{const I=[...T];return I.push(f),I}),()=>{h(T=>{const I=[...T],O=I.indexOf(f);return O>=0&&I.splice(O,1),I})}},[m,h]),_(v,{classNames:p,gap:r,...o,children:[_(M,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:g,children:[a("div",{className:"friend-header-text d-inline",children:e}),l&&a(QR,{className:"fa-icon"}),!l&&a($R,{className:"fa-icon"})]}),l&&a(v,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content p-1",children:n})]})},EX=s=>{const{...e}=s,[t,r]=d.exports.useState([]),i=d.exports.useCallback(()=>{for(const n of t)n()},[t]);return a(pX,{value:{closers:t,setClosers:r,closeAll:i},children:a(v,{gap:0,...e})})},Ge=s=>{const{overflow:e="auto",classNames:t=[],...r}=s,i=d.exports.useMemo(()=>{const n=["container-fluid","content-area"];return t.length&&n.push(...t),n},[t]);return a(v,{classNames:i,overflow:e,...r})},IX=d.exports.createContext({theme:null}),TX=s=>a(IX.Provider,{value:s.value,children:s.children}),He=s=>{const{headerText:e=null,isGalleryPhoto:t=!1,noCloseButton:r=!1,hideButtonClose:i=!1,onReportPhoto:n=null,onCloseClick:o=null,justifyContent:l="center",alignItems:c="center",classNames:h=[],children:u=null,...g}=s,m=d.exports.useMemo(()=>{const f=["drag-handler","container-fluid","nitro-card-header"];return h.length&&f.push(...h),f},[h]);return a(v,{center:!0,position:"relative",classNames:m,...g,children:_(M,{fullWidth:!0,center:!0,className:"nitro-card-header-holder",children:[a("span",{className:"nitro-card-header-text",children:e}),t&&a(K,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:n,children:a(TU,{className:"fa-icon"})}),a(M,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:f=>{f.stopPropagation(),f.nativeEvent.stopImmediatePropagation()},onClick:o,children:!i&&a(yo,{className:"fa-icon w-12 h-12"})})]})})},i0=s=>{const{justifyContent:e="center",classNames:t=[],variant:r="muted",...i}=s,n=d.exports.useMemo(()=>{const o=["container-fluid","p-1"];return t.length&&o.push(...t),o.push("bg-"+r),o},[t,r]);return a(M,{justifyContent:e,classNames:n,...i})};class hr{}hr.CENTER="DWP_CENTER";hr.TOP_CENTER="DWP_TOP_CENTER";hr.TOP_LEFT="DWP_TOP_LEFT";hr.NOTHING="DWP_NOTHING";const ha=[],vT=0,MT=0,wo=s=>{const{uniqueKey:e=null,handleSelector:t=".drag-handler",windowPosition:r=hr.CENTER,disableDrag:i=!1,dragStyle:n={},children:o=null,offsetLeft:l=0,offsetTop:c=0}=s,[h,u]=d.exports.useState(null),[g,m]=d.exports.useState(null),[p,f]=d.exports.useState({x:0,y:0}),[T,I]=d.exports.useState(!1),[O,A]=d.exports.useState(null),N=d.exports.useRef(),P=d.exports.useCallback(()=>{let H=400;for(const X of ha)H+=1,X.style.zIndex=H.toString()},[]),y=d.exports.useCallback(()=>{const H=ha.indexOf(N.current);if(H===-1)ha.push(N.current);else{if(H===ha.length-1)return;H>=0&&(ha.splice(H,1),ha.push(N.current))}P()},[P]),D=d.exports.useCallback(H=>{y()},[y]),x=d.exports.useCallback(H=>{y()},[y]),w=d.exports.useCallback((H,X)=>{f({x:H,y:X}),I(!0)},[]),k=d.exports.useCallback(H=>{w(H.clientX,H.clientY)},[w]),F=d.exports.useCallback(H=>{const X=H.touches[0];w(X.clientX,X.clientY)},[w]),L=d.exports.useCallback(H=>{u({x:H.clientX-p.x,y:H.clientY-p.y})},[p]),B=d.exports.useCallback(H=>{const X=H.touches[0];u({x:X.clientX-p.x,y:X.clientY-p.y})},[p]),V=d.exports.useCallback(()=>{if(!N.current||!O)return;let H=g.x+h.x,X=g.y+h.y;const ee=N.current.offsetLeft+H,Oe=N.current.offsetTop+X;if(Oe<vT?X=-N.current.offsetTop:Oe+O.offsetHeight>=document.body.offsetHeight-vT&&(X=document.body.offsetHeight-N.current.offsetHeight-N.current.offsetTop),ee+N.current.offsetWidth<MT?H=-N.current.offsetLeft:ee>=document.body.offsetWidth-MT&&(H=document.body.offsetWidth-N.current.offsetWidth-N.current.offsetLeft),u({x:0,y:0}),m({x:H,y:X}),I(!1),e!==null){const de={...mI(`nitro.windows.${e}`)};de.offset={x:H,y:X},II(`nitro.windows.${e}`,de)}},[O,h,g,e]),q=d.exports.useCallback(H=>{V()},[V]),Z=d.exports.useCallback(H=>{V()},[V]);return d.exports.useEffect(()=>{const H=N.current;if(!H)return;if(ha.push(H),P(),!i){const Oe=H.querySelector(t);Oe&&A(Oe)}let X=0,ee=0;switch(r){case hr.TOP_CENTER:H.style.top=50+c+"px",H.style.left=`calc(50vw - ${H.offsetWidth/2+l}px)`;break;case hr.CENTER:H.style.top=`calc(50vh - ${H.offsetHeight/2+c}px)`,H.style.left=`calc(50vw - ${H.offsetWidth/2+l}px)`;break;case hr.TOP_LEFT:H.style.top=50+c+"px",H.style.left=50+l+"px";break}return u({x:0,y:0}),m({x:X,y:ee}),()=>{const Oe=ha.indexOf(H);Oe>=0&&ha.splice(Oe,1)}},[t,r,e,i,l,c,P]),d.exports.useEffect(()=>{if(!g&&!h)return;const H=N.current;H&&(H.style.transform=`translate(${g.x+h.x}px, ${g.y+h.y}px)`,H.style.visibility="visible")},[g,h]),d.exports.useEffect(()=>{if(O)return O.addEventListener(fe.MOUSE_DOWN,k),O.addEventListener(Ir.TOUCH_START,F),()=>{O.removeEventListener(fe.MOUSE_DOWN,k),O.removeEventListener(Ir.TOUCH_START,F)}},[O,k,F]),d.exports.useEffect(()=>{if(T)return document.addEventListener(fe.MOUSE_UP,q),document.addEventListener(Ir.TOUCH_END,Z),document.addEventListener(fe.MOUSE_MOVE,L),document.addEventListener(Ir.TOUCH_MOVE,B),()=>{document.removeEventListener(fe.MOUSE_UP,q),document.removeEventListener(Ir.TOUCH_END,Z),document.removeEventListener(fe.MOUSE_MOVE,L),document.removeEventListener(Ir.TOUCH_MOVE,B)}},[T,q,L,Z,B]),d.exports.useEffect(()=>{if(!e)return;const H=JSON.parse(window.localStorage.getItem(`nitro.windows.${e}`));!H||!H.offset||(u({x:0,y:0}),H.offset&&m(H.offset))},[e]),up.exports.createPortal(a(K,{position:"absolute",innerRef:N,className:"draggable-window",onMouseDownCapture:D,onTouchStartCapture:x,style:n,children:o}),document.getElementById("draggable-windows-container"))},Be=s=>{const{theme:e="primary",uniqueKey:t=null,handleSelector:r=".drag-handler",windowPosition:i=hr.CENTER,disableDrag:n=!1,overflow:o="hidden",position:l="relative",gap:c=0,classNames:h=[],...u}=s,g=d.exports.useRef(),m=d.exports.useMemo(()=>{const p=["nitro-card","rounded"];return p.push(`theme-${e||"primary"}`),h.length&&p.push(...h),p},[e,h]);return a(TX,{value:{theme:e},children:a(wo,{uniqueKey:t,handleSelector:r,windowPosition:i,disableDrag:n,children:a(v,{innerRef:g,overflow:o,position:l,gap:c,classNames:m,...u})})})},Ts=s=>{const{figure:e="",gender:t="M",headOnly:r=!1,direction:i=0,scale:n=1,classNames:o=[],style:l={},...c}=s,[h,u]=d.exports.useState(null),[g,m]=d.exports.useState(-1),p=d.exports.useRef(!1),f=d.exports.useMemo(()=>{const I=["avatar-image"];return o.length&&I.push(...o),I},[o]),T=d.exports.useMemo(()=>{let I={};return h&&h.length&&(I.backgroundImage=`url('${h}')`),n!==1&&(I.transform=`scale(${n})`,n%1||(I.imageRendering="pixelated")),Object.keys(l).length&&(I={...I,...l}),I},[h,n,l]);return d.exports.useEffect(()=>{const I=Ks().createAvatarImage(e,yi.LARGE,t,{resetFigure:N=>{p.current||m(Math.random())},dispose:()=>{},disposed:!1},null);if(!I)return;let O=lr.FULL;r&&(O=lr.HEAD),I.setDirection(O,i);const A=I.getCroppedImage(O);A&&u(A.src),I.dispose()},[e,t,i,r,g]),d.exports.useEffect(()=>(p.current=!1,()=>{p.current=!0}),[]),a(K,{classNames:f,style:T,...c})},n0=s=>{const{imageUrl:e=null,fit:t=!0,style:r=null,...i}=s,n=d.exports.useMemo(()=>{const o={...r};return e&&(o.background=`url(${e}) center no-repeat`),o},[r,e]);return a(K,{fit:t,style:n,...i})},as=s=>{const{badgeCode:e=null,isGroup:t=!1,showInfo:r=!1,customTitle:i=null,isGrayscale:n=!1,scale:o=1,classNames:l=[],style:c={},children:h=null,...u}=s,[g,m]=d.exports.useState(null),p=d.exports.useMemo(()=>{const T=["badge-image"];return t&&T.push("group-badge"),n&&T.push("grayscale"),l.length&&T.push(...l),T},[l,t,n]),f=d.exports.useMemo(()=>{let T={};return g&&(T.backgroundImage=`url(${t?g.src:Ee("badge.asset.url").replace("%badgename%",e.toString())})`,T.width=g.width,T.height=g.height,o!==1&&(T.transform=`scale(${o})`,o%1||(T.imageRendering="pixelated"),T.width=g.width*o,T.height=g.height*o)),Object.keys(c).length&&(T={...T,...c}),T},[g,o,c]);return d.exports.useEffect(()=>{if(!e||!e.length)return;let T=!1;const I=A=>{if(A.badgeId!==e)return;const N=Lt.generateImage(new ds(A.image));N.onload=()=>m(N),T=!0,ie().events.removeEventListener(mo.IMAGE_READY,I)};ie().events.addEventListener(mo.IMAGE_READY,I);const O=t?ie().getGroupBadgeImage(e):ie().getBadgeImage(e);if(O&&!T){const A=Lt.generateImage(new ds(O));A.onload=()=>m(A)}return()=>ie().events.removeEventListener(mo.IMAGE_READY,I)},[e,t]),_(K,{classNames:p,style:f,...u,children:[r&&Ee("badge.descriptions.enabled",!0)&&_(K,{className:"badge-information text-black p-2",children:[a(C,{gfbold:!0,className:"mb-1",children:t?i:Th(e)}),a("div",{className:"badge-desc",children:t?E("group.badgepopup.body"):fI(e)})]}),h]})},Gs=s=>{const{type:e="",classNames:t=[],style:r={},...i}=s,n=d.exports.useMemo(()=>{const c=["nitro-currency-icon"];return t.length&&c.push(...t),c},[t]),o=d.exports.useMemo(()=>{let c=Ee("currency.asset.icon.url","");return c=c.replace("%type%",e.toString()),`url(${c})`},[e]),l=d.exports.useMemo(()=>{let c={};return c.backgroundImage=o,Object.keys(r).length&&(c={...c,...r}),c},[r,o]);return a(K,{classNames:n,style:l,...i})},NI=s=>{const{productType:e="s",productClassId:t=-1,direction:r=2,extraData:i="",scale:n=1,style:o={},...l}=s,[c,h]=d.exports.useState(null),u=d.exports.useMemo(()=>{var m;let g={};return(m=c==null?void 0:c.src)!=null&&m.length&&(g.backgroundImage=`url('${c.src}')`,g.width=c.width,g.height=c.height),n!==1&&(g.transform=`scale(${n})`,n%1||(g.imageRendering="pixelated")),Object.keys(o).length&&(g={...g,...o}),g},[c,n,o]);return d.exports.useEffect(()=>{let g=null;const m={imageReady:(p,f,T)=>{!T&&f&&(T=Lt.generateImage(f)),T.onload=()=>h(T)},imageFailed:null};switch(e.toLocaleLowerCase()){case nt.FLOOR:g=te().getFurnitureFloorImage(t,new G(r),64,m,0,i);break;case nt.WALL:g=te().getFurnitureWallImage(t,new G(r),64,m,0,i);break}if(g){const p=g.getImage();p.onload=()=>h(p)}},[e,t,r,i]),c?a(K,{classNames:["furni-image"],style:u,...l}):null},a0=s=>{const{figure:e=null,userName:t=null,message:r=null,editable:i=!1,onChange:n=null}=s;return _(M,{overflow:"hidden",className:"nitro-gift-card text-black",children:[_("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!t&&a("div",{className:"gift-incognito"}),e&&a("div",{className:"gift-avatar",children:a(Ts,{figure:e,direction:2,headOnly:!0})})]}),a(M,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:_(v,{grow:!0,overflow:"auto",justifyContent:"between",children:[!i&&a(C,{textBreak:!0,className:"gift-message",children:r}),i&&n!==null&&a("textarea",{className:"gift-message h-100",maxLength:140,value:r,onChange:o=>n(o.target.value),placeholder:E("catalog.gift_wrapping_new.message_hint")}),t&&a(C,{italics:!0,textEnd:!0,className:"pe-1",children:E("catalog.gift_wrapping_new.message_from",["name"],[t])})]})})]})},v=s=>{const{size:e=0,itemActive:t=!1,offset:r=0,column:i=!0,gap:n=2,classNames:o=[],...l}=s,{isCssGrid:c=!1}=fX(),h=d.exports.useMemo(()=>{const u=[];if(e){let g=`col-${e}`;c&&(g=`g-${g}`),u.push(g)}if(t&&u.push("active"),r){let g=`offset-${r}`;c&&(g=`g-start-${r}`),u.push(g)}return o.length&&u.push(...o),u},[e,t,r,c,o]);return a(M,{classNames:h,column:i,gap:n,...l})},nn=s=>{const{count:e=0,position:t="absolute",classNames:r=[],children:i=null,...n}=s,o=d.exports.useMemo(()=>{const l=["fw-bold","nitro-item-count"];return r.length&&l.push(...r),l},[r]);return _(K,{position:"absolute",classNames:o,...n,children:[e,i]})},ka=s=>{const{value:e=0}=s,t=e.toString().split("");return a(J,{children:t.map((r,i)=>a("i",{className:"limited-edition-number n-"+r},i))})},o0=s=>{const{uniqueNumber:e=0,uniqueSeries:t=0,classNames:r=[],children:i=null,...n}=s,o=d.exports.useMemo(()=>{const l=["unique-compact-plate","z-index-1"];return r.length&&l.push(...r),l},[r]);return _(K,{classNames:o,...n,children:[a("div",{children:a(ka,{value:e})}),a("div",{children:a(ka,{value:t})}),i]})},RX=s=>{const{uniqueLimitedItemsLeft:e=0,uniqueLimitedSeriesSize:t=0,classNames:r=[],...i}=s,n=d.exports.useMemo(()=>{const o=["unique-complete-plate"];return r.length&&o.push(...r),o},[r]);return a(K,{classNames:n,...i,children:_(v,{className:"plate-container",gap:0,children:[_(M,{justifyContent:"between",alignItems:"center",children:[E("unique.items.left"),a("div",{children:a(ka,{value:e})})]}),_(M,{justifyContent:"between",alignItems:"center",children:[E("unique.items.number.sold"),a("div",{children:a(ka,{value:t})})]})]})})},yt=s=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:r=!1,itemCount:i=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:h=!1,disabled:u=!1,center:g=!0,column:m=!0,style:p={},classNames:f=[],position:T="relative",overflow:I="hidden",children:O=null,...A}=s,N=d.exports.useMemo(()=>{const y=["layout-grid-item","border","border-2","border-muted","rounded"];return r&&y.push("active"),(o||l>0)&&y.push("unique-item"),o&&y.push("sold-out"),c&&y.push("unseen"),h&&y.push("has-highlight"),u&&y.push("disabled"),e===null&&y.push("icon","loading-icon"),f.length&&y.push(...f),y},[r,o,l,c,h,u,e,f]),P=d.exports.useMemo(()=>{let y={...p};return e&&!(o||l>0)&&(y.backgroundImage=`url(${e})`),t&&(y.backgroundColor=t),Object.keys(p).length&&(y={...y,...p}),y},[p,e,t,o,l]);return _(v,{center:g,pointer:!0,position:T,overflow:I,column:m,classNames:N,style:P,...A,children:[i>n&&a(nn,{count:i}),l>0&&_(J,{children:[a(K,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),a("div",{className:"position-absolute bottom-0 unique-item-counter",children:a(ka,{value:l})})]}),O]})},ja=s=>{const{imageUrl:e=null,className:t="",...r}=s;return a("img",{src:e,className:"no-select "+t,alt:"",...r})},bI=s=>{const{...e}=s;return _(K,{classNames:["spinner-container"],...e,children:[a(K,{className:"spinner"}),a(K,{className:"spinner"}),a(K,{className:"spinner"})]})},SX=s=>{const{roomId:e=-1,textureReceiver:t=null,onClose:r=null}=s,i=d.exports.useRef(),n=()=>{if(!i||!i.current)return null;const l=i.current.getBoundingClientRect();return new uS(Math.floor(l.x),Math.floor(l.y),Math.floor(l.width),Math.floor(l.height))},o=()=>{na(pi.CAMERA_SHUTTER),t(te().createTextureFromRoom(e,1,n()))};return a(wo,{handleSelector:".nitro-room-thumbnail-camera",children:_(M,{className:"nitro-room-thumbnail-camera pt-2 px-1",children:[a(M,{ref:i,className:"camera-frame"}),_(M,{gap:1,className:"align-items-end camera-buttons",children:[a(Y,{variant:"danger",onClick:r,children:E("cancel")}),a(Y,{variant:"success",onClick:o,children:E("navigator.thumbeditor.save")})]})]})})},_g=s=>{const{title:e="",onClose:t=null,classNames:r=[],children:i=null,type:n=Ze.DEFAULT,...o}=s,l=d.exports.useMemo(()=>{const c=["nitro-alert"];return c.push("nitro-alert-"+n),r.length&&c.push(...r),c},[r,n]);return _(Be,{classNames:l,theme:"primary",...o,children:[a(He,{headerText:e,onCloseClick:t}),a(Ge,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:i})]})};class Ys{}Ys.BOUNCE="bounce";Ys.SLIDE_LEFT="slideLeft";Ys.SLIDE_RIGHT="slideRight";Ys.FLIP_X="flipX";Ys.FADE_IN="fadeIn";Ys.FADE_DOWN="fadeDown";Ys.FADE_UP="fadeUp";Ys.HEAD_SHAKE="headShake";function OX(s,e,t=300){switch(s){case Ys.BOUNCE:switch(e){default:return{};case qa:return{animationName:"bounceIn",animationDuration:`${t}ms`};case Fo:return{animationName:"bounceOut",animationDuration:`${t}ms`}}case Ys.SLIDE_LEFT:switch(e){default:return{};case qa:return{animationName:"slideInLeft",animationDuration:`${t}ms`};case Fo:return{animationName:"slideOutLeft",animationDuration:`${t}ms`}}case Ys.SLIDE_RIGHT:switch(e){default:return{};case qa:return{animationName:"slideInRight",animationDuration:`${t}ms`};case Fo:return{animationName:"slideOutRight",animationDuration:`${t}ms`}}case Ys.FLIP_X:switch(e){default:return{};case qa:return{animationName:"flipInX",animationDuration:`${t}ms`};case Fo:return{animationName:"flipOutX",animationDuration:`${t}ms`}}case Ys.FADE_UP:switch(e){default:return{};case qa:return{animationName:"fadeInUp",animationDuration:`${t}ms`};case Fo:return{animationName:"fadeOutDown",animationDuration:`${t}ms`}}case Ys.FADE_IN:switch(e){default:return{};case qa:return{animationName:"fadeIn",animationDuration:`${t}ms`};case Fo:return{animationName:"fadeOut",animationDuration:`${t}ms`}}case Ys.FADE_DOWN:switch(e){default:return{};case qa:return{animationName:"fadeInDown",animationDuration:`${t}ms`};case Fo:return{animationName:"fadeOutUp",animationDuration:`${t}ms`}}case Ys.HEAD_SHAKE:switch(e){default:return{};case qa:return{animationName:"headShake",animationDuration:`${t}ms`}}}return null}const Pc=s=>{const{type:e=null,inProp:t=!1,timeout:r=300,className:i=null,children:n=null}=s,[o,l]=d.exports.useState(!1);return d.exports.useEffect(()=>{let c=null;return t?l(!0):c=setTimeout(()=>{l(!1),clearTimeout(r)},r),()=>{c&&clearTimeout(c)}},[t,r]),a(RU,{in:t,timeout:r,children:c=>a("div",{className:(i??"")+" animate__animated",style:{...OX(e,c,r)},children:o&&n})})},yI=s=>{const{fadesOut:e=!0,timeoutMs:t=8e3,onClose:r=null,overflow:i="hidden",classNames:n=[],...o}=s,[l,c]=d.exports.useState(!1),h=d.exports.useMemo(()=>{const u=["nitro-notification-bubble","rounded","p-2","notification-height"];return n.length&&u.push(...n),u},[n]);return d.exports.useEffect(()=>(c(!0),()=>c(!1)),[]),d.exports.useEffect(()=>{if(!e)return;const u=setTimeout(()=>{c(!1),setTimeout(()=>r(),300)},t);return()=>clearTimeout(u)},[e,t,r]),a(Pc,{type:Ys.FADE_IN,inProp:l,timeout:300,children:a(M,{overflow:i,classNames:h,onClick:r,...o})})},Na=s=>{const{figure:e="",typeId:t=-1,paletteId:r=-1,petColor:i=16777215,customParts:n=[],posture:o="std",headOnly:l=!1,direction:c=0,scale:h=1,style:u={},...g}=s,[m,p]=d.exports.useState(null),[f,T]=d.exports.useState(0),[I,O]=d.exports.useState(0),A=d.exports.useRef(!1),N=d.exports.useMemo(()=>{let P={};return m&&m.length&&(P.backgroundImage=`url(${m})`),h!==1&&(P.transform=`scale(${h})`,h%1||(P.imageRendering="pixelated")),P.width=f,P.height=I,Object.keys(u).length&&(P={...P,...u}),P},[m,h,u,f,I]);return d.exports.useEffect(()=>{let P=t,y=r,D=i,x=n,w=l;if(e&&e.length){const F=new ra(e);P=F.typeId,y=F.paletteId,D=F.color,x=F.customParts}P===16&&(w=!1);const k=te().getRoomObjectPetImage(P,y,D,new G(c*45),64,{imageReady:(F,L,B)=>{A.current||(B?(p(B.src),T(B.width),O(B.height)):L&&(p(Lt.generateImageUrl(L)),T(L.width),O(L.height)))},imageFailed:F=>{}},w,0,x,o);if(k){const F=k.getImage();F&&(p(F.src),T(F.width),O(F.height))}},[e,t,r,i,n,o,l,c]),d.exports.useEffect(()=>(A.current=!1,()=>{A.current=!0}),[]),a(K,{classNames:["pet-image"],style:N,...g})},l0=s=>{const{text:e="",progress:t=0,maxProgress:r=100,position:i="relative",justifyContent:n="center",classNames:o=[],children:l=null,...c}=s,h=d.exports.useMemo(()=>{const u=["nitro-progress-bar","text-white"];return o.length&&u.push(...o),u},[o]);return _(v,{position:i,justifyContent:n,classNames:h,...c,children:[e&&e.length>0&&a(M,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:e}),a(K,{className:"nitro-progress-bar-inner",style:{width:~~((t-0)*(100-0)/(r-0)+0)+"%"}}),l]})},c0=s=>{const{level:e=0,classNames:t=[],children:r=null,...i}=s,n=d.exports.useMemo(()=>{const o=["nitro-rarity-level"];return t.length&&o.push(...t),o},[t]);return _(K,{classNames:n,...i,children:[a("div",{children:e}),r]})},Ch=s=>{const{roomPreviewer:e=null,height:t=0,children:r=null}=s,[i,n]=d.exports.useState(null),o=d.exports.useRef(),l=c=>{e&&(c.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return d.exports.useEffect(()=>{if(!e)return;const c=u=>{!e||!i||!o.current||(e.updatePreviewRoomView(),i.canvasUpdated&&(o.current.style.backgroundImage=`url(${Lt.generateImageUrl(i.master)})`))};if(!i&&o.current&&e){let g=document.defaultView.getComputedStyle(o.current,null).backgroundColor;g=Sr.rgbStringToHex(g),g=g.replace("#","0x"),e.backgroundColor=parseInt(g,16);const m=o.current.parentElement.clientWidth;e.getRoomCanvas(m,t);const p=e.getRenderingCanvas();n(p),p.canvasUpdated=!0,c()}Rr().add(c);const h=new ResizeObserver(()=>{if(!e||!o.current)return;const u=o.current.parentElement.offsetWidth;e.modifyRoomCanvas(u,t),c()});return h.observe(o.current),()=>{h.disconnect(),Rr().remove(c)}},[i,e,o,t]),_("div",{className:"room-preview-container",children:[a("div",{ref:o,className:"room-preview-image",style:{height:t},onClick:l}),r]})},gg=s=>{const{roomId:e=-1,customUrl:t=null,shrink:r=!0,overflow:i="hidden",classNames:n=[],children:o=null,...l}=s,c=d.exports.useMemo(()=>{const u=["room-thumbnail","border"];return n.length&&u.push(...n),u},[n]),h=d.exports.useMemo(()=>t&&t.length?Ee("image.library.url")+t:Ee("thumbnails.url").replace("%thumbnail%",e.toString()),[t,e]);return _(K,{shrink:r,overflow:i,classNames:c,...l,children:[h&&a("img",{alt:"",src:h}),o]})},u0=s=>{const{color:e="",message:t="",date:r="",senderName:i="",customTitle:n=null,onCloseClick:o=null}=s;return a(wo,{handleSelector:".drag-handler",children:_(v,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${e}`,children:[_(M,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[a(K,{position:"absolute",pointer:!0,className:"trophy-close",onClick:o}),a(C,{bold:!0,children:E("widget.furni.trophy.title")})]}),_(v,{className:"trophy-content py-1",gap:1,children:[n&&a(C,{bold:!0,children:n}),t]}),_(M,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[a(C,{bold:!0,children:r}),a(C,{bold:!0,children:i})]})]})})},Ei=s=>{const{userId:e=0,userName:t=null,classNames:r=[],pointer:i=!0,children:n=null,...o}=s,l=d.exports.useMemo(()=>{const c=["nitro-friends-spritesheet","icon-profile-sm"];return r.length&&c.push(...r),c},[r]);return a(K,{classNames:l,pointer:i,onClick:c=>ri(e),...o,children:n})},Dn=s=>{const{isActive:e=!1,count:t=0,overflow:r="hidden",position:i="relative",pointer:n=!0,classNames:o=[],children:l=null,...c}=s,h=d.exports.useMemo(()=>{const u=["nav-link","cursor-pointer","position-relative"];return e&&u.push("active"),o.length&&u.push(...o),u},[e,o]);return _(M,{pointer:n,position:i,classNames:h,...c,children:[a(M,{shrink:!0,center:!0,children:l}),t>0&&a(nn,{count:t})]})},ca=s=>{const{justifyContent:e="center",gap:t=1,classNames:r=[],children:i=null,subClassName:n="",...o}=s,l=d.exports.useMemo(()=>{const c=["container-fluid","nitro-card-tabs","pt-1","position-relative"];return r.length&&c.push(...r),c},[r]);return a(M,{classNames:l,...o,children:a("ul",{className:"nav nav-tabs border-0 "+n,children:i})})},bo=(...s)=>s.filter(Boolean).join(" "),CX=s=>{const{classNames:e=[],...t}=s,r=d.exports.useMemo(()=>{const i=["form-group"];return e.length&&i.push(...e),i},[e]);return a(M,{classNames:r,...t})},AX=s=>{const{variant:e="black",height:t=1,classNames:r=[],style:i={},...n}=s,o=d.exports.useMemo(()=>{const c=[];return e&&c.push("bg-"+e),r.length&&c.push(...r),c},[e,r]),l=d.exports.useMemo(()=>{let c={display:"list-item"};return t>0&&(c.height=t),Object.keys(i).length&&(c={...c,...i}),c},[t,i]);return a(K,{classNames:o,style:l,...n})},mg=s=>{var p,f;const{rows:e=[],overscan:t=5,scrollToBottom:r=!1,rowRender:i=null}=s,[n,o]=d.exports.useState(e.length-1),l=d.exports.useRef(null),{virtualItems:c=[],totalSize:h=0,scrollToIndex:u=null}=SU({parentRef:l,size:e.length,overscan:t}),g=c.length>0&&((p=c==null?void 0:c[0])==null?void 0:p.start)||0,m=c.length>0?h-(((f=c==null?void 0:c[c.length-1])==null?void 0:f.end)||0):0;return d.exports.useEffect(()=>{r&&u(n)},[r,n,u]),_(K,{fit:!0,innerRef:l,position:"relative",overflow:"auto",children:[g>0&&a("div",{style:{minHeight:`${g}px`}}),c.map(T=>{const I=e[T.index];return I?a("div",{"data-index":T.index,ref:T.measureRef,children:i(I)},T.key):a(d.exports.Fragment,{},T.key)}),m>0&&a("div",{style:{minHeight:`${m}px`}})]})},C=s=>{const{variant:e=null,fontWeight:t=null,fontSize:r=0,align:i=null,bold:n=!1,gfbold:o=!1,underline:l=!1,italics:c=!1,truncate:h=!1,center:u=!1,textEnd:g=!1,small:m=!1,wrap:p=!1,noWrap:f=!1,textBreak:T=!1,...I}=s,O=d.exports.useMemo(()=>{const A=[""];return e&&A.push("text-"+e),n&&A.push("font-bold"),o&&A.push("goldfish-bold"),t&&A.push("fw-"+t),r&&A.push("fs-"+r),i&&A.push("text-"+i),l&&A.push("text-decoration-underline"),c&&A.push("font-italic"),h&&A.push("text-truncate"),u&&A.push("text-center"),g&&A.push("text-end"),m&&A.push("small"),p&&A.push("text-wrap"),f&&A.push("text-nowrap"),T&&A.push("text-break"),A},[e,t,r,i,n,o,l,c,h,u,g,m,p,f,T]);return a(K,{classNames:O,...I})},NX=()=>Math.floor(Math.random()*30),bX=({isError:s=!1,message:e="",percent:t=0})=>{const r=d.exports.useMemo(NX,[]);return _(v,{fullHeight:!0,alignItems:"center",justifyContent:"center",className:"nitro-loading",children:[_("div",{className:"loading-stories",children:[a("div",{className:"loadingPhoto position-absolute","data-image":r}),a("div",{className:"imageOverlay position-absolute"})]}),a(v,{className:"text-center py-4",children:s&&e?a(K,{className:"fs-4 text-shadow",children:e}):_(J,{children:[a(K,{className:"fs-4 text-shadow",children:e}),a("div",{className:"nitro-loading-bar mt-2",children:a("div",{className:"nitro-loading-bar-inner",style:{width:`${t}%`}})}),a("div",{className:"percent",children:_("p",{children:[t.toFixed(),"%"]})})]})})]})},Ya=(s,e,t,r=!0)=>{d.exports.useEffect(()=>{if(r)return Array.isArray(s)?s.map(i=>e.addEventListener(i,t)):e.addEventListener(s,t),()=>{Array.isArray(s)?s.map(i=>e.removeEventListener(i,t)):e.removeEventListener(s,t)}},[s,e,r,t])},DT=(s,e)=>Ya(s,nq().events,e),yX=(s,e)=>Ya(s,mt().cameraManager.events,e),vX=(s,e)=>Ya(s,mt().localization.events,e),ko=(s,e)=>Ya(s,mt().events,e),_t=(s,e)=>Ya(s,te().events,e),es=(s,e)=>Ya(s,Nl().events,e),MX=(s,e)=>Ya(s,ie().events,e),tl=(s,e,t=!0)=>Ya(s,mt().soundManager.events,e,t),j=(s,e)=>{d.exports.useEffect(()=>{const t=new s(e);return fl().registerMessageEvent(t),()=>fl().removeMessageEvent(t)},[s,e])},Cs=(s,e,t=!0)=>Ya(s,ia,e,t),DX=()=>{const[s,e]=d.exports.useState(!0),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(-1),[c,h]=d.exports.useState(0),u=d.exports.useMemo(()=>{let O=0;return t.forEach(A=>O+=mi.getAchievementCategoryTotalUnseen(A)),O},[t]),g=d.exports.useMemo(()=>{let O=0;return t.forEach(A=>O+=A.getProgress()),O},[t]),m=d.exports.useMemo(()=>{let O=0;return t.forEach(A=>O+=A.getMaxProgress()),O},[t]),p=d.exports.useMemo(()=>~~((g-0)*(100-0)/(m-0)+0),[g,m]),f=d.exports.useMemo(()=>i===null?null:t.find(O=>O.code===i),[t,i]),T=d.exports.useMemo(()=>o===-1||!f?null:f.achievements.find(O=>O.achievementId===o),[f,o]),I=d.exports.useCallback((O,A)=>{r(N=>{const P=[...N];for(const y of P)if(y.code===O)for(const D of y.achievements)D.achievementId===A&&(D.unseen=0);return P})},[]);return j(tA,O=>{const N=O.getParser().achievement;r(P=>{const y=[...P],D=y.findIndex(x=>x.code===N.category);if(D===-1){const x=new mT(N.category);x.achievements.push(N),y.push(x)}else{const x=Hr(y[D]),w=[...x.achievements],k=w.findIndex(L=>L.achievementId===N.achievementId);let F=null;k===-1?w.push(N):(F=w[k],w[k]=N),mi.getAchievementIsIgnored(N)||(N.unseen++,F&&(N.unseen+=F.unseen)),x.achievements=w,y[D]=x}return y})}),j(sA,O=>{const A=O.getParser(),N=[];for(const P of A.achievements){const y=P.category;let D=N.find(x=>x.code===y);D||(D=new mT(y),N.push(D)),D.achievements.push(P)}r(N)}),j(rA,O=>{const A=O.getParser();h(A.score)}),d.exports.useEffect(()=>{s&&(W(new Kb),e(!1))},[s]),d.exports.useEffect(()=>{!i||o===-1||I(i,o)},[i,o,I]),{achievementCategories:t,selectedCategoryCode:i,setSelectedCategoryCode:n,selectedAchievementId:o,setSelectedAchievementId:l,achievementScore:c,getTotalUnseen:u,getProgress:g,getMaxProgress:m,scaledProgressPercent:p,selectedCategory:f,selectedAchievement:T,setAchievementSeen:I}},fg=()=>vs(DX),PX=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(-1),[o,l]=d.exports.useState(10),[c,h]=d.exports.useState(null);return yX(Md.INITIALIZED,u=>{e(Array.from(bu().effects.values()))}),j(JO,u=>{const g=u.getParser();h({credits:g.creditPrice,duckets:g.ducketPrice,publishDucketPrice:g.publishDucketPrice})}),d.exports.useEffect(()=>{if(!bu().isLoaded){bu().init(),W(new ey);return}},[]),{availableEffects:s,cameraRoll:t,setCameraRoll:r,selectedPictureIndex:i,setSelectedPictureIndex:n,myLevel:o,price:c}},h0=()=>vs(PX);class Ii extends ct{}Ii.SHOW_CATALOG="CE_SHOW_CATALOG";Ii.HIDE_CATALOG="CE_HIDE_CATALOG";Ii.TOGGLE_CATALOG="CE_TOGGLE_CATALOG";Ii.SOLD_OUT="CE_SOLD_OUT";Ii.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT";Ii.PURCHASE_APPROVED="CE_PURCHASE_APPROVED";Ii.INIT_GIFT="CE_INIT_GIFT";Ii.CATALOG_RESET="CE_RESET";Ii.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";class LX extends Ii{constructor(e,t,r){super(Ii.INIT_GIFT),this._pageId=e,this._offerId=t,this._extraData=r}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const d0=class extends Ii{constructor(s){super(d0.POST_MARKETPLACE),this._item=s}get item(){return this._item}};let vI=d0;vI.POST_MARKETPLACE="CE_POST_MARKETPLACE";const _0=class extends ct{constructor(s){super(_0.PURCHASE_SUCCESS),this._purchase=s}get purchase(){return this._purchase}};let Ga=_0;Ga.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";const g0=class extends ct{constructor(s){super(g0.PURCHASE_FAILED),this._code=s}get code(){return this._code}};let El=g0;El.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";const m0=class extends ct{constructor(s){super(m0.NOT_ALLOWED),this._code=s}get code(){return this._code}};let f_=m0;f_.NOT_ALLOWED="CPNAE_NOT_ALLOWED";class nr extends ct{}nr.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED";nr.SELECT_PRODUCT="CWE_SELECT_PRODUCT";nr.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM";nr.PURCHASE="CWE_PURCHASE";nr.COLOUR_ARRAY="CWE_COLOUR_ARRAY";nr.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY";nr.COLOUR_INDEX="CWE_COLOUR_INDEX";nr.TEXT_INPUT="CWE_TEXT_INPUT";nr.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT";nr.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE";nr.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES";nr.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW";nr.GUILD_SELECTED="CWE_GUILD_SELECTED";nr.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED";nr.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED";nr.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA";nr.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY";nr.TOGGLE="CWE_CWE_TOGGLE";nr.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED";nr.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED";nr.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";const f0=class extends ct{constructor(){super(f0.SOLD_OUT)}};let p_=f0;p_.SOLD_OUT="CPSOE_SOLD_OUT";const p0=class extends ct{constructor(s,e){super(p0.UPDATE_STUFF_DATA),this._offer=s,this._stuffData=e}get offer(){return this._offer}get stuffData(){return this._stuffData}};let UX=p0;UX.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";class Mr extends ct{}Mr.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL";Mr.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL";Mr.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL";Mr.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST";Mr.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";class E_ extends ct{}E_.INIT="HC_NAME_CHANGE_INIT";const E0=class extends ct{constructor(s,e,t){super(E0.FURNI_ADDED),this.id=s,this.spriteId=e,this.category=t}};let I_=E0;I_.FURNI_ADDED="IFAE_FURNI_ADDED";class Sn extends ct{}Sn.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL";Sn.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL";Sn.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";const PT=s=>s&&s.length?s.replace(/\\r/g,"\r"):"",LT=s=>{const e="0"+s;return e.substr(e.length-2,e.length)};let tu=null;const xX=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(!1),u=()=>Ee("notification",{}),g=F=>{const L=u();return L?L[F]:null},m=(F,L,B,V)=>{if(F.has(B))return F.get(B);const q=["notification",L,B].join(".");return mt().localization.hasValue(q)||V?E(q,Array.from(F.keys()),Array.from(F.values())):null},p=(F,L)=>{let B=F.get("image");return B||(B=Ee("image.library.notifications.url","").replace("%image%",L.replace(/\./g,"_"))),E(B)},f=d.exports.useCallback((F,L=null,B=null,V=null,q=null,Z=null)=>{(!q||!q.length)&&(q=E("notifications.broadcast.title")),(!L||!L.length)&&(L=Ze.DEFAULT);const H=new Nd([PT(F)],L,B,V,q,Z);e(X=>[H,...X])},[]),T=d.exports.useCallback(()=>f(null,Ze.NITRO),[f]),I=d.exports.useCallback((F,L,B=null,V=null)=>{if(o)return;const q=new YL(F,L,B,V);r(Z=>[q,...Z])},[o]),O=(F,L=null)=>{L||(L=new Map);const B=g("notification."+F);if(B)for(const ee in B)L.set(ee,B[ee]);F==="floorplan_editor.error"&&L.set("message",L.get("message").replace(/[^a-zA-Z._ ]/g,""));const V=m(L,F,"title",!0),q=m(L,F,"message",!0).replace(/\\r/g,"\r"),Z=m(L,F,"linkTitle",!1),H=m(L,F,"linkUrl",!1),X=p(L,F);L.get("display")==="BUBBLE"?I(E(q),ls.INFO,X,H):f(E(q),F,H,Z,V,X),L.get("sound")&&na(L.get("sound"))},A=d.exports.useCallback((F,L,B,V=null,q=null,Z=null,H=null)=>{(!V||!V.length)&&(V=E("generic.confirm")),(!q||!q.length)&&(q=E("generic.cancel")),(!Z||!Z.length)&&(Z=E("notifications.broadcast.title"));const X=new zL(H,F,L,B,V,q,Z);n(ee=>[X,...ee])},[]),N=(F,L=null,B=!0)=>{f(F,Ze.DEFAULT,L,E("mod.alert.link"),E("mod.alert.title"))},P=d.exports.useCallback((F,L="")=>{switch(F){case js.ALERT_SCAM:f(E("inventory.trading.warning.other_not_offering"),null,null,null,E("inventory.trading.notification.title"));return;case js.HOTEL_TRADING_DISABLED:case js.YOU_NOT_ALLOWED:case js.THEY_NOT_ALLOWED:case js.ROOM_DISABLED:case js.YOU_OPEN:case js.THEY_OPEN:f(E(`inventory.trading.openfail.${F}`,["otherusername"],[L]),null,null,null,E("inventory.trading.openfail.title"));return;case js.ERROR_WHILE_COMMIT:f(`${E("inventory.trading.notification.caption")}, ${E("inventory.trading.notification.commiterror.info")}`,null,null,null,E("inventory.trading.notification.title"));return;case js.THEY_CANCELLED:f(E("inventory.trading.info.closed"),null,null,null,E("inventory.trading.notification.title"));return}},[f]),y=d.exports.useCallback(F=>{e(L=>{const B=[...L],V=B.findIndex(q=>F===q);return V>=0&&B.splice(V,1),B})},[]),D=d.exports.useCallback(F=>{r(L=>{const B=[...L],V=B.findIndex(q=>F===q);return V>=0&&B.splice(V,1),B})},[]),x=d.exports.useCallback(F=>{n(L=>{const B=[...L],V=B.findIndex(q=>F===q);return V>=0&&B.splice(V,1),B})},[]);j(fE,F=>{const L=F.getParser();if(L.userId!==ie().userId)return;const B=E("notifications.text.respect.1"),V=E("notifications.text.respect.2",["count"],[L.respectsReceived.toString()]);I(B,ls.RESPECT),I(V,ls.RESPECT)}),j(hN,F=>{const L=F.getParser();f(L.message.replace(/\\r/g,"\r"),null,null,E("notifications.broadcast.title"))}),j(oN,F=>{const L=F.getParser(),B=E("achievements.levelup.desc"),V=Th(L.data.badgeCode),q=ie().getBadgeUrl(L.data.badgeCode),Z="questengine/achievements/"+L.data.category;I(B+" "+V,ls.ACHIEVEMENT,q,Z)}),j(cN,F=>{const L=F.getParser();L.numGifts<=0||I(L.numGifts.toString(),ls.CLUBGIFT,null,"catalog/open/"+Ee("catalog.links")["hc.hc_gifts"])}),j(kA,F=>{const L=F.getParser();N(L.message,L.url,!1)}),j(nE,F=>{const L=F.getParser();if(L.amountChanged<=0||L.type!==5)return;const B=Ee("currency.asset.icon.url","").replace("%type%",L.type.toString());I(E("notifications.text.loyalty.received",["AMOUNT"],[L.amountChanged.toString()]),ls.INFO,B)}),j(jA,F=>{const L=F.getParser();N(L.message)}),j(GO,F=>{const L=F.getParser();f(E("opening.hours."+(L.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[LT(L.openHour),LT(L.openMinute)]),Ze.DEFAULT,null,null,E("opening.hours.title"))}),j(dA,async F=>{var Z;const L=F.getParser(),B=E("notifications.text."+(L.boughtAsGift?"petbought":"petreceived"));let V=null;const q=te().getRoomObjectPetImage(L.pet.typeId,L.pet.paletteId,parseInt(L.pet.color,16),new G(45*3),64,null,!0);q&&(V=(Z=await q.getImage())==null?void 0:Z.src),I(B,ls.PETLEVEL,V)}),j(_N,F=>{const B=F.getParser().messages.map(q=>PT(q)),V=new Nd(B,Ze.MOTD,null,null,E("notifications.motd.title"));e(q=>[V,...q])}),j(mN,async F=>{var q;const L=F.getParser();let B=null;const V=te().getRoomObjectPetImage(L.figureData.typeId,L.figureData.paletteId,parseInt(L.figureData.color,16),new G(45*3),64,null,!0);V&&(B=(q=await V.getImage())==null?void 0:q.src),I(E("notifications.text.petlevel",["pet_name","level"],[L.petName,L.level.toString()]),ls.PETLEVEL,B)}),j(dN,F=>{const L=F.getParser();l(!L.enabled)}),j(oC,F=>{const L=F.getParser();if(!L.products||!L.products.length)return;const B=L.products[0];B&&I(E("notifications.text.club_gift.selected"),ls.INFO,Ad.getProductImageUrl(B.productType,B.furniClassId,B.extraParam))}),j(VO,F=>{const L=F.getParser();f(E("maintenance.shutdown",["m","d"],[L.minutesUntilMaintenance.toString(),L.duration.toString()]),Ze.DEFAULT,null,null,E("opening.hours.title"))}),j(wA,F=>{const L=F.getParser();N(L.message,L.url)}),j(gN,F=>{const L=F.getParser();O(L.type,L.parameters)}),j(BO,F=>{const L=F.getParser();f(E("opening.hours.shutdown",["m"],[L.openMinute.toString()]),Ze.DEFAULT,null,null,E("opening.hours.title"))}),j(kO,F=>{const L=F.getParser();f(E("opening.hours.disconnected",["h","m"],[L.openHour.toString(),L.openMinute.toString()]),Ze.DEFAULT,null,null,E("opening.hours.title"))}),j(uN,F=>{const L=F.getParser();switch(L.errorCode){default:case 0:f(E("connection.server.error.desc",["errorCode"],[L.errorCode.toString()]),Ze.ALERT,null,null,E("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:F.connection.dispose();break;case 4013:f(E("connection.room.maintenance.desc"),Ze.ALERT,null,null,E("connection.room.maintenance.title"));break}}),j(pN,F=>{const L=F.getParser();f(E(L.alertMessage),Ze.DEFAULT,null,null,E(L.titleMessage?L.titleMessage:"notifications.broadcast.title"))});const w=d.exports.useCallback((F=null,L=null,B=null,V=null,q=null,Z=null,H=null,X=null,ee=null,Oe=null,de=null,ve=null,Me=null,ce=null,ue=null)=>{const $=new Nd(null,Ze.ABOUT_ALERT,null,null,null,null,null,null,B,V,F,null,q,Z,H,X,ee,Oe,de,ve,Me,ce,ue);e(re=>[$,...re])},[]);j(gP,F=>{const L=F.getParser();w(null,Ze.ABOUT_ALERT,L.username,L.look,L.version,L.onlineUsers,L.activeRooms,L.catalogPages,L.items,L.furnis,L.uptime,L.ramUsage,L.cpuCores,L.totalMemory,L.hotelName)});const k=d.exports.useCallback(()=>{if(!c)if(tr.isRunning()){if(tu)return;tu=setTimeout(()=>{k()},tr.totalRunningTime+5e3)}else tu&&(clearTimeout(tu),tu=null),I(E("mod.chatdisclaimer"),ls.INFO),h(!0)},[c,I]);return j(Wd,k),{alerts:s,bubbleAlerts:t,confirms:i,simpleAlert:f,showNitroAlert:T,showTradeAlert:P,showConfirm:A,showSingleBubble:I,closeAlert:y,closeBubbleAlert:D,closeConfirm:x}},$t=()=>vs(xX),wX=(s,e)=>{const[t,r]=d.exports.useState(()=>{if(typeof window>"u")return e;try{return mI(s)??e}catch{return e}});return[t,n=>{try{const o=n instanceof Function?n(t):n;r(o),typeof window<"u"&&II(s,o)}catch(o){xe.error(o)}}]},pg=wX,FX=()=>pg(Rh.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),I0=()=>vs(FX),kX=()=>pg(Rh.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),T0=()=>vs(kX),GX=-12345678,BX=()=>{const[s,e]=d.exports.useState(!1),[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(-1),[o,l]=d.exports.useState(-1),[c,h]=d.exports.useState(Ki.NORMAL),[u,g]=d.exports.useState(null),[m,p]=d.exports.useState(null),[f,T]=d.exports.useState(null),[I,O]=d.exports.useState(null),[A,N]=d.exports.useState([]),[P,y]=d.exports.useState(null),[D,x]=d.exports.useState([]),[w,k]=d.exports.useState(null),[F,L]=d.exports.useState(!1),[B,V]=d.exports.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[q,Z]=d.exports.useState({}),[H,X]=d.exports.useState(!1),[ee,Oe]=I0(),[de,ve]=T0(),[Me,ce]=d.exports.useState(null),[ue,$]=d.exports.useState(null),[re,me]=d.exports.useState(0),[ge,Ae]=d.exports.useState(0),[Xe,je]=d.exports.useState(0),[se,Te]=d.exports.useState(0),[Ce,Ie]=d.exports.useState(0),[Ue,ut]=d.exports.useState(0),{simpleAlert:De=null}=$t(),zt=d.exports.useRef(new Aa),ss=d.exports.useCallback(()=>{n(-1),l(-1),g(null),p(null),T(null),O(null),N([]),y(null),x([]),e(!1)},[]),cs=d.exports.useCallback(ae=>{if(!ae)return ui.MISSING_OFFER;if(re<0||re>=ge)return ui.FURNI_LIMIT_REACHED;const _e=bt();if(!_e)return ui.NOT_IN_ROOM;if(!_e.isRoomOwner)return ui.NOT_ROOM_OWNER;if(se<=0){const be=te();let Ye=be.getRoomObjectCount(_e.roomId,z.UNIT);for(;Ye>0;){const Mt=be.getRoomObjectByIndex(_e.roomId,Ye,z.UNIT),us=_e.userDataManager.getUserDataByIndex(Mt.id);if(us&&us.type===jt.USER&&us.roomIndex!==_e.ownRoomIndex&&!us.isModerator)return ui.VISITORS_IN_ROOM;Ye--}}return ui.OKAY},[re,ge,se]),Nr=d.exports.useCallback(ae=>{const _e=bt();return!!((_e&&ae.page&&ae.page.layoutCode!=="sold_ltd_items"&&c===Ki.NORMAL&&(_e.isRoomOwner||_e.isGuildRoom&&_e.controllerLevel>=Rt.GUILD_MEMBER)||c===Ki.BUILDER&&cs(ae)===ui.OKAY)&&ae.pricingModel!==Ns.PRICING_MODEL_BUNDLE&&ae.product.productType!==nt.EFFECT&&ae.product.productType!==nt.HABBO_CLUB)},[c,cs]),Hs=d.exports.useCallback(ae=>{if(!Nr(ae))return;const _e=ae.product;if(!_e)return;let be=0;switch(_e.productType){case nt.FLOOR:be=z.FLOOR;break;case nt.WALL:be=z.WALL;break}te().processRoomObjectPlacement(Co.CATALOG,-ae.offerId,be,_e.productClassId,_e.extraParam)&&(ce(ae),X(!0),e(!1))},[Nr]),Fs=d.exports.useCallback((ae,_e)=>{const be=te();let Ye=be.getRoomInstanceVariable(be.activeRoomId,b.ROOM_WALL_TYPE),Mt=be.getRoomInstanceVariable(be.activeRoomId,b.ROOM_FLOOR_TYPE),us=be.getRoomInstanceVariable(be.activeRoomId,b.ROOM_LANDSCAPE_TYPE);switch(Ye=Ye&&Ye.length?Ye:"101",Mt=Mt&&Mt.length?Mt:"101",us=us&&us.length?us:"1.1",ae){case"floor":be.updateRoomInstancePlaneType(be.activeRoomId,_e,Ye,us,!0);return;case"wallpaper":be.updateRoomInstancePlaneType(be.activeRoomId,Mt,_e,us,!0);return;case"landscape":be.updateRoomInstancePlaneType(be.activeRoomId,Mt,Ye,_e,!0);return;default:be.updateRoomInstancePlaneType(be.activeRoomId,Mt,Ye,us,!0);return}},[]),Fn=d.exports.useCallback(()=>{Me&&(te().cancelRoomObjectInsert(),X(!1),ce(null))},[Me]),hn=d.exports.useCallback((ae=!0)=>{X(_e=>(_e&&ae&&Le("catalog/open"),!1))},[]),dn=d.exports.useCallback((ae=!1)=>{ae||hn(),$(_e=>{if(_e)switch(_e.category){case z.FLOOR:te().removeRoomObjectFloor(_e.roomId,_e.objectId);break;case z.WALL:{switch(_e.furniData.className){case"floor":case"wallpaper":case"landscape":Fs("reset","");break;default:te().removeRoomObjectWall(_e.roomId,_e.objectId);break}break}default:te().deleteRoomObject(_e.objectId,_e.category);break}return null})},[hn,Fs]),$s=d.exports.useCallback((ae,_e)=>{if(_e.pageId===ae&&_e!==u)return _e;for(const be of _e.children){const Ye=$s(ae,be);if(Ye)return Ye}return null},[u]),Ai=d.exports.useCallback((ae,_e)=>{if(_e.pageName===ae&&_e!==u)return _e;for(const be of _e.children){const Ye=Ai(ae,be);if(Ye)return Ye}return null},[u]),kn=d.exports.useCallback((ae,_e=!1)=>{if(!m||!m.size)return null;if(_e){const be=[],Ye=m.get(ae);if(Ye&&Ye.length)for(const Mt of Ye)Mt.isVisible&&be.push(Mt);if(be.length)return be}return m.get(ae)},[m]),ni=d.exports.useCallback((ae,_e)=>{ae<0||(r(!0),n(ae),ae>-1&&W(new ly(ae,_e,c)))},[c]),Zc=d.exports.useCallback((ae,_e,be,Ye,Mt,us)=>{const ar=new hI(ae,_e,be,Ye,us);if(T(ar),l(ft=>ae!==-1?ae:ft),L(!1),Mt>-1&&ar.offers.length){for(const ft of ar.offers)if(ft.offerId===Mt){O(ft);break}}},[]),_n=d.exports.useCallback((ae,_e=-1)=>{if(Fn(),ae.parent.pageName==="root"&&ae.children.length){for(const Mt of ae.children)if(Mt.isVisible){ae=Mt;break}}const be=[];let Ye=ae;for(;Ye&&Ye.pageName!=="root";)be.push(Ye),Ye=Ye.parent;be.reverse(),N(Mt=>{const us=Mt.indexOf(ae)>=0,ar=ae.isOpen;for(const ft of Mt)ft.deactivate(),be.indexOf(ft)===-1&&ft.close();for(const ft of be)ft.activate(),ft.parent&&ft.open(),ft===ae.parent&&ft.children.length&&ft.open();return us&&ar?ae.close():ae.open(),be}),ae.pageId>-1&&ni(ae.pageId,_e)},[N,ni,Fn]),eu=d.exports.useCallback(ae=>{if(ae!==-1&&y(null),!s)zt.current.requestById=ae,e(!0);else{const _e=$s(ae,u);_e&&_n(_e)}},[s,u,$s,_n]),bg=d.exports.useCallback(ae=>{if(y(null),!s)zt.current.requestByName=ae,e(!0);else{const _e=Ai(ae,u);_e&&_n(_e)}},[s,u,Ai,_n]),yg=d.exports.useCallback(ae=>{if(y(null),!s)zt.current.requestedByOfferId=ae,e(!0);else{const _e=kn(ae);if(!_e||!_e.length)return;_n(_e[0],ae)}},[s,kn,_n]),HI=d.exports.useCallback(()=>{},[]);return j(nC,ae=>{const _e=ae.getParser(),be=new Map,Ye=(Mt,us,ar)=>{const ft=new oq(Mt,us,ar);for(const Bi of ft.offerIds)be.has(Bi)?be.get(Bi).push(ft):be.set(Bi,[ft]);us++;for(const Bi of Mt.children)ft.addChild(Ye(Bi,us,ft));return ft};g(Ye(_e.root,0,null)),p(be)}),j(iC,ae=>{const _e=ae.getParser();if(_e.catalogType!==c)return;const be=[];for(const Ye of _e.offers){const Mt=[],us=gc(Ye.localizationId);for(const ft of Ye.products){const Bi=c_(ft.furniClassId,ft.productType);Mt.push(new dl(ft.productType,ft.furniClassId,ft.extraParam,ft.productCount,us,Bi,ft.uniqueLimitedItem,ft.uniqueLimitedSeriesSize,ft.uniqueLimitedItemsLeft))}if(!Mt.length)continue;const ar=new Ns(Ye.offerId,Ye.localizationId,Ye.rent,Ye.priceCredits,Ye.priceActivityPoints,Ye.priceActivityPointsType,Ye.giftable,Ye.clubLevel,Mt,Ye.bundlePurchaseAllowed);(c===Ki.NORMAL||ar.pricingModel!==Ns.PRICING_MODEL_BUNDLE&&ar.pricingModel!==Ns.PRICING_MODEL_MULTI)&&be.push(ar)}_e.frontPageItems&&_e.frontPageItems.length&&x(_e.frontPageItems),r(!1),i===_e.pageId&&Zc(_e.pageId,_e.layoutCode,new DL(_e.localization.images.concat(),_e.localization.texts.concat()),be,_e.offerId,_e.acceptSeasonCurrencyAsCredits)}),j(mC,ae=>{const _e=ae.getParser();zs(new Ga(_e.offer))}),j(_C,ae=>{const _e=ae.getParser();zs(new El(_e.code))}),j(gC,ae=>{const _e=ae.getParser();zs(new f_(_e.code))}),j(hC,ae=>{ae.getParser(),zs(new p_)}),j(dC,ae=>{const be=ae.getParser().offer;if(!be||!be.products.length)return;be.products[0].uniqueLimitedItem;const Mt=[],us=gc(be.localizationId);for(const ft of be.products){const Bi=c_(ft.furniClassId,ft.productType);Mt.push(new dl(ft.productType,ft.furniClassId,ft.extraParam,ft.productCount,us,Bi,ft.uniqueLimitedItem,ft.uniqueLimitedSeriesSize,ft.uniqueLimitedItemsLeft))}const ar=new Ns(be.offerId,be.localizationId,be.rent,be.priceCredits,be.priceActivityPoints,be.priceActivityPointsType,be.giftable,be.clubLevel,Mt,be.bundlePurchaseAllowed);(c===Ki.NORMAL||ar.pricingModel!==Ns.PRICING_MODEL_BUNDLE&&ar.pricingModel!==Ns.PRICING_MODEL_MULTI)&&(ar.page=f,O(ar),ar.product&&ar.product.productType===nt.WALL&&V(ft=>{const Bi={...ft};return Bi.extraData=ar.product.extraParam||null,Bi}))}),j(pC,ae=>{const _e=ae.getParser(),be=new lq(_e.productCode,_e.palettes.slice());Z(Ye=>{const Mt=[];Ye.petPalettes&&Mt.push(...Ye.petPalettes);for(let us=0;us<Mt.length;us++)if(Mt[us].breed===be.breed){Mt.splice(us,1);break}return Mt.push(be),{...Ye,petPalettes:Mt}})}),j(uC,ae=>{const _e=ae.getParser();Z(be=>{const Ye=_e.offers;return{...be,clubOffers:Ye}})}),j(wb,ae=>{const _e=ae.getParser();Z(be=>{const Ye=_e.groups;return{...be,groups:Ye}})}),j(cC,ae=>{const _e=ae.getParser();Z(be=>{const Ye=new mq(_e);return{...be,giftConfiguration:Ye}})}),j(yA,ae=>{const _e=ae.getParser();if(!_e)return;let be="";_e.result===1?be=E("inventory.marketplace.result.title.success"):be=E("inventory.marketplace.result.title.failure");const Ye=E(`inventory.marketplace.result.${_e.result}`);De(Ye,Ze.DEFAULT,null,null,be)}),j(Kp,ae=>{const _e=ae.getParser();Z(be=>({...be,clubGifts:_e}))}),j(aC,ae=>{const _e=s;ss(),_e&&De(E("catalog.alert.published.description"),Ze.ALERT,null,null,E("catalog.alert.published.title"))}),j(sC,ae=>{const _e=ae.getParser();me(_e.furniCount),HI()}),j(rC,ae=>{const _e=ae.getParser();Ae(_e.furniLimit),je(_e.maxFurniLimit),Te(_e.secondsLeft),Ie(tt()),ut(_e.secondsLeftWithGrace),HI()}),Cs(Ga.PURCHASE_SUCCESS,ae=>na(pi.CREDITS)),_t(Im.PLACED,ae=>{if(!H||ae.type!==Im.PLACED)return;if(dn(!0),!Me){hn();return}let _e=!1;const be=Me.product;if(ae.category===z.WALL)switch(be.furnitureData.className){case"floor":case"wallpaper":case"landscape":_e=ae.placedOnFloor||ae.placedOnWall;break;default:_e=ae.placedInRoom;break}else _e=ae.placedInRoom;if(!_e){hn();return}switch($(new fq(ae.roomId,ae.objectId,ae.category,ae.wallLocation,ae.x,ae.y,ae.direction,Me)),c){case Ki.NORMAL:{switch(ae.category){case z.FLOOR:te().addFurnitureFloor(ae.roomId,ae.objectId,be.productClassId,new G(ae.x,ae.y,ae.z),new G(ae.direction),0,new ei);break;case z.WALL:switch(be.furnitureData.className){case"floor":case"wallpaper":case"landscape":Fs(be.furnitureData.className,be.extraParam);break;default:te().addFurnitureWall(ae.roomId,ae.objectId,be.productClassId,new G(ae.x,ae.y,ae.z),new G(ae.direction*45),0,ae.instanceData,0);break}}const Ye=te().getRoomObject(ae.roomId,ae.objectId,ae.category);Ye&&Ye.model.setValue(b.FURNITURE_ALPHA_MULTIPLIER,.5),de&&W(new ih(i,Me.offerId,be.extraParam,1)),ee&&Hs(Me);break}case Ki.BUILDER:{let Ye=Me.page.pageId;switch(Ye===GX&&(Ye=-1),ae.category){case z.FLOOR:W(new ry(Ye,Me.offerId,be.extraParam,ae.x,ae.y,ae.direction));break;case z.WALL:W(new iy(Ye,Me.offerId,be.extraParam,ae.wallLocation));break}ee&&Hs(Me);break}}}),Cs(I_.FURNI_ADDED,ae=>{const _e=te();if(!(!ue||ue.productClassId!==ae.spriteId||ue.roomId!==_e.activeRoomId)){switch(ae.category){case Pe.FLOOR:{const be=_e.getRoomInstanceVariable(_e.activeRoomId,b.ROOM_FLOOR_TYPE);ue.extraParam!==be&&W(new Ou(ae.id));break}case Pe.WALL_PAPER:{const be=_e.getRoomInstanceVariable(_e.activeRoomId,b.ROOM_WALL_TYPE);ue.extraParam!==be&&W(new Ou(ae.id));break}case Pe.LANDSCAPE:{const be=_e.getRoomInstanceVariable(_e.activeRoomId,b.ROOM_LANDSCAPE_TYPE);ue.extraParam!==be&&W(new Ou(ae.id));break}default:W(new bE(ae.id,ue.category,ue.wallLocation,ue.x,ue.y,ue.direction))}ee||dn()}}),d.exports.useEffect(()=>()=>O(null),[f]),d.exports.useEffect(()=>{if(!(!s||!u||!m||!zt.current))switch(zt.current.requestType){case Aa.REQUEST_TYPE_NONE:if(f)return;if(u.isBranch){for(const ae of u.children)if(ae&&ae.isVisible){_n(ae);return}}return;case Aa.REQUEST_TYPE_ID:eu(zt.current.requestById),zt.current.resetRequest();return;case Aa.REQUEST_TYPE_OFFER:yg(zt.current.requestedByOfferId),zt.current.resetRequest();return;case Aa.REQUEST_TYPE_NAME:bg(zt.current.requestByName),zt.current.resetRequest();return}},[s,u,m,f,_n,eu,yg,bg]),d.exports.useEffect(()=>{!P&&f&&f.pageId===-1&&eu(o)},[P,f,o,eu]),d.exports.useEffect(()=>{I&&V({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[I]),d.exports.useEffect(()=>{!s||u||(W(new uy),W(new pE),W(new oy(c)),W(new ny))},[s,u,c]),d.exports.useEffect(()=>(k(new Yr(te(),++Yr.PREVIEW_COUNTER)),()=>{k(ae=>(ae.dispose(),null))}),[]),{isVisible:s,setIsVisible:e,isBusy:t,pageId:i,previousPageId:o,currentType:c,rootNode:u,offersToNodes:m,currentPage:f,setCurrentPage:T,currentOffer:I,setCurrentOffer:O,activeNodes:A,searchResult:P,setSearchResult:y,frontPageItems:D,roomPreviewer:w,navigationHidden:F,setNavigationHidden:L,purchaseOptions:B,setPurchaseOptions:V,catalogOptions:q,setCatalogOptions:Z,getNodeById:$s,getNodeByName:Ai,activateNode:_n,openPageById:eu,openPageByName:bg,openPageByOfferId:yg,requestOfferToMover:Hs}},Ft=()=>vs(BX),VX=1e3,HX=10,WX=1e3;let jX=0,YX=0;const zX=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState(!1),c=g=>{g.id=jX++,e(m=>{const p=[...m];return p.push(g),p.length>VX&&p.shift(),p})},h=g=>{r(m=>{const p=[...m];return p.push(g),p.length>HX&&p.shift(),p})},u=g=>{g.id=YX++,n(m=>{const p=[...m];return p.push(g),p.length>WX&&p.shift(),p})};return es(Ve.STARTED,g=>l(!0)),j(wa,g=>{if(!o)return;const m=g.getParser();t.length&&t[t.length-1].id===m.data.roomId||(c({id:-1,webId:-1,entityId:-1,name:m.data.roomName,timestamp:BL(),type:rn.TYPE_ROOM_INFO,roomId:m.data.roomId}),h({id:m.data.roomId,name:m.data.roomName}),l(!1))}),j(qp,g=>{const m=g.getParser();u({id:-1,webId:m.senderId,entityId:-1,name:"",message:m.messageText,roomId:-1,timestamp:RT(m.secondsSinceSent),type:rn.TYPE_IM})}),j(Qp,g=>{const m=g.getParser();u({id:-1,webId:m.senderId,entityId:-1,name:"",message:m.messageText,roomId:-1,timestamp:RT(),type:rn.TYPE_IM})}),{addChatEntry:c,chatHistory:s,roomHistory:t,messengerHistory:i}},Eg=()=>vs(zX),KX=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState(null),u=d.exports.useMemo(()=>{const A=s.filter(N=>N.online);return A.sort((N,P)=>N.name<P.name?-1:N.name>P.name?1:0),A},[s]),g=d.exports.useMemo(()=>{const A=s.filter(N=>!N.online);return A.sort((N,P)=>N.name<P.name?-1:N.name>P.name?1:0),A},[s]),m=A=>W(new q_(A.id)),p=(A,N)=>N!==A.relationshipStatus&&W(new ac(A.id,N)),f=A=>{for(const N of s)if(N.id===A)return N;return null},T=A=>!(A===ie().userId||f(A)||t.find(N=>N.requesterUserId===A)||i.indexOf(A)>=0),I=(A,N)=>{if(!T(A))return!1;n(P=>{const y=[...P];return y.push(A),y}),W(new IE(N))},O=(A,N)=>{A===-1&&!N?(W(new df(!0)),r([])):r(P=>{const y=[...P],D=y.findIndex(x=>x.id===A);return D===-1?P:(W(N?new Cy(y[D].id):new df(!1,y[D].id)),y.splice(D,1),y)})};return j(MC,A=>{const N=A.getParser();h(new Xq(N.userFriendLimit,N.normalFriendLimit,N.extendedFriendLimit,N.categories)),W(new Ny)}),j(NC,A=>{const N=A.getParser();e(P=>{const y=[...P];for(const D of N.fragment){const x=y.findIndex(k=>k.id===D.id),w=new Pr;w.populate(D),x>-1?y[x]=w:y.push(w)}return y})}),j(bC,A=>{const N=A.getParser();e(P=>{const y=[...P],D=x=>{const w=y.findIndex(k=>k.id===x.id);if(w===-1){const k=new Pr;k.populate(x),y.unshift(k)}else y[w].populate(x)};for(const x of N.addedFriends)D(x);for(const x of N.updatedFriends)D(x);for(const x of N.removedFriendIds){const w=y.findIndex(k=>k.id===x);w>-1&&y.splice(w,1)}return y})}),j(yC,A=>{const N=A.getParser();r(P=>{const y=[...P];for(const D of N.requests){const x=y.findIndex(w=>w.requesterUserId===D.requesterUserId);if(x>0)y[x]=Hr(y[x]),y[x].populate(D);else{const w=new ST;w.populate(D),y.push(w)}}return y})}),j(Xp,A=>{const P=A.getParser().request;r(y=>{const D=[...y];if(D.findIndex(w=>w.requesterUserId===P.requesterUserId)===-1){const w=new ST;w.populate(P),D.push(w)}return D})}),d.exports.useEffect(()=>{W(new yy);const A=setInterval(()=>W(new Ay),12e4);return()=>{clearInterval(A)}},[]),{friends:s,requests:t,sentRequests:i,dismissedRequestIds:o,setDismissedRequestIds:l,settings:c,onlineFriends:u,offlineFriends:g,getFriend:f,canRequestFriend:T,requestFriend:I,requestResponse:O,followFriend:m,updateRelationship:p}},Oi=()=>vs(KX),qX=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState(Nn.HIDDEN),{getFriend:c=null}=Oi(),{simpleAlert:h=null}=$t(),u=d.exports.useMemo(()=>s.filter(T=>i.indexOf(T.threadId)===-1),[s,i]),g=d.exports.useMemo(()=>t>0&&u.find(T=>T.threadId===t||null),[t,u]),m=T=>{let I=s.find(O=>O.participant&&O.participant.id===T);if(I){const O=i.indexOf(I.threadId);O>=0&&n(A=>{const N=[...A];return N.splice(O,1),N})}else{const O=c(T);if(!O)return null;I=new TI(O),I.addMessage(null,E("messenger.moderationinfo"),0,null,bn.SECURITY_NOTIFICATION),I.setRead(),e(A=>{const N=[...A];return N.push(I),N})}return I},p=T=>{n(I=>{const O=[...I];return O.indexOf(T)>=0?I:(O.push(T),O)}),t===T&&r(-1)},f=(T,I,O,A=0,N=null,P=bn.CHAT)=>{if(!T||!O||!O.length)return;const y=I===ie().userId;y&&O.length<=255&&W(new My(T.participant.id,O)),e(D=>{const x=[...D],w=x.findIndex(k=>k.threadId===T.threadId);return w===-1?D:(T=Hr(x[w]),y&&T.groups.length===1&&na(pi.MESSENGER_NEW_THREAD),T.addMessage(P===bn.ROOM_INVITE?null:I,O,A,N,P),t===T.threadId&&T.setRead(),x[w]=T,!y&&T.unread&&na(pi.MESSENGER_MESSAGE_RECEIVED),x)})};return j(qp,T=>{const I=T.getParser(),O=m(I.senderId);O&&f(O,I.senderId,I.messageText,I.secondsSinceSent,I.extraData)}),j(Qp,T=>{const I=T.getParser(),O=m(I.senderId);O&&f(O,I.senderId,I.messageText,0,null,bn.ROOM_INVITE)}),j(DC,T=>{const I=T.getParser();h(`Received room invite error: ${I.errorCode},recipients: ${I.failedRecipients}`,Ze.DEFAULT,null,null,E("friendlist.alert.title"))}),d.exports.useEffect(()=>{t<=0||e(T=>{const I=[...T],O=I.findIndex(A=>A.threadId===t);return O>=0&&(I[O]=Hr(I[O]),I[O].setRead()),I})},[t]),d.exports.useEffect(()=>{l(T=>{if(!u.length)return Nn.HIDDEN;let I=!1;for(const O of u)if(O.unreadCount>0){I=!0;break}return I?Nn.UNREAD:Nn.SHOW})},[u]),{messageThreads:s,activeThread:g,iconState:o,visibleThreads:u,getMessageThread:m,setActiveThreadId:r,closeThread:p,sendMessage:f}},R0=()=>vs(qX),XX=()=>{const[s,e]=d.exports.useState(!1),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(!1),[u,g]=d.exports.useState(null);return j(LC,m=>{let p=m.getParser();!p||p&&!p.games.length||(n(p.games[0]),r(p.games))}),j(PC,m=>{let p=m.getParser();p&&l(p)}),j(UC,m=>{let p=m.getParser();p&&h(p.isInMaintenance)}),j($p,m=>{let p=m.getParser();if(p)switch(p.gameTypeId){case 2:return console.log("snowwar");default:return g(p.url)}}),d.exports.useEffect(()=>{s&&(W(new Uy),dI())},[s]),{isVisible:s,setIsVisible:e,games:t,accountStatus:o,selectedGame:i,setSelectedGame:n,gameOffline:c,gameURL:u,setGameURL:g}},Ig=()=>vs(XX),QX=()=>{const[s,e]=d.exports.useState(null);return j(Jp,t=>{const r=t.getParser(),i={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};r.bases.forEach((o,l)=>i.badgeBases.push({id:l,images:o})),r.symbols.forEach((o,l)=>i.badgeSymbols.push({id:l,images:o})),r.partColors.forEach((o,l)=>i.badgePartColors.push({id:l,color:o})),r.colorsA.forEach((o,l)=>i.groupColorsA.push({id:l,color:o})),r.colorsB.forEach((o,l)=>i.groupColorsB.push({id:l,color:o}));const n=(o,l)=>o.id<l.id?-1:o.id>l.id?1:0;i.badgeBases.sort(n),i.badgeSymbols.sort(n),i.badgePartColors.sort(n),i.groupColorsA.sort(n),i.groupColorsB.sort(n),e(i)}),d.exports.useEffect(()=>{W(new Hy)},[]),{groupCustomize:s}},Ah=()=>vs(QX),$X=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(null),{simpleAlert:i=null,showConfirm:n=null}=$t(),o=(l,c)=>{const h={reportType:l,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(l){case Qt.BULLY:case Qt.EMERGENCY:case Qt.IM:h.reportedUserId=c.reportedUserId,h.currentStep=ur.SELECT_CHATS;break;case Qt.ROOM:h.roomId=c.roomId,h.roomName=c.roomName,h.currentStep=ur.SELECT_TOPICS;break;case Qt.THREAD:h.groupId=c.groupId,h.threadId=c.threadId,h.currentStep=ur.SELECT_TOPICS;break;case Qt.MESSAGE:h.groupId=c.groupId,h.threadId=c.threadId,h.messageId=c.messageId,h.currentStep=ur.SELECT_TOPICS;break;case Qt.PHOTO:h.extraData=c.extraData,h.roomId=c.roomId,h.reportedUserId=c.reportedUserId,h.roomObjectId=c.roomObjectId,h.currentStep=ur.SELECT_TOPICS;break}e(h)};return j(zC,l=>{const c=l.getParser();let h=c.messageText;switch(c.resultType){case d_.TOO_MANY_PENDING_CALLS_CODE:W(new gv),i(E("help.cfh.error.pending"),Ze.MODERATION,null,null,E("help.cfh.error.title"));break;case d_.HAS_ABUSIVE_CALL_CODE:i(E("help.cfh.error.abusive"),Ze.MODERATION,null,null,E("help.cfh.error.title"));break;default:h.trim().length===0&&(h=E("help.cfh.sent.text")),i(h,Ze.MODERATION,null,null,E("help.cfh.sent.title"))}}),j(eA,l=>{const c=l.getParser(),h=c.messageText.length===0?E("help.cfh.closed."+sX(c.closeReason)):c.messageText;i(h,Ze.MODERATION,null,null,E("mod.alert.title"))}),j(jC,l=>{const c=l.getParser();c.count>0&&n(E("help.emergency.pending.title")+`
`+c.pendingCalls[0].message,()=>{W(new dv)},null,E("help.emergency.pending.button.discard"),E("help.emergency.pending.button.keep"),E("help.emergency.pending.message.subtitle"))}),j(WC,l=>{i("Your pending calls were deleted",Ze.MODERATION,null,null,E("mod.alert.title"))}),j(YC,l=>{const c=l.getParser();i(c.message,Ze.MODERATION,null,null,E("help.cfh.reply.title"))}),j(HC,l=>{const c=l.getParser();i(E("help.emergency.global_mute.message"),Ze.MODERATION,c.infoUrl,E("help.emergency.global_mute.link"),E("help.emergency.global_mute.subtitle"))}),j(qO,l=>{const c=l.getParser();r(c)}),{activeReport:s,setActiveReport:e,sanctionInfo:t,setSanctionInfo:r,report:o}},un=()=>vs($X),Tg=()=>{const[s,e]=d.exports.useState([]),t=d.exports.useMemo(()=>!!s.length,[s]),r=d.exports.useCallback(()=>{let n=-1;return e(o=>{const l=[...o];return n=l.length?l[l.length-1]+1:0,l.push(n),l}),n},[]),i=d.exports.useCallback(n=>{e(o=>{const l=[...o],c=l.indexOf(n);return c===-1?o:(l.splice(c,1),l)})},[]);return{isVisible:t,activate:r,deactivate:i}},JX=s=>W(new Uv(s)),ZX=(s,e)=>W(new xv(s,...e)),e7=()=>{const[s,e]=d.exports.useState(new Map),t=d.exports.useCallback(c=>{var h;return((h=s.get(c))==null?void 0:h.length)||0},[s]),r=d.exports.useMemo(()=>{let c=0;for(const h of s.keys())c+=t(h);return c},[s,t]),i=d.exports.useCallback(c=>{let h=!0;return e(u=>{if(!u.has(c))return h=!1,u;const g=new Map(u);return g.delete(c),JX(c),g}),h},[]),n=d.exports.useCallback((c,h)=>{let u=!0;return e(g=>{if(!g.has(c))return u=!1,g;const m=new Map(g),p=m.get(c);if(p)for(const f of h)p.splice(p.indexOf(f),1);return ZX(c,h),m}),u},[]),o=d.exports.useCallback((c,h)=>s.has(c)?s.get(c).indexOf(h)>=0:!1,[s]),l=d.exports.useCallback((c,h)=>{e(u=>{if(!u.has(c))return u;const g=new Map(u),m=g.get(c),p=m.indexOf(h);return p>=0&&m.splice(p,1),g})},[]);return j(EN,c=>{const h=c.getParser();e(u=>{const g=new Map(u);for(const m of h.categories){let p=g.get(m);p||(p=[],g.set(m,p));const f=h.getItemsByCategory(m);for(const T of f)p.indexOf(T)===-1&&p.push(T)}return g})}),{getCount:t,getFullCount:r,resetCategory:i,resetItems:n,isUnseen:o,removeUnseen:l}},Ci=()=>vs(e7),t7=()=>{const[s,e]=d.exports.useState(!0),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(new Map),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState(null),{isVisible:u=!1,activate:g=null,deactivate:m=null}=Tg(),{isUnseen:p=null,resetCategory:f=null}=Ci(),T=Ee("user.badges.max.slots",5),I=P=>o.indexOf(P)>=0,O=()=>o.length<T,A=P=>{l(y=>{const D=[...y],x=D.indexOf(P);if(x===-1){if(!O())return y;D.push(P)}else D.splice(x,1);const w=new Cv;for(let k=0;k<T;k++)w.addActivatedBadge(D[k]??"");return W(w),D})},N=P=>t.indexOf(P)===-1?0:i.get(P)??0;return j(nA,P=>{const y=P.getParser(),D=[];n(x=>{const w=new Map(x);return y.getAllBadgeCodes().forEach(k=>{const F=t.indexOf(k)>=0,L=y.getBadgeId(k);w.set(k,L),!F&&D.push(k)}),w}),l(y.getActiveBadgeCodes()),r(x=>[...x,...D])}),j(iA,P=>{const y=P.getParser(),D=p(os.BADGE,y.badgeId);r(x=>{const w=[...x];return D?w.unshift(y.badgeCode):w.push(y.badgeCode),w}),n(x=>{const w=new Map(x);return w.set(y.badgeCode,y.badgeId),w})}),d.exports.useEffect(()=>{!t||!t.length||h(P=>{let y=P;return y&&t.indexOf(y)===-1&&(y=null),y||(y=t[0]),y})},[t]),d.exports.useEffect(()=>{if(u)return()=>{f(os.BADGE)}},[u,f]),d.exports.useEffect(()=>{!u||!s||(W(new Ov),e(!1))},[u,s]),{badgeCodes:t,activeBadgeCodes:o,selectedBadgeCode:c,setSelectedBadgeCode:h,isWearingBadge:I,canWearBadges:O,toggleBadge:A,getBadgeId:N,activate:g,deactivate:m}},Rg=()=>vs(t7),s7=()=>{const[s,e]=d.exports.useState(!0),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=Tg(),{isUnseen:h=null,resetCategory:u=null}=Ci();return j(jO,g=>{const m=g.getParser();r(p=>{const f=[...p],T=f.map(O=>O.botData.id),I=[];for(const O of m.items.values())T.indexOf(O.id)===-1&&I.push(O);for(const O of T){let A=!0;for(const y of m.items.values())if(y.id===O){A=!1;break}if(!A)continue;const N=f.findIndex(y=>y.botData.id===O),P=f[N];N===-1||!P||(bc()===P.botData.id&&(zu(),Le("inventory/open")),f.splice(N,1))}for(const O of I){const A={botData:O};h(os.BOT,O.id)?f.unshift(A):f.push(A)}return f})}),j(WO,g=>{const m=g.getParser();r(p=>{const f=[...p];if(f.findIndex(A=>A.botData.id===m.item.id)>=0)return p;const I={botData:m.item};return h(os.BOT,I.botData.id)?f.unshift(I):f.push(I),f})}),j(YO,g=>{const m=g.getParser();r(p=>{const f=[...p],T=f.findIndex(I=>I.botData.id===m.itemId);return T===-1?p:(f.splice(T,1),bc()===m.itemId&&(zu(),Le("inventory/show")),f)})}),d.exports.useEffect(()=>{!t||!t.length||n(g=>{let m=g;return m&&t.indexOf(m)===-1&&(m=null),m||(m=t[0]),m})},[t]),d.exports.useEffect(()=>{if(o)return()=>{u(os.BOT)}},[o,u]),d.exports.useEffect(()=>{!o||!s||(W(new mf),e(!1))},[o,s]),{botItems:t,selectedBot:i,setSelectedBot:n,activate:l,deactivate:c}},S0=()=>vs(s7);let xh=null;const r7=()=>{const[s,e]=d.exports.useState(!0),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=Tg(),{isUnseen:h=null,resetCategory:u=null}=Ci(),g=f=>{if(!(!t||!t.length))return t.filter(T=>T.type===f)},m=f=>{if(!(!t||!t.length)){for(const T of t){const I=T.getItemById(f);if(I&&I.isWallItem)return T}return null}},p=f=>{if(!(!t||!t.length)){for(const T of t){const I=T.getItemById(f);if(I&&!I.isWallItem)return T}return null}};return j(sE,f=>{const T=f.getParser();r(I=>{const O=[...I];for(const A of T.items){let N=0,P=null;for(;N<O.length;){const y=O[N];let D=0;for(;D<y.items.length;){const x=y.items[D];if(x.id===A.itemId){x.update(A);const w=[...y.items];w[D]=x,y.items=w,P=y;break}D++}if(P)break;N++}if(P)P.hasUnseenItems=!0,O[N]=Hr(P);else{const y=new Yu(A);pT(O,y,h(os.FURNI,A.itemId)),zs(new I_(y.id,y.type,y.category))}}return O})}),j(Gd,f=>{const T=f.getParser();xh||(xh=new Array(T.totalFragments));const I=Mq(T.fragment,T.totalFragments,T.fragmentNumber,xh);I&&(r(O=>{const A=[...O],N=Dq(A);for(const P of N){if(I.get(P))continue;let y=0;for(;y<A.length;){const D=A[y],x=D.remove(P);if(!x){y++;continue}bc()===x.ref&&(zu(),yc(D)||Le("inventory/show")),D.getTotalCount()<=0&&(A.splice(y,1),D.dispose());break}}for(const P of I.keys()){if(N.indexOf(P)>=0)continue;const y=I.get(P);if(!y)continue;const D=new Yu(y);pT(A,D,h(os.FURNI,P)),zs(new I_(D.id,D.type,D.category))}return A}),xh=null)}),j(oA,f=>{e(!0)}),j(rE,f=>{const T=f.getParser();r(I=>{const O=[...I];let A=0;for(;A<O.length;){const N=O[A],P=N.remove(T.itemId);if(!P){A++;continue}bc()===P.ref&&(zu(),yc(N)||Le("inventory/show")),N.getTotalCount()<=0&&(O.splice(A,1),N.dispose());break}return O})}),j(lA,f=>{}),d.exports.useEffect(()=>{!t||!t.length||n(f=>{let T=f;return T&&t.indexOf(T)===-1&&(T=null),T||(T=t[0]),T})},[t]),d.exports.useEffect(()=>{if(o)return()=>{u(os.FURNI)&&r(f=>{const T=[...f];for(const I of T)I.hasUnseenItems=!1;return T})}},[o,u]),d.exports.useEffect(()=>{!o||!s||(W(new Av),e(!1))},[o,s]),{isVisible:o,groupItems:t,setGroupItems:r,selectedItem:i,setSelectedItem:n,activate:l,deactivate:c,getWallItemById:m,getFloorItemById:p,getItemsByType:g}},yl=()=>vs(r7);let wh=null;const i7=()=>{const[s,e]=d.exports.useState(!0),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(null),{isVisible:o=!1,activate:l=null,deactivate:c=null}=Tg(),{isUnseen:h=null,resetCategory:u=null}=Ci();return j(hA,g=>{const m=g.getParser();wh||(wh=new Array(m.totalFragments));const p=Uq(m.fragment,m.totalFragments,m.fragmentNumber,wh);p&&(r(f=>{const T=[...f];return Lq(T,p,h),T}),wh=null)}),j(uA,g=>{const m=g.getParser();r(p=>{const f=[...p];return kL(m.pet,f,h(os.PET,m.pet.id)),f})}),j(_A,g=>{const m=g.getParser();r(p=>{const f=[...p];return GL(m.petId,f),f})}),d.exports.useEffect(()=>{!t||!t.length||n(g=>{let m=g;return m&&t.indexOf(m)===-1&&(m=null),m||(m=t[0]),m})},[t]),d.exports.useEffect(()=>{if(o)return()=>{u(os.PET)}},[o,u]),d.exports.useEffect(()=>{!o||!s||(W(new ff),e(!1))},[o,s]),{petItems:t,selectedPet:i,setSelectedPet:n,activate:l,deactivate:c}},O0=()=>vs(i7),n7=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(ps.TRADING_STATE_READY),{groupItems:o=[],setGroupItems:l=null,activate:c=null,deactivate:h=null}=yl(),{simpleAlert:u=null,showTradeAlert:g=null}=$t(),m=i>=ps.TRADING_STATE_RUNNING,p=()=>{switch(i){case ps.TRADING_STATE_RUNNING:!t.itemCount&&!s.accepts&&u(E("inventory.trading.warning.other_not_offering"),null,null,null),s.accepts?W(new Lv):W(new Nv);return;case ps.TRADING_STATE_CONFIRMING:W(new vv),n(ps.TRADING_STATE_CONFIRMED);return}},f=I=>{const O=I.getLastItem();O&&W(new Dv(O.id))},T=()=>{if(m)switch(i){case ps.TRADING_STATE_RUNNING:W(new yv);return;default:W(new bv);return}};return j(gA,I=>{const O=I.getParser();!s||!t||(s.userId===O.userID?e(A=>{const N=Hr(A);return N.accepts=O.userAccepts,N}):t.userId===O.userID&&r(A=>{const N=Hr(A);return N.accepts=O.userAccepts,N}))}),j(mA,I=>{const O=I.getParser();O.reason===xp.ERROR_WHILE_COMMIT?g(js.ERROR_WHILE_COMMIT):s&&O.userID!==s.userId&&g(js.THEY_CANCELLED),e(null),r(null),n(ps.TRADING_STATE_READY)}),j(fA,I=>{I.getParser(),e(null),r(null),n(ps.TRADING_STATE_READY)}),j(pA,I=>{I.getParser(),n(ps.TRADING_STATE_COUNTDOWN)}),j(EA,I=>{const O=I.getParser(),A=TT(O.firstUserItemArray),N=TT(O.secondUserItemArray);e(P=>{const y=Hr(P);y.userId===O.firstUserID?(y.creditsCount=O.firstUserNumCredits,y.itemCount=O.firstUserNumItems,y.userItems=A):(y.creditsCount=O.secondUserNumCredits,y.itemCount=O.secondUserNumItems,y.userItems=N);const D=[];for(const x of y.userItems.getValues()){let w=0;for(;w<x.getTotalCount();){const k=x.getItemByIndex(w);k&&D.push(k.ref),w++}}return l(x=>{const w=[...x];for(const k of w)k.lockItemIds(D);return w}),y}),r(P=>{const y=Hr(P);return y.userId===O.firstUserID?(y.creditsCount=O.firstUserNumCredits,y.itemCount=O.firstUserNumItems,y.userItems=A):(y.creditsCount=O.secondUserNumCredits,y.itemCount=O.secondUserNumItems,y.userItems=N),y})}),j(IA,I=>{I.getParser()}),j(TA,I=>{const O=I.getParser(),A=new ET,N=bt().userDataManager.getUserData(O.userID);A.userItems=new As;const P=new ET,y=bt().userDataManager.getUserData(O.otherUserID);P.userItems=new As,N.webID===ie().userId?(A.userId=N.webID,A.userName=N.name,A.canTrade=O.userCanTrade,P.userId=y.webID,P.userName=y.name,P.canTrade=O.otherUserCanTrade):y.webID===ie().userId&&(A.userId=y.webID,A.userName=y.name,A.canTrade=O.otherUserCanTrade,P.userId=N.webID,P.userName=N.name,P.canTrade=O.userCanTrade),e(A),r(P),n(ps.TRADING_STATE_RUNNING)}),j(RA,I=>{const O=I.getParser();g(O.reason,O.otherUserName)}),j(SA,I=>{I.getParser(),g(js.THEY_NOT_ALLOWED)}),j(OA,I=>{I.getParser(),g(js.YOU_NOT_ALLOWED)}),d.exports.useEffect(()=>{if(i===ps.TRADING_STATE_READY)return;const I=c();return()=>h(I)},[i,c,h]),{ownUser:s,otherUser:t,tradeState:i,setTradeState:n,isTrading:m,groupItems:o,progressTrade:p,removeItem:f,stopTrading:T}},MI=()=>vs(n7),a7=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState([]),[u,g]=d.exports.useState([]),[m,p]=d.exports.useState([]),{simpleAlert:f=null}=$t(),T=L=>{t.indexOf(L)>=0||r(B=>[...B,L])},I=L=>{r(B=>{const V=[...B],q=V.indexOf(L);return q>=0&&V.splice(q),V})},O=L=>{t.indexOf(L)>=0?I(L):T(L)},A=L=>{i.indexOf(L)>=0||n(B=>[...B,L])},N=L=>{n(B=>{const V=[...B],q=V.indexOf(L);return q>=0&&V.splice(q),V})},P=L=>{i.indexOf(L)>=0?N(L):A(L)},y=L=>{o.indexOf(L)>=0||l(B=>[...B,L])},D=L=>{l(B=>{const V=[...B],q=V.indexOf(L);return q>=0&&V.splice(q),V})},x=L=>{o.indexOf(L)>=0?D(L):y(L)},w=L=>{c.indexOf(L)>=0||h(B=>[...B,L])},k=L=>{h(B=>{const V=[...B],q=V.indexOf(L);return q>=0&&V.splice(q),V})},F=L=>{i.indexOf(L)>=0?k(L):w(L)};return j(FA,L=>{const V=L.getParser().data;e(V),g(V.issues)}),j(LA,L=>{const B=L.getParser();g(V=>{const q=[...V],Z=q.findIndex(H=>H.issueId===B.issueData.issueId);return Z>=0?q[Z]=B.issueData:(q.push(B.issueData),na(pi.MODTOOLS_NEW_TICKET)),q})}),j(BA,L=>{L.getParser()}),j(UA,L=>{L.getParser()&&f("Failed to pick issue",Ze.DEFAULT,null,null,"Error")}),j(PA,L=>{const B=L.getParser();g(V=>{const q=[...V],Z=q.findIndex(H=>H.issueId===B.issueId);return Z>=0&&q.splice(Z,1),q})}),j(xA,L=>{L.getParser().success?f("Moderation action was successfull",Ze.MODERATION,null,null,"Success"):f("There was a problem applying tht moderation action",Ze.MODERATION,null,null,"Error")}),j(KO,L=>{const B=L.getParser();p(B.callForHelpCategories)}),j(zO,L=>{L.getParser()}),{settings:s,openRooms:t,openRoomChatlogs:i,openUserChatlogs:c,openUserInfos:o,cfhCategories:m,tickets:u,openRoomInfo:T,closeRoomInfo:I,toggleRoomInfo:O,openRoomChatlog:A,closeRoomChatlog:N,toggleRoomChatlog:P,openUserInfo:y,closeUserInfo:D,toggleUserInfo:x,openUserChatlog:w,closeUserChatlog:k,toggleUserChatlog:F}},Jc=()=>vs(a7),o7=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState({roomInfo:null,state:Pt.NONE}),[u,g]=d.exports.useState(null),[m,p]=d.exports.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:f=null}=$t();return j(iN,T=>{const I=T.getParser();W(new Bu(I.roomId,!1,!1))}),j(QA,T=>{const I=T.getParser();I.canCreate||f(E(`navigator.cannotcreateevent.error.${I.errorCode}`),null,null,null,E("navigator.cannotcreateevent.title"))}),j(Tc,T=>{W(new oM),W(new SE)}),j(hE,T=>{const I=T.getParser();p(O=>{const A={...O};return A.eventMod=I.securityLevel>=ii.MODERATOR,A.roomPicker=I.securityLevel>=ii.COMMUNITY,A})}),j(UN,T=>{const I=T.getParser();Wr(I.roomId)}),j(lE,T=>{const I=T.getParser();p(O=>{const A={...O};return A.enteredGuestRoom=null,A.currentRoomOwner=I.isOwner,A.currentRoomId=I.roomId,A}),W(new Bu(I.roomId,!0,!1)),It.available&&It.call("legacyTrack","navigator","private",[I.roomId])}),j(wa,T=>{const I=T.getParser();if(I.roomEnter)h({roomInfo:null,state:Pt.NONE}),p(O=>{const A={...O};return A.enteredGuestRoom=I.data,A.currentRoomIsStaffPick=I.staffPick,!(A.createdFlatId===I.data.roomId)&&I.data.displayRoomEntryAd&&Ee("roomenterad.habblet.enabled",!1)&&an.openRoomEnterAd(),A.createdFlatId=0,A.enteredGuestRoom&&A.enteredGuestRoom.habboGroupId>0,A});else if(I.roomForward){if(I.data.ownerName!==ie().userName&&!I.isGroupMember)switch(I.data.doorMode){case Ot.DOORBELL_STATE:h(O=>{const A={...O};return A.roomInfo=I.data,A.state=Pt.START_DOORBELL,A});return;case Ot.PASSWORD_STATE:h(O=>{const A={...O};return A.roomInfo=I.data,A.state=Pt.START_PASSWORD,A});return}if(I.data.doorMode===Ot.NOOB_STATE&&!ie().isAmbassador&&!ie().isRealNoob&&!ie().isModerator)return;ol(I.data.roomId)}else p(O=>{const A={...O};return A.enteredGuestRoom=I.data,A.currentRoomIsStaffPick=I.staffPick,A})}),j(FN,T=>{const I=T.getParser();p(O=>{const A={...O};return A.currentRoomRating=I.totalLikes,A.canRate=I.canLike,A})}),j(iE,T=>{const I=T.getParser();(!I.userName||I.userName.length===0)&&h(O=>{const A={...O};return A.state=Pt.STATE_WAITING,A})}),j(Vd,T=>{const I=T.getParser();(!I.userName||I.userName.length===0)&&h(O=>{const A={...O};return A.state=Pt.STATE_ACCEPTED,A})}),j(Bd,T=>{const I=T.getParser();(!I.userName||I.userName.length===0)&&h(O=>{const A={...O};return A.state=Pt.STATE_NO_ANSWER,A})}),j(kd,T=>{switch(T.getParser().errorCode){case-100002:h(O=>{const A={...O};return A.state=Pt.STATE_WRONG_PASSWORD,A});return;case 4009:f(E("navigator.alert.need.to.be.vip"),Ze.DEFAULT,null,null,E("generic.alert.title"));return;case 4010:f(E("navigator.alert.invalid_room_name"),Ze.DEFAULT,null,null,E("generic.alert.title"));return;case 4011:f(E("navigator.alert.cannot_perm_ban"),Ze.DEFAULT,null,null,E("generic.alert.title"));return;case 4013:f(E("navigator.alert.room_in_maintenance"),Ze.DEFAULT,null,null,E("generic.alert.title"));return}}),j(ZA,T=>{const I=T.getParser();l(I.topLevelContexts),n(I.topLevelContexts.length?I.topLevelContexts[0]:null)}),j(tN,T=>{const I=T.getParser();n(O=>{let A=O;if(A||(A=o&&o.length&&o[0]||null),!A)return null;if(I.result.code!==A.code&&o&&o.length)for(const N of o)N.code===I.result.code&&(A=N);for(const N of o)N.code===I.result.code&&(A=N);return A}),g(I.result)}),j(aN,T=>{const I=T.getParser();e(I.categories)}),j(nN,T=>{const I=T.getParser();r(I.categories)}),j($A,T=>{const I=T.getParser();ol(I.roomId)}),j(JA,T=>{const I=T.getParser();let O=!1;if(p(P=>{O=P.settingsReceived;const y={...P};return y.homeRoomId=I.homeRoomId,y.settingsReceived=!0,y}),O)return;let A=-1,N=-1;Ee("friend.id")!==void 0&&parseInt(Ee("friend.id"))>0&&(A=0,W(new q_(parseInt(Ee("friend.id"))))),Ee("forward.type")!==void 0&&Ee("forward.id")!==void 0&&(A=parseInt(Ee("forward.type")),N=parseInt(Ee("forward.id"))),A===2?Wr(N):A===-1&&I.roomIdToEnter>0&&(Le("navigator/close"),I.roomIdToEnter!==I.homeRoomId?ol(I.roomIdToEnter):ol(I.homeRoomId))}),j(LN,T=>{const I=T.getParser();switch(I.reason){case fo.REASON_FULL:f(E("navigator.guestroomfull.text"),Ze.DEFAULT,null,null,E("navigator.guestroomfull.title"));break;case fo.REASON_QUEUE_ERROR:f(E(`room.queue.error.${I.parameter}`),Ze.DEFAULT,null,null,E("room.queue.error.title"));break;case fo.REASON_BANNED:f(E("navigator.banned.text"),Ze.DEFAULT,null,null,E("navigator.banned.title"));break;default:f(E("room.queue.error.title"),Ze.DEFAULT,null,null,E("room.queue.error.title"));break}dI()}),j(eN,T=>Le("navigator/show")),{categories:s,doorData:c,setDoorData:h,topLevelContext:i,topLevelContexts:o,searchResult:u,navigatorData:m}},Fi=()=>vs(o7),l7=()=>{const[s,e]=d.exports.useState(new SI),t=d.exports.useMemo(()=>Ee("hc.disabled",!1),[]),r=d.exports.useMemo(()=>t||s.clubDays>0?On.ACTIVE:s.pastVipDays>0||s.pastVipDays>0?On.EXPIRED:On.NONE,[s,t]),i=n=>{if(n===-1)return s.credits;for(const[o,l]of s.activityPoints.entries())if(o===n)return l;return 0};return j(Bb,n=>{const o=n.getParser();e(l=>{const c=Hr(l);return c.credits=parseFloat(o.credits),l.credits!==c.credits&&na(pi.CREDITS),c})}),j(Vb,n=>{const o=n.getParser();e(l=>{const c=Hr(l);return c.activityPoints=o.currencies,c})}),j(nE,n=>{const o=n.getParser();e(l=>{const c=Hr(l);return c.activityPoints=new Map(c.activityPoints),c.activityPoints.set(o.type,o.amount),o.type===0&&na(pi.DUCKETS),c})}),j(Hb,n=>{const o=n.getParser(),l=o.productName;l!=="club_habbo"&&l!=="habbo_club"||e(c=>{const h=Hr(c);return h.clubDays=Math.max(0,o.daysToPeriodEnd),h.clubPeriods=Math.max(0,o.periodsSubscribedAhead),h.isVip=o.isVip,h.pastClubDays=o.pastClubDays,h.pastVipDays=o.pastVipDays,h.isExpiring=o.responseType===xc.RESPONSE_TYPE_DISCOUNT_AVAILABLE,h.minutesUntilExpiration=o.minutesUntilExpiration,h.minutesSinceLastModified=o.minutesSinceLastModified,h})}),d.exports.useEffect(()=>{if(t)return;W(new Nf("habbo_club"));const n=setInterval(()=>W(new Nf("habbo_club")),5e4);return()=>clearInterval(n)},[t]),d.exports.useEffect(()=>{W(new nP)},[]),{purse:s,hcDisabled:t,clubStatus:r,getCurrencyAmount:i}},vl=()=>vs(l7),c7=(s,e)=>{d.exports.useEffect(()=>{if(!s)return;const t=r=>e(r);return ia.addEventListener(Ct.FURNI_ADDED,t),()=>{ia.removeEventListener(Ct.FURNI_ADDED,t)}},[s,e])},ki=(s,e)=>{d.exports.useEffect(()=>{if(!s)return;const t=r=>e(r);return ia.addEventListener(Ct.FURNI_REMOVED,t),()=>{ia.removeEventListener(Ct.FURNI_REMOVED,t)}},[s,e])},u7=s=>{Cs(Ct.OBJECT_DESELECTED,s)},h7=s=>{Cs(Ct.OBJECT_DOUBLE_CLICKED,s)},d7=s=>{Cs(Ct.OBJECT_ROLL_OUT,s)},_7=s=>{Cs(Ct.OBJECT_ROLL_OVER,s)},DI=s=>{Cs(Ct.OBJECT_SELECTED,s)},C0=(s,e)=>{d.exports.useEffect(()=>{if(!s)return;const t=r=>e(r);return ia.addEventListener(Ct.USER_ADDED,t),()=>{ia.removeEventListener(Ct.USER_ADDED,t)}},[s,e])},A0=(s,e)=>{d.exports.useEffect(()=>{if(!s)return;const t=r=>e(r);return ia.addEventListener(Ct.USER_REMOVED,t),()=>{ia.removeEventListener(Ct.USER_REMOVED,t)}},[s,e])},g7=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(!1);return j(sN,i=>{const n=i.getParser();n&&e(n)}),{promoteInformation:s,isExtended:t,setPromoteInformation:e,setIsExtended:r}},PI=()=>vs(g7),m7=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(0),c=(u,g,m,p=!1)=>{if(!t)return;const f=Sr.hslToRGB(((u&255)<<16)+((g&255)<<8)+(m&255));p&&l(f),!u&&!g&&!m?t.tint=0:t.tint=f},h=u=>{if(!i)return;const g=u>>16&255,m=u>>8&255,p=u&255;i.red=g/255,i.green=m/255,i.blue=p/255};return Cs(go.PREVIEW,u=>c(u.hue,u.saturation,u.lightness)),Cs(go.CLEAR_PREVIEW,u=>{t&&(t.tint=o)}),_t(Pd.ROOM_BACKGROUND_COLOR,u=>{Zn.isRoomPreviewerId(u.roomId)||(u.enable?c(u.hue,u.saturation,u.lightness,!0):c(0,0,0,!0))}),_t(pp.ROOM_COLOR,u=>{if(Zn.isRoomPreviewerId(u.roomId))return;let g=0,m=255;u.bgOnly||(g=u.color,m=u.brightness),h(Sr.hslToRGB((Sr.rgbToHSL(g)&16776960)+m))}),_t([lt.INITIALIZED,lt.DISPOSED],u=>{if(Zn.isRoomPreviewerId(u.roomId))return;const g=bt();if(g)switch(u.type){case lt.INITIALIZED:gT(u.roomId),e(g);return;case lt.DISPOSED:e(null);return}}),es([Ve.CREATED,Ve.ENDED],u=>{switch(u.type){case Ve.CREATED:Rq(u.session);return;case Ve.ENDED:e(null);return}}),_t([ye.SELECTED,ye.DESELECTED,ye.ADDED,ye.REMOVED,ye.PLACED,ye.REQUEST_MOVE,ye.REQUEST_ROTATE,ye.MOUSE_ENTER,ye.MOUSE_LEAVE,ye.DOUBLE_CLICK],u=>{if(Zn.isRoomPreviewerId(u.roomId))return;let g=null;switch(u.type){case ye.SELECTED:Oq(u)||(g=new Ct(Ct.OBJECT_SELECTED,u.objectId,u.category,u.roomId));break;case ye.DESELECTED:g=new Ct(Ct.OBJECT_DESELECTED,u.objectId,u.category,u.roomId);break;case ye.ADDED:{let m=null;switch(u.category){case z.FLOOR:case z.WALL:m=Ct.FURNI_ADDED;break;case z.UNIT:m=Ct.USER_ADDED;break}m&&(g=new Ct(m,u.objectId,u.category,u.roomId));break}case ye.REMOVED:{let m=null;switch(u.category){case z.FLOOR:case z.WALL:m=Ct.FURNI_REMOVED;break;case z.UNIT:m=Ct.USER_REMOVED;break}m&&(g=new Ct(m,u.objectId,u.category,u.roomId));break}case ye.REQUEST_MOVE:Wu(s,u.objectId,u.category)&&cc(u.objectId,u.category,Qe.OBJECT_MOVE);break;case ye.REQUEST_ROTATE:Wu(s,u.objectId,u.category)&&cc(u.objectId,u.category,Qe.OBJECT_ROTATE_POSITIVE);break;case ye.MOUSE_ENTER:g=new Ct(Ct.OBJECT_ROLL_OVER,u.objectId,u.category,u.roomId);break;case ye.MOUSE_LEAVE:g=new Ct(Ct.OBJECT_ROLL_OUT,u.objectId,u.category,u.roomId);break;case ye.DOUBLE_CLICK:g=new Ct(Ct.OBJECT_DOUBLE_CLICKED,u.objectId,u.category,u.roomId);break}g&&zs(g)}),d.exports.useEffect(()=>{if(!s)return;const u=mt(),g=te(),m=s.roomId,p=1,f=Math.floor(window.innerWidth),T=Math.floor(window.innerHeight),I=u.application.renderer;I&&(I.view.style.width=`${f}px`,I.view.style.height=`${T}px`,I.resolution=window.devicePixelRatio,I.resize(f,T));const O=g.getRoomInstanceDisplay(m,p,f,T,No.SCALE_ZOOMED_IN),A=te().getRoomInstanceRenderingCanvas(m,p);if(!O||!A)return;const N=new ds(dp.WHITE),P=new lS,y=A.master;N.tint=0,N.width=f,N.height=T,y.addChildAt(N,0),y.filters=[P],r(N),n(P);const D=g.getRoomInstanceGeometry(m,p);if(D){const k=g.getRoomInstanceVariable(m,Ht.ROOM_MIN_X)||0,F=g.getRoomInstanceVariable(m,Ht.ROOM_MAX_X)||0,L=g.getRoomInstanceVariable(m,Ht.ROOM_MIN_Y)||0,B=g.getRoomInstanceVariable(m,Ht.ROOM_MAX_Y)||0;let V=(k+F)/2,q=(L+B)/2;const Z=20;V=V+(Z-1),q=q+(Z-1);const H=Math.sqrt(Z*Z+Z*Z)*Math.tan(30/180*Math.PI);D.location=new G(V,q,H)}const x=u.application.stage;if(!x)return;x.addChild(O),gT(s.roomId);const w=k=>{const F=Math.floor(window.innerWidth),L=Math.floor(window.innerHeight);I.view.style.width=`${F}px`,I.view.style.height=`${L}px`,I.resolution=window.devicePixelRatio,I.resize(F,L),N.width=F,N.height=L,Sq(F,L,1),u.application.render()};return window.addEventListener("resize",w),()=>{r(null),n(null),l(0),window.removeEventListener("resize",w)}},[s]),{roomSession:s}},Yt=()=>vs(m7),f7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(0),{roomSession:o=null}=Yt(),l=()=>{const u=Sr.rgbToHSL(i),[g,m,p,f]=si.int_to_8BitVals(u);W(new mD(s,m,p,f))},c=()=>o.useMultistateItem(s),h=()=>{zs(new go(go.CLEAR_PREVIEW)),e(-1),r(-1),n(0)};return _t(ne.REQUEST_BACKGROUND_COLOR,u=>{if(!Wu(o,u.objectId,u.category))return;const m=te().getRoomObject(u.roomId,u.objectId,u.category).model;e(u.objectId),r(u.category);const p=parseInt(m.getValue(b.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),f=parseInt(m.getValue(b.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),T=parseInt(m.getValue(b.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),I=si.eight_bitVals_to_int(0,p,f,T),O=Sr.hslToRGB(I);n(O)}),ki(s!==-1&&t!==-1,u=>{u.id!==s||u.category!==t||h()}),d.exports.useEffect(()=>{if(s===-1||t===-1)return;const u=Sr.rgbToHSL(i),[g,m,p,f]=si.int_to_8BitVals(u);zs(new go(go.PREVIEW,m,p,f))},[s,t,i]),{objectId:s,color:i,setColor:n,applyToner:l,toggleToner:c,onClose:h}},p7=f7,E7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState("1"),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(""),[u,g]=d.exports.useState(""),[m,p]=d.exports.useState(""),{simpleAlert:f=null}=$t(),T=()=>{e(-1),r(-1),n("1"),l(""),h(""),g(""),p("")};return _t([ne.REQUEST_BADGE_DISPLAY_ENGRAVING,ne.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],I=>{const O=te().getRoomObject(I.roomId,I.objectId,I.category);if(!O)return;const A=new vn;A.initializeFromRoomObjectModel(O.model),e(I.objectId),r(I.category),n("1"),l(Th(A.getValue(1))),h(fI(A.getValue(1))),g(A.getValue(2)),p(A.getValue(3))}),_t(ne.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,I=>{const O=te().getRoomObject(I.roomId,I.objectId,I.category);!O||O.model.getValue(b.FURNITURE_OWNER_ID)!==ie().userId||f(`${E("resolution.failed.subtitle")} ${E("resolution.failed.text")}`,null,null,null,E("resolution.failed.title"))}),ki(s!==-1&&t!==-1,I=>{I.id!==s||I.category!==t||T()}),{objectId:s,category:t,color:i,badgeName:o,badgeDesc:c,date:u,senderName:m,onClose:T}},I7=E7,Zf="MONSTERPLANT_SEED_CONFIRMATION",ep="PURCHASABLE_CLOTHING_CONFIRMATION",N0="GROUP_FURNITURE",b0="EFFECTBOX_OPEN",tp="MYSTERYTROPHY_OPEN_DIALOG",T7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(-1),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(!1),[m,p]=d.exports.useState(-1),{roomSession:f=null}=Yt(),T=()=>{e(-1),h(null),g(!1),r(null)},I=()=>{n(null),l(-1)},O=A=>{if(A)switch(A){case"use_friend_furni":f.useMultistateItem(s);break;case"use_monsterplant_seed":n(Zf),l(s);break;case"use_random_teleport":te().useRoomObject(s,z.FLOOR);break;case"use_purchaseable_clothing":n(ep),l(s);break;case"use_mystery_box":f.useMultistateItem(s);break;case"use_mystery_trophy":n(tp),l(s);break;case"join_group":RI(c.guildId),g(!0);return;case"go_to_group_homeroom":c&&Wr(c.guildHomeRoomId);break}T()};return _t([ne.OPEN_FURNI_CONTEXT_MENU,ne.CLOSE_FURNI_CONTEXT_MENU,ne.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,ne.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,ne.REQUEST_EFFECTBOX_OPEN_DIALOG,ne.REQUEST_MYSTERYBOX_OPEN_DIALOG,ne.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],A=>{const N=te().getRoomObject(f.roomId,A.objectId,A.category);if(N)switch(p(N.model.getValue(b.FURNITURE_OWNER_ID)),A.type){case ne.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Dr(N))return;l(N.id),n(Zf),T();return;case ne.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Dr(N))return;l(N.id),n(b0),T();return;case ne.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Dr(N))return;l(N.id),n(ep),T();return;case ne.REQUEST_MYSTERYBOX_OPEN_DIALOG:f.useMultistateItem(N.id),T();return;case ne.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Dr(N))return;l(N.id),n(tp),T();return;case ne.OPEN_FURNI_CONTEXT_MENU:switch(e(N.id),A.contextMenu){case Wt.FRIEND_FURNITURE:r(Wt.FRIEND_FURNITURE);return;case Wt.MONSTERPLANT_SEED:Dr(N)&&r(Wt.MONSTERPLANT_SEED);return;case Wt.MYSTERY_BOX:r(Wt.MYSTERY_BOX);return;case Wt.MYSTERY_TROPHY:Dr(N)&&r(Wt.MYSTERY_TROPHY);return;case Wt.RANDOM_TELEPORT:r(Wt.RANDOM_TELEPORT);return;case Wt.PURCHASABLE_CLOTHING:Dr(N)&&r(Wt.PURCHASABLE_CLOTHING);return}return;case ne.CLOSE_FURNI_CONTEXT_MENU:N.id===s&&T();return}}),j(HN,A=>{const N=A.getParser();e(N.objectId),h(N),g(N.userIsMember),r(N0)}),{objectId:s,mode:t,confirmMode:i,confirmingObjectId:o,groupData:c,isGroupMember:u,objectOwnerId:m,closeConfirm:I,processAction:O,onClose:T}},R7=T7,S7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(new Map),[m,p]=d.exports.useState(!1),{groupItems:f=[],getItemsByType:T=null,activate:I=null,deactivate:O=null}=yl(),{simpleAlert:A=null}=$t(),N=i&&u.get(i.name)||null,P=()=>{r([]),n(null),l([]),g(new Map)},y=()=>{e(-1),P()},D=()=>{p(!0),W(new Iy(s,i.name))},x=w=>{n(w),u.get(w.name)||W(new Ry(w.name))};return _t(ne.OPEN_WIDGET,w=>{w.widget===et.CRAFTING&&(e(w.objectId),P(),W(new Ty(w.objectId)))}),j(SC,w=>{const k=w.getParser();if(!k.isActive()){e(-1);return}r(F=>{const L=[];for(const B of k.recipes){const V=te().roomContentLoader._activeObjectTypeIds.get(B.itemName),q=te().getFurnitureFloorIconUrl(V);L.push({name:B.recipeName,localizedName:E("roomItem.name."+V),iconUrl:q})}return L}),h(k.ingredients)}),j(OC,w=>{const k=w.getParser();g(F=>{const L=new Map(F);return L.set(i.name,k.ingredients),L})}),j(AC,w=>{n(null),p(!1),w.getParser().result&&A(E("crafting.info.result.ok"))}),j(CC,w=>{}),d.exports.useEffect(()=>{!c||!c.length||l(w=>{const k=[];for(const F of c){const L=te().roomContentLoader._activeObjectTypeIds.get(F),B=te().getFurnitureFloorIconUrl(L),V=T(L);let q=0;if(V)for(const Z of V)q+=Z.items.length;k.push({name:F,iconUrl:B,count:q})}return k})},[f,c,T]),d.exports.useEffect(()=>{if(s===-1)return;const w=I();return()=>O(w)},[s,I,O]),{objectId:s,recipes:t,ingredients:o,selectedRecipe:i,requiredIngredients:N,isCrafting:m,selectRecipe:x,craft:D,onClose:y}},O7=S7,C7=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState(0),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(0),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(16777215),[m,p]=d.exports.useState(255),[f,T]=d.exports.useState(0),[I,O]=d.exports.useState(0),[A,N]=d.exports.useState(0),{roomSession:P=null}=Yt(),y=()=>P.isRoomOwner||P.controllerLevel>=Rt.GUEST||ie().isModerator,D=w=>{const k=s[w-1];k&&(r(k.id),T(k.type),O(k.color),N(k.light))},x=()=>{if(i===0)return;const w=t-1;if(t<1||t>s.length)return;const k=s[w];!k||f===k.type&&I===k.color&&A===k.light||(e(F=>{const L=[...F];return L[w]=new bT(k.id,f,I,A),L}),li.savePreset(k.id,f,I,A,!0))};return _t(ne.REQUEST_DIMMER,w=>{y()&&P.requestMoodlightSettings()}),es(Ud.ROOM_DIMMER_PRESETS,w=>{const k=[];let F=0;for(;F<w.presetCount;){const L=w.getPreset(F);L&&k.push(new bT(L.id,L.type,L.color,L.brightness)),F++}e(k),r(w.selectedPresetId)}),_t(Ip.ROOM_COLOR,w=>{Zn.isRoomPreviewerId(w.roomId)||(l(i),n(w.state),r(w.presetId),h(w.effectId),T(w.effectId),g(w.color),O(w.color),p(w.brightness),N(w.brightness))}),d.exports.useEffect(()=>{i===0&&o===0||li.previewDimmer(I,A,f===2)},[i,o,I,A,f]),{presets:s,selectedPresetId:t,dimmerState:i,lastDimmerState:o,effectId:c,color:u,brightness:m,selectedEffectId:f,setSelectedEffectId:T,selectedColor:I,setSelectedColor:O,selectedBrightness:A,setSelectedBrightness:N,selectPresetId:D,applyChanges:x}},A7=C7,N7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(0),o=()=>{e(-1),r(-1),n(0)},l=()=>{bt().connection.send(new oD(s)),o()};return _t(ne.REQUEST_CREDITFURNI,c=>{const h=te().getRoomObject(c.roomId,c.objectId,c.category);!h||!Dr(h)||(e(c.objectId),r(c.category),n(h.model.getValue(b.FURNITURE_CREDIT_VALUE)||0))}),ki(s!==-1&&t!==-1,c=>{c.id!==s||c.category!==t||o()}),{objectId:s,value:i,redeem:l,onClose:o}},b7=N7,y7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(-1),[o,l]=d.exports.useState([]),{roomSession:c=null}=Yt(),h=()=>{e(-1),r(-1),n(-1),l([])};return _t(ne.REQUEST_EXTERNAL_IMAGE,u=>{const g=te().getRoomObject(u.roomId,u.objectId,u.category),m=te().getRoomObjects(c==null?void 0:c.roomId,z.WALL);if(!g)return;const p=[];m.forEach(T=>{if(T.type!=="external_image_wallitem_poster_small")return null;const I=T.model.getValue(b.FURNITURE_DATA),O=JSON.parse(I);p.push(O)}),e(u.objectId),r(u.category),l(p);const f=JSON.parse(g.model.getValue(b.FURNITURE_DATA));n(T=>{let I=0;return f&&(I=p.findIndex(O=>O.u===f.u)),I<0&&(I=0),I})}),ki(s!==-1&&t!==-1,u=>{u.id!==s||u.category!==t||h()}),{objectId:s,currentPhotoIndex:i,currentPhotos:o,onClose:h}},v7=y7,M7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState([]),[u,g]=d.exports.useState(null),[m,p]=d.exports.useState(0),f=()=>{e(-1),r(-1),n(0),l([]),h([]),g(null)},T=I=>{bt().connection.send(new Oy(s,I)),f()};return j(YN,I=>{const O=I.getParser();e(O.furniId),p(O.start?1:2)}),j(WN,I=>f()),j(jN,I=>f()),_t(ne.REQUEST_FRIEND_FURNITURE_ENGRAVING,I=>{const O=te().getRoomObject(I.roomId,I.objectId,I.category);if(!O)return;const A=O.model.getValue(b.FURNITURE_DATA),N=O.model.getValue(b.FURNITURE_FRIENDFURNI_ENGRAVING);A[0]!=="1"||A.length!==6||(e(I.objectId),r(I.category),n(N),l([A[1],A[2]]),h([A[3],A[4]]),g(A[5]),p(0))}),ki(s!==-1&&t!==-1,I=>{I.id!==s||I.category!==t||f()}),{objectId:s,type:i,usernames:o,figures:c,date:u,stage:m,onClose:f,respond:T}},D7=M7,P7=["perteam","mostwins","classic"],L7=["alltime","daily","weekly","monthly"],U7=()=>{const[s,e]=d.exports.useState(new Map),{roomSession:t=null}=Yt(),r=n=>P7[n],i=n=>L7[n];return _t(ne.REQUEST_HIGH_SCORE_DISPLAY,n=>{const o=te().getRoomObject(n.roomId,n.objectId,n.category);if(!o)return;const l=o.model.getValue(b.FURNITURE_DATA_FORMAT),c=$n.getData(l);c.initializeFromRoomObjectModel(o.model),e(h=>{const u=new Map(h);return u.set(o.id,c),u})}),_t(ne.REQUEST_HIDE_HIGH_SCORE_DISPLAY,n=>{n.roomId===t.roomId&&e(o=>{const l=new Map(o);return l.delete(n.objectId),l})}),{stuffDatas:s,getScoreType:r,getClearType:i}},x7=U7,w7="internalLink",F7=()=>(_t(ne.REQUEST_INTERNAL_LINK,s=>{const e=te().getRoomObject(s.roomId,s.objectId,s.category);if(!e)return;let r=e.model.getValue(b.FURNITURE_DATA)[w7];(!r||!r.length)&&(r=e.model.getValue(b.FURNITURE_INTERNAL_LINK)),r&&r.length&&Le(r)}),{}),k7=F7,G7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(Lr.NO_CLUB),[u,g]=d.exports.useState(null),m=()=>{e(-1),r(-1),n(null),l(null),g(null)},p=()=>{s!==-1&&(W(new hD(s)),m())},f=()=>{s!==-1&&(W(new Sc(s)),m())},T=()=>{s!==-1&&W(new dD(s,u))};return _t(ne.REQUEST_MANNEQUIN,I=>{const O=te().getRoomObject(I.roomId,I.objectId,I.category);if(!O)return;const A=O.model,N=A.getValue(b.FURNITURE_MANNEQUIN_FIGURE)||null,P=A.getValue(b.FURNITURE_MANNEQUIN_GENDER)||null,y=Ks().createFigureContainer(N),D=Ks().getFigureClubLevel(y,P,mc.MANNEQUIN_CLOTHING_PART_TYPES);e(I.objectId),r(I.category),n(N),l(P),h(D),g(A.getValue(b.FURNITURE_MANNEQUIN_NAME)||null)}),ki(s!==-1&&t!==-1,I=>{I.id!==s||I.category!==t||m()}),{objectId:s,figure:i,gender:o,clubLevel:c,name:u,setName:g,saveFigure:p,wearFigure:f,saveName:T,onClose:m}},B7=G7,V7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(-1),[o,l]=d.exports.useState(new As),[c,h]=d.exports.useState([]),{roomSession:u=null}=Yt(),{showSingleBubble:g=null,simpleAlert:m=null}=$t(),p=()=>{e(-1),r(-1)},f=d.exports.useCallback((A,N)=>W(new WD(A,N)),[]),T=d.exports.useCallback(A=>W(new XD(A)),[]),I=d.exports.useCallback((A,N)=>W(new Sc(A,N)),[]);_t(ne.REQUEST_PLAYLIST_EDITOR,A=>{var P,y,D;const N=te().getRoomObject(A.roomId,A.objectId,A.category);if(N){if(Dr(N)){e(A.objectId),r(A.category),(P=mt().soundManager.musicController)==null||P.requestUserSongDisks(),(D=(y=mt().soundManager.musicController)==null?void 0:y.getRoomItemPlaylist())==null||D.requestPlayList();return}(u.isRoomOwner||u.controllerLevel>=Rt.GUEST||ie().isModerator)&&W(new Sc(A.objectId,-2))}}),ki(s!==-1&&t!==-1,A=>{A.id!==s||A.category!==t||p()}),tl(An.NPE_SONG_CHANGED,A=>{n(A.position)}),tl(aI.NOTIFY_PLAYED_SONG,A=>{g(E("soundmachine.notification.playing",["songname","songauthor"],[A.name,A.creator]),ls.SOUNDMACHINE)}),tl(lc.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,A=>{var N;l((N=mt().soundManager.musicController)==null?void 0:N.songDiskInventory.clone())}),tl(Xn.PLUE_PLAY_LIST_UPDATED,A=>{var N,P;h((P=(N=mt().soundManager.musicController)==null?void 0:N.getRoomItemPlaylist())==null?void 0:P.entries.concat())}),tl(Xn.PLUE_PLAY_LIST_FULL,A=>{m(E("playlist.editor.alert.playlist.full"),Ze.ALERT,"","",E("playlist.editor.alert.playlist.full.title"))});const O=A=>{var N,P;s!==-1&&(A instanceof Gd?A.getParser().fragmentNumber===0&&((N=mt().soundManager.musicController)==null||N.requestUserSongDisks()):(P=mt().soundManager.musicController)==null||P.requestUserSongDisks())};return j(Gd,O),j(rE,O),j(sE,O),{objectId:s,diskInventory:o,playlist:c,currentPlayingIndex:i,onClose:p,addToPlaylist:f,removeFromPlaylist:T,togglePlayPause:I}},H7=V7,UT="floor",W7="wallpaper",xT="landscape",j7="poster",Y7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(!1),[u,g]=d.exports.useState(null),[m,p]=d.exports.useState(null),[f,T]=d.exports.useState(-1),[I,O]=d.exports.useState(null),[A,N]=d.exports.useState(!1),[P,y]=d.exports.useState(null),{roomSession:D=null}=Yt(),x=()=>{e(-1),r(-1),n(null),l(null),h(!1),g(null),p(null),T(-1),O(null),N(!1),y(null)},w=()=>{s!==-1&&(D.openGift(s),te().changeObjectModelData(te().activeRoomId,s,z.FLOOR,b.FURNITURE_DISABLE_PICKING_ANIMATION,1))},k=d.exports.useMemo(()=>({imageReady:(F,L,B)=>{!B&&L&&(B=Lt.generateImage(L)),y(B.src)},imageFailed:null}),[]);return es(xd.RSPE_PRESENT_OPENED,F=>{let L=null;F.itemType===nt.FLOOR?L=ie().getFloorItemData(F.classId):F.itemType===nt.WALL&&(L=ie().getWallItemData(F.classId));let B=!1;if(F.placedInRoom){const V=te().getRoomObject(D.roomId,F.placedItemId,z.FLOOR);V&&(B=Dr(V))}switch(F.itemType){case nt.WALL:{if(L)switch(L.className){case UT:case xT:case W7:let V=null;L.className===UT?V=E("inventory.furni.item.floor.name"):L.className===xT?V=E("inventory.furni.item.landscape.name"):V=E("inventory.furni.item.wallpaper.name"),l(V);break;case j7:{const q=F.productCode;let Z=null;q.indexOf("poster")===0&&(Z=q.replace("poster",""));const H=ie().getProductData(q);let X=null;H?X=H.name:L&&(X=L.name),l(X),y(te().getFurnitureWallIconUrl(F.classId,Z));break}default:{l(L.name||null),y(te().getFurnitureWallIconUrl(F.classId));break}}break}case nt.HABBO_CLUB:l(E("widget.furni.present.hc"));break;default:{if(F.placedItemType===nt.PET){const q=F.petFigureString;if(q&&q.length){const Z=new ra(q),H=te().getRoomObjectPetImage(Z.typeId,Z.paletteId,Z.color,new G(90),64,k,!0,0,Z.customParts);H&&y(H.getImage().src)}}else{const q=te().getFurnitureFloorImage(F.classId,new G(90),64,k);q&&y(q.getImage().src)}const V=ie().getProductData(F.productCode);l(V&&V.name||L.name);break}}e(0),r(F.classId),n(F.itemType),h(B),T(F.placedItemId),O(F.placedItemType),N(F.placedInRoom)}),_t(ne.REQUEST_PRESENT,F=>{const L=te().getRoomObject(F.roomId,F.objectId,F.category);if(!L)return null;x(),e(F.objectId),r(-1),l(L.model.getValue(b.FURNITURE_DATA)||""),h(Dr(L)),g(L.model.getValue(b.FURNITURE_PURCHASER_NAME)||null),p(L.model.getValue(b.FURNITURE_PURCHASER_FIGURE)||null)}),ki(s!==-1,F=>{F.id===s&&x(),F.id===f&&A&&N(!1)}),{objectId:s,classId:t,itemType:i,text:o,isOwnerOfFurniture:c,senderName:u,senderFigure:m,placedItemId:f,placedItemType:I,placedInRoom:A,imageUrl:P,openPresent:w,onClose:x}},z7=Y7,K7="internalLink",q7=()=>{const[s,e]=d.exports.useState(0);return _t(ne.REQUEST_ROOM_LINK,t=>{const r=te().getRoomObject(t.roomId,t.objectId,t.category);if(!r)return;let n=r.model.getValue(b.FURNITURE_DATA)[K7];(!n||!n.length)&&(n=r.model.getValue(b.FURNITURE_INTERNAL_LINK)),!(!n||!n.length)&&(n=parseInt(n,10),!isNaN(n)&&(e(n),W(new Bu(n,!1,!1))))}),j(wa,t=>{!s||t.getParser().data.roomId!==s||e(0)}),{}},X7=q7,Q7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState("0"),[u,g]=d.exports.useState(""),[m,p]=d.exports.useState(!1),{getWallItemById:f=null}=yl(),T=()=>{W(new QM(s,o,c,u)),e(-1),r(-1),n(""),l(""),h("0"),g(""),p(!1)};return j(zN,I=>{const O=I.getParser();e(O.itemId),r(z.WALL);const A=f(O.itemId);let N="post_it";if(A){const P=te().getFurnitureWallName(A.type);P.match("post_it_")&&(N=P)}n(N),l(O.location),h("FFFF33"),g(""),p(!0)}),{objectId:s,color:c,setColor:h,text:u,setText:g,canModify:m,onClose:T}},$7=Q7,Gg=40,J7=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(-1),c=()=>{e(-1),r(-1),n(0),l(-1)},h=(u,g=!1)=>{u||(u=0),u=Math.abs(u),g||u>Gg&&(u=Gg),n(parseFloat(u.toFixed(2))),g||l(u*100)};return j(BN,u=>{const g=u.getParser();s===g.furniId&&h(g.height,!0)}),_t(ne.REQUEST_STACK_HEIGHT,u=>{if(!Wu(bt(),u.objectId,u.category))return;const g=te().getRoomObject(u.roomId,u.objectId,u.category);g&&(e(u.objectId),r(u.category),n(g.getLocation().z),l(-1))}),ki(s!==-1&&t!==-1,u=>{u.id!==s||u.category!==t||c()}),d.exports.useEffect(()=>{if(s===-1||o===-1)return;const u=setTimeout(()=>W(new t_(s,~~o)),10);return()=>clearTimeout(u)},[s,o]),{objectId:s,height:i,maxHeight:Gg,onClose:c,updateHeight:h}},Z7=J7,e8=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState("0"),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(""),[u,g]=d.exports.useState(!1),m=()=>{e(-1),r(-1),n("0"),l(""),h(""),g(!1)},p=I=>{I!==i&&(n(I),te().modifyRoomObjectData(s,t,I,o))},f=I=>{l(I),te().modifyRoomObjectData(s,t,i,I)},T=()=>te().deleteRoomObject(s,t);return _t(ne.REQUEST_STICKIE,I=>{const O=te().getRoomObject(I.roomId,I.objectId,I.category);if(!O)return;const A=O.model.getValue(b.FURNITURE_ITEMDATA);if(A.length<6)return;let N=null,P=null;A.indexOf(" ")>0?(N=A.slice(0,A.indexOf(" ")),P=A.slice(A.indexOf(" ")+1,A.length)):N=A,e(I.objectId),r(I.category),n(N||"0"),l(P||""),h(O.type||"post_it"),g(bt().isRoomOwner||ie().isModerator||Dr(O))}),ki(s!==-1&&t!==-1,I=>{I.id!==s||I.category!==t||m()}),{objectId:s,color:i,text:o,type:c,canModify:u,updateColor:p,updateText:f,trash:T,onClose:m}},t8=e8,s8=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState("1"),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(""),[u,g]=d.exports.useState(""),m=()=>{e(-1),r(-1),n("1"),l(""),h(""),g("")};return _t(ne.REQUEST_TROPHY,p=>{const f=te().getRoomObject(p.roomId,p.objectId,p.category);if(!f)return;let T=f.model.getValue(b.FURNITURE_DATA);f.model.getValue(b.FURNITURE_EXTRAS),e(p.objectId),r(p.category),n(f.model.getValue(b.FURNITURE_COLOR)||"1");const I=T.substring(0,T.indexOf("	"));T=T.substring(I.length+1,T.length);const O=T.substring(0,T.indexOf("	")),A=T.substr(O.length+1,T.length);l(I),h(O),g(A)}),ki(s!==-1&&t!==-1,p=>{p.id!==s||p.category!==t||m()}),{objectId:s,color:i,senderName:o,date:c,message:u,onClose:m}},r8=s8;let sp=null;const i8=s=>{sp=s},n8=()=>{const[s,e]=d.exports.useState(null);return j(FE,r=>{const i=r.getParser();if(s&&s.furniAssignments.forEach(n=>{qt.hide(n.furniId)}),i.assignments.length===0){if(!s||s.variableName!==i.variableName)e(null);else if(s&&s.variableName===i.variableName){const n={variableName:i.variableName,furniAssignments:[],userAssignments:s.userAssignments};e(n)}}else{const n={variableName:i.variableName,furniAssignments:i.assignments,userAssignments:s&&s.variableName===i.variableName?s.userAssignments:[]};n.furniAssignments.forEach(o=>{qt.show(o.furniId)}),e(n)}}),j(IP,r=>{const i=r.getParser();if(s&&s.furniAssignments.length>0&&s.furniAssignments.forEach(n=>{qt.hide(n.furniId)}),i.assignments.length===0){if(!s||s.variableName!==i.variableName)e(null);else if(s&&s.variableName===i.variableName){const n={variableName:i.variableName,furniAssignments:s.furniAssignments,userAssignments:[]};e(n)}}else{const n={variableName:i.variableName,furniAssignments:s&&s.variableName===i.variableName?s.furniAssignments:[],userAssignments:i.assignments};e(n)}}),{activeHighlight:s,clearHighlights:()=>{s&&(s.furniAssignments.forEach(r=>{qt.hide(r.furniId)}),e(null)),sp&&sp()}}},y0=n8,a8=()=>{const[s,e]=d.exports.useState(new Map),t=()=>{e(new Map)};return d.exports.useEffect(()=>{i8(t)},[]),j(FE,r=>{const i=r.getParser(),n=new Map;i.assignments.forEach(o=>{n.set(o.virtualId,{variableName:i.variableName,value:o.value,label:o.label})}),e(n)}),{displayData:s,clearDisplayData:t}},o8=a8,l8=0,c8=1,u8=2,h8=3,d8=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(-1),[m,p]=d.exports.useState(null),[f,T]=d.exports.useState(null),[I,O]=d.exports.useState(!1),A=()=>{e(-1),r(-1),n(null),l(null),h(null),g(-1),p(null),T(null),O(!1)},N=()=>W(new cu(s,l8)),P=()=>W(new cu(s,c8)),y=()=>I&&i&&i.length&&W(new cu(s,u8)),D=()=>I&&i&&i.length&&W(new cu(s,h8)),x=w=>{if(m===w){p(null),W(new Cf(s,""));return}p(w),W(new Cf(s,w))};return _t(ne.REQUEST_YOUTUBE,w=>{if(Zn.isRoomPreviewerId(w.roomId))return;const k=te().getRoomObject(w.roomId,w.objectId,w.category);k&&(e(w.objectId),r(w.category),O(ie().hasSecurity(ii.EMPLOYEE)||Dr(k)),W(new pD(w.objectId)))}),j(QN,w=>{const k=w.getParser();s===-1||s!==k.furniId||(n(k.videoId),l(k.startAtSeconds),h(k.endAtSeconds),g(k.state))}),j(XN,w=>{const k=w.getParser();s===-1||s!==k.furniId||(T(k.playlists),p(k.selectedPlaylistId),n(null),g(-1),h(null),l(null))}),j(qN,w=>{const k=w.getParser();if(!(s===-1||s!==k.furniId))switch(k.commandId){case 1:g(tn.PLAYING);break;case 2:g(tn.PAUSED);break}}),ki(s!==-1&&t!==-1,w=>{w.id!==s||w.category!==t||A()}),{objectId:s,videoId:i,videoStart:o,videoEnd:c,currentVideoState:u,selectedVideo:m,playlists:f,onClose:A,previous:N,next:P,pause:y,play:D,selectVideo:x}},_8=d8,g8=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState([]),[u,g]=d.exports.useState(0),[m,p]=d.exports.useState(0),[f,T]=d.exports.useState(0),[I,O]=d.exports.useState(0),[A,N]=d.exports.useState(0),[P,y]=d.exports.useState(0),[D,x]=d.exports.useState(0),[w,k]=d.exports.useState(0),[F,L]=d.exports.useState(0),[B,V]=d.exports.useState(Se.STUFF_SELECTION_OPTION_NONE),[q,Z]=d.exports.useState(0),[H,X]=d.exports.useState(0),[ee,Oe]=d.exports.useState(!1),{showConfirm:de=null}=$t(),ve=()=>{const ce=ue=>{ue&&(ue instanceof Wp?W(new kD(ue.id,t,i,o,u,I,A,P,D,ue.stuffTypeSelectionCode,c)):ue instanceof Hp?W(new HD(ue.id,t,i,o,ue.stuffTypeSelectionCode)):ue instanceof Vp?W(new BD(ue.id,t,i,o,I,A,P,D,w,F)):ue instanceof Yp?W(new VD(ue.id,t,i,o,m,f,ue.stuffTypeSelectionCode)):ue instanceof jp&&W(new GD(ue.id,t,i,o,ue.stuffTypeSelectionCode)))};Iq(s.id)?ce(s):de(E("wiredfurni.nonowner.change.confirm.body"),()=>{ce(s)},null,null,null,E("wiredfurni.nonowner.change.confirm.title"))},Me=(ce,ue)=>{!s||!B||ce<=0||(q===0||q===1?(l($=>{const re=[...$],me=$.indexOf(ce);return me>=0?(re.splice(me,1),qt.clearSelectionShaderFromFurni([ce])):re.length<s.maximumItemSelectionCount&&(re.push(ce),H===1&&ee?qt.applySelectionShaderToFurniYellow([ce]):qt.applySelectionShaderToFurni([ce])),re}),h($=>{if(!$||$.length===0)return $;const re=$.indexOf(ce);if(re>=0){const me=[...$];return me.splice(re,1),qt.clearSelectionShaderFromFurniBlue([ce]),me}return $})):q===2&&(h($=>{const re=[...$],me=$.indexOf(ce);return me>=0?(re.splice(me,1),qt.clearSelectionShaderFromFurniBlue([ce])):re.length<s.maximumItemSelectionCount&&(re.push(ce),qt.applySelectionShaderToFurniBlue([ce])),re}),l($=>{if(!$||$.length===0)return $;const re=$.indexOf(ce);if(re>=0){const me=[...$];return me.splice(re,1),qt.clearSelectionShaderFromFurni([ce]),me}return $})))};return j(mb,ce=>{const ue=ce.getParser();W(new wD(ue.stuffId))}),j(fb,ce=>{ce.getParser(),e(null)}),j(_b,ce=>{const ue=ce.getParser();e(ue.definition)}),j(hb,ce=>{const ue=ce.getParser();e(ue.definition)}),j(ub,ce=>{const ue=ce.getParser();e(ue.definition)}),j(db,ce=>{const ue=ce.getParser();e(ue.definition)}),j(gb,ce=>{const ue=ce.getParser();e(ue.definition)}),d.exports.useEffect(()=>{if(s)return s&&qt.hideSelectedWired(s.id),()=>{s&&qt.hideSelectedWired(s.id),r([]),n(""),g(0),O(0),N(0),y(0),x(0),p(0),T(0),l(ce=>(ce&&ce.length&&qt.clearSelectionShaderFromFurni(ce),[])),h(ce=>(ce&&ce.length&&qt.clearSelectionShaderFromFurniBlue(ce),[])),V(Se.STUFF_SELECTION_OPTION_NONE),Z(0)}},[s]),{trigger:s,setTrigger:e,intParams:t,setIntParams:r,stringParam:i,setStringParam:n,furniIds:o,setFurniIds:l,destFurniIds:c,setDestFurniIds:h,actionDelay:u,setActionDelay:g,isFiltered:m,setIsFiltered:p,isInverted:f,setIsInverted:T,furniOptions:I,setFurniOptions:O,furniType:A,setFurniType:N,userOptions:P,setUserOptions:y,userType:D,setUserType:x,selectMode:q,setSelectMode:Z,setAllowsFurni:V,saveWired:ve,selectObjectForWired:Me,allOrOneOptions:w,setAllOrOneOptions:k,allOrOneType:F,setAllOrOneType:L,preferredSelectionColor:H,setPreferredSelectionColor:X,allowYellowSelection:ee,setAllowYellowSelection:Oe}},Ne=()=>vs(g8),m8=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState([]),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(-1),[m,p]=d.exports.useState(!1),{friends:f=[]}=Oi(),{selectObjectForWired:T=null}=Ne(),{roomSession:I=null}=Yt(),O=D=>{n(x=>{const w=[...x];return w.splice(D,1),w})},A=D=>{l(x=>{const w=[...x],k=w.splice(D,1)[0];return c===k&&h(null),w})},N=D=>{h(D),l([])},P=(D,x)=>{const w=Ll.getObjectName(D,x);w&&(r(w),x!==z.UNIT&&l([]))},y=(D,x)=>{let w=null;switch(x){case z.FLOOR:case z.WALL:w=Ll.getFurniInfo(D,x),w&&T(D,x);break;case z.UNIT:{const k=I.userDataManager.getUserDataByIndex(D);if(!k)break;switch(k.type){case jt.PET:I.userDataManager.requestPetInfo(k.webID),g(k.webID);break;case jt.USER:w=Ll.getUserInfo(x,k);break;case jt.BOT:w=Ll.getBotInfo(x,k);break;case jt.RENTABLE_BOT:w=Ll.getRentableBotInfo(x,k);break}}}w&&e(w)};return es(Np.USER_DATA_UPDATED,D=>{if(!D.addedUsers.length)return;let x=[];D.addedUsers.forEach(w=>{w.webID!==ie().userId&&f.find(k=>k.id===w.webID)&&x.push(new XL(w.roomIndex,z.UNIT,w.webID,w.name,w.type,!0))}),x.length&&n(w=>{const k=[...w];return x.forEach(F=>{const L=k.findIndex(B=>B.id===F.id);L>-1&&k.splice(L,1),k.push(F)}),k})}),es(Op.PET_INFO,D=>{const x=D.petInfo;if(!x||x.id!==u)return;const w=Ll.getPetInfo(x);w&&(e(w),g(-1))}),es(Cp.PET_STATUS_UPDATE,D=>{}),_t(pc.USE_PRODUCT_FROM_INVENTORY,D=>{}),_t(pc.USE_PRODUCT_FROM_ROOM,D=>{const x=te().getRoomObject(I.roomId,D.objectId,z.FLOOR);if(!x||!Dr(x))return;const w=x.model.getValue(b.FURNITURE_OWNER_ID),k=x.model.getValue(b.FURNITURE_TYPE_ID),F=ie().getFloorItemData(k),L=F.customParams.split(" "),B=L.length?parseInt(L[0]):-1;if(B===-1)return;const V=[],q=te().getRoomObjects(I.roomId,z.UNIT);for(const Z of q){const H=I.userDataManager.getUserDataByIndex(Z.id);let X=!1;if(!(!H||H.type!==jt.PET)){if(H.ownerId===w){H.hasSaddle&&F.specialType===Pe.PET_SADDLE&&(X=!0);const ee=H.figure.split(" ");if((ee.length?parseInt(ee[0]):-1)===B){if(F.specialType===Pe.MONSTERPLANT_REVIVAL&&!H.canRevive||F.specialType===Pe.MONSTERPLANT_REBREED&&(H.petLevel<7||H.canRevive||H.canBreed)||F.specialType===Pe.MONSTERPLANT_FERTILIZE&&(H.petLevel>=7||H.canRevive))continue;V.push(new dX(H.roomIndex,z.UNIT,H.name,D.objectId,Z.id,-1,X))}}}}h(null),V.length&&l(V)}),_t(ye.REQUEST_MANIPULATION,D=>{Wu(I,D.objectId,D.category)&&p(!0)}),DI(D=>{y(D.id,D.category)}),u7(D=>{e(null),l([])}),_7(D=>{s||D.category!==z.UNIT||P(D.id,D.category)}),d7(D=>{!t||D.category!==z.UNIT||t.roomIndex!==D.id||r(null)}),Cs([Ct.FURNI_REMOVED,Ct.USER_REMOVED],D=>{if(t&&t.category===D.category&&t.roomIndex===D.id&&r(null),D.category===z.UNIT){let x=i.findIndex(w=>w.roomIndex===D.id);x>-1&&n(w=>w.filter(k=>k.roomIndex===D.id)),x=o.findIndex(w=>w.id===D.id),x>-1&&l(w=>w.filter(k=>k.id!==D.id))}else D.category===z.FLOOR&&o.findIndex(w=>w.id===D.id)>-1&&l(w=>w.filter(k=>k.requestRoomObjectId!==D.id));s&&(s instanceof vc?s.id===D.id&&e(null):(s instanceof fs||s instanceof Dc||s instanceof Mc)&&s.roomIndex===D.id&&e(null))}),d.exports.useEffect(()=>{s&&(r(null),n([]),l([]))},[s]),d.exports.useEffect(()=>{t&&n([])},[t]),d.exports.useEffect(()=>{I.isDecorating=m},[I,m]),{avatarInfo:s,setAvatarInfo:e,activeNameBubble:t,setActiveNameBubble:r,nameBubbles:i,productBubbles:o,confirmingProduct:c,isDecorating:m,setIsDecorating:p,removeNameBubble:O,removeProductBubble:A,updateConfirmingProduct:N,getObjectName:P}},f8=m8,p8=()=>{const[s,e]=d.exports.useState(""),[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(!1),[u,g]=d.exports.useState(0),{showNitroAlert:m=null,showConfirm:p=null}=$t(),{roomSession:f=null}=Yt(),T=(I,O,A="",N=0)=>{if(I==="")return null;const P=I.split(" ");if(P.length>0){const y=P[0];let D="";if(P.length>1&&(D=P[1]),y.charAt(0)===":"&&D==="x"){const x=te().selectedAvatarId;if(x>-1){const w=f.userDataManager.getUserDataByIndex(x);w&&(D=w.name,I=I.replace(" x"," "+w.name))}}switch(y.toLowerCase()){case":shake":return xi.init(2500,5e3),xi.turnVisualizationOn(),null;case":rotate":return Ui.init(2500,5e3),Ui.turnVisualizationOn(),null;case":d":case";d":Li()===Lr.VIP&&f.sendExpressionMessage(Tr.LAUGH.ordinal);break;case"o/":case"_o/":return f.sendExpressionMessage(Tr.WAVE.ordinal),null;case":kiss":if(Li()===Lr.VIP)return f.sendExpressionMessage(Tr.BLOW.ordinal),null;break;case":jump":if(Li()===Lr.VIP)return f.sendExpressionMessage(Tr.JUMP.ordinal),null;break;case":idle":return f.sendExpressionMessage(Tr.IDLE.ordinal),null;case"_b":return f.sendExpressionMessage(Tr.RESPECT.ordinal),null;case":sign":return f.sendSignMessage(parseInt(D)),null;case":iddqd":case":flip":return te().events.dispatchEvent(new Ld(f.roomId,-1,!0)),null;case":zoom":return te().events.dispatchEvent(new Ld(f.roomId,parseFloat(D),!1)),null;case":screenshot":const x=te().createTextureFromRoom(f.roomId,1),w=new Image;return w.src=Lt.generateImageUrl(x),window.open("").document.write(w.outerHTML),null;case":pickall":return(f.isRoomOwner||ie().isModerator)&&p(E("room.confirm.pick_all"),()=>{ie().sendSpecialCommandMessage(":pickall")},null,null,null,E("generic.alert.title")),null;case":ejectall":return(f.isRoomOwner||ie().isModerator||f.controllerLevel>=Rt.GUEST)&&p(E("room.confirm.eject_all"),()=>{ie().sendSpecialCommandMessage(":ejectall")},null,null,null,E("generic.alert.title")),null;case":furni":return Le("furni-chooser/"),null;case":chooser":return Le("user-chooser/"),null;case":floor":case":bcfloor":return f.controllerLevel>=Rt.ROOM_OWNER&&Le("floor-editor/show"),null;case":togglefps":return Rr().maxFPS>0?Rr().maxFPS=0:Rr().maxFPS=Ee("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return m(),null;case":settings":return(f.isRoomOwner||ie().isModerator)&&W(new AE(f.roomId)),null}}switch(O){case Cn.CHAT_DEFAULT:f.sendChatMessage(I,N);break;case Cn.CHAT_SHOUT:f.sendShoutMessage(I,N);break;case Cn.CHAT_WHISPER:f.sendWhisperMessage(A,I,N);break}};return es(at.FLOOD_EVENT,I=>{h(!0),g(parseFloat(I.message))}),DI(I=>{if(I.category!==z.UNIT)return;const O=f.userDataManager.getUserDataByIndex(I.id);O&&e(O.name)}),_t(ye.DESELECTED,I=>e("")),d.exports.useEffect(()=>{if(!c)return;let I=0;const O=setInterval(()=>{g(A=>(I=(A||0)-1,I)),I<0&&(clearInterval(O),h(!1))},1e3);return()=>clearInterval(O)},[c]),d.exports.useEffect(()=>{if(!o)return;let I=null;return o&&(I=setTimeout(()=>{l(!1),r(!1)},1e4)),()=>clearTimeout(I)},[o]),d.exports.useEffect(()=>{t?i||(n(!0),f.sendChatTypingMessage(t)):i&&(n(!1),f.sendChatTypingMessage(t))},[f,t,i]),{selectedUsername:s,floodBlocked:c,floodBlockedSeconds:u,setIsTyping:r,setIsIdle:l,sendChat:T}},E8=p8,wT=new Map,FT=new Map,kT=new Map,I8=()=>{const[s,e]=d.exports.useState([]),[t,r]=d.exports.useState({mode:xt.CHAT_MODE_FREE_FLOW,weight:xt.CHAT_BUBBLE_WIDTH_NORMAL,speed:xt.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:xt.FLOOD_FILTER_NORMAL}),{roomSession:i=null}=Yt(),{addChatEntry:n}=Eg(),o=d.exports.useRef(!1),l=d.exports.useMemo(()=>{if(!t)return 6e3;switch(t.speed){case xt.CHAT_SCROLL_SPEED_FAST:return 3e3;case xt.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case xt.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[t]),c=g=>{const m=Ks().createAvatarImage(g,yi.LARGE,null,{resetFigure:T=>{o.current||c(T)},dispose:()=>{},disposed:!1});if(!m)return;const p=m.getCroppedImage(lr.HEAD),f=m.getPartColor(We.CHEST);return wT.set(g,f&&f.rgb||16777215),m.dispose(),FT.set(g,p.src),p.src},h=g=>{let m=FT.get(g);return m||(m=c(g)),m},u=(g,m,p,f=64,T=null)=>{let I=kT.get(g+T);if(I)return I;const O=new ra(g),A=O.typeId,N=te().getRoomObjectPetImage(A,O.paletteId,O.color,new G(m*45),f,null,!1,0,O.customParts,T);return N&&(I=Lt.generateImageUrl(N.data),kT.set(g+T,I)),I};return es(at.CHAT_EVENT,g=>{const m=te().getRoomObject(i.roomId,g.objectId,z.UNIT),p=m?PL(i.roomId,m==null?void 0:m.id,z.UNIT):new vr,f=m?i.userDataManager.getUserDataByIndex(g.objectId):new TL(-1);let T="",I=0,O=null,A=g.chatType,N=g.style,P=0,y=g.message;if(f){P=f.type;const k=f.figure;switch(P){case jt.PET:O=u(k,2,!0,64,m.model.getValue(b.FIGURE_POSTURE)),new ra(k).typeId;break;case jt.USER:O=h(k);break;case jt.RENTABLE_BOT:case jt.BOT:N=Ca.BOT;break}I=wT.get(k),T=f.name}switch(A){case at.CHAT_TYPE_RESPECT:y=E("widgets.chatbubble.respect",["username"],[T]),Ee("respect.options").enabled&&na(Ee("respect.options").sound);break;case at.CHAT_TYPE_PETREVIVE:case at.CHAT_TYPE_PET_REBREED_FERTILIZE:case at.CHAT_TYPE_PET_SPEED_FERTILIZE:{let k="widget.chatbubble.petrevived";A===at.CHAT_TYPE_PET_REBREED_FERTILIZE?k="widget.chatbubble.petrefertilized;":A===at.CHAT_TYPE_PET_SPEED_FERTILIZE&&(k="widget.chatbubble.petspeedfertilized");let F=null;if(te().getRoomObject(i.roomId,g.extraParam,z.UNIT)){const B=i.userDataManager.getUserDataByIndex(m.id);B&&(F=B.name)}y=E(k,["petName","userName"],[T,F]);break}case at.CHAT_TYPE_PETRESPECT:y=E("widget.chatbubble.petrespect",["petname"],[T]);break;case at.CHAT_TYPE_PETTREAT:y=E("widget.chatbubble.pettreat",["petname"],[T]);break;case at.CHAT_TYPE_HAND_ITEM_RECEIVED:y=E("widget.chatbubble.handitem",["username","handitem"],[T,E("handitem"+g.extraParam)]);break;case at.CHAT_TYPE_MUTE_REMAINING:{const k=(g.extraParam>0?Math.floor(g.extraParam/3600):0).toString(),F=(g.extraParam>0?Math.floor(g.extraParam%3600/60):0).toString(),L=(g.extraParam%60).toString();y=E("widget.chatbubble.mutetime",["hours","minutes","seconds"],[k,F,L]);break}}const D=Fq(y),x=I&&("#"+I.toString(16).padStart(6,"0")||null),w=new JL(f.roomIndex,z.UNIT,i.roomId,y,D,T,new vr(p.x,p.y),A,N,O,x);e(k=>[...k,w]),n({id:-1,webId:f.webID,entityId:f.roomIndex,name:T,imageUrl:O,style:N,chatType:A,entityType:f.type,message:D,timestamp:BL(),type:rn.TYPE_CHAT,roomId:i.roomId,color:x})}),_t(Ep.ROOM_DRAG,g=>{if(!s.length||g.roomId!==i.roomId)return;const m=g.offsetX;s.forEach(p=>p.elementRef&&(p.left+=m))}),j(wa,g=>{const m=g.getParser();m.roomEnter&&r(m.chat)}),j(wN,g=>{const m=g.getParser();r(m.chat)}),d.exports.useEffect(()=>(o.current=!1,()=>{o.current=!0}),[]),{chatMessages:s,setChatMessages:e,chatSettings:t,getScrollSpeed:l}},T8=I8,R8=()=>{const[s,e]=d.exports.useState([]),t=n=>{s.indexOf(n)>=0||e([...s,n])},r=n=>{const o=s.indexOf(n);if(o===-1)return;const l=[...s];l.splice(o,1),e(l)},i=(n,o)=>{bt().sendDoorbellApprovalMessage(n,o),r(n)};return es(en.DOORBELL,n=>t(n.userName)),es(en.RSDE_REJECTED,n=>r(n.userName)),es(en.RSDE_ACCEPTED,n=>r(n.userName)),{users:s,addUser:t,removeUser:r,answer:i}},S8=R8,O8=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(!1),i=()=>r(!1);return j(rN,n=>{const o=n.getParser();r(!0),e(o.words)}),{wordsFilter:s,isVisible:t,setWordsFilter:e,onClose:i}},C8=O8,A8=()=>{const[s,e]=d.exports.useState([]),{requests:t=[],dismissedRequestIds:r=[],setDismissedRequestIds:i=null}=Oi(),n=d.exports.useMemo(()=>s.filter(l=>r.indexOf(l.request.requesterUserId)===-1),[s,r]),o=l=>{i(c=>{if(c.indexOf(l)>=0)return c;const h=[...c];return h.push(l),h})};return C0(!0,l=>{if(l.category!==z.UNIT)return;const c=bt().userDataManager.getUserDataByIndex(l.id);if(!c||c.type!==gt.getTypeNumber(gt.USER))return;const h=t.find(g=>g.requesterUserId===c.webID);if(!h||s.find(g=>g.request.requesterUserId===c.webID))return;const u=[...s];u.push({roomIndex:c.roomIndex,request:h}),e(u)}),A0(!0,l=>{if(l.category!==z.UNIT)return;const c=s.findIndex(u=>u.roomIndex===l.id);if(c===-1)return;const h=[...s];h.splice(c,1),e(h)}),d.exports.useEffect(()=>{const l=[];for(const c of t){const h=bt().userDataManager.getUserData(c.requesterUserId);h&&l.push({roomIndex:h.roomIndex,request:c})}e(l)},[t]),{displayedRequests:n,hideFriendRequest:o}},N8=A8,b8=()=>{const[s,e]=d.exports.useState(null),{roomSession:t=null}=Yt(),r=()=>e(null),i=o=>o&&te().selectRoomObject(bt().roomId,o.id,o.category),n=()=>{const o=ie(),l=te().getRoomObjects(t.roomId,z.WALL),c=te().getRoomObjects(t.roomId,z.FLOOR),h=l.map(g=>{if(g.id<0)return null;let m=g.type;if(m.startsWith("poster"))m=E(`poster_${m.replace("poster","")}_name`);else{const p=g.model.getValue(b.FURNITURE_TYPE_ID),f=o.getWallItemData(p);f&&f.name.length&&(m=f.name)}return new uc(g.id,z.WALL,m)}),u=c.map(g=>{if(g.id<0)return null;let m=g.type;const p=g.model.getValue(b.FURNITURE_TYPE_ID),f=o.getFloorItemData(p);return f&&f.name.length&&(m=f.name),new uc(g.id,z.FLOOR,m)});e([...h,...u].sort((g,m)=>g.name<m.name?-1:1))};return c7(!!s,o=>{if(o.id<0)return;const l=te().getRoomObject(bt().roomId,o.id,o.category);if(!l)return;let c=null;switch(o.category){case z.WALL:{let h=l.type;if(h.startsWith("poster"))h=E(`poster_${h.replace("poster","")}_name`);else{const u=l.model.getValue(b.FURNITURE_TYPE_ID),g=ie().getWallItemData(u);g&&g.name.length&&(h=g.name)}c=new uc(l.id,z.WALL,h);break}case z.FLOOR:{let h=l.type;const u=l.model.getValue(b.FURNITURE_TYPE_ID),g=ie().getFloorItemData(u);g&&g.name.length&&(h=g.name),c=new uc(l.id,z.FLOOR,h)}}e(h=>[...h,c].sort((u,g)=>u.name<g.name?-1:1))}),ki(!!s,o=>{o.id<0||e(l=>{const c=[...l];for(let h=0;h<c.length;h++){const u=c[h];if(!(u.id!==o.id||u.category!==o.category)){c.splice(h,1);break}}return c})}),{items:s,onClose:r,selectItem:i,populateChooser:n}},y8=b8,v8=()=>{const[s,e]=d.exports.useState(!1),[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(""),u=()=>{h(""),l(""),n(""),r(-1),e(!1)},g=()=>{W(new yE(t,o))},m=f=>{l(f),c.length>0&&h("")},p=f=>{if(!(!f||f===0))switch(f){case 1:return E("catalog.alert.petname.long");case 2:return E("catalog.alert.petname.short");case 3:return E("catalog.alert.petname.chars");case 4:default:return E("catalog.alert.petname.bobba")}};return es(ho.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,f=>{if(!f)return;const T=te().getRoomObject(f.session.roomId,f.objectId,z.FLOOR);r(f.objectId),n(T.type),e(!0)}),es(ho.RSOPPE_OPEN_PET_PACKAGE_RESULT,f=>{f&&(f.nameValidationStatus===0&&u(),f.nameValidationStatus!==0&&h(p(f.nameValidationStatus)))}),{isVisible:s,errorResult:c,petName:o,objectType:i,onChangePetName:m,onConfirm:g,onClose:u}},M8=v8,D8=()=>{const{roomSession:s=null}=Yt(),e=i=>s.sendPollStartMessage(i),t=i=>s.sendPollRejectMessage(i),r=(i,n,o)=>s.sendPollAnswerMessage(i,n,o);return es(qi.OFFER,i=>{const n=new Sa(Sa.OFFER,i.id);n.summary=i.summary,n.headline=i.headline,zs(n)}),es(qi.ERROR,i=>{const n=new Sa(Sa.ERROR,i.id);n.summary=i.summary,n.headline=i.headline,zs(n)}),es(qi.CONTENT,i=>{const n=new Sa(Sa.CONTENT,i.id);n.startMessage=i.startMessage,n.endMessage=i.endMessage,n.numQuestions=i.numQuestions,n.questionArray=i.questionArray,n.npsPoll=i.npsPoll,zs(n)}),{startPoll:e,rejectPoll:t,answerPoll:r}},P8=D8,L8=()=>{const[s,e]=d.exports.useState(null);Yt();const t=()=>e(null),r=n=>n&&te().selectRoomObject(bt().roomId,n.id,n.category),i=()=>{const n=bt(),o=te().getRoomObjects(n.roomId,z.UNIT);e(o.map(l=>{if(l.id<0)return null;const c=n.userDataManager.getUserDataByIndex(l.id);return c?new uc(c.roomIndex,z.UNIT,c.name):null}).sort((l,c)=>l.name<c.name?-1:1))};return C0(!!s,n=>{if(n.id<0)return;const o=bt().userDataManager.getUserDataByIndex(n.id);o&&e(l=>{const c=[...l];return c.push(new uc(o.roomIndex,z.UNIT,o.name)),c.sort((h,u)=>h.name<u.name?-1:1),c})}),A0(!!s,n=>{n.id<0||e(o=>{const l=[...o];for(let c=0;c<l.length;c++){const h=l[c];if(!(h.id!==n.id||h.category!==n.category)){l.splice(c,1);break}}return l})}),{items:s,onClose:t,selectItem:r,populateChooser:i}},U8=L8,GT=4e3,x8=3,w8=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(new Map),[u,g]=d.exports.useState(new Map),{answerPoll:m=null}=P8(),{roomSession:p=null}=Yt(),f=()=>{e(-1),r(null)},T=I=>{i||!t||(m(s,t.id,[I]),n(!0))};return es(Xi.ANSWERED,I=>{const O=p.userDataManager.getUserData(I.userId);O&&(h(I.answerCounts),g(A=>{if(!A.has(O.roomIndex)){const N=new Map(u);return N.set(O.roomIndex,{value:I.value,secondsLeft:x8}),N}return A}),te().updateRoomObjectUserGesture(p.roomId,O.roomIndex,he.getGestureId(I.value==="0"?he.GESTURE_SAD:he.GESTURE_SMILE)))}),es(Xi.FINISHED,I=>{t&&t.id===I.questionId&&(h(I.answerCounts),n(!0),l(O=>(O&&clearTimeout(O),setTimeout(()=>f(),GT)))),g(new Map)}),es(Xi.QUESTION,I=>{e(I.id),r(I.question),n(!1),h(new Map),g(new Map),l(O=>{if(O&&clearTimeout(O),I.duration>0){const A=I.duration<1e3?GT:I.duration;return setTimeout(()=>f(),A)}return null})}),d.exports.useEffect(()=>{const I=()=>{g(A=>{const N=[];if(A.forEach((y,D)=>{y.secondsLeft--,y.secondsLeft<=0&&N.push(D)}),N.length===0)return A;const P=new Map(A);return N.forEach(y=>P.delete(y)),P})},O=setInterval(()=>I(),1e3);return()=>clearInterval(O)},[]),d.exports.useEffect(()=>()=>{l(I=>(I&&clearTimeout(I),null))},[]),{question:t,answerSent:i,answerCounts:c,userAnswers:u,vote:T}},F8=w8,k8=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(0),[c,h]=d.exports.useState(0),[u,g]=pg("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),m=T=>{n(T),W(new CD(T))},p=T=>{ie().giveRespect(T),l(ie().respectsLeft)},f=T=>{ie().givePetRespect(T),h(ie().respectsPetLeft)};return j(Tc,T=>{const I=T.getParser();e(I.userInfo),r(I.userInfo.figure),l(I.userInfo.respectsRemaining),h(I.userInfo.respectsPetRemaining)}),j(zp,T=>{const I=T.getParser();r(I.figure)}),j(gE,T=>{const I=T.getParser();n(I.chatType)}),d.exports.useEffect(()=>{const T=mI("nitro.screensize");if(T&&(T.width!==window.innerWidth||T.height!==window.innerHeight)){let O=window.localStorage.length;for(;O>0;){const A=window.localStorage.key(O);A&&A.startsWith("nitro.window")&&window.localStorage.removeItem(A),O--}}const I=O=>g({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",I),()=>{window.removeEventListener("resize",I)}},[g]),{userInfo:s,userFigure:t,chatStyleId:i,userRespectRemaining:o,petRespectRemaining:c,respectUser:p,respectPet:f,updateChatStyleId:m}},za=()=>vs(k8),G8=s=>d.exports.useEffect(s,[]),v0=s=>G8(()=>s()),M0=s=>{const{achievement:e=null,scale:t=1,...r}=s;return e?a(as,{badgeCode:mi.getAchievementBadgeCode(e),isGrayscale:!mi.getAchievementHasStarted(e),scale:t,...r}):null},B8=s=>{const{achievement:e=null}=s,{selectedAchievement:t=null,setSelectedAchievementId:r=null}=fg();return e?a(yt,{itemActive:t===e,itemUnseen:e.unseen>0,onClick:i=>r(e.achievementId),children:a(M0,{achievement:e})}):null},V8=s=>{const{achievements:e=null}=s;return a(Bt,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:e&&e.length>0&&e.map((t,r)=>a(B8,{achievement:t},r))})},H8=s=>{const{achievement:e=null}=s;return e?_(M,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[_(v,{center:!0,gap:1,children:[a(M0,{className:"nitro-achievements-badge-image",achievement:e,scale:2}),a(C,{fontWeight:"bold",children:E("achievements.details.level",["level","limit"],[mi.getAchievementLevel(e).toString(),e.levelCount.toString()])})]}),_(v,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[_(v,{gap:1,children:[a(C,{fontWeight:"bold",truncate:!0,children:Th(mi.getAchievementBadgeCode(e))}),a(C,{textBreak:!0,children:fI(mi.getAchievementBadgeCode(e))})]}),(e.levelRewardPoints>0||e.scoreLimit>0)&&_(v,{gap:1,children:[e.levelRewardPoints>0&&_(M,{alignItems:"center",gap:1,children:[a(C,{truncate:!0,className:"small",children:E("achievements.details.reward")}),_(M,{center:!0,className:"fw-bold small",gap:1,children:[e.levelRewardPoints,a(Gs,{type:e.levelRewardPointType})]})]}),e.scoreLimit>0&&a(l0,{text:E("achievements.details.progress",["progress","limit"],[(e.currentPoints+e.scoreAtStartOfLevel).toString(),(e.scoreLimit+e.scoreAtStartOfLevel).toString()]),progress:e.currentPoints+e.scoreAtStartOfLevel,maxProgress:e.scoreLimit+e.scoreAtStartOfLevel})]})]})]}):null},W8=s=>{const{category:e=null}=s,{selectedAchievement:t=null,setSelectedAchievementId:r=null}=fg();return d.exports.useEffect(()=>{var i,n;e&&(t||r((n=(i=e==null?void 0:e.achievements)==null?void 0:i[0])==null?void 0:n.achievementId))},[e,t,r]),e?_(v,{fullHeight:!0,justifyContent:"between",children:[a(V8,{achievements:e.achievements}),!!t&&a(H8,{achievement:t})]}):null},j8=s=>{const{category:e=null,selectedCategoryCode:t=null,setSelectedCategoryCode:r=null}=s;if(!e)return null;const i=mi.getAchievementCategoryProgress(e),n=mi.getAchievementCategoryMaxProgress(e),o=mi.getAchievementCategoryImageUrl(e,i),l=mi.getAchievementCategoryTotalUnseen(e);return _(yt,{itemActive:t===e.code,itemCount:l,itemCountMinimum:0,gap:1,onClick:c=>r(e.code),children:[a(C,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:E(`quests.${e.code}.name`)}),a(n0,{position:"relative",imageUrl:o,children:_(C,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[i," / ",n]})})]})},Y8=s=>{const{categories:e=null,selectedCategoryCode:t=null,setSelectedCategoryCode:r=null}=s;return a(Bt,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:e&&e.length>0&&e.map((i,n)=>a(j8,{category:i,selectedCategoryCode:t,setSelectedCategoryCode:r},n))})},z8=s=>{const[e,t]=d.exports.useState(!1),{achievementCategories:r=[],selectedCategoryCode:i=null,setSelectedCategoryCode:n=null,achievementScore:o=0,getProgress:l=0,getMaxProgress:c=0,selectedCategory:h=null}=fg();return d.exports.useEffect(()=>{const u={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(p=>!p);return}},eventUrlPrefix:"achievements/"};return xs(u),()=>ws(u)},[]),e?_(Be,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary",children:[a(He,{headerText:E("inventory.achievements"),onCloseClick:u=>t(!1)}),h&&_(i0,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[a(K,{onClick:u=>n(null),className:"nitro-achievements-back-arrow"}),_(v,{grow:!0,gap:0,children:[a(C,{fontSize:4,fontWeight:"bold",className:"text-small",children:E(`quests.${h.code}.name`)}),a(C,{children:E("achievements.details.categoryprogress",["progress","limit"],[h.getProgress().toString(),h.getMaxProgress().toString()])})]}),a(ja,{imageUrl:mi.getAchievementCategoryImageUrl(h,null,!0)})]}),_(Ge,{gap:1,children:[!h&&_(J,{children:[a(Y8,{categories:r,selectedCategoryCode:i,setSelectedCategoryCode:n}),_(v,{grow:!0,justifyContent:"end",gap:1,children:[a(C,{small:!0,center:!0,children:E("achievements.categories.score",["score"],[o.toString()])}),a(l0,{text:E("achievements.categories.totalprogress",["progress","limit"],[l.toString(),c.toString()]),progress:l,maxProgress:c})]})]}),h&&a(W8,{category:h})]})]}):null},K8=s=>{const{figureData:e=null}=s,[t,r]=d.exports.useState(-1),i=n=>{n<_i.MIN_DIRECTION&&(n=_i.MAX_DIRECTION+(n+1)),n>_i.MAX_DIRECTION&&(n=n-(_i.MAX_DIRECTION+1)),e.direction=n};return d.exports.useEffect(()=>{if(e)return e.notify=()=>r(n=>n+1),()=>{e.notify=null}},[e]),_(v,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[a(Ts,{figure:e.getFigureString(),direction:e.direction,scale:2}),a(K,{className:"avatar-shadow"}),a(K,{className:"arrow-container",children:a("i",{className:"icon arrow-left",onClick:n=>i(e.direction+1)})})]})},yu=s=>{const{icon:e=null,selected:t=!1,classNames:r=[],children:i=null,...n}=s,o=d.exports.useMemo(()=>{const l=["nitro-avatar-editor-spritesheet"];return e&&e.length&&l.push(e+"-icon"),t&&l.push("selected"),r.length&&l.push(...r),l},[e,t,r]);return a(K,{classNames:o,...n})},q8=s=>{const{partItem:e=null,children:t=null,...r}=s,[i,n]=d.exports.useState(-1),o=Ee("hc.disabled",!1);return d.exports.useEffect(()=>{const l=()=>n(c=>c+1);return e.notify=l,()=>e.notify=null},[e]),_(yt,{itemImage:e.isClear?void 0:e.imageUrl,itemActive:e.isSelected,...r,children:[!o&&e.isHC&&a("i",{className:"icon hc-icon position-absolute"}),e.isClear&&a(yu,{icon:"clear"}),e.isSellable&&a(yu,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"}),t]})},X8=s=>{const{model:e=null,category:t=null,setMaxPaletteCount:r=null}=s,i=d.exports.useRef(null),n=d.exports.useCallback(o=>{const l=t.parts.indexOf(o);if(l===-1)return;e.selectPart(t.name,l);const c=t.getCurrentPart();r(c.maxColorIndex||1)},[e,t,r]);return d.exports.useEffect(()=>{!e||!t||!i||!i.current||(i.current.scrollTop=0)},[e,t]),a(Bt,{innerRef:i,columnCount:3,columnMinHeight:50,children:t.parts.length>0&&t.parts.map((o,l)=>a(q8,{partItem:o,onClick:c=>n(o)},l))})},Q8=s=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:r=!1,itemCount:i=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:h=!1,disabled:u=!1,center:g=!0,column:m=!0,style:p={},classNames:f=[],position:T="relative",overflow:I="hidden",children:O=null,...A}=s,N=d.exports.useMemo(()=>{const y=["layout-grid-item","color-picker-frame"];return r&&y.push("active"),(o||l>0)&&y.push("unique-item"),o&&y.push("sold-out"),c&&y.push("unseen"),h&&y.push("has-highlight"),u&&y.push("disabled"),e===null&&y.push("icon","loading-icon"),f.length&&y.push(...f),y},[r,o,l,c,h,u,e,f]),P=d.exports.useMemo(()=>{let y={...p};return e&&(y.backgroundImage=`url(${e})`),t&&(y.backgroundColor=t),Object.keys(p).length&&(y={...y,...p}),y},[p,e,t]);return _(v,{center:g,pointer:!0,position:T,overflow:I,column:m,classNames:N,style:P,...A,children:[i>n&&a(nn,{count:i}),l>0&&_(J,{children:[a(K,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),a("div",{className:"position-absolute bottom-0 unique-item-counter",children:a(ka,{value:l})})]}),O]})},$8=s=>{const{colorItem:e=null,children:t=null,...r}=s,[i,n]=d.exports.useState(-1),o=Ee("hc.disabled",!1);return d.exports.useEffect(()=>{const l=()=>n(c=>c+1);return e.notify=l,()=>e.notify=null},[e]),_(Q8,{itemHighlight:!0,itemColor:e.color,itemActive:e.isSelected,className:"color-picker-frame clear-bg",...r,children:[!o&&e.isHC&&a("i",{className:"icon hc-icon position-absolute"}),t]})},BT=s=>{const{model:e=null,category:t=null,paletteSet:r=[],paletteIndex:i=-1}=s,n=d.exports.useRef(null),o=d.exports.useCallback(l=>{const c=r.indexOf(l);c!==-1&&e.selectColor(t.name,c,i)},[e,t,r,i]);return d.exports.useEffect(()=>{!e||!t||!n||!n.current||(n.current.scrollTop=0)},[e,t]),a(Bt,{className:"py-1",innerRef:n,gap:1,columnCount:5,columnMinWidth:13,children:r.length>0&&r.map((l,c)=>a($8,{colorItem:l,onClick:h=>o(l)},c))})},J8=s=>{const{model:e=null,gender:t=null,setGender:r=null}=s,[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(1),c=d.exports.useCallback(h=>{const u=e.categories.get(h);if(u){u.init(),n(u);for(const g of u.parts)if(!(!g||!g.isSelected)){l(g.maxColorIndex||1);break}}},[e]);return d.exports.useEffect(()=>{e.init();for(const h of e.categories.keys()){c(h);break}},[e,c]),!e||!i?null:a(qe,{children:_(v,{className:"choose-clothing overflow-auto",children:[_(M,{justifyContent:"center",gap:4,children:[e.canSetGender&&_(J,{children:[_(M,{center:!0,pointer:!0,className:"category-item",gap:3,onClick:h=>r(Je.MALE),children:[a(yu,{icon:"male",selected:t===Je.MALE}),a(C,{bold:!0,children:E("avatareditor.generic.boy")})]}),_(M,{center:!0,pointer:!0,className:"category-item",gap:3,onClick:h=>r(Je.FEMALE),children:[a(yu,{icon:"female",selected:t===Je.FEMALE}),a(C,{bold:!0,children:E("avatareditor.generic.girl")})]})]}),!e.canSetGender&&e.categories&&e.categories.size>0&&Array.from(e.categories.keys()).map(h=>{const u=e.categories.get(h);return a(M,{center:!0,pointer:!0,className:"category-item",onClick:g=>c(h),children:a(yu,{icon:u.name,selected:i===u})},h)})]}),a(v,{className:"h-50",size:5,overflow:"hidden",children:a(X8,{model:e,category:i,setMaxPaletteCount:l})}),_(v,{size:5,overflow:"hidden",className:"h-50",children:[o>=1&&a(BT,{model:e,category:i,paletteSet:i.getPalette(0),paletteIndex:0}),o===2&&a(BT,{model:e,category:i,paletteSet:i.getPalette(1),paletteIndex:1})]})]})})},Z8=s=>{const{figureData:e=null,savedFigures:t=[],setSavedFigures:r=null,loadAvatarInEditor:i=null}=s,n=Ee("hc.disabled",!1),o=d.exports.useCallback(h=>{if(h>=t.length||h<0)return;const[u,g]=t[h];i(u.getFigureString(),g)},[t,i]),l=d.exports.useCallback(h=>{if(!e||h>=t.length||h<0)return;const u=[...t],g=e.getFigureString(),m=e.gender;u[h]=[Ks().createFigureContainer(g),m],r(u),W(new $b(h+1,g,m))},[e,t,r]),c=d.exports.useMemo(()=>{if(!t||!t.length)return[];const h=[];return t.forEach(([u,g],m)=>{let p=0;u&&(p=Ks().getFigureClubLevel(u,g)),h.push(_(yt,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[u&&a(Ts,{figure:u.getFigureString(),gender:g,direction:2}),a(K,{className:"avatar-shadow"}),!n&&p>0&&a(Gs,{className:"position-absolute top-1 start-1",type:"hc"}),_(M,{gap:1,className:"button-container",children:[a(Y,{fullWidth:!0,onClick:f=>l(m),children:E("avatareditor.wardrobe.save")}),u&&a(Y,{fullWidth:!0,onClick:f=>o(m),disabled:p>Li(),children:E("generic_usable.button.use")})]})]},m))}),h},[t,n,l,o]);return a(Bt,{columnCount:5,columnMinWidth:80,columnMinHeight:140,children:c})},e9="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",t9="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",s9=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(null),[g,m]=d.exports.useState([]),[p,f]=d.exports.useState([]),[T,I]=d.exports.useState([]),[O,A]=d.exports.useState(!1),[N,P]=d.exports.useState(null),[y,D]=d.exports.useState(null),[x,w]=d.exports.useState(!0),[k,F]=d.exports.useState(!1),L=d.exports.useMemo(()=>Ee("avatar.wardrobe.max.slots",10),[]);j(aA,ee=>{const Oe=ee.getParser();m(Oe.figureSetIds),f(Oe.boundsFurnitureNames)}),j(zb,ee=>{const Oe=ee.getParser(),de=[];let ve=0;for(;ve<L;)de.push([null,null]),ve++;for(let[Me,[ce,ue]]of Oe.looks.entries()){const $=Ks().createFigureContainer(ce);de[Me-1]=[$,ue]}I(de)});const B=d.exports.useCallback(ee=>{l&&u(l.get(ee))},[l]),V=d.exports.useCallback(()=>{const ee=new Map;ee.set(Br.GENERIC,new Aq),ee.set(Br.HEAD,new Wq),ee.set(Br.TORSO,new Yq),ee.set(Br.LEGS,new jq),c(ee)},[]),q=d.exports.useCallback(()=>{const ee=new Map,Oe=new Je,de=new Je;Oe.loadAvatarData(e9,Je.MALE),de.loadAvatarData(t9,Je.FEMALE),ee.set(Je.MALE,Oe),ee.set(Je.FEMALE,de),i(ee),o(ee.get(Je.MALE))},[]),Z=d.exports.useCallback((ee,Oe,de=!0)=>{Oe=Ls.getGender(Oe);let ve=n;Oe!==ve.gender&&(ve=r.get(Oe)),ee!==ve.getFigureString()&&ve.loadAvatarData(ee,Oe),ve!==n&&o(ve),de&&(P(n.getFigureString()),D(n.gender))},[r,n]),H=d.exports.useCallback(ee=>{switch(ee){case Ni.ACTION_CLEAR:Z(n.getFigureStringWithFace(0,!1),n.gender,!1),V();return;case Ni.ACTION_RESET:Z(N,y),V();return;case Ni.ACTION_RANDOMIZE:const Oe=Hq(n,n.gender,Li(),g,[Je.FACE]);Z(Oe,n.gender,!1),V();return;case Ni.ACTION_SAVE:W(new xE(n.gender,n.getFigureString())),t(!1);return}},[n,N,y,g,Z,V]),X=d.exports.useCallback(ee=>{ee=Ls.getGender(ee),o(r.get(ee))},[r]);return d.exports.useEffect(()=>{const ee={linkReceived:Oe=>{const de=Oe.split("/");if(!(de.length<2))switch(de[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(ve=>!ve);return}},eventUrlPrefix:"avatar-editor/"};return xs(ee),()=>ws(ee)},[]),d.exports.useEffect(()=>{I(new Array(L))},[L]),d.exports.useEffect(()=>{O&&(u(null),W(new Qb))},[O]),d.exports.useEffect(()=>{h&&A(!1)},[h]),d.exports.useEffect(()=>{l&&B(Br.GENERIC)},[l,B]),d.exports.useEffect(()=>{if(n)return Ls.CURRENT_FIGURE=n,V(),()=>Ls.CURRENT_FIGURE=null},[n,V]),d.exports.useEffect(()=>(Ls.FIGURE_SET_IDS=g,Ls.BOUND_FURNITURE_NAMES=p,V(),()=>{Ls.FIGURE_SET_IDS=null,Ls.BOUND_FURNITURE_NAMES=null}),[g,p,V]),d.exports.useEffect(()=>{if(e&&!r){q(),F(!0);return}},[e,r,q]),d.exports.useEffect(()=>{!e||!k||!x||(Z(ie().figure,ie().gender),w(!1))},[e,k,x,Z]),d.exports.useEffect(()=>{if(!e)return()=>{w(!0)}},[e]),!e||!n?null:_(Be,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[a(He,{headerText:E("avatareditor.title"),onCloseClick:ee=>t(!1)}),_(ca,{className:"avatar-editor-tabs",children:[l&&l.size>0&&Array.from(l.keys()).map(ee=>{const Oe=h&&h.name===ee;return a(Dn,{isActive:Oe,onClick:de=>B(ee),children:E(`avatareditor.category.${ee}`)},ee)}),a(Dn,{isActive:O,onClick:ee=>A(!0),children:E("avatareditor.category.wardrobe")})]}),a(Ge,{children:_(qe,{children:[_(v,{size:6,overflow:"hidden",children:[h&&!O&&a(J8,{model:h,gender:n.gender,setGender:X}),O&&a(Z8,{figureData:n,savedFigures:T,setSavedFigures:I,loadAvatarInEditor:Z})]}),_(v,{size:3,overflow:"hidden",children:[a(K8,{figureData:n}),a(v,{className:"randomize-container position-absolute",children:a("i",{className:"icon randomize-icon",onClick:ee=>H(Ni.ACTION_RANDOMIZE)})}),_(v,{grow:!0,gap:1,children:[_(sa,{children:[a(Y,{variant:"secondary",onClick:ee=>H(Ni.ACTION_RESET),children:a(OU,{className:"fa-icon"})}),a(Y,{variant:"secondary",onClick:ee=>H(Ni.ACTION_CLEAR),children:a(hp,{className:"fa-icon"})}),a(Y,{variant:"secondary",onClick:ee=>H(Ni.ACTION_RANDOMIZE),children:a(CU,{className:"fa-icon"})})]}),a(Y,{className:"w-100",variant:"success",onClick:ee=>H(Ni.ACTION_SAVE),children:E("avatareditor.save")})]})]})]})})]})},r9=5,i9=s=>{const{onClose:e=null,onEdit:t=null,onDelete:r=null}=s,{cameraRoll:i=null,setCameraRoll:n=null,selectedPictureIndex:o=-1,setSelectedPictureIndex:l=null}=h0(),{simpleAlert:c=null}=$t(),h=d.exports.useRef(),u=o>-1?i[o]:null,g=()=>{if(!h||!h.current)return null;const p=h.current.getBoundingClientRect();return new uS(Math.floor(p.x),Math.floor(p.y),Math.floor(p.width),Math.floor(p.height))},m=()=>{if(o>-1){l(-1);return}const p=te().createTextureFromRoom(bt().roomId,1,g()),f=[...i];f.length>=r9&&(c(E("camera.full.body")),f.pop()),na(pi.CAMERA_SHUTTER),f.push(new zq(p,Lt.generateImageUrl(p))),n(f)};return a(wo,{uniqueKey:"nitro-camera-capture",children:_(v,{center:!0,className:"nitro-camera-capture",gap:0,children:[u&&a("img",{alt:"",className:"camera-area",src:u.imageUrl}),_("div",{className:"camera-canvas drag-handler",children:[a("div",{className:"position-absolute header-close",onClick:e,children:a(yo,{className:"fa-icon"})}),!u&&a("div",{ref:h,className:"camera-area camera-view-finder"}),u&&a("div",{className:"camera-area camera-frame",children:_("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[a("button",{className:"btn btn-success me-3",title:E("camera.editor.button.tooltip"),onClick:t,children:E("camera.editor.button.text")}),a("button",{className:"btn btn-danger",onClick:r,children:E("camera.delete.button.text")})]})}),a("div",{className:"d-flex justify-content-center",children:a("div",{className:"camera-button",title:E("camera.take.photo.button.tooltip"),onClick:m})})]}),i.length>0&&a(M,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:i.map((p,f)=>a("img",{alt:"",src:p.imageUrl,onClick:T=>l(f)},f))})]})})},n9=s=>{const{base64Url:e=null,onCloseClick:t=null,onCancelClick:r=null,price:i=null}=s,[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(0),[g,m]=d.exports.useState(!1),[p,f]=d.exports.useState(!1),[T,I]=d.exports.useState(0),O=d.exports.useMemo(()=>Ee("camera.publish.disabled",!1),[]);j(QO,N=>{u(P=>P+1),f(!1)}),j(XO,N=>{const P=N.getParser();c(P.extraDataId),I(P.secondsToWait),m(P.ok),f(!1)}),j($O,N=>{const P=N.getParser();o(Ee("camera.url")+"/"+P.url)});const A=(N,P=null)=>{switch(N){case"close":t();return;case"buy":if(p)return;f(!0),W(new Zb(""));return;case"publish":if(p)return;f(!0),W(new Jb);return;case"cancel":r();return}};return d.exports.useEffect(()=>{e&&te().saveBase64AsScreenshot(e)},[e]),i?_(Be,{className:"nitro-camera-checkout",theme:"primary",children:[a(He,{headerText:E("camera.confirm_phase.title"),onCloseClick:N=>A("close")}),_(Ge,{children:[_(M,{center:!0,children:[n&&n.length&&a(ja,{className:"picture-preview border",imageUrl:n}),(!n||!n.length)&&a(M,{center:!0,className:"picture-preview border",children:a(C,{bold:!0,children:E("camera.loading")})})]}),_(M,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[_(v,{size:O?10:6,gap:1,children:[a(C,{bold:!0,children:E("camera.purchase.header")}),(i.credits>0||i.duckets>0)&&_(M,{gap:1,children:[a(C,{children:E("catalog.purchase.confirmation.dialog.cost")}),i.credits>0&&_(M,{gap:1,children:[a(C,{bold:!0,children:i.credits}),a(Gs,{type:-1})]}),i.duckets>0&&_(M,{gap:1,children:[a(C,{bold:!0,children:i.duckets}),a(Gs,{type:5})]})]}),h>0&&_(C,{children:[a(C,{bold:!0,children:E("camera.purchase.count.info")})," ",h,a("u",{className:"ms-1 cursor-pointer",onClick:()=>Le("inventory/toggle"),children:E("camera.open.inventory")})]})]}),a(M,{alignItems:"center",children:a(Y,{variant:"success",disabled:p,onClick:N=>A("buy"),children:E(h?"camera.buy.another.button.text":"buy")})})]}),!O&&_(M,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E(g?"camera.publish.successful":"camera.publish.explanation")}),a(C,{children:E(g?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),g&&a("a",{href:l,rel:"noreferrer",target:"_blank",children:E("camera.link.to.published")}),!g&&i.publishDucketPrice>0&&_(M,{gap:1,children:[a(C,{children:E("catalog.purchase.confirmation.dialog.cost")}),_(M,{gap:1,children:[a(C,{bold:!0,children:i.publishDucketPrice}),a(Gs,{type:5})]})]}),T>0&&a("div",{className:"mt-1 text-center fw-bold",children:E("camera.publish.wait",["minutes"],[Math.ceil(T/60).toString()])})]}),!g&&a(M,{className:"d-flex align-items-end",children:a(Y,{variant:"success",disabled:p||T>0,onClick:N=>A("publish"),children:E("camera.publish.button.text")})})]}),a(C,{center:!0,children:E("camera.warning.disclaimer")}),a(M,{justifyContent:"end",children:a(Y,{onClick:N=>A("cancel"),children:E("generic.cancel")})})]})]}):null},a9=s=>{const{effect:e=null,thumbnailUrl:t=null,isActive:r=!1,isLocked:i=!1,selectEffect:n=null,removeEffect:o=null}=s;return _(yt,{title:E(i?`camera.effect.required.level ${e.minLevel}`:`camera.effect.name.${e.name}`),itemActive:r,onClick:l=>!r&&n(),children:[r&&a(Y,{variant:"danger",className:"rounded-circle remove-effect",onClick:o,children:a(yo,{className:"fa-icon"})}),!i&&t&&t.length>0&&a("div",{className:"effect-thumbnail-image border",children:a("img",{alt:"",src:t})}),i&&_(C,{center:!0,bold:!0,children:[a("div",{children:a(JR,{className:"fa-icon"})}),e.minLevel]})]})},o9=s=>{const{myLevel:e=0,selectedEffects:t=[],effects:r=[],thumbnails:i=[],processAction:n=null}=s;return a(qe,{columnCount:3,overflow:"auto",children:r&&r.length>0&&r.map((o,l)=>{const c=i.find(u=>u.effectName===o.name),h=t.findIndex(u=>u.effect.name===o.name)>-1;return a(a9,{effect:o,thumbnailUrl:c&&c.thumbnailUrl||null,isActive:h,isLocked:o.minLevel>e,selectEffect:()=>n("select_effect",o.name),removeEffect:()=>n("remove_effect",o.name)},l)})})},VT=[Ku.COLORMATRIX,Ku.COMPOSITE],l9=s=>{const{picture:e=null,availableEffects:t=null,myLevel:r=1,onClose:i=null,onCancel:n=null,onCheckout:o=null}=s,[l,c]=d.exports.useState(VT[0]),[h,u]=d.exports.useState(null),[g,m]=d.exports.useState([]),[p,f]=d.exports.useState([]),[T,I]=d.exports.useState(!1),O=d.exports.useMemo(()=>t.filter(F=>F.colorMatrix),[t]),A=d.exports.useMemo(()=>t.filter(F=>F.texture),[t]),N=d.exports.useCallback(()=>l===Ku.COLORMATRIX?O:A,[l,O,A]),P=d.exports.useCallback(F=>!F||!F.length||!g||!g.length?-1:g.findIndex(L=>L.effect.name===F),[g]),y=d.exports.useMemo(()=>P(h),[h,P]),D=d.exports.useMemo(()=>h&&g[y]||null,[h,y,g]),x=d.exports.useCallback(F=>{const L=y;L!==-1&&m(B=>{const V=[...B],q=V[L];return V[y]=new Pg(q.effect,F),V})},[y,m]),w=d.exports.useMemo(()=>bu().applyEffects(e.texture,g,T).src,[e,g,T]),k=d.exports.useCallback((F,L=null)=>{switch(F){case"close":i();return;case"cancel":n();return;case"checkout":o(w);return;case"change_tab":c(String(L));return;case"select_effect":{if(P(L)>=0)return;const V=t.find(q=>q.name===L);if(!V)return;m(q=>[...q,new Pg(V,1)]),u(V.name);return}case"remove_effect":{let B=P(L);if(B===-1)return;m(V=>{const q=[...V];return q.splice(B,1),q}),h===L&&u(null);return}case"clear_effects":u(null),m([]);return;case"download":{const B=new Image;B.src=w,window.open("").document.write(B.outerHTML);return}case"zoom":I(!T);return}},[T,t,h,w,P,n,o,i,I,m]);return d.exports.useEffect(()=>{const F=[];for(const L of t)F.push(new Kq(L.name,bu().applyEffects(e.texture,[new Pg(L,1)],!1).src));f(F)},[e,t]),_(Be,{className:"nitro-camera-editor",children:[a(He,{headerText:E("camera.editor.button.text"),onCloseClick:F=>k("close")}),a(ca,{children:VT.map(F=>a(Dn,{isActive:l===F,onClick:L=>k("change_tab",F),children:a("i",{className:"icon icon-camera-"+F})},F))}),a(Ge,{children:_(qe,{children:[a(v,{size:5,overflow:"hidden",children:a(o9,{myLevel:r,selectedEffects:g,effects:N(),thumbnails:p,processAction:k})}),_(v,{size:7,justifyContent:"between",overflow:"hidden",children:[_(v,{center:!0,children:[a(ja,{imageUrl:w,className:"picture-preview"}),h&&_(v,{center:!0,fullWidth:!0,gap:1,children:[a(C,{children:E("camera.effect.name."+h)}),a(ts,{className:"nitro-slider",min:0,max:1,step:.01,value:D.alpha,onChange:F=>x(F),renderThumb:(F,L)=>a("div",{...F,children:L.valueNow})})]})]}),_(M,{justifyContent:"between",children:[_(sa,{children:[a(Y,{onClick:F=>k("clear_effects"),children:a(hp,{className:"fa-icon"})}),a(Y,{onClick:F=>k("download"),children:a(AU,{className:"fa-icon"})}),_(Y,{onClick:F=>k("zoom"),children:[T&&a(NU,{className:"fa-icon"}),!T&&a(bU,{className:"fa-icon"})]})]}),_(M,{gap:1,children:[a(Y,{onClick:F=>k("cancel"),children:E("generic.cancel")}),a(Y,{onClick:F=>k("checkout"),children:E("camera.preview.button.text")})]})]})]})]})})]})},Ul=0,Fh=1,HT=2,WT=3,c9=s=>{const[e,t]=d.exports.useState(Ul),[r,i]=d.exports.useState(null),{availableEffects:n=[],selectedPictureIndex:o=-1,cameraRoll:l=[],setCameraRoll:c=null,myLevel:h=0,price:u={credits:0,duckets:0,publishDucketPrice:0}}=h0(),g=p=>{switch(p){case"close":t(Ul);return;case"edit":t(HT);return;case"delete":c(f=>{const T=[...f];return T.splice(o,1),T});return;case"editor_cancel":t(Fh);return}},m=p=>{i(p),t(WT)};return es(Ve.ENDED,p=>t(Ul)),d.exports.useEffect(()=>{const p={linkReceived:f=>{const T=f.split("/");if(!(T.length<2))switch(T[1]){case"show":t(Fh);return;case"hide":t(Ul);return;case"toggle":t(I=>I?Ul:Fh);return}},eventUrlPrefix:"camera/"};return xs(p),()=>ws(p)},[]),e===Ul?null:_(J,{children:[e===Fh&&a(i9,{onClose:()=>g("close"),onEdit:()=>g("edit"),onDelete:()=>g("delete")}),e===HT&&a(l9,{picture:l[o],myLevel:h,onClose:()=>g("close"),onCancel:()=>g("editor_cancel"),onCheckout:m,availableEffects:n}),e===WT&&a(n9,{base64Url:r,onCloseClick:()=>g("close"),onCancelClick:()=>g("editor_cancel"),price:u})]})},u9=s=>{const{itemId:e=-1,state:t=null,product:r=null,active:i=!1,onClick:n=null}=s,o=l=>{let c=ie().getFloorItemDataByName(l),h=null;return c?h=te().getFurnitureFloorIconUrl(c.id):(c=ie().getWallItemDataByName(l),c&&(h=te().getFurnitureWallIconUrl(c.id))),h};return _(v,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${i?"active":""}`,onClick:()=>n(e),children:[t===Er.STATE_UNLOCKED&&a(M,{center:!0,className:"campaign-spritesheet unlocked-bg",children:a(M,{center:!0,className:"campaign-spritesheet campaign-opened",children:r&&a(ja,{imageUrl:r.customImage?Ee("image.library.url")+r.customImage:o(r.productName)})})}),t!==Er.STATE_UNLOCKED&&_(M,{center:!0,className:"campaign-spritesheet locked-bg",children:[t===Er.STATE_LOCKED_AVAILABLE&&a(K,{className:"campaign-spritesheet available"}),(t===Er.STATE_LOCKED_EXPIRED||t===Er.STATE_LOCKED_FUTURE)&&a(K,{className:"campaign-spritesheet unavailable"})]})]})},Bg=5,h9=s=>{const{onClose:e=null,campaignName:t=null,currentDay:r=null,numDays:i=null,missedDays:n=null,openedDays:o=null,openPackage:l=null,receivedProducts:c=null}=s,[h,u]=d.exports.useState(r),[g,m]=d.exports.useState(Math.max(0,h-1)),p=N=>o.includes(N)?Er.STATE_UNLOCKED:N>r?Er.STATE_LOCKED_FUTURE:n.includes(N)?Er.STATE_LOCKED_EXPIRED:Er.STATE_LOCKED_AVAILABLE,f=N=>{switch(p(N)){case Er.STATE_UNLOCKED:return E("campaign.calendar.info.unlocked");case Er.STATE_LOCKED_FUTURE:return E("campaign.calendar.info.future");case Er.STATE_LOCKED_EXPIRED:return E("campaign.calendar.info.expired");default:return E("campaign.calendar.info.available.desktop")}},T=()=>{const N=h+1;N!==i&&(u(N),g+Bg<N+1&&m(g+1))},I=()=>{const N=h-1;N<0||(u(N),g>N&&m(g-1))},O=N=>{if(h===N){p(N)===Er.STATE_LOCKED_AVAILABLE&&l(N,!1);return}u(N)},A=()=>{const N=h;p(N)!==Er.STATE_UNLOCKED&&l(N,!0)};return _(Be,{className:"nitro-campaign-calendar",theme:"primary",children:[a(He,{headerText:E(`campaign.calendar.${t}.title`),onCloseClick:e}),_(Ge,{children:[_(qe,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[a(v,{size:1}),a(v,{size:10,children:_(M,{justifyContent:"between",alignItems:"center",gap:1,children:[_(v,{gap:1,children:[a(C,{fontSize:3,children:E("campaign.calendar.heading.day",["number"],[(h+1).toString()])}),a(C,{children:f(h)})]}),a("div",{children:ie().isModerator&&a(Y,{variant:"danger",onClick:A,children:"Force open"})})]})}),a(v,{size:1})]}),_(M,{fullHeight:!0,gap:2,children:[a(M,{center:!0,children:a(K,{pointer:!0,className:"campaign-spritesheet prev",onClick:I})}),a(v,{center:!0,fullWidth:!0,children:a(qe,{fit:!0,columnCount:Bg,gap:1,children:[...Array(Bg)].map((N,P)=>{const y=g+P;return a(v,{overflow:"hidden",children:a(u9,{itemId:y,state:p(y),active:h===y,product:c.has(y)?c.get(y):null,onClick:O})},P)})})}),a(M,{center:!0,children:a(K,{pointer:!0,className:"campaign-spritesheet next",onClick:T})})]})]})]})},d9=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(new Map),[l,c]=d.exports.useState(!1),h=(u,g=!1)=>{e&&(i(u),W(g?new ty(e.campaignName,u):new sy(e.campaignName,u)))};return j(ZO,u=>{const g=u.getParser();g&&t(g.calendarData)}),j(eC,u=>{const g=u.getParser();if(!g)return;const m=r;g.doorOpened&&(t(p=>{const f=p.clone();return f.openedDays.push(r),f}),o(p=>{const f=new Map(p);return f.set(m,new qq(g.productName,g.customImage,g.furnitureClassName)),f})),i(-1)}),d.exports.useEffect(()=>{const u={linkReceived:g=>{const m=g.split("/");if(!(m.length<2))switch(m[1]){case"calendar":c(!0);break}},eventUrlPrefix:"openView/"};return xs(u),()=>ws(u)},[]),a(J,{children:e&&l&&a(h9,{onClose:()=>c(!1),campaignName:e.campaignName,currentDay:e.currentDay,numDays:e.campaignDays,openedDays:e.openedDays,missedDays:e.missedDays,openPackage:h,receivedProducts:n})})},LI=s=>{const{icon:e=0}=s,t=d.exports.useMemo(()=>Ee("catalog.asset.icon.url").replace("%name%",e.toString()),[e]);return a(ja,{className:"catalog-icon",imageUrl:t,style:{width:20,height:20}})},_9=s=>{const{variant:e="primary",size:t="",active:r=!1,disabled:i=!1,classNames:n=[],...o}=s,l=d.exports.useMemo(()=>{const c=["gift-color-btn"];return e&&c.push("btn-"+e),t&&c.push("btn-"+t),r&&c.push("active"),i&&c.push("disabled"),n.length&&c.push(...n),c},[e,t,r,i,n]);return a(M,{center:!0,classNames:l,...o})},g9=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(""),[h,u]=d.exports.useState(""),[g,m]=d.exports.useState(!0),[p,f]=d.exports.useState(""),[T,I]=d.exports.useState([]),[O,A]=d.exports.useState(0),[N,P]=d.exports.useState(0),[y,D]=d.exports.useState(0),[x,w]=d.exports.useState(0),[k,F]=d.exports.useState(0),[L,B]=d.exports.useState(!1),{catalogOptions:V=null}=Ft(),{friends:q}=Oi(),{giftConfiguration:Z=null}=V,[H,X]=d.exports.useState([]),[ee,Oe]=d.exports.useState([]),[de,ve]=d.exports.useState(!0),Me=d.exports.useCallback(()=>{t(!1),i(0),o(0),c(""),u(""),m(!0),f(""),A(0),P(0),ve(!1),Oe([]),T.length&&D(T[0].id)},[T]),ce=d.exports.useMemo(()=>Z?Z.defaultStuffTypes.findIndex(Ie=>Ie===H[O])>-1:!1,[H,Z,O]),ue=d.exports.useMemo(()=>Z?(H[O]*1e3+Z.ribbonTypes[N]).toString():"",[Z,O,N,H]),$=d.exports.useMemo(()=>{if(!Z||ce)return!1;const Ie=H[O];return!(Ie===8||Ie>=3&&Ie<=6)},[Z,O,ce,H]),re=d.exports.useMemo(()=>ce?H[O]:y,[ce,H,O,y]),me=q.filter(Ie=>Ie.id!==-1),ge=Ie=>{const Ue=Ie.target.value;let ut=[];Ue.length>0&&(ut=me.sort().filter(De=>De.name.includes(Ue))),u(Ue),ve(!0),Oe(ut)},Ae=Ie=>{u(Ie),ve(!1)},Xe=d.exports.useCallback(Ie=>{switch(Ie){case"prev_box":A(Ue=>Ue===0?x:Ue-1);return;case"next_box":A(Ue=>Ue===x?0:Ue+1);return;case"prev_ribbon":P(Ue=>Ue===0?k:Ue-1);return;case"next_ribbon":P(Ue=>Ue===k?0:Ue+1);return;case"buy":if(!h||h.length===0){B(!0);return}W(new gy(r,n,l,h,p,re,O,N,g));return}},[re,l,x,k,p,n,r,h,O,N,g]);j(lC,Ie=>B(!0)),Cs([Ga.PURCHASE_SUCCESS,Ii.INIT_GIFT],Ie=>{switch(Ie.type){case Ga.PURCHASE_SUCCESS:Me();return;case Ii.INIT_GIFT:const Ue=Ie;Me(),i(Ue.pageId),o(Ue.offerId),c(Ue.extraData),t(!0);return}}),d.exports.useEffect(()=>{B(!1)},[h]);const je=d.exports.useCallback(()=>{Z&&X(Ie=>{let Ue=[...Z.boxTypes];return Ue.push(Z.defaultStuffTypes[Math.floor(Math.random()*(Z.defaultStuffTypes.length-1))]),w(Ue.length-1),F(Ue.length-1),Ue})},[Z]);if(d.exports.useEffect(()=>{if(!Z)return;const Ie=[];for(const Ue of Z.stuffTypes){const ut=ie().getFloorItemData(Ue);ut&&ut.colors&&ut.colors.length>0&&Ie.push({id:Ue,color:si.makeColorNumberHex(ut.colors[0])})}je(),Ie.length&&(D(Ie[0].id),I(Ie))},[Z,je]),d.exports.useEffect(()=>{e&&je()},[je,e]),!Z||!Z.isEnabled||!e)return null;const se="catalog.gift_wrapping_new.box."+(ce?"default":H[O]),Te=`catalog.gift_wrapping_new.ribbon.${N}`,Ce="catalog.gift_wrapping_new."+(ce?"freeprice":"price");return _(Be,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary",children:[a(He,{headerText:E("catalog.gift_wrapping.title"),onCloseClick:Me}),_(Ge,{className:"text-black",children:[_(CX,{column:!0,children:[a(C,{children:E("catalog.gift_wrapping.receiver")}),a("input",{type:"text",className:bo("form-control form-control-sm",L&&"is-invalid"),value:h,onChange:Ie=>ge(Ie)}),ee.length>0&&de&&a(v,{className:"autocomplete-gift-container",children:ee.map(Ie=>a(K,{className:"autocomplete-gift-item",onClick:Ue=>Ae(Ie.name),children:Ie.name},Ie.id))}),L&&a(K,{className:"invalid-feedback",children:E("catalog.gift_wrapping.receiver_not_found.title")})]}),a(a0,{figure:ie().figure,userName:ie().userName,message:p,editable:!0,onChange:Ie=>f(Ie)}),_(K,{className:"form-check",children:[a("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:g,onChange:Ie=>m(Ue=>!Ue)}),a("label",{className:"form-check-label",children:E("catalog.gift_wrapping.show_face.title")})]}),_(M,{alignItems:"center",gap:2,children:[y&&a(K,{className:"gift-preview",children:a(NI,{productType:nt.FLOOR,productClassId:re,extraData:ue})}),_(v,{gap:1,children:[_(M,{gap:2,children:[_(sa,{children:[a(Y,{variant:"primary",onClick:()=>Xe("prev_box"),children:a(Kn,{className:"fa-icon"})}),a(Y,{variant:"primary",onClick:()=>Xe("next_box"),children:a(qn,{className:"fa-icon"})})]}),_(v,{gap:1,children:[a(C,{fontWeight:"bold",children:E(se)}),_(M,{alignItems:"center",gap:1,children:[E(Ce,["price"],[Z.price.toString()]),a(Gs,{type:-1})]})]})]}),_(M,{alignItems:"center",gap:2,className:$?"":"opacity-50 pointer-events-none",children:[_(sa,{children:[a(Y,{variant:"primary",onClick:()=>Xe("prev_ribbon"),children:a(Kn,{className:"fa-icon"})}),a(Y,{variant:"primary",onClick:()=>Xe("next_ribbon"),children:a(qn,{className:"fa-icon"})})]}),a(C,{fontWeight:"bold",children:E(Te)})]})]})]}),_(v,{gap:1,className:$?"":"opacity-50 pointer-events-none",children:[a(C,{fontWeight:"bold",children:E("catalog.gift_wrapping.pick_color")}),a(sa,{fullWidth:!0,className:"gap-2",children:T.map(Ie=>a(_9,{variant:"dark",active:Ie.id===y,disabled:!$,style:{backgroundColor:Ie.color},onClick:()=>D(Ie.id)},Ie.id))})]}),_(M,{justifyContent:"between",alignItems:"center",children:[a(Y,{variant:"link",onClick:Me,className:"text-black",children:E("cancel")}),a(Y,{variant:"success",onClick:()=>Xe("buy"),children:E("catalog.gift_wrapping.give_gift")})]})]})]})},m9=s=>{const[e,t]=d.exports.useState(""),{currentType:r=null,rootNode:i=null,offersToNodes:n=null,searchResult:o=null,setSearchResult:l=null,setCurrentPage:c=null}=Ft();return d.exports.useEffect(()=>{let h=e==null?void 0:e.toLocaleLowerCase().replace(" ","");if(!h||!h.length){l(null);return}const u=setTimeout(()=>{const g=ie().getAllFurnitureData({loadFurnitureData:null});if(!g||!g.length)return;const m=[],p=[];for(const I of g){if(r===Ki.BUILDER&&!I.availableForBuildersClub||r===Ki.NORMAL&&I.excludeDynamic)continue;const O=[I.className,I.name,I.description].join(" ").replace(/ /gi,"").toLowerCase();if(r===Ki.BUILDER&&I.purchaseOfferId===-1&&I.rentOfferId===-1)I.furniLine!==""&&p.indexOf(I.furniLine)<0&&O.indexOf(h)>=0&&p.push(I.furniLine);else if([..._T(n,I.purchaseOfferId),..._T(n,I.rentOfferId)].length&&(O.indexOf(h)>=0&&m.push(I),m.length===250))break}const f=[];for(const I of m)f.push(new _q(I));let T=[];vL(h,p,i,T),l(new pq(h,f,T.filter(I=>I.isVisible))),c(new hI(-1,"default_3x3",new DL([],[]),f,!1,1))},300);return()=>clearTimeout(u)},[n,r,i,e,c,l]),_(M,{gap:1,className:"position-relative",children:[a(M,{fullWidth:!0,alignItems:"center",position:"relative",children:a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("generic.search"),value:e,onChange:h=>t(h.target.value)})}),(!e||!e.length)&&a("i",{className:"icon icon-pen position-absolute catalog-search-button"}),e&&!!e.length&&a(Y,{variant:"primary",className:"catalog-search-button",onClick:h=>t(""),children:a("i",{className:"icon icon-clear position-absolute catalog-clear-button"})})]})},D0=s=>{const{node:e=null,child:t=!1}=s;return a(J,{children:e&&e.children.length>0&&e.children.map((r,i)=>r.isVisible?a(P0,{node:r,child:t},i):null)})},P0=s=>{const{node:e=null,child:t=!1}=s,{activateNode:r=null}=Ft();return _(J,{children:[_(yt,{style:{marginLeft:`${(e.depth-2)*10}px`},gap:1,column:!1,itemActive:e.isActive,onClick:i=>r(e),children:[a(LI,{icon:e.iconId}),a(C,{grow:!0,truncate:!0,children:e.localization}),e.isBranch&&_(J,{children:[e.isOpen&&a(QR,{className:"fa-icon"}),!e.isOpen&&a($R,{className:"fa-icon"})]})]}),e.isOpen&&e.isBranch&&a(D0,{node:e,child:!0})]})},f9=s=>{const{node:e=null}=s,{searchResult:t=null}=Ft();return _(J,{children:[a(m9,{}),a(v,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container grid-bg w-100 p-1",overflow:"hidden",children:_(Bt,{gap:1,columnCount:1,children:[t&&t.filteredNodes.length>0&&t.filteredNodes.map((r,i)=>a(P0,{node:r},i)),!t&&a(D0,{node:e})]})})]})},p9=s=>{const{currentPage:e=null,activateNode:t=null,rootNode:r=null,getNodeById:i=null}=Ft();return a(J,{children:_(M,{className:"catalog-header",children:[_(v,{gap:0,className:"catalog-header-content",children:[e&&r&&a(LI,{icon:i(e.pageId,r).iconId}),e&&r&&a(C,{bold:!0,className:"catalog-header-title h-100",children:i(e.pageId,r).localization}),a(C,{className:"catalog-header-desc",dangerouslySetInnerHTML:{__html:e&&e.localization.getText(0)}})]}),a(M,{className:"catalog-header-image",style:{backgroundImage:`url(${e&&e.localization.getImage(0)})`}})]})})},E9=s=>{const{columnCount:e=5,...t}=s,[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState(null),{currentOffer:l=null,setPurchaseOptions:c=null}=Ft(),{badgeCodes:h=[],activate:u=null,deactivate:g=null}=Rg(),m=d.exports.useMemo(()=>{if(!n)return null;const p=new vn;return p.setValue(["0",n,"",""]),p},[n]);return d.exports.useEffect(()=>{l&&c(p=>{const f={...p};return f.extraParamRequired=!0,f.extraData=m&&m.getValue(1)||null,f.previewStuffData=m,f})},[l,m,c]),d.exports.useEffect(()=>{if(!r)return;const p=u();return()=>g(p)},[r,u,g]),d.exports.useEffect(()=>(i(!0),()=>i(!1)),[]),a(Bt,{columnCount:e,...t,children:h&&h.length>0&&h.map((p,f)=>a(yt,{itemActive:n===p,onClick:T=>o(p),children:a(as,{badgeCode:p})},f))})},Sg=s=>{const{currentPage:e=null,setCurrentOffer:t=null}=Ft();return d.exports.useEffect(()=>{!e||!e.offers.length||t(e.offers[0])},[e,t]),null},I9=s=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:r=!1,itemCount:i=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:h=!1,disabled:u=!1,center:g=!0,column:m=!0,style:p={},classNames:f=[],position:T="relative",overflow:I="hidden",children:O=null,...A}=s,N=d.exports.useMemo(()=>{const y=["layout-catalog-grid-item","justify-content-end"];return r&&y.push("active"),(o||l>0)&&y.push("unique-item"),o&&y.push("sold-out"),c&&y.push("unseen"),h&&y.push("has-highlight"),u&&y.push("disabled"),e===null&&y.push("icon","loading-icon"),f.length&&y.push(...f),y},[r,o,l,c,h,u,e,f]),P=d.exports.useMemo(()=>{let y={...p};return e&&(y.backgroundImage=`url(${e})`),t&&(y.backgroundColor=t),Object.keys(p).length&&(y={...y,...p}),y},[p,e,t]);return _(v,{pointer:!0,position:T,overflow:I,column:m,classNames:N,style:P,...A,children:[i>n&&a(nn,{count:i}),l>0&&_(J,{children:[a(K,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),a("div",{className:"position-absolute unique-item-counter",children:a(ka,{value:l})})]}),O]})},T9=s=>{const{offer:e=null,separator:t=!1}=s,{purchaseOptions:r=null}=Ft(),{quantity:i=1}=r;return e?_(J,{children:[e.priceInCredits>0&&_(M,{alignItems:"end",justifyContent:"end",gap:1,className:"grid-price-view",children:[a(C,{bold:!0,children:e.priceInCredits*i}),a("i",{className:"icon icon-small-coin"})]}),t&&e.priceInCredits>0&&e.priceInActivityPoints>0&&a(Lc,{className:"fa-icon"}),e.priceInActivityPoints>0&&_(M,{alignItems:"end",justifyContent:"end",gap:1,className:"grid-price-view",children:[a(C,{bold:!0,children:e.priceInActivityPoints*i}),a("i",{className:"icon icon-small-"+e.activityPointType})]})]}):null},UI=s=>{const{offer:e=null,selectOffer:t=null,itemActive:r=!1,...i}=s,[n,o]=d.exports.useState(!1),{requestOfferToMover:l=null}=Ft(),{isVisible:c=!1}=yl(),h=d.exports.useMemo(()=>e.pricingModel===Ns.PRICING_MODEL_BUNDLE?null:e.product.getIconUrl(e),[e]),u=m=>{switch(m.type){case fe.MOUSE_DOWN:t(e),o(!0);return;case fe.MOUSE_UP:o(!1);return;case fe.ROLL_OUT:if(!n||!r||!c)return;l(e);return}},g=e.product;return g?_(v,{className:"catalog-grid-active cursor-pointer",gap:0,itemActive:r,onMouseDown:u,onMouseUp:u,onMouseOut:u,children:[a(I9,{itemImage:h,itemCount:e.pricingModel===Ns.PRICING_MODEL_MULTI?g.productCount:1,itemUniqueSoldout:g.uniqueLimitedItemSeriesSize&&!g.uniqueLimitedItemsLeft,itemUniqueNumber:g.uniqueLimitedItemSeriesSize,...i,children:e.product.productType===nt.ROBOT&&a(Ts,{figure:e.product.extraParam,headOnly:!0,direction:3})}),a(M,{alignItems:"end",justifyContent:"end",fullWidth:!0,gap:0,children:a(v,{gap:0,children:a(T9,{offer:e})})})]}):null},Nh=s=>{const{columnCount:e=5,children:t=null,...r}=s,{currentOffer:i=null,setCurrentOffer:n=null,currentPage:o=null,setPurchaseOptions:l=null}=Ft(),c=d.exports.useRef();if(d.exports.useEffect(()=>{c&&c.current&&(c.current.scrollTop=0)},[o]),!o)return null;const h=u=>{u.activate(),!u.isLazy&&(n(u),u.product&&u.product.productType===nt.WALL&&l(g=>{const m={...g};return m.extraData=u.product.extraParam||null,m}))};return _(Bt,{innerRef:c,columnCount:e,...r,children:[o.offers&&o.offers.length>0&&o.offers.map((u,g)=>a(UI,{itemActive:i&&i.offerId===u.offerId,offer:u,selectOffer:h},g)),t]})},Og=s=>{const{children:e=null,...t}=s,{currentOffer:r=null}=Ft();return!r||r.pricingModel!==Ns.PRICING_MODEL_SINGLE||!r.product.isUniqueLimitedItem?null:_(K,{...t,children:[a(RX,{uniqueLimitedItemsLeft:r.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:r.product.uniqueLimitedItemSeriesSize}),e]})},wn=s=>{const{noGiftOption:e=!1,purchaseCallback:t=null}=s;d.exports.useState(!1);const[r,i]=d.exports.useState(Xt.NONE);pg(Rh.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:n=null,currentPage:o=null,purchaseOptions:l=null,setPurchaseOptions:c=null}=Ft(),{getCurrencyAmount:h=null}=vl(),u=d.exports.useCallback(f=>{switch(f.type){case Ga.PURCHASE_SUCCESS:i(Xt.NONE);return;case El.PURCHASE_FAILED:i(Xt.FAILED);return;case f_.NOT_ALLOWED:i(Xt.FAILED);return;case p_.SOLD_OUT:i(Xt.SOLD_OUT);return}},[]);Cs(Ga.PURCHASE_SUCCESS,u),Cs(El.PURCHASE_FAILED,u),Cs(f_.NOT_ALLOWED,u),Cs(p_.SOLD_OUT,u);const g=d.exports.useMemo(()=>{if(!n||l.extraParamRequired&&(!l.extraData||!l.extraData.length))return!1;if(n.pricingModel===Ns.PRICING_MODEL_SINGLE){const f=n.product;if(f&&f.isUniqueLimitedItem)return!f.uniqueLimitedItemsLeft}return!1},[n,l]),m=(f=!1)=>{if(!n)return;if(Li()<n.clubLevel){Le("habboUI/open/hccenter");return}if(f){zs(new LX(n.page.pageId,n.offerId,l.extraData));return}if(i(Xt.PURCHASE),t){t();return}let T=n.page.pageId;W(new ih(T,n.offerId,l.extraData,l.quantity))};if(d.exports.useEffect(()=>{n&&i(Xt.NONE)},[n,c]),d.exports.useEffect(()=>{let f=null;return(r===Xt.CONFIRM||r===Xt.FAILED)&&(f=setTimeout(()=>i(Xt.NONE),3e3)),()=>{f&&clearTimeout(f)}},[r]),!n)return null;const p=()=>{const f=n.priceInCredits*l.quantity,T=n.priceInActivityPoints*l.quantity;if(Li()<n.clubLevel)return a(Y,{variant:"danger",disabled:!0,children:E("catalog.alert.hc.required")});if(g)return a("div",{className:"unique-sold-out-blocker",children:a("div",{children:E("catalog.alert.limited_edition_sold_out.title")})});if(f>h(-1))return a(Y,{variant:"danger",disabled:!0,children:E("catalog.alert.notenough.title")});if(T>h(n.activityPointType))return a(Y,{variant:"danger",disabled:!0,children:E("catalog.alert.notenough.activitypoints.title."+n.activityPointType)});switch(r){case Xt.CONFIRM:return a(Y,{variant:"warning",onClick:I=>m(),children:E("catalog.marketplace.confirm_title")});case Xt.PURCHASE:return a(Y,{disabled:!0,children:a(bI,{})});case Xt.FAILED:return a(Y,{variant:"danger",children:E("generic.failed")});case Xt.SOLD_OUT:return a(Y,{variant:"danger",children:E("generic.failed")+" - "+E("catalog.alert.limited_edition_sold_out.title")});case Xt.NONE:default:return a(Y,{variant:"success",disabled:l.extraParamRequired&&(!l.extraData||!l.extraData.length),onClick:I=>i(Xt.CONFIRM),children:E("catalog.purchase_confirmation."+(n.isRentOffer?"rent":"buy"))})}};return _(J,{children:[!e&&!n.isRentOffer&&!n.product.isUniqueLimitedItem&&a(Y,{disabled:l.quantity>1||!n.giftable||g||l.extraParamRequired&&(!l.extraData||!l.extraData.length),onClick:f=>m(!0),children:E("catalog.purchase_confirmation.gift")}),a(p,{})]})},L0=s=>{const{offer:e=null,separator:t=!1}=s,{purchaseOptions:r=null}=Ft(),{quantity:i=1}=r;return e?_(J,{children:[e.priceInCredits>0&&_(M,{alignItems:"center",gap:1,children:[a(C,{bold:!0,children:e.priceInCredits*i}),a(Gs,{type:-1})]}),t&&e.priceInCredits>0&&e.priceInActivityPoints>0&&a(Lc,{size:"xs",color:"black",className:"fa-icon"}),e.priceInActivityPoints>0&&_(M,{alignItems:"center",gap:1,children:[_(C,{bold:!0,children:[" ",e.priceInActivityPoints*i]}),a(Gs,{type:e.activityPointType})]})]}):null},Ka=s=>{const{gap:e=1,...t}=s,{currentOffer:r=null}=Ft();return a(M,{gap:e,...t,children:a(L0,{offer:r})})},Ml=s=>{const{currentOffer:e=null,roomPreviewer:t=null,purchaseOptions:r=null}=Ft(),{previewStuffData:i=null}=r;return d.exports.useEffect(()=>{if(!e||e.pricingModel===Ns.PRICING_MODEL_BUNDLE||!t)return;const n=e.product;if(n)switch(t.reset(!1),n.productType){case nt.FLOOR:{if(!n.furnitureData)return;if(n.furnitureData.specialType===Pe.FIGURE_PURCHASABLE_SET){const l=ie().getFloorItemData(n.furnitureData.id).customParams.split(",").map(u=>parseInt(u)),c=[];for(const u of l)Ks().isValidFigureSetForGender(u,ie().gender)&&c.push(u);const h=Ks().getFigureStringWithFigureIds(ie().figure,ie().gender,c);t.addAvatarIntoRoom(h,n.productClassId)}else t.addFurnitureIntoRoom(n.productClassId,new G(90),i,n.extraParam);return}case nt.WALL:{if(!n.furnitureData)return;switch(n.furnitureData.specialType){case Pe.FLOOR:t.updateObjectRoom(n.extraParam);return;case Pe.WALL_PAPER:t.updateObjectRoom(null,n.extraParam);return;case Pe.LANDSCAPE:{t.updateObjectRoom(null,null,n.extraParam);const o=ie().getWallItemDataByName("window_double_default");o&&t.addWallItemIntoRoom(o.id,new G(90),o.customParams);return}default:t.updateObjectRoom("default","default","default"),t.addWallItemIntoRoom(n.productClassId,new G(90),n.extraParam);return}}case nt.ROBOT:t.addAvatarIntoRoom(n.extraParam,0);return;case nt.EFFECT:t.addAvatarIntoRoom(ie().figure,n.productClassId);return}},[e,i,t]),e?e.pricingModel===Ns.PRICING_MODEL_BUNDLE?a(v,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:a(Bt,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:e.products.length>0&&e.products.map((n,o)=>a(yt,{itemImage:n.getIconUrl(e),itemCount:n.productCount},o))})}):a(Ch,{roomPreviewer:t,height:235}):null},R9=s=>{const{page:e=null}=s,{currentOffer:t=null}=Ft();return _(J,{children:[a(Sg,{}),_(qe,{children:[_(v,{size:7,overflow:"hidden",children:[a(Nh,{shrink:!0}),_(v,{gap:1,overflow:"hidden",children:[a(C,{truncate:!0,shrink:!0,fontWeight:"bold",children:E("catalog_selectbadge")}),a(E9,{})]})]}),_(v,{center:!t,size:5,overflow:"hidden",children:[!t&&_(J,{children:[!!e.localization.getImage(1)&&a("img",{alt:"",src:e.localization.getImage(1)}),a(C,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),t&&_(J,{children:[a(K,{position:"relative",overflow:"hidden",children:a(Ml,{})}),_(v,{grow:!0,gap:1,children:[a(Og,{fullWidth:!0}),a(C,{grow:!0,truncate:!0,children:t.localizationName}),a(M,{justifyContent:"end",children:a(Ka,{alignItems:"end"})}),a(wn,{})]})]})]})]})]})},Il=s=>{const{...e}=s,{currentOffer:t=null}=Ft();return!t||!t.badgeCode||!t.badgeCode.length?null:a(as,{badgeCode:t.badgeCode,...e})},S9=1,O9=100,xI=s=>{const{currentOffer:e=null,purchaseOptions:t=null,setPurchaseOptions:r=null}=Ft(),{quantity:i=1}=t,n=o=>{isNaN(o)&&(o=1),o=Math.max(o,S9),o=Math.min(o,O9),o!==i&&r(l=>{const c={...l};return c.quantity=o,c})};return!e||!e.bundlePurchaseAllowed?null:_(J,{children:[a(C,{children:E("catalog.bundlewidget.spinner.select.amount")}),_(M,{alignItems:"center",gap:1,children:[a(ZR,{className:"text-black cursor-pointer fa-icon",onClick:o=>n(i-1)}),a("input",{type:"number",className:"form-control form-control-sm quantity-input",value:i,onChange:o=>n(o.target.valueAsNumber)}),a(eS,{className:"text-black cursor-pointer fa-icon",onClick:o=>n(i+1)})]})]})},C9=s=>{const{page:e=null}=s,[t,r]=d.exports.useState(new Map),{currentOffer:i=null,setCurrentOffer:n=null}=Ft(),[o,l]=d.exports.useState(!1),c=(p,f)=>!p.product.furnitureData.colorIndex||!f.product.furnitureData.colorIndex||p.product.furnitureData.colorIndex>f.product.furnitureData.colorIndex?1:p==f?0:-1,h=(p,f)=>p.product.furnitureData.className>f.product.furnitureData.className?1:p==f?0:-1,u=p=>{p.activate(),n(p)},g=(p,f)=>{const T=`${f}*${p}`,I=e.offers.findIndex(O=>O.product.furnitureData.fullName===T);I>-1&&u(e.offers[I])},m=d.exports.useMemo(()=>{const p=[],f=new Map,T=new Map;return e.offers.sort(c),e.offers.forEach(I=>{if(!I.product)return;const O=I.product.furnitureData;if(!O||!O.hasIndexedColor)p.push(I);else{const A=O.className,N=O.colorIndex;T.has(A)||T.set(A,[]);let P=16777215;if(O.colors){for(let y of O.colors)y!==16777215&&(P=y);T.get(A).indexOf(P)===-1&&(T.get(A)[N]=P)}f.has(A)||(p.push(I),f.set(A,!0))}}),p.sort(h),r(T),p},[e.offers]);return _(qe,{children:[a(v,{size:7,overflow:"hidden",children:_(Bt,{columnCount:5,children:[(!o||!i||!t.has(i.product.furnitureData.className))&&m.map((p,f)=>a(UI,{itemActive:i&&(i.product.furnitureData.hasIndexedColor?i.product.furnitureData.className===p.product.furnitureData.className:i.offerId===p.offerId),offer:p,selectOffer:u},f)),o&&i&&t.has(i.product.furnitureData.className)&&t.get(i.product.furnitureData.className).map((p,f)=>a(yt,{itemHighlight:!0,itemActive:i.product.furnitureData.colorIndex===f,itemColor:Sr.int2rgb(p),className:"clear-bg",onClick:T=>g(f,i.product.furnitureData.className)},f))]})}),_(v,{center:!i,size:5,overflow:"hidden",children:[!i&&_(J,{children:[!!e.localization.getImage(1)&&a("img",{alt:"",src:e.localization.getImage(1)}),a(C,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),i&&_(J,{children:[_(K,{position:"relative",overflow:"hidden",children:[a(Ml,{}),a(Il,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),i.product.furnitureData.hasIndexedColor&&a(Y,{position:"absolute",className:"bottom-1 start-1",onClick:p=>l(f=>!f),children:a(tS,{className:"fa-icon"})})]}),_(v,{grow:!0,gap:1,children:[a(Og,{fullWidth:!0}),a(C,{grow:!0,truncate:!0,children:i.localizationName}),_(M,{justifyContent:"between",children:[a(v,{gap:1,children:a(xI,{})}),a(Ka,{justifyContent:"end",alignItems:"end"})]}),a(wn,{})]})]})]})]})},A9=s=>{const{page:e=null}=s,{currentOffer:t=null,currentPage:r=null}=Ft();return _("div",{children:[_(v,{className:"position-relative catalog-default-image",center:!t,size:5,overflow:"hidden",children:[!t&&a(J,{children:!!e.localization.getImage(1)&&a("img",{className:"catalog-image-column",alt:"",src:e.localization.getImage(1)})}),t&&_(J,{children:[_(K,{position:"relative",overflow:"hidden",children:[a(Ml,{}),a(Ka,{className:"credits-default-layout credits-bg py-1 px-2 bottom-1 end-1",justifyContent:"end",alignItems:"end"}),a(Og,{fullWidth:!0,position:"absolute",className:"top-1"}),a(Il,{position:"absolute",className:"bg-muted rounded top-1 end-1"})]}),a(v,{grow:!0,gap:1,children:a(C,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName})})]})]}),a(v,{className:"grid-bg item-picker p-2",size:7,overflow:"hidden",children:a(Nh,{})}),a(M,{gap:1,className:"quanity-container mt-2",children:a(xI,{})}),a(M,{gap:2,className:"purchase-buttons align-items-end mt-2",children:a(wn,{})})]})},N9=s=>{const{...e}=s,{currentOffer:t=null,purchaseOptions:r=null}=Ft(),{previewStuffData:i=null}=r,n=d.exports.useMemo(()=>{if(!t||!i)return null;const o=i.getValue(2);return!o||!o.length?null:o},[t,i]);return n?a(as,{badgeCode:n,isGroup:!0,...e}):null},U0=s=>{const[e,t]=d.exports.useState(0),{currentOffer:r=null,catalogOptions:i=null,setPurchaseOptions:n=null}=Ft(),{groups:o=null}=i,l=d.exports.useMemo(()=>{if(!o||!o.length)return null;const h=o[e];if(!h)return null;const u=new vn;return u.setValue(["0",h.groupId.toString(),h.badgeCode,h.colorA,h.colorB]),u},[e,o]);if(d.exports.useEffect(()=>{r&&n(h=>{const u={...h};return u.extraParamRequired=!0,u.extraData=l&&l.getValue(1)||null,u.previewStuffData=l,u})},[r,l,n]),d.exports.useEffect(()=>{W(new LE)},[]),!o||!o.length)return _(K,{className:"bg-muted rounded p-1 text-black text-center",children:[E("catalog.guild_selector.members_only"),a(Y,{className:"mt-1",children:E("catalog.guild_selector.find_groups")})]});const c=o[e];return _(M,{gap:1,children:[!!c&&_(M,{overflow:"hidden",className:"rounded border",children:[a(K,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorA}}),a(K,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+c.colorB}})]}),a("select",{className:"form-select form-select-sm",value:e,onChange:h=>t(parseInt(h.target.value)),children:o.map((h,u)=>a("option",{value:u,children:h.groupName},u))})]})},b9=s=>{const{page:e=null}=s,{currentOffer:t=null}=Ft();return _(v,{children:[_(v,{className:"position-relative",center:!t,size:5,overflow:"hidden",children:[!t&&_(J,{children:[!!e.localization.getImage(1)&&a("img",{alt:"",src:e.localization.getImage(1)}),a(C,{className:"py-5",center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),t&&_(J,{children:[_(K,{position:"relative",overflow:"hidden",children:[a(Ml,{}),a(N9,{position:"absolute",className:"top-1 end-1"}),a(Ka,{className:"credits-default-layout credits-bg py-1 px-2 bottom-1 end-1",justifyContent:"end",alignItems:"end"})]}),_(v,{grow:!0,gap:1,children:[a(C,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName}),a(M,{justifyContent:"between"})]}),a(K,{grow:!0,children:a(U0,{})})]})]}),a(v,{className:"grid-bg group-furni-picker p-2",size:7,overflow:"hidden",children:a(Nh,{})}),a(M,{gap:2,className:"purchase-buttons align-items-end mt-2",children:a(wn,{})})]})},y9=s=>{const{page:e=null}=s;d.exports.useState(0);const{currentOffer:t=null,setCurrentOffer:r=null,catalogOptions:i=null}=Ft();return d.exports.useEffect(()=>{W(new LE)},[e]),_(J,{children:[a(Sg,{}),_(v,{children:[a(v,{className:"p-1",overflow:"hidden",children:a(C,{className:"group-forum-page",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})}),a(v,{overflow:"hidden",gap:1,children:!!t&&a(J,{children:_(v,{grow:!0,gap:0,children:[a(C,{truncate:!0,children:t.localizationName}),a(K,{grow:!0,children:a(U0,{})}),a(M,{justifyContent:"end",children:a(Ka,{alignItems:"end"})}),a(wn,{noGiftOption:!0})]})})})]})]})},v9=s=>{const{page:e=null}=s;return _(v,{children:[_(v,{gap:4,overflow:"hidden",className:"p-3",children:[a(C,{bold:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),a(C,{overflow:"auto",dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),a(C,{dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),_(v,{center:!0,size:5,overflow:"hidden",children:[a(ja,{imageUrl:e.localization.getImage(1)}),a(Y,{onClick:()=>Le("groups/create"),children:E("catalog.start.guild.purchase.button")})]})]})},M9=s=>{const{page:e=null}=s;return a("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:a("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:a("div",{dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})})})},x0=s=>{const{page:e=null}=s,t=e.localization.getImage(1);return _(v,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[_(M,{alignItems:"center",gap:2,children:[t&&a("img",{alt:"",src:t}),a(K,{className:"fs-5",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),a(v,{grow:!0,alignItems:"center",overflow:"auto",children:a(K,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}})}),a(M,{alignItems:"center",children:a(K,{className:"fw-bold",dangerouslySetInnerHTML:{__html:e.localization.getText(3)}})})]})},D9=s=>a(x0,{...s}),P9=s=>{const{page:e=null}=s,[t,r]=d.exports.useState(""),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(-1),[c,h]=d.exports.useState([]),[u,g]=d.exports.useState(!1),[m,p]=d.exports.useState(1),{categories:f=null}=Fi(),{setIsVisible:T=null}=Ft(),{promoteInformation:I,isExtended:O,setIsExtended:A}=PI();d.exports.useEffect(()=>{O&&(l(I.data.flatId),r(I.data.eventName),n(I.data.eventDescription),p(I.data.categoryId),g(O),A(!1))},[O,t,i,m]);const N=()=>{l(-1),r(""),n(""),p(1),A(!1),T(!1)},P=()=>{const y=e.pageId,D=e.offers.length>=1?e.offers[0].offerId:-1,x=o,w=t,k=i,F=m;W(new my(y,D,x,w,u,k,F)),N()};return j(fC,y=>{const D=y.getParser();D&&h(D.rooms)}),d.exports.useEffect(()=>{W(new dy),W(new SE)},[]),_(J,{children:[a(C,{bold:!0,center:!0,children:E("roomad.catalog_header")}),_(v,{size:12,overflow:"hidden",className:"text-black",children:[a(K,{children:E("roomad.catalog_text",["duration"],["120"])}),_(K,{className:"bg-muted rounded p-1",children:[_(v,{gap:2,children:[a(C,{bold:!0,children:E("navigator.category")}),a("select",{className:"form-select form-select-sm",value:m,onChange:y=>p(parseInt(y.target.value)),disabled:u,children:f&&f.map((y,D)=>a("option",{value:y.id,children:E(y.name)},D))})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("roomad.catalog_name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:t,onChange:y=>r(y.target.value),readOnly:u})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("roomad.catalog_description")}),a("textarea",{className:"form-control form-control-sm",maxLength:64,value:i,onChange:y=>n(y.target.value),readOnly:u})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("roomad.catalog_roomname")}),_("select",{className:"form-select form-select-sm",value:o,onChange:y=>l(parseInt(y.target.value)),disabled:u,children:[a("option",{value:-1,disabled:!0,children:E("roomad.catalog_roomname")}),c&&c.map((y,D)=>a("option",{value:y.roomId,children:y.roomName},D))]})]}),a(v,{gap:1,children:a(Y,{variant:!t||!i||o===-1?"danger":"success",onClick:P,disabled:!t||!i||o===-1,children:E(u?"roomad.extend.event":"buy")})})]})]})]})},w0=s=>{const{columnCount:e=5,children:t=null,...r}=s,{currentOffer:i=null}=Ft(),n=d.exports.useRef();return d.exports.useEffect(()=>{n&&n.current&&(n.current.scrollTop=0)},[i]),i?_(Bt,{innerRef:n,columnCount:5,...r,children:[i.products&&i.products.length>0&&i.products.map((o,l)=>a(yt,{itemImage:o.getIconUrl(),itemCount:o.productCount},l)),t]}):null},F0=s=>{const{gap:e=1,...t}=s,{currentOffer:r=null}=Ft();return a(M,{gap:e,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...t,children:a(L0,{separator:!0,offer:r})})},L9=s=>{const{page:e=null}=s;return _(J,{children:[a(Sg,{}),_(qe,{children:[_(v,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&a(C,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),a(v,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:a(w0,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),_(v,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&a(C,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),_(v,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&a("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),a(Il,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),a(F0,{position:"absolute",className:"bottom-0 end-0"})]}),a(v,{gap:1,children:a(wn,{})})]})]})]})},U9=s=>{const{page:e=null}=s;return _(J,{children:[a(Sg,{}),a(v,{children:!!e.localization.getText(1)&&a(C,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)})}),_(qe,{children:[_(v,{size:5,overflow:"hidden",gap:1,children:[_(v,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&a("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),a(Il,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),a(F0,{position:"absolute",className:"bottom-0 end-0"})]}),a(v,{gap:1,children:a(wn,{})})]}),_(v,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&a(C,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),a(v,{grow:!0,overflow:"hidden",className:"grid-bg p-2",children:a(w0,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]})]})]})},x9=s=>{const{imageUrl:e=null}=s,[t,r]=d.exports.useState("");return d.exports.useEffect(()=>{r(e??Ee("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[e]),a(M,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:a("img",{src:t,onError:({currentTarget:i})=>{i.src=Ee("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},w9=s=>{const{page:e=null}=s,[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState(""),{currentOffer:o=null,currentPage:l=null}=Ft(),c=h=>{var u;return(u=mt().soundManager.musicController)==null?void 0:u.playSong(h,er.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return j(bb,h=>{const u=h.getParser();u.officialSongId===i&&r(u.songId)}),d.exports.useEffect(()=>{if(!o)return;const h=o.product;if(h){if(h.extraParam.length>0){const u=parseInt(h.extraParam);u>0?r(u):(n(h.extraParam),W(new zD(h.extraParam)))}else n(""),r(-1);return()=>{var u;return(u=mt().soundManager.musicController)==null?void 0:u.stop(er.PRIORITY_PURCHASE_PREVIEW)}}},[o]),d.exports.useEffect(()=>()=>{var h;return(h=mt().soundManager.musicController)==null?void 0:h.stop(er.PRIORITY_PURCHASE_PREVIEW)},[]),a(J,{children:_(qe,{children:[_(v,{size:7,overflow:"hidden",children:[Ee("catalog.headers")&&a(x9,{imageUrl:l.localization.getImage(0)}),a(Nh,{})]}),_(v,{center:!o,size:5,overflow:"hidden",children:[!o&&_(J,{children:[!!e.localization.getImage(1)&&a(ja,{imageUrl:e.localization.getImage(1)}),a(C,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),o&&_(J,{children:[_(M,{center:!0,overflow:"hidden",style:{height:140},children:[o.product.productType!==nt.BADGE&&_(J,{children:[a(Ml,{}),a(Il,{className:"bg-muted rounded bottom-1 end-1"})]}),o.product.productType===nt.BADGE&&a(Il,{className:"scale-2"})]}),_(v,{grow:!0,gap:1,children:[a(Og,{fullWidth:!0}),a(C,{grow:!0,truncate:!0,children:o.localizationName}),t>-1&&a(Y,{onClick:()=>c(t),children:E("play_preview_button")}),_(M,{justifyContent:"between",children:[a(v,{gap:1,children:a(xI,{})}),a(Ka,{justifyContent:"end",alignItems:"end"})]}),a(wn,{})]})]})]})]})})},F9=["floors","walls","views"],k9=s=>{const{columnCount:e=5,children:t=null,...r}=s,[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(-1),[c,h]=d.exports.useState(null),{currentPage:u=null,currentOffer:g=null,setCurrentOffer:m=null,setPurchaseOptions:p=null}=Ft(),f=d.exports.useRef(),T=O=>{O&&h(A=>{const N=[...A];return N[o]=O,N})};if(d.exports.useEffect(()=>{if(!u)return;const O=[[],[],[]];for(const A of u.offers){if(A.pricingModel!==Ns.PRICING_MODEL_SINGLE&&A.pricingModel!==Ns.PRICING_MODEL_MULTI)continue;const N=A.product;if(!N||N.productType!==nt.WALL&&N.productType!==nt.FLOOR||!N.furnitureData)continue;switch(N.furnitureData.className){case"floor":O[0].push(A);break;case"wallpaper":O[1].push(A);break;case"landscape":O[2].push(A);break}}n(O),l(0),h([O[0][0],O[1][0],O[2][0]])},[u]),d.exports.useEffect(()=>{o===-1||!c||m(c[o])},[o,c,m]),d.exports.useEffect(()=>{o===-1||!c||!g||p(O=>{const A={...O};return A.extraData=c[o].product.extraParam,A.extraParamRequired=!0,A})},[g,o,c,p]),d.exports.useEffect(()=>{f&&f.current&&(f.current.scrollTop=0)},[o]),!i||o===-1)return null;const I=i[o];return _(J,{children:[a(sa,{className:"purchase-buttons",children:F9.map((O,A)=>a(Y,{active:o===A,onClick:N=>l(A),children:E(`catalog.spaces.tab.${O}`)},A))}),a(v,{className:"grid-bg item-picker p-2",size:7,overflow:"hidden",children:_(Bt,{columnCount:e,...r,children:[I&&I.length>0&&I.map((O,A)=>a(UI,{itemActive:g&&g===O,offer:O,selectOffer:N=>T(N)},A)),t]})})]})},G9=s=>{const{page:e=null}=s,{currentOffer:t=null,roomPreviewer:r=null}=Ft();return d.exports.useEffect(()=>{r.updatePreviewObjectBoundingRectangle(new vr)},[r]),_(v,{children:[_(v,{center:!t,size:5,overflow:"hidden",children:[!t&&_(J,{children:[!!e.localization.getImage(1)&&a("img",{alt:"",src:e.localization.getImage(1)}),a(C,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),t&&_(J,{children:[_(K,{position:"relative",overflow:"hidden",children:[a(Ml,{}),a(Ka,{className:"credits-default-layout credits-bg py-1 px-2 bottom-1 end-1",justifyContent:"end",alignItems:"end"}),a(C,{bold:!0,variant:"white",className:"item-title",grow:!0,truncate:!0,children:t.localizationName})]}),a(M,{gap:2,className:"purchase-buttons align-items-end mt-2",children:a(wn,{})})]})]}),a(v,{size:7,overflow:"hidden",children:a(k9,{})})]})},B9=s=>{const{page:e=null}=s,[t,r]=d.exports.useState(""),{currentOffer:i=null,setPurchaseOptions:n=null}=Ft();return d.exports.useEffect(()=>{i&&n(o=>{const l={...o};return l.extraData=t,l})},[i,t,n]),_(v,{children:[a(v,{className:"pt-2",center:!i,overflow:"hidden",children:_(J,{children:[!!e.localization.getImage(1)&&a("img",{alt:"",src:e.localization.getImage(1)}),a(C,{small:!0,center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]})}),_(v,{size:7,overflow:"hidden",children:[a(v,{className:"grid-bg item-picker p-2",size:7,overflow:"hidden",children:a(Nh,{})}),i&&a(J,{children:_(v,{grow:!0,gap:1,children:[a(C,{grow:!0,center:!0,truncate:!0,children:i.localizationName}),a(M,{justifyContent:"end",children:a(Ka,{alignItems:"end",className:"credits-bg py-1 px-2"})}),a(M,{gap:2,className:"purchase-buttons align-items-end mt-2",children:a(wn,{})})]})}),a("textarea",{className:"flex-grow-1 form-control w-100 trophy-text",defaultValue:t||"",onChange:o=>r(o.target.value)})]})]})},V9=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(Xt.NONE),{currentPage:n=null,catalogOptions:o=null}=Ft(),{purse:l=null,getCurrencyAmount:c=null}=vl(),{clubOffers:h=null}=o,u=d.exports.useCallback(O=>{switch(O.type){case Ga.PURCHASE_SUCCESS:i(Xt.NONE);return;case El.PURCHASE_FAILED:i(Xt.FAILED);return}},[]);Cs(Ga.PURCHASE_SUCCESS,u),Cs(El.PURCHASE_FAILED,u);const g=d.exports.useCallback(O=>{let A="";return O.months>0&&(A=E("catalog.vip.item.header.months",["num_months"],[O.months.toString()])),O.extraDays>0&&(A!==""&&(A+=" "),A+=" "+E("catalog.vip.item.header.days",["num_days"],[O.extraDays.toString()])),A},[]),m=d.exports.useCallback(()=>{if(!l)return"";const O=l.clubDays>0||l.clubPeriods>0?"extension.":"subscription.",A=e.months===0?"days":"months",N=e.months===0?e.extraDays:e.months;return E("catalog.vip.buy.confirm."+O+A).replace("%NUM_"+A.toUpperCase()+"%",N.toString())},[e,l]);d.exports.useCallback(()=>{let O=E("catalog.vip.buy.confirm.end_date");return O=O.replace("%month%",e.month.toString()),O=O.replace("%day%",e.day.toString()),O=O.replace("%year%",e.year.toString()),O},[e]);const p=d.exports.useMemo(()=>{const O=l.clubDays,N=l.clubPeriods*31+O;return E("catalog.vip.extend.info",["days"],[N.toString()])},[l]),f=d.exports.useCallback(()=>{e&&(i(Xt.PURCHASE),W(new ih(n.pageId,e.offerId,null,1)))},[e,n]),T=d.exports.useCallback(O=>{i(Xt.NONE),t(O)},[]),I=d.exports.useCallback(()=>{if(!e)return null;if(e.priceCredits>c(-1))return a(Y,{fullWidth:!0,variant:"danger",children:E("catalog.alert.notenough.title")});if(e.priceActivityPoints>c(e.priceActivityPointsType))return a(Y,{fullWidth:!0,variant:"danger",children:E("catalog.alert.notenough.activitypoints.title."+e.priceActivityPointsType)});switch(r){case Xt.CONFIRM:return a(Y,{variant:"warning",onClick:f,children:E("catalog.marketplace.confirm_title")});case Xt.PURCHASE:return a(Y,{variant:"primary",disabled:!0,children:a(bI,{})});case Xt.FAILED:return a(Y,{variant:"danger",disabled:!0,children:E("generic.failed")});case Xt.NONE:default:return a(Y,{variant:"success",onClick:()=>i(Xt.CONFIRM),children:E("buy")})}},[e,r,f,c]);return d.exports.useEffect(()=>{h||W(new cy(1))},[h]),_(v,{fullHeight:!0,children:[_(M,{fullHeight:!0,center:!0,overflow:"hidden",children:[n.localization.getImage(1)&&a("img",{alt:"",src:n.localization.getImage(1)}),_(v,{className:"px-2",children:[a(C,{bold:!0,children:E("catalog.vip.extend.title")}),a(C,{small:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:p}})]})]}),_(v,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[a(Bt,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:h&&h.length>0&&h.map((O,A)=>_(yt,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:e===O,className:"p-1",onClick:()=>T(O),children:[a("i",{className:"icon-hc-banner"}),_(v,{justifyContent:"end",gap:0,children:[a(C,{textEnd:!0,children:g(O)}),_(M,{justifyContent:"end",gap:1,children:[O.priceCredits>0&&_(M,{alignItems:"center",justifyContent:"end",gap:1,children:[a(C,{children:O.priceCredits}),a(Gs,{type:-1})]}),O.priceActivityPoints>0&&_(M,{alignItems:"center",justifyContent:"end",gap:1,children:[a(C,{children:O.priceActivityPoints}),a(Gs,{type:O.priceActivityPointsType})]})]})]})]},A))}),a(v,{size:5,overflow:"hidden",children:e&&a(v,{fullWidth:!0,grow:!0,justifyContent:"end",children:_(M,{alignItems:"end",children:[_(v,{grow:!0,gap:0,children:[a(C,{fontWeight:"bold",children:m()}),_(M,{gap:1,children:[e.priceCredits>0&&_(M,{alignItems:"center",justifyContent:"end",gap:1,children:[a(C,{children:e.priceCredits}),a(Gs,{type:-1})]}),e.priceActivityPoints>0&&_(M,{alignItems:"center",justifyContent:"end",gap:1,children:[a(C,{children:e.priceActivityPoints}),a(Gs,{type:e.priceActivityPointsType})]})]})]}),I()]})})}),a(C,{small:!0,center:!0,className:"pb-2",dangerouslySetInnerHTML:{__html:E("catalog.vip.buy.hccenter")}})]})]})},H9=s=>{const{text:e=null}=s,[t,r]=d.exports.useState(""),[i,n]=d.exports.useState(!1),{simpleAlert:o=null}=$t(),l=()=>{!t||!t.length||i||(W(new py(t)),n(!0))};return j(TC,c=>{const h=c.getParser();let u=E("catalog.alert.voucherredeem.ok.description");h.productName&&(u=E("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[h.productName,h.productDescription])),o(u,null,null,null,E("catalog.alert.voucherredeem.ok.title")),n(!1),r("")}),j(IC,c=>{const h=c.getParser();o(E(`catalog.alert.voucherredeem.error.description.${h.errorCode}`),null,null,null,E("catalog.alert.voucherredeem.error.title")),n(!1)}),_(v,{className:"voucher-box p-2",gap:1,children:[a(C,{className:"px-1",children:e}),_(M,{className:"voucher-form",gap:5,children:[a("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>r(c.target.value)}),a(Y,{variant:"primary",onClick:l,disabled:i,children:E("redeem")})]})]})},kh=s=>{const{item:e=null,position:t="relative",pointer:r=!0,overflow:i="hidden",fullHeight:n=!0,classNames:o=[],children:l=null,...c}=s,h=d.exports.useMemo(()=>{const g=["nitro-front-page-item"];return o.length&&g.push(...o),g},[o]);if(!e)return null;const u=Ee("image.library.url")+e.itemPromoImage;return _(n0,{imageUrl:u,classNames:h,position:t,fullHeight:n,pointer:r,overflow:i,...c,children:[a(C,{position:"absolute",variant:"white",className:"nitro-front-page-item-text p-2 m-2 bottom-0",children:e.itemName}),l]})},W9=s=>{const{page:e=null,hideNavigation:t=null}=s,{frontPageItems:r=[]}=Ft(),i=d.exports.useCallback(n=>{switch(n.type){case Ec.ITEM_CATALOGUE_PAGE:Le(`catalog/open/${n.catalogPageLocation}`);return;case Ec.ITEM_PRODUCT_OFFER:Le(`catalog/open/${n.productOfferId}`);return}},[]);return d.exports.useEffect(()=>{t()},[e,t]),_(qe,{children:[a(v,{size:4,children:r[0]&&a(kh,{item:r[0],onClick:n=>i(r[0])})}),_(v,{size:8,children:[r[1]&&a(kh,{item:r[1],onClick:n=>i(r[1])}),r[2]&&a(kh,{item:r[2],onClick:n=>i(r[2])}),r[3]&&a(kh,{item:r[3],onClick:n=>i(r[3])}),a(H9,{text:e.localization.getText(1)})]})]})},rp=1,bd=2,k0=s=>{const{offerData:e=null,type:t=bd,onClick:r=null}=s,i=d.exports.useMemo(()=>e?E((e.furniType===2?"wallItem":"roomItem")+`.name.${e.furniId}`):"",[e]),n=d.exports.useCallback(()=>{if(!e)return"";if(e.status===pl.SOLD)return E("catalog.marketplace.offer.sold");if(e.timeLeftMinutes<=0)return E("catalog.marketplace.offer.expired");const o=Math.max(1,e.timeLeftMinutes),l=Math.floor(o/60);let h=o-l*60+" "+E("catalog.marketplace.offer.minutes");return l>0&&(h=l+" "+E("catalog.marketplace.offer.hours")+" "+h),E("catalog.marketplace.offer.time_left",["time"],[h])},[e]);return _(yt,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[a(v,{style:{width:40,height:40},children:a(yt,{column:!1,itemImage:gq(e.furniType===Eh.TYPE_FLOOR?nt.FLOOR:nt.WALL,e.furniId,e.extraData),itemUniqueNumber:e.isUniqueLimitedItem?e.stuffData.uniqueNumber:0})}),_(v,{grow:!0,gap:0,children:[a(C,{fontWeight:"bold",children:i}),t===rp&&_(J,{children:[a(C,{children:E("catalog.marketplace.offer.price_own_item",["price"],[e.price.toString()])}),a(C,{children:n()})]}),t===bd&&_(J,{children:[a(C,{children:E("catalog.marketplace.offer.price_public_item",["price","average"],[e.price.toString(),e.averagePrice>0?e.averagePrice.toString():"-"])}),a(C,{children:E("catalog.marketplace.offer_count",["count"],[e.offerCount.toString()])})]})]}),_(v,{gap:1,children:[t===rp&&e.status!==pl.SOLD&&a(Y,{variant:"secondary",onClick:()=>r(e),children:E("catalog.marketplace.offer.pick")}),t===bd&&_(J,{children:[a(Y,{variant:"secondary",onClick:()=>r(e),children:E("buy")}),a(Y,{variant:"secondary",disabled:!0,children:E("catalog.marketplace.view_more")})]})]})]})},j9=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState([]),{simpleAlert:n=null}=$t();j(MA,h=>{const u=h.getParser();if(!u)return;const g=u.offers.map(m=>{const p=new Eh(m.offerId,m.furniId,m.furniType,m.extraData,m.stuffData,m.price,m.status,m.averagePrice,m.offerCount);return p.timeLeftMinutes=m.timeLeftMinutes,p});t(u.creditsWaiting),i(g)}),j(NA,h=>{const u=h.getParser();if(u){if(!u.success){n(E("catalog.marketplace.cancel_failed"),Ze.DEFAULT,null,null,E("catalog.marketplace.operation_failed.topic"));return}i(g=>g.filter(m=>m.offerId!==u.offerId))}});const o=d.exports.useMemo(()=>r.filter(h=>h.status===pl.SOLD),[r]),l=d.exports.useCallback(()=>{i(h=>{const u=o.map(g=>g.offerId);return h.filter(g=>u.indexOf(g.offerId)===-1)}),W(new Hv)},[o]),c=h=>{W(new Fv(h.offerId))};return d.exports.useEffect(()=>{W(new Bv)},[]),_(v,{overflow:"hidden",children:[e<=0&&a(C,{center:!0,className:"bg-muted rounded p-1",children:E("catalog.marketplace.redeem.no_sold_items")}),e>0&&_(v,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[a(C,{children:E("catalog.marketplace.redeem.get_credits",["count","credits"],[o.length.toString(),e.toString()])}),a(Y,{className:"mt-1",onClick:l,children:E("catalog.marketplace.offer.redeem")})]}),_(v,{gap:1,overflow:"hidden",children:[a(C,{truncate:!0,shrink:!0,fontWeight:"bold",children:E("catalog.marketplace.items_found",["count"],[r.length.toString()])}),a(v,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:r.length>0&&r.map(h=>a(k0,{offerData:h,type:rp,onClick:c},h.offerId))})]})]})},Y9=s=>{const{searchType:e=null,sortTypes:t=null,onSearch:r=null}=s,[i,n]=d.exports.useState(t?t[0]:3),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(0),m=d.exports.useCallback(f=>{n(f),(e===pr.BY_ACTIVITY||e===pr.BY_VALUE)&&r({minPrice:-1,maxPrice:-1,query:"",type:f})},[r,e]),p=d.exports.useCallback(()=>{const f=c>0?c:-1,T=u>0?u:-1;r({minPrice:f,maxPrice:T,type:i,query:o})},[u,c,r,o,i]);return d.exports.useEffect(()=>{if(!t||!t.length)return;const f=t[0];n(f),(e===pr.BY_ACTIVITY||pr.BY_VALUE===e)&&r({minPrice:-1,maxPrice:-1,query:"",type:f})},[r,e,t]),_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("catalog.marketplace.sort_order")}),a("select",{className:"form-select form-select-sm",value:i,onChange:f=>m(parseInt(f.target.value)),children:t.map(f=>a("option",{value:f,children:E(`catalog.marketplace.sort.${f}`)},f))})]}),e===pr.ADVANCED&&_(J,{children:[_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("catalog.marketplace.search_name")}),a("input",{className:"form-control form-control-sm",type:"text",value:o,onChange:f=>l(f.target.value)})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("catalog.marketplace.search_price")}),_(M,{fullWidth:!0,gap:1,children:[a("input",{className:"form-control form-control-sm",type:"number",min:0,value:c,onChange:f=>h(f.target.valueAsNumber)}),a("input",{className:"form-control form-control-sm",type:"number",min:0,value:u,onChange:f=>g(f.target.valueAsNumber)})]})]}),a(Y,{variant:"secondary",className:"mx-auto",onClick:p,children:E("generic.search")})]})]})},z9=[1,2],K9=[3,4,5,6],q9=[1,2,3,4,5,6],X9=s=>{const[e,t]=d.exports.useState(pr.BY_ACTIVITY),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState(new Map),[l,c]=d.exports.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:h=null}=vl(),{simpleAlert:u=null,showConfirm:g=null}=$t(),m=d.exports.useCallback(T=>{c(T),W(new Gv(T.minPrice,T.maxPrice,T.query,T.type))},[]),p=d.exports.useMemo(()=>{switch(e){case pr.BY_ACTIVITY:return K9;case pr.BY_VALUE:return z9;case pr.ADVANCED:return q9}return[]},[e]),f=d.exports.useCallback(T=>{if(T.price>h(-1)){u(E("catalog.alert.notenough.credits.description"),Ze.DEFAULT,null,null,E("catalog.alert.notenough.title"));return}const I=T.offerId;g(E("catalog.marketplace.confirm_header"),()=>{W(new Ef(I))},null,null,null,E("catalog.marketplace.confirm_title"))},[h,u,g]);return j(vA,T=>{const I=T.getParser();if(!I)return;const O=new Map;I.offers.forEach(A=>{const N=new Eh(A.offerId,A.furniId,A.furniType,A.extraData,A.stuffData,A.price,A.status,A.averagePrice,A.offerCount);N.timeLeftMinutes=A.timeLeftMinutes,O.set(A.offerId,N)}),i(I.totalItemsFound),o(O)}),j(AA,T=>{const I=T.getParser();if(I)switch(I.result){case 1:m(l);break;case 2:o(O=>{const A=new Map(O);return A.delete(I.requestedOfferId),A}),u(E("catalog.marketplace.not_available_header"),Ze.DEFAULT,null,null,E("catalog.marketplace.not_available_title"));break;case 3:o(O=>{const A=new Map(O),N=A.get(I.requestedOfferId);return N&&(N.offerId=I.offerId,N.price=I.newPrice,N.offerCount--,A.set(N.offerId,N)),A.delete(I.requestedOfferId),A}),g(E("catalog.marketplace.confirm_higher_header")+`
`+E("catalog.marketplace.confirm_price",["price"],[I.newPrice.toString()]),()=>{W(new Ef(I.offerId))},null,null,null,E("catalog.marketplace.confirm_higher_title"));break;case 4:u(E("catalog.alert.notenough.credits.description"),Ze.DEFAULT,null,null,E("catalog.alert.notenough.title"));break}}),_(J,{children:[_(sa,{children:[a(Y,{active:e===pr.BY_ACTIVITY,onClick:()=>t(pr.BY_ACTIVITY),children:E("catalog.marketplace.search_by_activity")}),a(Y,{active:e===pr.BY_VALUE,onClick:()=>t(pr.BY_VALUE),children:E("catalog.marketplace.search_by_value")}),a(Y,{active:e===pr.ADVANCED,onClick:()=>t(pr.ADVANCED),children:E("catalog.marketplace.search_advanced")})]}),a(Y9,{sortTypes:p,searchType:e,onSearch:m}),_(v,{gap:1,overflow:"hidden",children:[a(C,{truncate:!0,shrink:!0,fontWeight:"bold",children:E("catalog.marketplace.items_found",["count"],[n.size.toString()])}),a(v,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(n.values()).map((T,I)=>a(k0,{offerData:T,type:bd,onClick:f},I))})]})]})},Q9=s=>{const{page:e=null}=s,[t,r]=d.exports.useState(-1),[i,n]=d.exports.useState([]),[o,l]=d.exports.useState(-1),[c,h]=d.exports.useState([]),[u,g]=d.exports.useState(-1),[m,p]=d.exports.useState(!1),[f,T]=d.exports.useState("");d.exports.useState(!0);const[I,O]=d.exports.useState(-1),{currentOffer:A=null,setCurrentOffer:N=null,setPurchaseOptions:P=null,catalogOptions:y=null,roomPreviewer:D=null}=Ft(),{petPalettes:x=null}=y,w=d.exports.useMemo(()=>!c.length||u===-1?16777215:c[u][0],[c,u]),k=d.exports.useMemo(()=>t===-1||!i.length||o===-1?"":E(`pet.breed.${t}.${i[o].breedId}`),[t,i,o]),F=d.exports.useMemo(()=>{if(!i.length||o===-1)return"";const V=i[o].paletteId;let q=16777215;if(t<=7){if(u===-1)return"";q=c[u][0]}let Z=q.toString(16).toUpperCase();for(;Z.length<6;)Z="0"+Z;return`${V}
${Z}`},[i,o,t,c,u]),L=d.exports.useMemo(()=>{let V="";switch(I){case 1:V="catalog.alert.petname.long";break;case 2:V="catalog.alert.petname.short";break;case 3:V="catalog.alert.petname.chars";break;case 4:V="catalog.alert.petname.bobba";break}return!V||!V.length?"":E(V)},[I]),B=d.exports.useCallback(()=>{if(I===-1){W(new QD(f,1));return}if(I===0){W(new ih(e.pageId,A.offerId,`${f}
${F}`,1));return}},[e,A,f,F,I]);return j(Db,V=>{const q=V.getParser();O(q.result),q.result===0?B():zs(new El(-1))}),d.exports.useEffect(()=>{if(!e||!e.offers.length)return;const V=e.offers[0];N(V),r(hq(V.localizationId)),p(!1)},[e,N]),d.exports.useEffect(()=>{if(!A)return;const V=A.product.productData;if(V){if(x)for(const q of x){if(q.breed!==V.type)continue;const Z=[];for(const H of q.palettes)H.sellable&&Z.push(H);l(Z.length?0:-1),n(Z);return}l(-1),n([]),W(new _y(V.type))}},[A,x]),d.exports.useEffect(()=>{if(t===-1)return;const V=dq(t,i);g(V.length?0:-1),h(V)},[t,i]),d.exports.useEffect(()=>{if(!D||(D.reset(!1),t===-1||!i.length||o===-1))return;let V=`${t} ${i[o].paletteId}`;t<=7&&(V+=` ${w.toString(16)}`),D.addPetIntoRoom(V)},[D,t,i,o,w]),d.exports.useEffect(()=>{O(-1)},[f]),A?a(v,{children:_(v,{center:!A,size:5,overflow:"hidden",children:[!A&&_(J,{children:[!!e.localization.getImage(1)&&a("img",{alt:"",src:e.localization.getImage(1)}),a(C,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),A&&_(J,{children:[_(K,{position:"relative",overflow:"hidden",children:[a(Ml,{}),a(Ka,{className:"credits-default-layout credits-bg py-1 px-2 bottom-1 end-1",justifyContent:"end",alignItems:"end"}),a(Il,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),t>-1&&t<=7&&a(Y,{position:"absolute",className:"bottom-1 start-1",onClick:V=>p(!m),children:a(tS,{className:"fa-icon"})})]}),a(v,{size:7,overflow:"hidden",children:_(Bt,{className:"grid-bg group-furni-picker p-2",columnCount:7,children:[!m&&i.length>0&&i.map((V,q)=>a(yt,{itemActive:o===q,onClick:Z=>l(q),children:a(Na,{typeId:t,paletteId:V.paletteId,direction:2,headOnly:!0})},q)),m&&c.length>0&&c.map((V,q)=>a(yt,{itemHighlight:!0,itemActive:u===q,itemColor:Sr.int2rgb(V[0]),className:"clear-bg",onClick:Z=>g(q)},q))]})}),_(v,{grow:!0,gap:1,children:[a(C,{truncate:!0,children:k}),_(v,{grow:!0,gap:1,children:[a("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:E("widgets.petpackage.name.title"),value:f,onChange:V=>T(V.target.value)}),I>0&&a(K,{className:"invalid-feedback d-block m-0",children:L})]}),a(M,{gap:2,className:"purchase-buttons align-items-end mt-2",children:a(wn,{purchaseCallback:B})})]})]})]})}):null},$9=s=>{const{offer:e=null,isAvailable:t=!1,daysRequired:r=0,onSelect:i=null}=s,n=d.exports.useCallback(()=>{if(!e||!e.products.length)return"";const l=e.products[0];return Ad.getProductImageUrl(l.productType,l.furniClassId,l.extraParam)},[e]),o=d.exports.useCallback(()=>{if(!e||!e.products.length)return"";const l=e.products[0],c=Ad.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.name."+l.furniClassId:"roomItem.name."+l.furniClassId;return E(c)},[e]);return d.exports.useCallback(()=>{if(!e||!e.products.length)return"";const l=e.products[0],c=Ad.getProductCategory(l.productType,l.furniClassId)===2?"wallItem.desc."+l.furniClassId:"roomItem.desc."+l.furniClassId;return E(c)},[e]),d.exports.useCallback(()=>Math.floor(r/31),[r]),_(yt,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[a(ja,{imageUrl:n()}),a(C,{grow:!0,fontWeight:"bold",children:o()}),a(Y,{variant:"secondary",onClick:()=>i(e.localizationId),disabled:!t,children:E("catalog.club_gift.select")})]})},J9=s=>{const{purse:e=null}=vl(),{catalogOptions:t=null,setCatalogOptions:r=null}=Ft(),{clubGifts:i=null}=t,{showConfirm:n=null}=$t(),o=d.exports.useCallback(()=>i?i.giftsAvailable>0?E("catalog.club_gift.available",["amount"],[i.giftsAvailable.toString()]):i.daysUntilNextGift>0?E("catalog.club_gift.days_until_next",["days"],[i.daysUntilNextGift.toString()]):e.isVip?E("catalog.club_gift.not_available"):E("catalog.club_gift.no_club"):"",[i,e]),l=d.exports.useCallback(h=>{n(E("catalog.club_gift.confirm"),()=>{W(new Ey(h)),r(u=>(u.clubGifts.giftsAvailable--,{...u}))},null)},[r,n]),c=d.exports.useMemo(()=>i.offers.sort((u,g)=>i.getOfferExtraData(u.offerId).daysRequired-i.getOfferExtraData(g.offerId).daysRequired),[i]);return _(J,{children:[a(C,{truncate:!0,shrink:!0,fontWeight:"bold",children:o()}),a(Bt,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:i.offers.length>0&&c.map(h=>a($9,{offer:h,isAvailable:i.getOfferExtraData(h.offerId).isSelectable&&i.giftsAvailable>0,onSelect:l,daysRequired:i.getOfferExtraData(h.offerId).daysRequired},h.offerId))})]})},Z9=(s,e)=>{if(!s)return null;const t={page:s,hideNavigation:e};switch(s.layoutCode){case"frontpage_featured":return null;case"frontpage4":return a(W9,{...t});case"pets":return a(Q9,{...t});case"pets2":return a(D9,{...t});case"pets3":return a(x0,{...t});case"vip_buy":return a(V9,{...t});case"guild_frontpage":return a(v9,{...t});case"guild_forum":return a(y9,{...t});case"guild_custom_furni":return a(b9,{...t});case"club_gifts":return a(J9,{...t});case"marketplace_own_items":return a(j9,{...t});case"marketplace":return a(X9,{...t});case"single_bundle":return a(U9,{...t});case"room_bundle":return a(L9,{...t});case"spaces_new":return a(G9,{...t});case"trophies":return a(B9,{...t});case"info_loyalty":return a(M9,{...t});case"badge_display":return a(R9,{...t});case"roomads":return a(P9,{...t});case"default_3x3_color_grouping":return a(C9,{...t});case"soundmachine":return a(w9,{...t});case"bots":case"default_3x3":default:return a(A9,{...t})}},eQ=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState("0"),{catalogOptions:l=null,setCatalogOptions:c=null}=Ft(),{marketplaceConfiguration:h=null}=l,{showConfirm:u=null}=$t(),g=I=>{o(I);const O=parseInt(I);isNaN(O)||O===r||i(parseInt(I))};if(j(bA,I=>{const O=I.getParser();c(A=>{const N={...A};return N.marketplaceConfiguration=O,N})}),Cs(vI.POST_MARKETPLACE,I=>t(I.item)),d.exports.useEffect(()=>{!e||h||W(new kv)},[e,h]),d.exports.useEffect(()=>{if(e)return()=>i(0)},[e]),!h||!e)return null;const m=e?E(e.isWallItem?"wallItem.name."+e.type:"roomItem.name."+e.type):"",p=e?E(e.isWallItem?"wallItem.desc."+e.type:"roomItem.desc."+e.type):"",f=()=>Math.max(Math.ceil(h.commission*.01*r),1),T=()=>{!e||r<h.minimumPrice||u(E("inventory.marketplace.confirm_offer.info",["furniname","price"],[m,r.toString()]),()=>{W(new Vv(r,e.isWallItem?2:1,e.id)),t(null)},()=>{t(null)},null,null,E("inventory.marketplace.confirm_offer.title"))};return _(Be,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary",children:[a(He,{headerText:E("inventory.marketplace.make_offer.title"),onCloseClick:I=>t(null)}),a(Ge,{overflow:"hidden",children:_(qe,{fullHeight:!0,children:[a(v,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:a(NI,{productType:e.isWallItem?nt.WALL:nt.FLOOR,productClassId:e.type,extraData:e.extra.toString()})}),_(v,{size:8,justifyContent:"between",overflow:"hidden",children:[_(v,{grow:!0,gap:1,children:[a(C,{fontWeight:"bold",children:m}),a(C,{truncate:!0,shrink:!0,children:p})]}),_(v,{overflow:"auto",children:[a(C,{italics:!0,children:E("inventory.marketplace.make_offer.expiration_info",["time"],[h.offerTime.toString()])}),_("div",{className:"input-group has-validation",children:[a("input",{className:"form-control form-control-sm",type:"number",min:0,value:n,onChange:I=>g(I.target.value),placeholder:E("inventory.marketplace.make_offer.price_request")}),(r<h.minimumPrice||isNaN(r))&&a(K,{className:"invalid-feedback d-block",children:E("inventory.marketplace.make_offer.min_price",["minprice"],[h.minimumPrice.toString()])}),r>h.maximumPrice&&!isNaN(r)&&a(K,{className:"invalid-feedback d-block",children:E("inventory.marketplace.make_offer.max_price",["maxprice"],[h.maximumPrice.toString()])}),!(r<h.minimumPrice||r>h.maximumPrice||isNaN(r))&&a(K,{className:"invalid-feedback d-block",children:E("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[f().toString(),(r+f()).toString()])})]}),a(Y,{disabled:r<h.minimumPrice||r>h.maximumPrice||isNaN(r),onClick:T,children:E("inventory.marketplace.make_offer.post")})]})]})]})})]})},tQ=s=>{const{isVisible:e=!1,setIsVisible:t=null,rootNode:r=null,currentPage:i=null,navigationHidden:n=!1,setNavigationHidden:o=null,activeNodes:l=[],searchResult:c=null,setSearchResult:h=null,openPageByName:u=null,openPageByOfferId:g=null,activateNode:m=null,getNodeById:p}=Ft();return d.exports.useEffect(()=>{const f={linkReceived:T=>{const I=T.split("/");if(!(I.length<2))switch(I[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(O=>!O);return;case"open":if(I.length>2)if(I.length===4)switch(I[2]){case"offerId":g(parseInt(I[3]));return}else u(I[2]);else t(!0);return}},eventUrlPrefix:"catalog/"};return xs(f),()=>ws(f)},[t,g,u]),_(J,{children:[e&&_(Be,{uniqueKey:"catalog",className:"nitro-catalog",style:Ee("catalog.headers")?{width:710}:{},children:[a(He,{headerText:E("catalog.title"),onCloseClick:f=>t(!1)}),a(ca,{subClassName:"w-100",children:r&&r.children.length>0&&r.children.map(f=>f.isVisible?a(Dn,{isActive:f.isActive,onClick:T=>{c&&h(null),m(f)},children:_(M,{gap:Ee("catalog.tab.icons")?1:0,alignItems:"center",children:[Ee("catalog.tab.icons")&&a(LI,{icon:f.iconId}),f.localization]})},f.pageId):null)}),a(p9,{node:r}),a(Ge,{children:_(qe,{children:[!n&&a(v,{className:"catalog-left",size:4,overflow:"hidden",children:l&&l.length>0&&a(f9,{node:l[0]})}),a(v,{size:n?12:8,overflow:"hidden",children:Z9(i,()=>o(!0))})]})})]}),a(g9,{}),a(eQ,{})]})},sQ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(""),{chatHistory:n=[]}=Eg(),o=d.exports.useRef(null),l=d.exports.useMemo(()=>{if(r.length===0)return n;let c=r.toLowerCase();return n.filter(h=>h.message&&h.message.toLowerCase().includes(c)||h.name&&h.name.toLowerCase().includes(c))},[n,r]);return d.exports.useEffect(()=>{o&&o.current&&e&&(o.current.scrollTop=o.current.scrollHeight)},[e]),d.exports.useEffect(()=>{const c={linkReceived:h=>{const u=h.split("/");if(!(u.length<2))switch(u[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(g=>!g);return}},eventUrlPrefix:"chat-history/"};return xs(c),()=>ws(c)},[]),e?a(J,{children:e&&_(M,{gap:2,className:"nitro-chat-history",children:[a(v,{className:"chat-history-content h-100",children:a(v,{className:"h-100",children:a(mg,{rows:l,estimateSize:35,rowRender:c=>_(M,{alignItems:"center",className:"p-1",gap:2,children:[a(C,{variant:"muted",children:c.timestamp}),c.type===rn.TYPE_CHAT&&_("div",{className:"bubble-container",style:{position:"relative"},children:[c.style===0&&a("div",{className:"user-container-bg",style:{backgroundColor:c.color}}),_("div",{className:`chat-bubble bubble-${c.style} type-${c.chatType}`,style:{maxWidth:"100%"},children:[a("div",{className:"user-container",children:c.imageUrl&&c.imageUrl.length>0&&a("div",{className:"user-image",style:{backgroundImage:`url(${c.imageUrl})`}})}),_("div",{className:"chat-content",children:[a("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${c.name}: `}}),a("span",{className:"message",dangerouslySetInnerHTML:{__html:`${c.message}`}})]})]})]}),c.type===rn.TYPE_ROOM_INFO&&_(J,{children:[a("i",{className:"icon icon-small-room"}),a(C,{textBreak:!0,wrap:!0,grow:!0,children:c.name})]})]})})})}),a(M,{className:"chat-toggle",onClick:c=>t(!1)})]})}):null},sn=32,Go=64,vu="x0123456789abcdefghijklmnopq";class ks{}ks.DOOR=0;ks.UP=1;ks.DOWN=2;ks.SET=3;ks.UNSET=4;const rQ={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class iQ{constructor(){this._currentAction=ks.SET,this._currentHeight=vu[1]}get currentAction(){return this._currentAction}set currentAction(e){this._currentAction=e}get currentHeight(){return this._currentHeight}set currentHeight(e){this._currentHeight=e}clear(){this._currentAction=ks.SET,this._currentHeight=vu[1]}}class Gh{constructor(e,t){this._height=e,this._isBlocked=t}get height(){return this._height}set height(e){this._height=e}get isBlocked(){return this._isBlocked}set isBlocked(e){this._isBlocked=e}}const nQ=(s,e)=>{let t=s*sn/2-e*sn/2;const r=s*sn/4+e*sn/4;return t=t+1024,[t,r]},aQ=(s,e)=>{const t=s-1024,r=(t/(sn/2)+e/(sn/4))/2,i=(e/(sn/4)-t/(sn/2))/2;return[r,i]},T_=s=>{switch(s=parseInt(s.toString()),s){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},Bh=s=>{switch(s){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},Zo=class extends sr{constructor(){const s=sn*Go+20,e=sn*Go/2+100;super({width:s,height:e,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._isShiftPressed=!1,this._selectionStart=null,this._selectionEnd=null,this._undoStack=[],this._redoStack=[],this._maxHistoryLength=50,this._tilemap=[],this._doorLocation=new vr(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new vr(-1,-1),this._actionSettings=new iQ,this.registerKeyboardListeners()}initialize(){if(this._isInitialized)return;const s=di().getCollection("floor_editor");s&&(this._assetCollection=s,this._tilemapRenderer=new $U(s.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerKeyboardListeners(){window.addEventListener("keydown",s=>{s.key==="Shift"&&(this._isShiftPressed=!0),s.key.toLowerCase()==="z"&&(s.ctrlKey||s.metaKey)&&(s.preventDefault(),this.undo()),s.key.toLowerCase()==="y"&&(s.ctrlKey||s.metaKey)&&(s.preventDefault(),this.redo()),s.key.toLowerCase()==="z"&&(s.ctrlKey||s.metaKey)&&s.shiftKey&&(s.preventDefault(),this.redo())}),window.addEventListener("keyup",s=>{s.key==="Shift"&&(this._isShiftPressed=!1,this._selectionStart=null,this._selectionEnd=null,this.renderTiles())})}registerEventListeners(){const s=new vr;this._tilemapRenderer.containsPoint=e=>(this._tilemapRenderer.worldTransform.applyInverse(e,s),this.getTileFromPosition(s)!==null),this._tilemapRenderer.on("pointerup",()=>{this._isHolding=!1,this._isShiftPressed&&this._selectionStart&&this._selectionEnd&&(this.getSelectionAreaSize(),this.applySelectionArea(),this._selectionStart=null,this._selectionEnd=null,this.renderTiles())}),this._tilemapRenderer.on("pointerout",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",e=>{if(!(e.data.originalEvent instanceof PointerEvent)&&!(e.data.originalEvent instanceof TouchEvent))return;const t=e.data.originalEvent;if(t instanceof MouseEvent&&t.button===2)return;const r=e.data.global,i=this.getTileFromPosition(r);i&&(this.pushUndoState(),this._isShiftPressed?(this._selectionStart?this._selectionEnd=new vr(i.x,i.y):(this._selectionStart=new vr(i.x,i.y),this._selectionEnd=new vr(i.x,i.y)),this._isHolding=!0,this.applyCurrentActionToSelectionArea(),this.renderTiles()):(this._isHolding=!0,this._lastUsedTile.x=i.x,this._lastUsedTile.y=i.y,this.onClick(i.x,i.y)))}),this._tilemapRenderer.on("pointermove",e=>{if(!this._isHolding)return;const t=e.data.global,r=this.getTileFromPosition(t);r&&(this._isShiftPressed&&this._selectionStart?(this._selectionEnd=new vr(r.x,r.y),this.applyCurrentActionToSelectionArea(),this.renderTiles()):(this._lastUsedTile.x!==r.x||this._lastUsedTile.y!==r.y)&&(this._isHolding||this.pushUndoState(),this._lastUsedTile.x=r.x,this._lastUsedTile.y=r.y,this.onClick(r.x,r.y)))})}getTileFromPosition(s){const e=this._tilemapRenderer.pointsBuf,t=yU,r=e.length;for(let i=0;i<r;i+=t){const n=i+t,o=e.slice(i,n),l=sn,c=sn/2,h=Math.floor(s.x),u=Math.floor(s.y),g=o[2],m=o[3],p=g+l/2,f=m+c/2,T=Math.abs(h-p),I=Math.abs(u-f);if(T/(l*.5)+I/(c*.5)<=1){const[A,N]=aQ(g,m);return new vr(A,N)}}return null}getSelectionAreaSize(){if(!this._selectionStart||!this._selectionEnd)return 0;const s=Math.min(this._selectionStart.x,this._selectionEnd.x),e=Math.max(this._selectionStart.x,this._selectionEnd.x),t=Math.min(this._selectionStart.y,this._selectionEnd.y),r=Math.max(this._selectionStart.y,this._selectionEnd.y);return(e-s+1)*(r-t+1)}applySelectionArea(){if(!this._selectionStart||!this._selectionEnd)return;const s=Math.min(this._selectionStart.x,this._selectionEnd.x),e=Math.max(this._selectionStart.x,this._selectionEnd.x),t=Math.min(this._selectionStart.y,this._selectionEnd.y),r=Math.max(this._selectionStart.y,this._selectionEnd.y);for(let i=t;i<=r;i++)for(let n=s;n<=e;n++)this.applyActionToTile(n,i)}applyCurrentActionToSelectionArea(){if(!this._selectionStart||!this._selectionEnd)return;const s=Math.min(this._selectionStart.x,this._selectionEnd.x),e=Math.max(this._selectionStart.x,this._selectionEnd.x),t=Math.min(this._selectionStart.y,this._selectionEnd.y),r=Math.max(this._selectionStart.y,this._selectionEnd.y);for(let i=t;i<=r;i++)for(let n=s;n<=e;n++)this.applyActionToTile(n,i)}applyActionToTile(s,e){const t=this._tilemap[e][s],r=vu.indexOf(t.height);let i=0;switch(this._actionSettings.currentAction){case ks.DOOR:t.height!=="x"&&(this._doorLocation.x=s,this._doorLocation.y=e);return;case ks.UP:if(t.height==="x")return;i=r+1;break;case ks.DOWN:if(t.height==="x"||r<=1)return;i=r-1;break;case ks.SET:i=vu.indexOf(this._actionSettings.currentHeight);break;case ks.UNSET:if(t.height==="x")return;i=0;break}if(i===-1||r===i)return;const n=i===0?"x":vu[i];n!=="x"&&(s+1>this._width&&(this._width=s+1),e+1>this._height&&(this._height=e+1)),this._tilemap[e][s].height=n}onClick(s,e){this.applyActionToTile(s,e),this.renderTiles()}renderTiles(){this._tilemapRenderer.clear();for(let s=0;s<this._tilemap.length;s++)for(let e=0;e<this._tilemap[s].length;e++){const t=this._tilemap[s][e];let r=t.height;t.height==="x"?r="x":this._doorLocation.x===e&&this._doorLocation.y===s?r=Zo.TILE_DOOR:t.isBlocked&&(r=Zo.TILE_BLOCKED);const[i,n]=nQ(e,s);this._tilemapRenderer.tile(this._assetCollection.getTexture(`floor_editor_${r}`),i,n)}}pushUndoState(){if(!this._tilemap||this._tilemap.length===0)return;const s=this._tilemap.map(e=>e.map(t=>t.height));this._undoStack.push(s),this._undoStack.length>this._maxHistoryLength&&this._undoStack.shift(),this._redoStack=[]}restoreState(s){if(s){for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++){const r=s[e][t];this._tilemap[e]&&this._tilemap[e][t]&&(this._tilemap[e][t].height=r)}this.renderTiles()}}undo(){if(this._undoStack.length===0)return;const s=this._tilemap.map(t=>t.map(r=>r.height));this._redoStack.push(s);const e=this._undoStack.pop();this.restoreState(e)}redo(){if(this._redoStack.length===0)return;const s=this._tilemap.map(t=>t.map(r=>r.height));this._undoStack.push(s);const e=this._redoStack.pop();this.restoreState(e)}setTilemap(s,e){this._tilemap=[];const t=s.split("\r");let r=0,i=t.length;for(let n=0;n<i;n++){const o=t[n];if(o.length===0){t.splice(n,1),i=t.length,n--;continue}o.length>r&&(r=o.length)}for(let n=0;n<i;n++){this._tilemap[n]=[];const o=t[n];for(let l=0;l<r;l++){const c=e[n]&&e[n][l]||!1,h=o[l];h!=="x"&&h!=="X"&&h?this._tilemap[n][l]=new Gh(h,c):this._tilemap[n][l]=new Gh("x",c)}for(let l=r;l<Go;l++)this._tilemap[n][l]=new Gh("x",!1)}for(let n=i;n<Go;n++){this._tilemap[n]||(this._tilemap[n]=[]);for(let o=0;o<Go;o++)this._tilemap[n][o]=new Gh("x",!1)}this._width=r,this._height=i}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let t=Go-1;t>=0;t--)if(this._tilemap[t])for(let r=Go-1;r>=0;r--){if(!this._tilemap[t][r])continue;this._tilemap[t][r].height!=="x"&&(r+1>this._width&&(this._width=r+1),t+1>this._height&&(this._height=t+1))}}const e=[];for(let t=0;t<this._height;t++){const r=[];for(let i=0;i<this._width;i++){const n=this._tilemap[t][i];r[i]=n.height}e[t]=r.join("")}return e.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear(),this._selectionStart=null,this._selectionEnd=null,this._isShiftPressed=!1,this._undoStack=[],this._redoStack=[]}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(s){this._doorLocation=s}get actionSettings(){return this._actionSettings}static get instance(){return Zo._INSTANCE||(Zo._INSTANCE=new Zo),Zo._INSTANCE}};let mr=Zo;mr._INSTANCE=null;mr.TILE_BLOCKED="r_blocked";mr.TILE_DOOR="r_door";const G0=d.exports.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),oQ=s=>a(G0.Provider,{...s}),wI=()=>d.exports.useContext(G0),lQ=s=>{const{gap:e=1,children:t=null,...r}=s,[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),{originalFloorplanSettings:c=null,setOriginalFloorplanSettings:h=null,setVisualizationSettings:u=null}=wI(),g=d.exports.useRef(null);j($N,p=>{const f=p.getParser();h(T=>{const I={...T};return I.reservedTiles=f.blockedTilesMap,mr.instance.setTilemap(I.tilemap,I.reservedTiles),I}),n(!0),g.current.scrollTo(mr.instance.view.width/3,0)}),j(Yd,p=>{const f=p.getParser();h(T=>{const I={...T};return I.entryPoint=[f.x,f.y],I.entryPointDir=f.direction,I}),u(T=>{const I={...T};return I.entryPointDir=f.direction,I}),mr.instance.doorLocation=new vr(f.x,f.y),l(!0)});const m=p=>{const f=g.current;if(f)switch(p){case"up":f.scrollBy({top:-10});break;case"down":f.scrollBy({top:10});break;case"left":f.scrollBy({left:-10});break;case"right":f.scrollBy({left:10});break}};return d.exports.useEffect(()=>()=>{mr.instance.clear(),u(p=>({wallHeight:c.wallHeight,thicknessWall:c.thicknessWall,thicknessFloor:c.thicknessFloor,entryPointDir:p.entryPointDir}))},[c.thicknessFloor,c.thicknessWall,c.wallHeight,u]),d.exports.useEffect(()=>{!o||!i||mr.instance.renderTiles()},[o,i]),d.exports.useEffect(()=>{W(new ID),W(new ED),mr.instance.tilemapRenderer.interactive=!0,g.current&&g.current.appendChild(mr.instance.renderer.view)},[]),_(v,{gap:e,...r,children:[_(qe,{overflow:"hidden",gap:1,children:[a(v,{center:!0,size:1,children:a(Y,{className:"d-md-none",onClick:p=>m("left"),children:a(sS,{className:"fa-icon"})})}),_(v,{overflow:"hidden",size:10,gap:1,children:[a(M,{justifyContent:"center",className:"d-md-none",children:a(Y,{shrink:!0,onClick:p=>m("up"),children:a(vU,{className:"fa-icon"})})}),a(K,{overflow:"auto",innerRef:g}),a(M,{justifyContent:"center",className:"d-md-none",children:a(Y,{shrink:!0,onClick:p=>m("down"),children:a(MU,{className:"fa-icon"})})})]}),a(v,{center:!0,size:1,children:a(Y,{className:"d-md-none",onClick:p=>m("right"),children:a(rS,{className:"fa-icon"})})})]}),t]})},jT=s=>s.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),cQ=s=>{const{onCloseClick:e=null}=s,[t,r]=d.exports.useState(""),{originalFloorplanSettings:i=null}=wI(),n=()=>{W(new vE(t.split(`
`).join("\r"),i.entryPoint[0],i.entryPoint[1],i.entryPointDir,T_(i.thicknessWall),T_(i.thicknessFloor),i.wallHeight-1))};return v0(()=>{r(jT(i.tilemap))}),_(Be,{theme:"primary",className:"floorplan-import-export",children:[a(He,{headerText:E("floor.plan.editor.import.export"),onCloseClick:e}),_(Ge,{children:[a("textarea",{className:"h-100",value:t,onChange:o=>r(o.target.value)}),_(M,{justifyContent:"between",children:[a(Y,{onClick:o=>r(jT(i.tilemap)),children:E("floor.plan.editor.revert.to.last.received.map")}),a(Y,{onClick:n,children:E("floor.plan.editor.save")})]})]})]})},YT=0,Vh=16,uQ=0,hQ=26,dQ=s=>{const{visualizationSettings:e=null,setVisualizationSettings:t=null}=wI(),[r,i]=d.exports.useState(ks.SET),[n,o]=d.exports.useState(0),l=T=>{i(T),mr.instance.actionSettings.currentAction=T},c=()=>{t(T=>{const I={...T};return I.entryPointDir<7?++I.entryPointDir:I.entryPointDir=0,I})},h=T=>{(isNaN(T)||T<=0)&&(T=0),T>26&&(T=26),o(T),mr.instance.actionSettings.currentHeight=T.toString(36)},u=T=>{t(I=>{const O={...I};return O.thicknessFloor=T,O})},g=T=>{t(I=>{const O={...I};return O.thicknessWall=T,O})},m=T=>{(isNaN(T)||T<=0)&&(T=YT),T>Vh&&(T=Vh),t(I=>{const O={...I};return O.wallHeight=T,O})},p=()=>{let T=e.wallHeight+1;T>Vh&&(T=Vh),m(T)},f=()=>{let T=e.wallHeight-1;T<=0&&(T=YT),m(T)};return _(v,{children:[_(M,{gap:1,children:[_(v,{size:5,gap:1,children:[a(C,{bold:!0,children:E("floor.plan.editor.draw.mode")}),_(M,{gap:3,children:[_(M,{gap:1,children:[a(yt,{itemActive:r===ks.SET,onClick:T=>l(ks.SET),children:a("i",{className:"icon icon-set-tile"})}),a(yt,{itemActive:r===ks.UNSET,onClick:T=>l(ks.UNSET),children:a("i",{className:"icon icon-unset-tile"})})]}),_(M,{gap:1,children:[a(yt,{itemActive:r===ks.UP,onClick:T=>l(ks.UP),children:a("i",{className:"icon icon-increase-height"})}),a(yt,{itemActive:r===ks.DOWN,onClick:T=>l(ks.DOWN),children:a("i",{className:"icon icon-decrease-height"})})]}),a(yt,{itemActive:r===ks.DOOR,onClick:T=>l(ks.DOOR),children:a("i",{className:"icon icon-set-door"})})]})]}),_(v,{alignItems:"center",size:4,children:[a(C,{bold:!0,children:E("floor.plan.editor.enter.direction")}),a("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:c})]}),_(v,{size:3,children:[a(C,{bold:!0,children:E("floor.editor.wall.height")}),_(M,{alignItems:"center",gap:1,children:[a(ZR,{className:"cursor-pointer fa-icon",onClick:f}),a("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:T=>m(T.target.valueAsNumber)}),a(eS,{className:"cursor-pointer fa-icon",onClick:p})]})]})]}),_(M,{gap:1,children:[_(v,{size:6,children:[_(C,{bold:!0,children:[E("floor.plan.editor.tile.height"),": ",n]}),a(ts,{className:"nitro-slider",min:uQ,max:hQ,step:1,value:n,onChange:T=>h(T),renderThumb:({style:T,...I},O)=>a("div",{style:{backgroundColor:`#${rQ[O.valueNow.toString(33)]}`,...T},...I,children:O.valueNow})})]}),_(v,{size:6,children:[a(C,{bold:!0,children:E("floor.plan.editor.room.options")}),_(M,{className:"align-items-center",children:[_("select",{className:"form-control form-control-sm",value:e.thicknessWall,onChange:T=>g(parseInt(T.target.value)),children:[a("option",{value:0,children:E("navigator.roomsettings.wall_thickness.thinnest")}),a("option",{value:1,children:E("navigator.roomsettings.wall_thickness.thin")}),a("option",{value:2,children:E("navigator.roomsettings.wall_thickness.normal")}),a("option",{value:3,children:E("navigator.roomsettings.wall_thickness.thick")})]}),_("select",{className:"form-control form-control-sm",value:e.thicknessFloor,onChange:T=>u(parseInt(T.target.value)),children:[a("option",{value:0,children:E("navigator.roomsettings.floor_thickness.thinnest")}),a("option",{value:1,children:E("navigator.roomsettings.floor_thickness.thin")}),a("option",{value:2,children:E("navigator.roomsettings.floor_thickness.normal")}),a("option",{value:3,children:E("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},_Q=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[l,c]=d.exports.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),h=()=>{W(new vE(mr.instance.getCurrentTilemapString(),mr.instance.doorLocation.x,mr.instance.doorLocation.y,l.entryPointDir,T_(l.thicknessWall),T_(l.thicknessFloor),l.wallHeight-1))},u=()=>{c({wallHeight:n.wallHeight,thicknessWall:n.thicknessWall,thicknessFloor:n.thicknessFloor,entryPointDir:n.entryPointDir}),mr.instance.doorLocation=new vr(n.entryPoint[0],n.entryPoint[1]),mr.instance.setTilemap(n.tilemap,n.reservedTiles),mr.instance.renderTiles()};return _t(lt.DISPOSED,g=>t(!1)),j(jd,g=>{const m=g.getParser();o(p=>{const f={...p};return f.tilemap=m.model,f.wallHeight=m.wallHeight+1,f}),c(p=>{const f={...p};return f.wallHeight=m.wallHeight+1,f})}),j(zd,g=>{const m=g.getParser();o(p=>{const f={...p};return f.thicknessFloor=Bh(m.thicknessFloor),f.thicknessWall=Bh(m.thicknessWall),f}),c(p=>{const f={...p};return f.thicknessFloor=Bh(m.thicknessFloor),f.thicknessWall=Bh(m.thicknessWall),f})}),d.exports.useEffect(()=>{const g={linkReceived:m=>{const p=m.split("/");if(!(p.length<2))switch(p[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(f=>!f);return}},eventUrlPrefix:"floor-editor/"};return xs(g),()=>ws(g)},[]),d.exports.useEffect(()=>{mr.instance.initialize()},[]),_(oQ,{value:{originalFloorplanSettings:n,setOriginalFloorplanSettings:o,visualizationSettings:l,setVisualizationSettings:c},children:[e&&_(Be,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary",children:[a(He,{headerText:E("floor.plan.editor.title"),onCloseClick:()=>t(!1)}),_(Ge,{overflow:"hidden",children:[a(dQ,{}),a(lQ,{overflow:"hidden"}),_(M,{justifyContent:"between",children:[a(Y,{onClick:u,children:E("floor.plan.editor.reload")}),_(sa,{children:[a(Y,{disabled:!0,children:E("floor.plan.editor.preview")}),a(Y,{onClick:g=>i(!0),children:E("floor.plan.editor.import.export")}),a(Y,{onClick:h,children:E("floor.plan.editor.save")})]})]})]})]}),r&&a(cQ,{onCloseClick:()=>i(!1)})]})},gQ=s=>{const{friend:e=null}=s,[t,r]=d.exports.useState(!1),{followFriend:i=null}=Oi(),n=d.exports.useRef();return d.exports.useEffect(()=>{const o=l=>{const c=n.current;c&&l.target!==c&&!c.contains(l.target)&&r(!1)};return document.addEventListener(fe.MOUSE_CLICK,o),()=>document.removeEventListener(fe.MOUSE_CLICK,o)},[]),e?_("div",{ref:n,className:"btn find-friends-active friend-bar-item "+(t?"friend-bar-item-active":""),onClick:o=>r(l=>!l),children:[_("div",{className:`friend-bar-item-head position-absolute ${e.id>0?"avatar":"group"}`,children:[e.id>0&&a(Ts,{headOnly:!0,figure:e.figure,direction:2}),e.id<=0&&a(as,{isGroup:!0,badgeCode:e.figure})]}),a("div",{className:"friend-bar-text",children:e.name}),t&&_("div",{className:"d-flex pt-3 justify-content-between",children:[a(K,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:o=>dg(e.id)}),e.followingAllowed&&a(K,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:o=>i(e)}),a(K,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:o=>ri(e.id)})]})]}):_("div",{ref:n,className:"btn find-friends friend-bar-item friend-bar-search",children:[a("div",{className:"friend-bar-item-head position-absolute"}),a("div",{className:"friend-bar-text",children:E("friend.bar.find.title")})]})},Vg=3,mQ=s=>{const{onlineFriends:e=null}=s,[t,r]=d.exports.useState(0),i=d.exports.useRef();return _(M,{innerRef:i,alignItems:"center",className:"friend-bar",children:[a("button",{className:"friend-bar-button left",disabled:t<=0,onClick:n=>r(t-1)}),Array.from(Array(Vg),(n,o)=>a(gQ,{friend:e[t+o]||null},o)),a("button",{className:"friend-bar-button right",disabled:!(e.length>Vg&&t+Vg<=e.length-1),onClick:n=>r(t+1)})]})},zT=s=>{const{headerText:e="",isExpanded:t=!1,gap:r=0,classNames:i=[],children:n=null,...o}=s,[l,c]=d.exports.useState(!1),{setClosers:h=null,closeAll:u=null}=r0(),g=()=>{c(f=>!f)},m=d.exports.useCallback(()=>c(!1),[]),p=d.exports.useMemo(()=>{const f=["nitro-card-accordion-set"];return l&&f.push("active"),i&&i.length&&f.push(...i),f},[l,i]);return d.exports.useEffect(()=>{c(t)},[t]),d.exports.useEffect(()=>{const f=m;return h(T=>{const I=[...T];return I.push(f),I}),()=>{h(T=>{const I=[...T],O=I.indexOf(f);return O>=0&&I.splice(O,1),I})}},[m,h]),_(v,{classNames:p,gap:r,...o,children:[_(M,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:g,children:[a(C,{children:e}),l&&a(A_,{className:"fa-icon"}),!l&&a(N_,{className:"fa-icon"})]}),l&&a(v,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content p-1",children:n})]})},fQ=s=>{const{friend:e=null,selected:t=!1,selectFriend:r=null}=s,[i,n]=d.exports.useState(!1),{followFriend:o=null,updateRelationship:l=null}=Oi(),c=p=>{p.stopPropagation(),o(e)},h=p=>{p.stopPropagation(),dg(e.id)},u=p=>{p.stopPropagation(),n(!0)},g=(p,f)=>{p.stopPropagation(),l(e,f),n(!1)},m=()=>{if(!e)return"none";switch(e.relationshipStatus){case Pr.RELATIONSHIP_HEART:return"heart";case Pr.RELATIONSHIP_SMILE:return"smile";case Pr.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return e?_(m_,{justifyContent:"between",className:`friend-tab px-2 py-1 ${t&&"bg-primary text-white"}`,onClick:p=>r(e.id),children:[_(M,{alignItems:"center",gap:1,children:[a(K,{onClick:p=>p.stopPropagation(),children:a(Ei,{userId:e.id})}),a("div",{children:e.name})]}),_(M,{alignItems:"center",gap:1,children:[!i&&_(J,{children:[e.followingAllowed&&a(K,{pointer:!0,onClick:c,className:"nitro-friends-spritesheet icon-follow",title:E("friendlist.tip.follow")}),e.online&&a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:h,title:E("friendlist.tip.im")}),e.id>0&&a(K,{className:`nitro-friends-spritesheet icon-${m()} cursor-pointer`,onClick:u,title:E("infostand.link.relationship")})]}),i&&_(J,{children:[a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:p=>g(p,Pr.RELATIONSHIP_HEART)}),a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:p=>g(p,Pr.RELATIONSHIP_SMILE)}),a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:p=>g(p,Pr.RELATIONSHIP_BOBBA)}),a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:p=>g(p,Pr.RELATIONSHIP_NONE)})]})]})]}):null},KT=s=>{const{list:e=null,selectedFriendsIds:t=null,selectFriend:r=null}=s;return!e||!e.length?null:a(J,{children:e.map((i,n)=>a(fQ,{friend:i,selected:t&&t.indexOf(i.id)>=0,selectFriend:r},n))})},pQ=s=>{const{request:e=null}=s,{requestResponse:t=null}=Oi();return e?_(m_,{justifyContent:"between",className:"px-2 py-1",children:[_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:e.id}),a("div",{children:e.name})]}),_(M,{alignItems:"center",gap:1,children:[a(K,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:r=>t(e.id,!0)}),a(K,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:r=>t(e.id,!1)})]})]}):null},EQ=s=>{const{children:e=null,...t}=s,{requests:r=[],requestResponse:i=null}=Oi();return r.length?_(AI,{...t,children:[_(v,{fullHeight:!0,justifyContent:"between",gap:1,children:[a(v,{gap:0,children:r.map((n,o)=>a(pQ,{request:n},o))}),a(M,{justifyContent:"center",className:"px-2 py-1",children:a(Y,{onClick:n=>i(-1,!1),children:E("friendlist.requests.dismissall")})})]}),e]}):null},IQ=s=>{const{selectedFriendsIds:e=null,removeFriendsText:t=null,removeSelectedFriends:r=null,onCloseClick:i=null}=s;return _(Be,{className:"nitro-friends-remove-confirmation",theme:"primary",children:[a(He,{headerText:E("friendlist.removefriendconfirm.title"),onCloseClick:i}),_(Ge,{className:"text-black",children:[a("div",{children:t}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,variant:"danger",disabled:e.length===0,onClick:r,children:E("generic.ok")}),a(Y,{fullWidth:!0,onClick:i,children:E("generic.cancel")})]})]})]})},TQ=s=>{const{selectedFriendsIds:e=null,onCloseClick:t=null,sendRoomInvite:r=null}=s,[i,n]=d.exports.useState("");return _(Be,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",theme:"friendlist",children:[a(He,{headerText:E("friendlist.invite.title"),onCloseClick:t}),_(Ge,{className:"text-black",children:[E("friendlist.invite.summary",["count"],[e.length.toString()]),a("textarea",{className:"form-control",value:i,maxLength:255,onChange:o=>n(o.target.value)}),a(C,{center:!0,className:"bg-muted rounded p-1",children:E("friendlist.invite.note")}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,variant:"success",disabled:i.length===0||e.length===0,onClick:()=>r(i),children:E("friendlist.invite.send")}),a(Y,{fullWidth:!0,onClick:t,children:E("generic.cancel")})]})]})]})},RQ=s=>{const{...e}=s,[t,r]=d.exports.useState(""),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),{canRequestFriend:c=null,requestFriend:h=null}=Oi();return j(vC,u=>{const g=u.getParser();n(g.friends),l(g.others)}),d.exports.useEffect(()=>{if(!t||!t.length)return;const u=setTimeout(()=>{!t||!t.length||W(new by(t))},500);return()=>clearTimeout(u)},[t]),a(AI,{...e,children:_(v,{className:"h-100",children:[a(v,{children:a("input",{type:"text",className:"w-100 friend-search",placeholder:E("generic.search"),value:t,maxLength:50,onChange:u=>r(u.target.value)})}),_(v,{children:[i&&_(J,{children:[i.length===0&&a(C,{gfbold:!0,className:"px-2 py-1",children:E("friendlist.search.nofriendsfound")}),i.length>0&&_(v,{gap:0,children:[a(C,{gfbold:!0,className:"px-2 py-1",children:E("friendlist.search.friendscaption",["cnt"],[i.length.toString()])}),a("hr",{className:"mx-2 mt-0 mb-1 text-black"}),a(v,{gap:0,children:i.map(u=>_(m_,{justifyContent:"between",className:"px-2 py-1",children:[_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:u.avatarId}),a("div",{children:u.avatarName})]}),a(M,{alignItems:"center",gap:1,children:u.isAvatarOnline&&a(K,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:g=>dg(u.avatarId),title:E("friendlist.tip.im")})})]},u.avatarId))})]})]}),o&&_(J,{children:[o.length===0&&a(C,{gfbold:!0,className:"px-2 py-1",children:E("friendlist.search.noothersfound")}),o.length>0&&_(v,{gap:0,children:[a(C,{gfbold:!0,className:"px-2 py-1",children:E("friendlist.search.otherscaption",["cnt"],[o.length.toString()])}),a("hr",{className:"mx-2 mt-0 mb-1 text-black"}),a(v,{gap:0,children:o.map(u=>_(m_,{justifyContent:"between",className:"px-2 py-1",children:[_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:u.avatarId}),a("div",{children:u.avatarName})]}),a(M,{alignItems:"center",gap:1,children:c(u.avatarId)&&a(K,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:g=>h(u.avatarId,u.avatarName),title:E("friendlist.tip.addfriend")})})]},u.avatarId))})]})]})]})]})})},SQ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState([]),[n,o]=d.exports.useState(!1),[l,c]=d.exports.useState(!1),{onlineFriends:h=[],offlineFriends:u=[],requests:g=[],requestFriend:m=null}=Oi(),p=d.exports.useMemo(()=>{if(!r||!r.length)return"";const O=[];for(const A of r){let N=h.find(P=>P.id===A);N||(N=u.find(P=>P.id===A)),N&&O.push(N.name)}return E("friendlist.removefriendconfirm.userlist",["user_names"],[O.join(", ")])},[u,h,r]),f=d.exports.useCallback(O=>{O<0||i(A=>{const N=[...A],P=N.indexOf(O);return P>-1?N.splice(P,1):N.push(O),N})},[i]),T=O=>{!r.length||!O||!O.length||O.length>255||(W(new Dy(O,r)),o(!1))},I=()=>{r.length!==0&&(i(O=>(W(new vy(...O)),[])),c(!1))};return d.exports.useEffect(()=>{const O={linkReceived:A=>{const N=A.split("/");if(!(N.length<2))switch(N[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(P=>!P);return;case"request":if(N.length<4)return;m(parseInt(N[2]),N[3])}},eventUrlPrefix:"friends/"};return xs(O),()=>ws(O)},[m]),e?_(J,{children:[_(Be,{className:"nitro-friends",uniqueKey:"nitro-friends",theme:"friendlist",children:[a(He,{headerText:E("friendlist.friends"),onCloseClick:O=>t(!1)}),a(Ge,{overflow:"hidden",gap:1,className:"text-black p-0",children:_(EX,{fullHeight:!0,overflow:"hidden",children:[_(AI,{className:"friend-headers",headerText:E("friendlist.friends"),isExpanded:!0,children:[a(zT,{headerText:E("friendlist.friends")+` (${h.length})`,isExpanded:!0,children:a(KT,{list:h,selectedFriendsIds:r,selectFriend:f})}),a(zT,{headerText:E("friendlist.friends.offlinecaption")+` (${u.length})`,isExpanded:!0,children:a(KT,{list:u,selectedFriendsIds:r,selectFriend:f})}),r&&r.length===0&&_(M,{gap:1,className:"friend-active-tab p-1",children:[a("div",{className:"friend-follow-icon"}),a("div",{className:"friend-profile-icon"}),a("div",{className:"friend-delete-icon"})]}),r&&r.length>0&&_(M,{gap:1,className:"friend-active-tab p-1",children:[a("div",{className:"friend-follow-icon active",onClick:()=>o(!0)}),a("div",{className:"friend-profile-icon active"}),a("div",{className:"friend-delete-icon active",onClick:O=>c(!0)})]})]}),a(EQ,{className:"friend-headers",headerText:E("friendlist.tab.friendrequests")+` (${g.length})`,isExpanded:!1}),a(RQ,{className:"search-headers",headerText:E("people.search.title")})]})}),a("div",{className:"friendlist-bottom p-1"})]}),n&&a(TQ,{selectedFriendsIds:r,onCloseClick:()=>o(!1),sendRoomInvite:T}),l&&a(IQ,{selectedFriendsIds:r,removeFriendsText:p,onCloseClick:()=>c(!1),removeSelectedFriends:I})]}):null},OQ=s=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:r=!1,itemCount:i=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:h=!1,disabled:u=!1,center:g=!0,column:m=!0,style:p={},classNames:f=[],position:T="relative",overflow:I="hidden",children:O=null,...A}=s,N=d.exports.useMemo(()=>{const y=["layout-grid-item-messenger"];return r&&y.push("active"),(o||l>0)&&y.push("unique-item"),o&&y.push("sold-out"),c&&y.push("unseen"),h&&y.push("has-highlight"),u&&y.push("disabled"),e===null&&y.push("icon","loading-icon"),f.length&&y.push(...f),y},[r,o,l,c,h,u,e,f]),P=d.exports.useMemo(()=>{let y={...p};return e&&(y.backgroundImage=`url(${e})`),t&&(y.backgroundColor=t),Object.keys(p).length&&(y={...y,...p}),y},[p,e,t]);return _(v,{center:g,pointer:!0,position:T,overflow:I,column:m,classNames:N,style:P,...A,children:[i>n&&a(nn,{count:i}),l>0&&_(J,{children:[a(K,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),a("div",{className:"position-absolute bottom-0 unique-item-counter",children:a(ka,{value:l})})]}),O]})},CQ=s=>{const{thread:e=null,group:t=null}=s,r=d.exports.useMemo(()=>t.type===_l.GROUP_CHAT&&VL(t.chats[0].extraData),[t]),i=d.exports.useMemo(()=>!e||!t?!1:!!(t.type===_l.PRIVATE_CHAT&&t.userId===ie().userId||r&&t.chats.length&&r.userId===ie().userId),[e,t,r]);return!e||!t?null:t.userId?_(J,{children:[_(M,{fullWidth:!0,justifyContent:i?"end":"start",gap:2,children:[t.type===_l.PRIVATE_CHAT&&!i&&a(K,{shrink:!0,className:"message-avatar",children:a(Ts,{figure:e.participant.figure,direction:2})}),r&&!i&&a(K,{shrink:!0,className:"message-avatar",children:a(Ts,{figure:r.figure,direction:2})}),_(K,{className:"message-bubble text-black mt-2 py-1 px-2 messages-group-"+(i?"right":"left"),children:[_(K,{className:"username",children:[i&&ie().userName,!i&&(r?r.username:e.participant.name)]}),t.chats.map((n,o)=>a(K,{className:"text-break",children:n.message},o))]}),i&&a(K,{shrink:!0,className:"message-avatar",children:a(Ts,{figure:ie().figure,direction:4})})]}),t.chats.length>0&&a(M,{className:`text-black ${i?"":"px-5"}`,children:a(C,{variant:"muted",className:i?"px-1":"px-3",children:Or.format((new Date().getTime()-t.chats[t.chats.length-1].date.getTime())/1e3,".ago",2)})})]}):a(J,{children:t.chats.map((n,o)=>a(M,{fullWidth:!0,gap:2,justifyContent:"start",children:_(K,{className:"w-100 text-break",children:[n.type===bn.SECURITY_NOTIFICATION&&_(M,{gap:2,alignItems:"center",className:"thread-message mb-2 px-2 py-1 ",children:[a(K,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0 px-3"}),a(K,{children:n.message})]}),n.type===bn.ROOM_INVITE&&_(M,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-black",children:[a(K,{className:"messenger-notification-icon flex-shrink-0"}),_(K,{children:[E("messenger.invitation")+" ",n.message]})]})]})},o))})},AQ=s=>{const{thread:e=null}=s;return e.setRead(),a(J,{children:e.groups.length>0&&e.groups.map((t,r)=>a(CQ,{thread:e,group:t},r))})},NQ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(""),{visibleThreads:l=[],activeThread:c=null,getMessageThread:h=null,sendMessage:u=null,setActiveThreadId:g=null,closeThread:m=null}=R0(),{report:p=null}=un(),f=d.exports.useRef(),T=()=>c&&c.participant&&W(new q_(c.participant.id)),I=()=>c&&c.participant&&ri(c.participant.id),O=()=>{!c||!n.length||(u(c,ie().userId,n),o(""))},A=N=>{N.key==="Enter"&&O()};return d.exports.useEffect(()=>{const N={linkReceived:P=>{const y=P.split("/");if(y.length===2){if(y[1]==="open"){t(!0);return}if(y[1]==="toggle"){t(x=>!x);return}const D=h(parseInt(y[1]));if(!D)return;g(D.threadId),t(!0)}},eventUrlPrefix:"friends-messenger/"};return xs(N),()=>ws(N)},[h,g]),d.exports.useEffect(()=>{!e||!c||(f.current.scrollTop=f.current.scrollHeight)},[e,c]),d.exports.useEffect(()=>{l.length===0&&t(!1)},[l]),d.exports.useEffect(()=>{if(e&&!c){r>0?g(r):l.length>0&&g(l[0].threadId);return}!e&&c&&(i(c.threadId),g(-1))},[e,c,r,l,g]),e?_(Be,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",theme:"messenger",children:[a(He,{headerText:E("messenger.window.title",["OPEN_CHAT_COUNT"],[l.length.toString()]),hideButtonClose:!0,onCloseClick:N=>t(!1)}),_(Ge,{children:[a(v,{fullWidth:!0,size:4,children:a("div",{className:"d-flex h-100 overflow-auto gap-2",children:l&&l.length>0&&l.map(N=>_(OQ,{itemActive:c===N,onClick:P=>g(N.threadId),children:[N.unread&&a(nn,{count:N.unreadCount}),a(M,{fullWidth:!0,alignItems:"center",gap:1,children:_(M,{alignItems:"center",className:"friend-head px-1",children:[N.participant.id>0&&a(Ts,{figure:N.participant.figure,headOnly:!0,direction:2}),N.participant.id<=0&&a(as,{isGroup:!0,badgeCode:N.participant.figure})]})})]},N.threadId))})}),a(v,{size:8,overflow:"hidden",className:"w-100",children:c&&_(J,{children:[a("div",{className:"messenger-line",children:a("p",{className:"nitro-messenger-header-text fw-bold",children:E("messenger.window.separator",["FRIEND_NAME"],[c.participant.name])})}),_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[_(M,{gap:1,children:[_(sa,{className:"gap-1",children:[a("button",{className:"follow",title:E("messenger.followfriend.tooltip"),onClick:T}),a("button",{className:"profile",title:E("guide.help.common.profile.tooltip"),onClick:I})]}),a("button",{className:"report",title:E("messenger.window.button.report.tooltip"),onClick:()=>p(Qt.IM,{reportedUserId:c.participant.id}),children:E("messenger.window.button.report")})]}),a("button",{className:"clear",onClick:N=>m(c.threadId)})]}),a(v,{fit:!0,className:"chat-messages",children:a(v,{innerRef:f,overflow:"auto",children:a(AQ,{thread:c})})}),_(M,{gap:1,children:[a("input",{type:"text",className:"chat-input-form form-control-sm",maxLength:255,placeholder:E("messenger.window.input.default",["FRIEND_NAME"],[c.participant.name]),value:n,onChange:N=>o(N.target.value),onKeyDown:A}),a("button",{className:"messenger-button chat-submit fw-bold px-3",onClick:O,children:E("widgets.chatinput.say")})]})]})})]})]}):null},bQ=s=>{const{settings:e=null,onlineFriends:t=[]}=Oi();return e?_(J,{children:[up.exports.createPortal(a(mQ,{onlineFriends:t}),document.getElementById("toolbar-friend-bar-container")),a(SQ,{}),a(NQ,{})]}):null},yQ=()=>{const{games:s,selectedGame:e,setSelectedGame:t}=Ig(),r=n=>{let o=["game-icon"];return e===n&&o.push("selected"),o.join(" ")},i=n=>`url(${n.assetUrl}${n.gameNameId}_icon.png)`;return _(K,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[E("gamecenter.game_list_title"),a(M,{gap:3,children:s&&s.map((n,o)=>a(K,{className:r(n),onClick:l=>t(n),style:{backgroundImage:i(n)}},o))})]})},vQ=()=>{const{gameURL:s,setGameURL:e}=Ig(),[t,r]=d.exports.useState(0),i=d.exports.useRef();return d.exports.useEffect(()=>{if(!i||i&&!i.current)return;r(0);let n=document.createElement("iframe");n.src=s,n.classList.add("game-center-stage"),n.classList.add("h-100"),n.onload=()=>{r(o=>o+=1)},i.current.innerHTML="",i.current.appendChild(n)},[i,s]),d.exports.useEffect(()=>{t>1&&(e(null),W(new Py))},[t,e]),s?a(K,{innerRef:i,className:"game-center-stage"}):null},MQ=()=>{const{selectedGame:s,accountStatus:e}=Ig();d.exports.useEffect(()=>{s&&(W(new xy(s.gameId)),W(new Ly(s.gameId)))},[s]);const t=()=>si.uintHexColor(s.bgColor),r=()=>`url(${s.assetUrl}${s.gameNameId}_theme.png)`,i=()=>si.uintHexColor(s.textColor),n=()=>{W(new Fy(s.gameId))};return _(M,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:t(),backgroundImage:r(),color:i()},children:[_(M,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[a(C,{bold:!0,children:E(`gamecenter.${s.gameNameId}.description_title`)}),a("img",{src:s.assetUrl+s.gameNameId+"_logo.png"}),(e.hasUnlimitedGames||e.freeGamesLeft>0)&&a(J,{children:_(Y,{variant:"light",position:"relative",className:"px-4",onClick:n,children:[E("gamecenter.play_now"),!e.hasUnlimitedGames&&a(nn,{className:"me-n1 mt-n1",count:e.freeGamesLeft})]})}),a(C,{bold:!0,className:"w-50",center:!0,children:E(`gamecenter.${s.gameNameId}.description_content`)})]}),a(K,{className:"w-25"})]})},DQ=()=>{const{isVisible:s,setIsVisible:e,games:t,accountStatus:r}=Ig();if(d.exports.useEffect(()=>{const i=()=>{e(o=>!o)},n={linkReceived:o=>{switch(o.split("/")[1]){case"toggle":i();break}},eventUrlPrefix:"games/"};return xs(n),()=>ws(n)},[]),!(!s||!t||!r))return _(M,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[_(M,{className:"game-center-main",column:!0,children:[a(MQ,{}),a(yQ,{})]}),a(vQ,{})]})},PQ=[0,1,2,3,4,5,6,7,8],LQ=s=>{const{badgeParts:e=[],setBadgeParts:t=null}=s,[r,i]=d.exports.useState(-1),{groupCustomize:n=null}=Ah(),o=(l,c,h)=>{const u=[...e];u[l][c]=h,t(u),c==="key"&&i(-1)};return!e||!e.length?null:_(J,{children:[r<0&&e&&e.length>0&&e.map((l,c)=>_(M,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[_(M,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:h=>i(c),children:[e[c].code&&e[c].code.length>0&&a(as,{badgeCode:e[c].code,isGroup:!0}),(!e[c].code||!e[c].code.length)&&a(M,{center:!0,className:"badge-image group-badge",children:a(Lc,{className:"fa-icon"})})]}),l.type!==Fr.BASE&&a(qe,{gap:1,columnCount:3,children:PQ.map((h,u)=>a(K,{pointer:!0,className:`group-badge-position-swatch ${e[c].position===h?"active":""}`,onClick:g=>o(c,"position",h)},u))}),a(qe,{gap:1,columnCount:8,children:n.badgePartColors.length>0&&n.badgePartColors.map((h,u)=>a(K,{pointer:!0,className:`group-badge-color-swatch ${e[c].color===u+1?"active":""}`,style:{backgroundColor:"#"+h.color},onClick:g=>o(c,"color",u+1)},u))})]},c)),r>=0&&_(qe,{gap:1,columnCount:5,children:[e[r].type===Fr.SYMBOL&&a(v,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:l=>o(r,"key",0),children:a(M,{center:!0,className:"badge-image group-badge",children:a(yo,{className:"fa-icon"})})}),(e[r].type===Fr.BASE?n.badgeBases:n.badgeSymbols).map((l,c)=>a(v,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:h=>o(r,"key",l.id),children:a(as,{badgeCode:Fr.getCode(e[r].type,l.id,e[r].color,4),isGroup:!0})},c))]})]})},B0=s=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:r=null,skipDefault:i=null}=s,[n,o]=d.exports.useState(null),{groupCustomize:l=null}=Ah(),c=()=>{if(!n||!n.length)return"";let u="";return n.forEach(g=>g.code&&(u+=g.code)),u},h=d.exports.useCallback(()=>{if(!e||!n||!n.length)return!1;if(e.groupBadgeParts===n)return!0;if(e.groupId<=0)return t(g=>{const m={...g};return m.groupBadgeParts=n,m}),!0;const u=[];return n.forEach(g=>{g.code&&(u.push(g.key),u.push(g.color),u.push(g.position))}),W(new $y(e.groupId,u)),!0},[e,n,t]);return d.exports.useEffect(()=>{if(e.groupBadgeParts)return;const u=[new Fr(Fr.BASE,l.badgeBases[0].id,l.badgePartColors[0].id),new Fr(Fr.SYMBOL,0,l.badgePartColors[0].id),new Fr(Fr.SYMBOL,0,l.badgePartColors[0].id),new Fr(Fr.SYMBOL,0,l.badgePartColors[0].id),new Fr(Fr.SYMBOL,0,l.badgePartColors[0].id)];t(g=>({...g,groupBadgeParts:u}))},[e.groupBadgeParts,l,t]),d.exports.useEffect(()=>{if(e.groupId<=0){o(e.groupBadgeParts?[...e.groupBadgeParts]:null);return}o(e.groupBadgeParts)},[e]),d.exports.useEffect(()=>(r({action:h}),()=>r(null)),[r,h]),_(qe,{overflow:"hidden",gap:1,children:[a(v,{size:2,children:a(M,{center:!0,className:"bg-muted rounded p-1",children:a(as,{badgeCode:c(),isGroup:!0})})}),a(v,{size:10,overflow:"auto",children:a(LQ,{badgeParts:n,setBadgeParts:o})})]})},V0=s=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:r=null}=s,[i,n]=d.exports.useState(null),{groupCustomize:o=null}=Ah(),l=u=>u===0?o.groupColorsA.find(g=>g.id===i[u]).color:o.groupColorsB.find(g=>g.id===i[u]).color,c=(u,g)=>{n(m=>{const p=[...m];return p[u]=g,p})},h=d.exports.useCallback(()=>!e||!i||!i.length?!1:e.groupColors===i?!0:e.groupId<=0?(t(u=>{const g={...u};return g.groupColors=[...i],g}),!0):(W(new Jy(e.groupId,i[0],i[1])),!0),[e,i,t]);return d.exports.useEffect(()=>{if(!o.groupColorsA||!o.groupColorsB||e.groupColors)return;const u=[o.groupColorsA[0].id,o.groupColorsB[0].id];t(g=>({...g,groupColors:u}))},[o,e.groupColors,t]),d.exports.useEffect(()=>{if(e.groupId<=0){n(e.groupColors?[...e.groupColors]:null);return}n(e.groupColors)},[e]),d.exports.useEffect(()=>(r({action:h}),()=>r(null)),[r,h]),i?_(qe,{overflow:"hidden",children:[_(v,{size:2,gap:1,children:[a(C,{bold:!0,children:E("group.edit.color.guild.color")}),e.groupColors&&e.groupColors.length>0&&_(M,{overflow:"hidden",className:"rounded border",children:[a(K,{className:"group-color-swatch",style:{backgroundColor:"#"+l(0)}}),a(K,{className:"group-color-swatch",style:{backgroundColor:"#"+l(1)}})]})]}),_(v,{size:5,gap:1,overflow:"hidden",children:[a(C,{bold:!0,children:E("group.edit.color.primary.color")}),a(Bt,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&o.groupColorsA&&o.groupColorsA.map((u,g)=>a("div",{className:bo("group-badge-color-swatch cursor-pointer",e.groupColors[0]===u.id&&"active"),style:{backgroundColor:"#"+u.color},onClick:()=>c(0,u.id)},g))})]}),_(v,{size:5,gap:1,overflow:"hidden",children:[a(C,{bold:!0,children:E("group.edit.color.secondary.color")}),a(Bt,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&o.groupColorsB&&o.groupColorsB.map((u,g)=>a("div",{className:bo("group-badge-color-swatch cursor-pointer",e.groupColors[1]===u.id&&"active"),style:{backgroundColor:"#"+u.color},onClick:()=>c(1,u.id)},g))})]})]}):null},UQ=s=>{const{groupData:e=null,setGroupData:t=null,purchaseCost:r=0}=s,{groupCustomize:i=null}=Ah(),n=()=>{if(!e||!e.groupBadgeParts||!e.groupBadgeParts.length)return"";let l="";return e.groupBadgeParts.forEach(c=>c.code&&(l+=c.code)),l},o=l=>l===0?i.groupColorsA.find(c=>c.id===e.groupColors[l]).color:i.groupColorsB.find(c=>c.id===e.groupColors[l]).color;return e?_(qe,{overflow:"hidden",gap:1,children:[_(v,{size:3,children:[_(v,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[a(C,{bold:!0,center:!0,children:E("group.create.confirm.guildbadge")}),a(as,{badgeCode:n(),isGroup:!0})]}),_(v,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[a(C,{bold:!0,center:!0,children:E("group.edit.color.guild.color")}),_(M,{overflow:"hidden",className:"rounded border",children:[a(K,{className:"group-color-swatch",style:{backgroundColor:"#"+o(0)}}),a(K,{className:"group-color-swatch",style:{backgroundColor:"#"+o(1)}})]})]})]}),_(v,{size:9,justifyContent:"between",children:[_(v,{children:[_(v,{gap:1,children:[a(C,{bold:!0,children:e.groupName}),a(C,{children:e.groupDescription})]}),a(C,{overflow:"auto",children:E("group.create.confirm.info")})]}),a(C,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:E("group.create.confirm.buyinfo",["amount"],[r.toString()])})]})]}):null},H0=s=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:r=null,onClose:i=null,isCreator:n=!1,availableRooms:o=[]}=s,[l,c]=d.exports.useState(""),[h,u]=d.exports.useState(""),[g,m]=d.exports.useState(-1),{showConfirm:p=null}=$t(),f=()=>{!e||e.groupId<=0||p(E("group.deleteconfirm.desc"),()=>{W(new zy(e.groupId)),i&&i()},null,null,null,E("group.deleteconfirm.title"))},T=d.exports.useCallback(()=>!e||!l||!l.length?!1:l===e.groupName&&h===e.groupDescription?!0:e.groupId<=0?g<=0?!1:(t(I=>{const O={...I};return O.groupName=l,O.groupDescription=h,O.groupHomeroomId=g,O}),!0):(W(new Zy(e.groupId,l,h||"")),!0),[e,l,h,g,t]);return d.exports.useEffect(()=>{c(e.groupName||""),u(e.groupDescription||""),m(e.groupHomeroomId)},[e]),d.exports.useEffect(()=>(r({action:T}),()=>r(null)),[r,T]),e?_(v,{justifyContent:"between",overflow:"auto",children:[_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a(C,{center:!0,className:"col-3",children:E("group.edit.name")}),a("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:29,onChange:I=>c(I.target.value)})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{center:!0,className:"col-3",children:E("group.edit.desc")}),a("textarea",{className:"form-control form-control-sm",value:h,maxLength:254,onChange:I=>u(I.target.value)})]}),n&&_(J,{children:[_(M,{alignItems:"center",gap:1,children:[a(C,{center:!0,className:"col-3",children:E("group.edit.base")}),a(v,{fullWidth:!0,gap:1,children:_("select",{className:"form-select form-select-sm",value:g,onChange:I=>m(parseInt(I.target.value)),children:[a("option",{value:-1,disabled:!0,children:E("group.edit.base.select.room")}),o&&o.map((I,O)=>a("option",{value:I.id,children:I.name},O))]})})]}),_(M,{gap:1,children:[a(K,{className:"col-3",children:""}),a(C,{small:!0,children:E("group.edit.base.warning")})]})]})]}),!n&&a(Y,{variant:"danger",onClick:f,children:E("group.delete")}),n&&a(C,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:I=>Le("navigator/create"),children:E("group.createroom")})]}):null},xQ=[1,2,3,4],wQ=s=>{const{onClose:e=null}=s,[t,r]=d.exports.useState(1),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(0),m=()=>{if(!o)return;const T=[];o.groupBadgeParts.forEach(I=>{I.code&&(T.push(I.key),T.push(I.color),T.push(I.position))}),W(new Wy(o.groupName,o.groupDescription,o.groupHomeroomId,o.groupColors[0],o.groupColors[1],T))},p=()=>{if(!(i&&i.action&&!i.action())){if(t===1){e();return}r(T=>T-1)}},f=()=>{if(!(i&&i.action&&!i.action())){if(t===4){m();return}r(T=>T===4?T:T+1)}};return j(xC,T=>{const I=T.getParser(),O=[];I.availableRooms.forEach((A,N)=>O.push({id:N,name:A})),h(O),g(I.groupCost)}),d.exports.useEffect(()=>{r(1),l({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),W(new jy)},[l]),o?_(Be,{className:"nitro-group-creator",theme:"primary",children:[a(He,{headerText:E("group.create.title"),onCloseClick:e}),_(Ge,{children:[a(M,{center:!0,className:"creator-tabs",children:xQ.map((T,I)=>a(M,{center:!0,className:`tab tab-${T===1?"blue-flat":T===4?"yellow":"blue-arrow"} ${t===T?"active":""}`,children:a(C,{variant:"white",children:E(`group.create.steplabel.${T}`)})},I))}),_(v,{overflow:"hidden",children:[_(M,{alignItems:"center",gap:2,children:[a(K,{className:`nitro-group-tab-image tab-${t}`}),_(v,{grow:!0,gap:0,children:[a(C,{bold:!0,fontSize:4,children:E(`group.create.stepcaption.${t}`)}),a(C,{children:E(`group.create.stepdesc.${t}`)})]})]}),_(v,{overflow:"hidden",children:[t===1&&a(H0,{groupData:o,setGroupData:l,setCloseAction:n,onClose:null,isCreator:!0,availableRooms:c}),t===2&&a(B0,{groupData:o,setGroupData:l,setCloseAction:n}),t===3&&a(V0,{groupData:o,setGroupData:l,setCloseAction:n}),t===4&&a(UQ,{groupData:o,setGroupData:l,purchaseCost:u})]}),_(M,{justifyContent:"between",children:[a(Y,{variant:"link",className:"text-black",onClick:p,children:E(t===1?"generic.cancel":"group.create.previousstep")}),a(Y,{disabled:t===4&&!ll(),variant:t===4?ll()?"success":"danger":"primary",onClick:f,children:E(t===4?ll()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},FQ=["regular","exclusive","private"],W0=s=>{const{groupInformation:e=null,onClose:t=null,overflow:r="hidden",...i}=s,{showConfirm:n=null}=$t(),o=e&&e.ownerName===ie().userName,l=()=>e&&RI(e.id),c=()=>{n(E("group.leaveconfirm.desc"),()=>{W(new X_(e.id,ie().userId)),t&&t()},null)},h=()=>e.membershipType===Zs.NOT_MEMBER||e.membershipType===Zs.REQUEST_PENDING?null:o?a("i",{className:"icon icon-group-owner",title:E("group.youareowner")}):e.isAdmin?a("i",{className:"icon icon-group-admin",title:E("group.youareadmin")}):a("i",{className:"icon icon-group-member",title:E("group.youaremember")}),u=()=>{if(o)return"group.youareowner";if(e.type===hi.PRIVATE&&e.membershipType!==Zs.MEMBER)return"";if(e.membershipType===Zs.MEMBER)return"group.leave";if(e.membershipType===Zs.NOT_MEMBER&&e.type===hi.REGULAR)return"group.join";if(e.membershipType===Zs.REQUEST_PENDING)return"group.membershippending";if(e.membershipType===Zs.NOT_MEMBER&&e.type===hi.EXCLUSIVE)return"group.requestmembership"},g=()=>{if(!(e.type===hi.PRIVATE&&e.membershipType===Zs.NOT_MEMBER)){if(e.membershipType===Zs.MEMBER){c();return}l()}},m=p=>{switch(p){case"members":OT(e.id);break;case"members_pending":OT(e.id,2);break;case"manage":jL(e.id);break;case"homeroom":Wr(e.roomId);break;case"furniture":Le("catalog/open/"+Ms.GUILD_CUSTOM_FURNI);break;case"popular_groups":Le("navigator/search/groups");break}};return e?_(qe,{className:"profile-grey-bg-border p-2",overflow:r,...i,children:[_(v,{center:!0,size:3,overflow:"hidden",children:[a(M,{alignItems:"center",overflow:"hidden",className:"group-badge",children:a(as,{badgeCode:e.badge,isGroup:!0,scale:2})}),_(v,{alignItems:"center",gap:1,children:[a(C,{small:!0,underline:!0,pointer:!0,onClick:()=>m("members"),children:E("group.membercount",["totalMembers"],[e.membersCount.toString()])}),e.pendingRequestsCount>0&&a(C,{small:!0,underline:!0,pointer:!0,onClick:()=>m("members_pending"),children:E("group.pendingmembercount",["amount"],[e.pendingRequestsCount.toString()])}),e.isOwner&&a(C,{small:!0,underline:!0,pointer:!0,onClick:()=>m("manage"),children:E("group.manage")})]}),h()]}),_(v,{size:9,justifyContent:"between",overflow:"auto",children:[_(v,{overflow:"hidden",children:[_(v,{gap:1,children:[_(M,{alignItems:"center",gap:2,children:[a(C,{bold:!0,children:e.title}),_(M,{gap:1,children:[a("i",{className:"icon icon-group-type-"+e.type,title:E(`group.edit.settings.type.${FQ[e.type]}.help`)}),e.canMembersDecorate&&a("i",{className:"icon icon-group-decorate",title:E("group.memberscandecorate")})]})]}),a(C,{small:!0,children:E("group.created",["date","owner"],[e.createdAt,e.ownerName])})]}),a(C,{small:!0,textBreak:!0,overflow:"auto",className:"group-description",children:e.description})]}),_(v,{children:[_(v,{gap:1,children:[a(C,{small:!0,underline:!0,pointer:!0,onClick:()=>m("homeroom"),children:E("group.linktobase")}),a(C,{small:!0,underline:!0,pointer:!0,onClick:()=>m("furniture"),children:E("group.buyfurni")}),a(C,{small:!0,underline:!0,pointer:!0,onClick:()=>m("popular_groups"),children:E("group.showgroups")})]}),(e.type!==hi.PRIVATE||e.type===hi.PRIVATE&&e.membershipType===Zs.MEMBER)&&a(Y,{disabled:e.membershipType===Zs.REQUEST_PENDING||o,onClick:g,children:E(u())})]})]})]}):null},kQ=s=>{const[e,t]=d.exports.useState(null);return j(kc,r=>{const i=r.getParser();(e&&e.id===i.id||i.flag)&&t(i)}),e?_(Be,{className:"nitro-group-information-standalone",theme:"primary",children:[a(He,{headerText:E("group.window.title"),onCloseClick:r=>t(null)}),a(Ge,{children:a(W0,{groupInformation:e,onClose:()=>t(null)})})]}):null},GQ=["regular","exclusive","private"],BQ=s=>{const{groupData:e=null,setGroupData:t=null,setCloseAction:r=null}=s,[i,n]=d.exports.useState(e.groupState),[o,l]=d.exports.useState(e.groupCanMembersDecorate),c=d.exports.useCallback(()=>e?i===e.groupState&&o===e.groupCanMembersDecorate?!0:e.groupId<=0?(t(h=>{const u={...h};return u.groupState=i,u.groupCanMembersDecorate=o,u}),!0):(W(new ev(e.groupId,i,o?0:1)),!0):!1,[e,i,o,t]);return d.exports.useEffect(()=>{n(e.groupState),l(e.groupCanMembersDecorate)},[e]),d.exports.useEffect(()=>(r({action:c}),()=>r(null)),[r,c]),_(v,{overflow:"auto",children:[a(v,{children:GQ.map((h,u)=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"groupState",checked:i===u,onChange:g=>n(u)}),_(v,{gap:0,children:[_(M,{gap:1,children:[a("i",{className:`icon icon-group-type-${u}`}),a(C,{bold:!0,children:E(`group.edit.settings.type.${h}.label`)})]}),a(C,{children:E(`group.edit.settings.type.${h}.help`)})]})]},u))}),a(AX,{}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:o,onChange:h=>l(u=>!u)}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("group.edit.settings.rights.caption")}),a(C,{children:E("group.edit.settings.rights.members.help")})]})]})]})},VQ=[1,2,3,5],HQ=s=>{const[e,t]=d.exports.useState(1),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(null),l=()=>{i(h=>(h&&h.action&&h.action(),null)),o(null)},c=h=>{r&&r.action&&r.action(),t(h)};return j(kc,h=>{const u=h.getParser();!n||n.groupId!==u.id||o(g=>{const m={...g};return m.groupName=u.title,m.groupDescription=u.description,m.groupState=u.type,m.groupCanMembersDecorate=u.canMembersDecorate,m})}),j(GC,h=>{const u=h.getParser(),g=[];u.badgeParts.forEach((m,p)=>{g.push(new ti(m.isBase?ti.BASE:ti.SYMBOL,m.key,m.color,m.position))}),o({groupId:u.id,groupName:u.title,groupDescription:u.description,groupHomeroomId:u.roomId,groupState:u.state,groupCanMembersDecorate:u.canMembersDecorate,groupColors:[u.colorA,u.colorB],groupBadgeParts:g})}),!n||n.groupId<=0?null:_(Be,{className:"nitro-group-manager",children:[a(He,{headerText:E("group.window.title"),onCloseClick:l}),a(ca,{children:VQ.map(h=>a(Dn,{isActive:e===h,onClick:()=>c(h),children:E(`group.edit.tab.${h}`)},h))}),_(Ge,{children:[_(M,{alignItems:"center",gap:2,children:[a(K,{className:`nitro-group-tab-image tab-${e}`}),_(v,{grow:!0,gap:0,children:[a(C,{bold:!0,fontSize:4,children:E(`group.edit.tabcaption.${e}`)}),a(C,{children:E(`group.edit.tabdesc.${e}`)})]})]}),_(v,{grow:!0,overflow:"hidden",children:[e===1&&a(H0,{groupData:n,setGroupData:o,setCloseAction:i,onClose:l}),e===2&&a(B0,{groupData:n,setGroupData:o,setCloseAction:i,skipDefault:!0}),e===3&&a(V0,{groupData:n,setGroupData:o,setCloseAction:i}),e===5&&a(BQ,{groupData:n,setGroupData:o,setCloseAction:i})]})]})]})},WQ=s=>{const[e,t]=d.exports.useState(-1),[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(-1),[h,u]=d.exports.useState(0),[g,m]=d.exports.useState(""),[p,f]=d.exports.useState(null),{showConfirm:T=null}=$t(),I=y=>{if(y.rank===or.OWNER)return"group.members.owner";if(n.admin){if(y.rank===or.ADMIN)return"group.members.removerights";if(y.rank===or.MEMBER)return"group.members.giverights"}return""},O=d.exports.useCallback(()=>{e===-1||r===-1||l===-1||W(new _f(e,l,g,r))},[e,r,l,g]),A=y=>{!n.admin||y.rank===or.OWNER||(y.rank!==or.ADMIN?W(new By(n.groupId,y.id)):W(new Vy(n.groupId,y.id)),O())},N=y=>{!n.admin||y.rank!==or.REQUESTED||(W(new Xy(n.groupId,y.id)),O())},P=y=>{if(n.admin){if(y.rank===or.REQUESTED){W(new Qy(n.groupId,y.id)),O();return}f(y.name),W(new Yy(n.groupId,y.id))}};return j(FC,y=>{const D=y.getParser();o(D),i(D.level),u(Math.ceil(D.totalMembersCount/D.pageSize))}),j(wC,y=>{const D=y.getParser();T(E(D.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[p,D.furnitureCount.toString()]),()=>{W(new X_(n.groupId,D.userId)),O()},null),f(null)}),d.exports.useEffect(()=>{const y={linkReceived:D=>{const x=D.split("/");if(x.length<2)return;const w=parseInt(x[1])||-1,k=parseInt(x[2])||3;t(w),i(k),c(0)},eventUrlPrefix:"group-members/"};return xs(y),()=>ws(y)},[]),d.exports.useEffect(()=>{c(0)},[e,r,g]),d.exports.useEffect(()=>{e===-1||r===-1||l===-1||W(new _f(e,l,g,r))},[e,r,l,g]),d.exports.useEffect(()=>{e!==-1&&(i(-1),o(null),u(0),m(""),f(null))},[e]),e===-1||!n?null:_(Be,{className:"nitro-group-members",theme:"primary",children:[a(He,{headerText:E("group.members.title",["groupName"],[n?n.groupTitle:""]),onCloseClick:y=>t(-1)}),_(Ge,{overflow:"hidden",children:[_(M,{gap:2,children:[a(M,{center:!0,className:"group-badge",children:a(as,{badgeCode:n.badge,isGroup:!0,className:"mx-auto d-block"})}),_(v,{fullWidth:!0,gap:1,children:[a("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:E("group.members.searchinfo"),value:g,onChange:y=>m(y.target.value)}),_("select",{className:"form-select form-select-sm w-100",value:r,onChange:y=>i(parseInt(y.target.value)),children:[a("option",{value:"0",children:E("group.members.search.all")}),a("option",{value:"1",children:E("group.members.search.admins")}),a("option",{value:"2",children:E("group.members.search.pending")})]})]})]}),a(qe,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:n.result.map((y,D)=>_(M,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[a("div",{className:"avatar-head cursor-pointer",onClick:()=>ri(y.id),children:a(Ts,{figure:y.figure,headOnly:!0,direction:2})}),_(v,{grow:!0,gap:1,children:[a(C,{bold:!0,small:!0,pointer:!0,onClick:x=>ri(y.id),children:y.name}),y.rank!==or.REQUESTED&&a(C,{small:!0,italics:!0,variant:"muted",children:E("group.members.since",["date"],[y.joinedAt])})]}),_(v,{gap:1,children:[y.rank!==or.REQUESTED&&a(M,{center:!0,children:a(K,{pointer:n.admin,className:`icon icon-group-small-${y.rank===or.OWNER?"owner":y.rank===or.ADMIN?"admin":n.admin&&y.rank===or.MEMBER?"not-admin":""}`,title:E(I(y)),onClick:x=>A(y)})}),n.admin&&y.rank===or.REQUESTED&&a(M,{alignItems:"center",children:a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:E("group.members.accept"),onClick:x=>N(y)})}),n.admin&&y.rank!==or.OWNER&&y.id!==ie().userId&&a(M,{alignItems:"center",children:a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:E(y.rank===or.REQUESTED?"group.members.reject":"group.members.kick"),onClick:x=>P(y)})})]})]},D))}),_(M,{gap:1,justifyContent:"between",alignItems:"center",children:[a(Y,{disabled:n.pageIndex===0,onClick:y=>c(D=>D-1),children:a(Kn,{className:"fa-icon"})}),a(C,{small:!0,children:E("group.members.pageinfo",["amount","page","totalPages"],[n.totalMembersCount.toString(),(n.pageIndex+1).toString(),h.toString()])}),a(Y,{disabled:n.pageIndex===h-1,onClick:y=>c(D=>D+1),children:a(qn,{className:"fa-icon"})})]})]})]})},jQ=s=>{const[e,t]=d.exports.useState(!1);return Ah(),j(kC,r=>{const i=r.getParser();t(!1),Wr(i.roomId)}),d.exports.useEffect(()=>{const r={linkReceived:i=>{const n=i.split("/");if(!(n.length<2))switch(n[1]){case"create":t(!0);return;case"manage":if(!n[2])return;t(!1),W(new tv(Number(n[2])));return}},eventUrlPrefix:"groups/"};return xs(r),()=>ws(r)},[]),_(J,{children:[e&&a(wQ,{onClose:()=>t(!1)}),!e&&a(HQ,{}),a(WQ,{}),a(kQ,{})]})},YQ=s=>{const{helpRequestDescription:e=null,helpRequestAverageTime:t=0}=s,r=i=>W(new Ev(i));return _(v,{children:[_(v,{gap:0,className:"bg-muted p-2 rounded",children:[a(C,{bold:!0,children:E("guide.help.request.guide.accept.request.title")}),a(C,{variant:"muted",children:E("guide.help.request.type.1")}),a(C,{wrap:!0,textBreak:!0,children:e})]}),_(v,{gap:1,children:[a(Y,{variant:"success",onClick:i=>r(!0),children:E("guide.help.request.guide.accept.accept.button")}),a(Y,{variant:"danger",onClick:i=>r(!1),children:E("guide.help.request.guide.accept.skip.link")})]})]})},zQ=s=>{const{isOnDuty:e=!1,isHandlingGuideRequests:t=!1,setIsHandlingGuideRequests:r=null,isHandlingHelpRequests:i=!1,setIsHandlingHelpRequests:n=null,isHandlingBullyReports:o=!1,setIsHandlingBullyReports:l=null,guidesOnDuty:c=0,helpersOnDuty:h=0,guardiansOnDuty:u=0,processAction:g=null}=s;return _(v,{children:[_(M,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[a(K,{className:"duty-switch"+(e?"":" off"),onClick:m=>g("toggle_duty")}),_(v,{gap:0,children:[a(C,{bold:!0,children:E("guide.help.guide.tool.yourstatus")}),a(C,{children:E(`guide.help.guide.tool.duty.${e?"on":"off"}`)})]})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("guide.help.guide.tool.tickettypeselection.caption")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:t,onChange:m=>r(m.target.checked)}),a(C,{children:E("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:i,onChange:m=>n(m.target.checked)}),a(C,{children:E("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:o,onChange:m=>l(m.target.checked)}),a(C,{children:E("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),a("hr",{className:"bg-dark m-0"}),_(M,{center:!0,gap:2,children:[a(K,{className:"info-icon"}),_(v,{gap:1,children:[a(K,{dangerouslySetInnerHTML:{__html:E("guide.help.guide.tool.guidesonduty",["amount"],[c.toString()])}}),a(K,{dangerouslySetInnerHTML:{__html:E("guide.help.guide.tool.helpersonduty",["amount"],[h.toString()])}}),a(K,{dangerouslySetInnerHTML:{__html:E("guide.help.guide.tool.guardiansonduty",["amount"],[u.toString()])}})]})]}),a("hr",{className:"bg-dark m-0"}),_(M,{justifyContent:"between",gap:2,children:[a(Y,{disabled:!0,onClick:m=>g("forum_link"),children:E("guide.help.guide.tool.forum.link")}),a(Y,{disabled:!0,children:E("guide.help.guide.tool.skill.link")})]})]})},KQ=s=>{const e=d.exports.useRef(null),{isGuide:t=!1,userId:r=0,userName:i=null,userFigure:n=null,isTyping:o=!1,messageGroups:l=[]}=s,[c,h]=d.exports.useState("");d.exports.useEffect(()=>{var I;(I=e.current)==null||I.scrollIntoView({block:"end",behavior:"smooth"})},[l]);const u=d.exports.useCallback(()=>{W(new pv)},[]),g=d.exports.useCallback(()=>{W(new Iv)},[]),m=d.exports.useCallback(()=>{W(new Sv)},[]);j(ZC,I=>{const O=I.getParser();Wr(O.requesterRoomId)});const p=d.exports.useCallback(()=>{!c||!c.length||(W(new Tv(c)),h(""))},[c]),f=d.exports.useCallback(I=>{I.key==="Enter"&&p()},[p]),T=d.exports.useCallback(I=>I===ie().userId,[]);return _(v,{fullHeight:!0,children:[_(M,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[t&&_(sa,{children:[a(Y,{onClick:u,children:E("guide.help.request.guide.ongoing.visit.button")}),a(Y,{onClick:g,children:E("guide.help.request.guide.ongoing.invite.button")})]}),!t&&_(v,{gap:0,children:[a(C,{bold:!0,children:i}),a(C,{children:E("guide.help.request.user.ongoing.guide.desc")})]}),a(Y,{variant:"danger",disabled:!0,children:E("guide.help.common.report.link")})]}),a(v,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:_(v,{overflow:"auto",children:[l.map((I,O)=>_(M,{fullWidth:!0,justifyContent:T(I.userId)?"end":"start",gap:2,children:[a(K,{shrink:!0,className:"message-avatar",children:!T(I.userId)&&a(Ts,{figure:n,direction:2})}),_(K,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(T(I.userId)?"right":"left"),children:[_(C,{bold:!0,children:[T(I.userId)&&ie().userName,!T(I.userId)&&i]}),I.messages.map((A,N)=>a(K,{pointer:!!A.roomId,className:A.roomId?"text-break text-underline":"text-break",onClick:()=>A.roomId?Wr(A.roomId):null,children:A.message},N))]}),T(I.userId)&&a(K,{className:"message-avatar flex-shrink-0",children:a(Ts,{figure:ie().figure,direction:4})})]},O)),a("div",{ref:e})]})}),_(v,{gap:1,children:[_(M,{gap:1,children:[a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("guide.help.request.guide.ongoing.input.empty",["name"],[i]),value:c,onChange:I=>h(I.target.value),onKeyDown:f}),a(Y,{variant:"success",onClick:p,children:E("widgets.chatinput.say")})]}),o&&a(C,{variant:"muted",children:E("guide.help.common.typing")})]}),a(Y,{fullWidth:!0,variant:"success",onClick:m,children:E("guide.help.request."+(t?"guide":"user")+".ongoing.close.link")})]})},qQ=15,XQ=s=>{const{userRequest:e="",setUserRequest:t=null}=s,[r,i]=d.exports.useState(!1),n=()=>{i(!0),W(new mv(1,e))};return _(v,{children:[a(C,{children:E("guide.help.request.user.create.help")}),a("textarea",{className:"request-message",maxLength:140,value:e,onChange:o=>t(o.target.value),placeholder:E("guide.help.request.user.create.input.help")}),a(Y,{fullWidth:!0,variant:"success",disabled:e.length<qQ||r,onClick:n,children:E("guide.help.request.user.create.input.button")})]})},QQ=s=>{const{userName:e=null}=s,t=r=>W(new fv(r));return _(v,{children:[_(M,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[_(v,{gap:0,children:[a(C,{bold:!0,children:e}),a(C,{children:E("guide.help.request.user.feedback.guide.desc")})]}),a(Y,{variant:"danger",disabled:!0,children:E("guide.help.common.report.link")})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("guide.help.request.user.feedback.closed.title")}),a(C,{children:E("guide.help.request.user.feedback.closed.desc")})]}),e&&e.length>0&&_(J,{children:[a("hr",{className:"bg-dark m-0 mt-auto"}),_(v,{children:[a(C,{center:!0,bold:!0,children:E("guide.help.request.user.feedback.question")}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,variant:"success",onClick:r=>t(!0),children:E("guide.help.request.user.feedback.positive.button")}),a(Y,{fullWidth:!0,variant:"danger",onClick:r=>t(!1),children:E("guide.help.request.user.feedback.negative.button")})]})]})]})]})},$Q=s=>_(v,{gap:1,children:[a(C,{bold:!0,children:E("guide.help.request.no_tour_guides.title")}),a(C,{children:E("guide.help.request.no_tour_guides.message")})]}),JQ=s=>{const{helpRequestDescription:e=null,helpRequestAverageTime:t=0}=s,r=()=>W(new Rv);return _(v,{children:[_(v,{gap:0,className:"bg-muted rounded p-2",children:[a(C,{bold:!0,children:E("guide.help.request.guide.accept.request.title")}),a(C,{variant:"muted",children:E("guide.help.request.type.1")}),a(C,{wrap:!0,textBreak:!0,children:e})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("guide.help.request.user.pending.info.title")}),a(C,{children:E("guide.help.request.user.pending.info.message")}),a(C,{children:E("guide.help.request.user.pending.info.waiting",["waitingtime"],[t.toString()])})]}),a(Y,{variant:"danger",onClick:r,children:E("guide.help.request.user.pending.cancel.button")})]})},ZQ=s=>a(v,{gap:1,children:a(C,{children:E("guide.help.request.user.guide.disconnected.error.desc")})}),e$=s=>_(v,{gap:1,children:[a(C,{bold:!0,children:E("guide.help.request.user.thanks.info.title")}),a(C,{children:E("guide.help.request.user.thanks.info.desc")})]}),t$=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(E("guide.help.guide.tool.title")),[n,o]=d.exports.useState(!1),[l,c]=d.exports.useState(rt.GUIDE_TOOL_MENU),[h,u]=d.exports.useState(!1),[g,m]=d.exports.useState(!1),[p,f]=d.exports.useState(!1),[T,I]=d.exports.useState(!1),[O,A]=d.exports.useState(0),[N,P]=d.exports.useState(0),[y,D]=d.exports.useState(0),[x,w]=d.exports.useState(""),[k,F]=d.exports.useState(null),[L,B]=d.exports.useState(0),[V,q]=d.exports.useState(0),[Z,H]=d.exports.useState(null),[X,ee]=d.exports.useState(null),[Oe,de]=d.exports.useState(!1),[ve,Me]=d.exports.useState([]),{simpleAlert:ce=null}=$t(),ue=d.exports.useCallback((me,ge)=>{switch(me){case rt.GUIDE_TOOL_MENU:i(E("guide.help.guide.tool.title")),o(!1);break;case rt.GUIDE_ACCEPT:i(E("guide.help.request.guide.accept.title")),o(!0);break;case rt.GUIDE_ONGOING:i(E("guide.help.request.guide.ongoing.title",["name"],[ge])),o(!0);break;case rt.USER_CREATE:i(E("guide.help.request.user.create.title")),o(!1);break;case rt.USER_PENDING:i(E("guide.help.request.user.pending.title")),o(!0);break;case rt.USER_ONGOING:i(E("guide.help.request.user.ongoing.title",["name"],[ge])),o(!0);break;case rt.USER_FEEDBACK:i(E("guide.help.request.user.feedback.title")),o(!0);break;case rt.USER_THANKS:i(E("guide.help.request.user.thanks.title")),o(!1);break;case rt.USER_NO_HELPERS:i(E("guide.help.request.no_tour_guides.heading")),o(!1);break;case rt.USER_SOMETHING_WRONG:i(E("guide.help.request.user.guide.disconnected.error.heading")),o(!1);break}c(me),t(!0)},[]),$=d.exports.useCallback(me=>{switch(me.type){case Mr.SHOW_GUIDE_TOOL:t(!0);return;case Mr.HIDE_GUIDE_TOOL:t(!1);return;case Mr.TOGGLE_GUIDE_TOOL:t(ge=>!ge);return;case Mr.CREATE_HELP_REQUEST:ue(rt.USER_CREATE);return}},[ue]);Cs(Mr.SHOW_GUIDE_TOOL,$),Cs(Mr.HIDE_GUIDE_TOOL,$),Cs(Mr.TOGGLE_GUIDE_TOOL,$),Cs(Mr.CREATE_HELP_REQUEST,$),j(aE,me=>{!me.getParser().isAllowed(Si.USE_GUIDE_TOOL)&&h&&(u(!1),W(new gf(!1,!1,!1,!1)))}),j(KC,me=>{const ge=me.getParser();u(ge.onDuty),P(ge.guidesOnDuty),A(ge.helpersOnDuty),D(ge.guardiansOnDuty)}),j(qC,me=>{const ge=me.getParser();F(ge.helpRequestDescription),B(ge.roleSpecificWaitTime),ge.asGuide&&h&&ue(rt.GUIDE_ACCEPT),ge.asGuide||ue(rt.USER_PENDING)}),j(tE,me=>{const ge=me.getParser();h?(q(ge.requesterUserId),H(ge.requesterName),ee(ge.requesterFigure),ue(rt.GUIDE_ONGOING,ge.requesterName)):(q(ge.guideUserId),H(ge.guideName),ee(ge.guideFigure),ue(rt.USER_ONGOING,ge.guideName))}),j(JC,me=>{const ge=me.getParser();de(ge.isTyping)}),j($C,me=>{const ge=me.getParser(),Ae=[...ve];let Xe=Ae[Ae.length-1];(!Xe||Xe.userId!==ge.senderId)&&(Xe=new AT(ge.senderId),Ae.push(Xe)),Xe.addChat(new CT(ge.chatMessage)),Me(Ae)}),j(QC,me=>{const ge=me.getParser();if(ge.roomId!==0){const Ae=[...ve];let Xe=Ae[Ae.length-1];const je=h?ie().userId:V;(!Xe||Xe.userId!==je)&&(Xe=new AT(je),Ae.push(Xe)),Xe.addChat(new CT(ge.roomName,ge.roomId)),Me(Ae)}}),j(Zp,me=>{h?(q(0),H(null),ee(null),de(!1),Me([]),ue(rt.GUIDE_TOOL_MENU)):ue(rt.USER_FEEDBACK)}),j(eE,me=>{switch(me.getParser().errorCode){case 0:ue(rt.USER_SOMETHING_WRONG);break;case 1:case 2:ue(rt.USER_NO_HELPERS);break}}),j(XC,me=>{q(0),H(null),ee(null),de(!1),Me([]),ue(h?rt.GUIDE_TOOL_MENU:rt.USER_THANKS)}),d.exports.useEffect(()=>{const me={linkReceived:ge=>{const Ae=ge.split("/");if(!(Ae.length<2))switch(Ae[1]){case"tour":return}},eventUrlPrefix:"help/"};return xs(me),()=>ws(me)},[]);const re=d.exports.useCallback(me=>{switch(me){case"close":t(!1),w(""),c(rt.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!g&&!p&&!T){ce(E("guide.help.guide.tool.noqueueselected.message"),null,null,null,E("guide.help.guide.tool.noqueueselected.caption"),null);return}u(Ae=>(W(new gf(!Ae,Ae?!1:p,Ae?!1:T,Ae?!1:g)),!Ae));return;case"forum_link":const ge=Ee("group.homepage.url","").replace("%groupid%",Ee("guide.help.alpha.groupid","0"));window.open(ge);return}},[g,p,T,ce]);return e?_(Be,{className:"nitro-guide-tool",theme:"primary",children:[a(He,{headerText:r,onCloseClick:me=>re("close"),noCloseButton:n}),_(Ge,{className:"text-black",children:[l===rt.GUIDE_TOOL_MENU&&a(zQ,{isOnDuty:h,isHandlingGuideRequests:p,setIsHandlingGuideRequests:f,isHandlingHelpRequests:T,setIsHandlingHelpRequests:I,isHandlingBullyReports:g,setIsHandlingBullyReports:m,guidesOnDuty:N,helpersOnDuty:O,guardiansOnDuty:y,processAction:re}),l===rt.GUIDE_ACCEPT&&a(YQ,{helpRequestDescription:k,helpRequestAverageTime:L}),[rt.GUIDE_ONGOING,rt.USER_ONGOING].includes(l)&&a(KQ,{isGuide:h,userId:V,userName:Z,userFigure:X,isTyping:Oe,messageGroups:ve}),l===rt.USER_CREATE&&a(XQ,{userRequest:x,setUserRequest:w}),l===rt.USER_PENDING&&a(JQ,{helpRequestDescription:k,helpRequestAverageTime:L}),l===rt.USER_FEEDBACK&&a(QQ,{userName:Z}),l===rt.USER_THANKS&&a(e$,{}),l===rt.USER_NO_HELPERS&&a($Q,{}),l===rt.USER_SOMETHING_WRONG&&a(ZQ,{})]})]}):null},s$=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(null),{userFigure:h=null}=za(),{purse:u=null,clubStatus:g=null}=vl(),{badgeCodes:m=[],activate:p=null,deactivate:f=null}=Rg(),T=()=>u.clubDays<=0?E("purse.clubdays.zero.amount.text"):u.minutesUntilExpiration>-1&&u.minutesUntilExpiration<60*24?Or.shortFormat(u.minutesUntilExpiration*60):Or.shortFormat((u.clubPeriods*31+u.clubDays)*86400),I=()=>{switch(g){case On.ACTIVE:return E(`hccenter.status.${g}.info`,["timeleft","joindate","streakduration"],[T(),r==null?void 0:r.firstSubscriptionDate,Or.shortFormat((r==null?void 0:r.currentHcStreak)*86400)]);case On.EXPIRED:return E(`hccenter.status.${g}.info`,["joindate"],[r==null?void 0:r.firstSubscriptionDate]);default:return E(`hccenter.status.${g}.info`)}},O=()=>!r||r.timeUntilPayday<60?E("hccenter.special.time.soon"):Or.shortFormat(r.timeUntilPayday*60),A=()=>E("hccenter.special.sum",["credits"],[((r==null?void 0:r.creditRewardForStreakBonus)+(r==null?void 0:r.creditRewardForMonthlySpent)).toString()]);if(j(Kp,P=>{const y=P.getParser();o(y.giftsAvailable)}),j(Yb,P=>{const y=P.getParser();i(y.data)}),d.exports.useEffect(()=>{const P={linkReceived:y=>{const D=y.split("/");if(!(D.length<2))switch(D[1]){case"open":if(D.length>2)switch(D[2]){case"hccenter":t(!0);break}return}},eventUrlPrefix:"habboUI/"};return xs(P),()=>ws(P)},[]),d.exports.useEffect(()=>{c(tX(m))},[m]),d.exports.useEffect(()=>{if(!e)return;const P=p();return()=>f(P)},[e,p,f]),d.exports.useEffect(()=>{W(new pE),W(new aP)},[]),!e)return null;const N=a(yd,{id:"popover-basic",children:_(yd.Body,{className:"text-black py-2 px-3",children:[a("h5",{children:E("hccenter.breakdown.title")}),a("div",{children:E("hccenter.breakdown.creditsspent",["credits"],[r==null?void 0:r.totalCreditsSpent.toString()])}),a("div",{children:E("hccenter.breakdown.paydayfactor.percent",["percent"],[((r==null?void 0:r.kickbackPercentage)*100).toString()])}),a("div",{children:E("hccenter.breakdown.streakbonus",["credits"],[r==null?void 0:r.creditRewardForStreakBonus.toString()])}),a("hr",{className:"w-100 text-black my-1"}),a("div",{children:E("hccenter.breakdown.total",["credits","actual"],[A(),(((r==null?void 0:r.kickbackPercentage)*(r==null?void 0:r.totalCreditsSpent)+(r==null?void 0:r.creditRewardForStreakBonus))*100/100).toString()])}),a("div",{className:"btn btn-link text-primary p-0",onClick:()=>Le("habbopages/"+Ee("hc.center")["payday.habbopage"]),children:E("hccenter.special.infolink")})]})});return _(Be,{theme:"primary",className:"nitro-hc-center",children:[a(He,{headerText:E("generic.hccenter"),onCloseClick:()=>t(!1)}),_(M,{position:"relative",className:"bg-muted p-2 hc-logo",children:[a(v,{gap:1,justifyContent:"end",className:"px-2",children:a(M,{children:a(Y,{variant:"success",onClick:P=>Le("catalog/open/"+Ee("catalog.links")["hc.buy_hc"]),children:E(g===On.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})}),a(K,{position:"absolute",className:"end-0 p-4 top-3 habbo-avatar",children:a(Ts,{figure:h,direction:4,scale:2})})]}),_(Ge,{children:[_(M,{gap:2,children:[a(as,{badgeCode:l,className:"align-self-center flex-shrink-0 me-1"}),_(v,{size:5,className:"streak-info",gap:0,children:[a(C,{small:!0,children:E("hccenter.status."+g)}),a(C,{small:!0,dangerouslySetInnerHTML:{__html:I()}})]})]}),Ee("hc.center")["payday.info"]&&_(M,{alignItems:"center",children:[_(v,{gap:1,className:"p-2 payday-special mb-1 ml-1",children:[a(C,{variant:"white",bold:!0,children:E("hccenter.special.title")}),a(C,{variant:"white",small:!0,children:E("hccenter.special.info")}),a(C,{variant:"white",small:!0,underline:!0,className:"pt-4 cursor-pointer",onClick:()=>Le("habbopages/"+Ee("hc.center")["payday.habbopage"]),children:E("hccenter.special.infolink")})]}),_(v,{gap:0,className:"payday flex-shrink-0 p-2",children:[a(C,{bold:!0,className:"ms-2",children:E("hccenter.special.time.title")}),_(M,{children:[a("i",{className:"clock me-2"}),a(C,{className:"align-self-center",children:O()})]}),g===On.ACTIVE&&_(v,{gap:1,className:"pe-3 pt-3",children:[a(C,{bold:!0,className:"ms-2",children:E("hccenter.special.amount.title")}),_(M,{children:[a(C,{className:"w-100 text-center ms-4n",children:A()}),a(iS,{trigger:["hover","focus"],placement:"left",overlay:N,children:a(C,{underline:!0,small:!0,variant:"primary",className:"pt-4",children:E("hccenter.breakdown.infolink")})})]})]})]})]}),Ee("hc.center")["gift.info"]&&_(M,{className:"hc-gift-special p-2",children:[_(v,{gap:1,children:[a(C,{variant:"white",bold:!0,children:E("hccenter.gift.title")}),a(C,{variant:"white",dangerouslySetInnerHTML:{__html:n>0?E("hccenter.unclaimedgifts",["unclaimedgifts"],[n.toString()]):E("hccenter.gift.info")}})]}),a(Y,{className:"btn-lg align-self-center ms-auto",onClick:()=>Le("catalog/open/"+Ee("catalog.links")["hc.hc_gifts"]),children:E(g===On.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),Ee("hc.center")["benefits.info"]&&_(v,{className:"benefits py-2",children:[a(C,{bold:!0,variant:"primary",children:E("hccenter.general.title")}),a(C,{small:!0,dangerouslySetInnerHTML:{__html:E("hccenter.general.info")}}),a(C,{small:!0,underline:!0,className:"cursor-pointer",variant:"primary",onClick:()=>Le("habbopages/"+Ee("hc.center")["benefits.habbopage"]),children:E("hccenter.general.infolink")})]})]})]})},r$=s=>{const[e,t]=d.exports.useState(""),{activeReport:r=null,setActiveReport:i=null}=un(),n=()=>{e.length<15||i(l=>{const c=ur.REPORT_SUMMARY;return{...l,message:e,currentStep:c}})},o=()=>{i(l=>({...l,currentStep:l.currentStep-1}))};return _(J,{children:[_(v,{gap:1,children:[a(C,{fontSize:4,children:E("help.emergency.chat_report.subtitle")}),a(C,{children:E("help.cfh.input.text")})]}),a("textarea",{className:"form-control h-100",value:e,onChange:l=>t(l.target.value)}),_(M,{gap:2,justifyContent:"between",children:[a(Y,{variant:"secondary",disabled:!(r.reportType===Qt.BULLY||r.reportType===Qt.EMERGENCY),onClick:o,children:E("generic.back")}),a(Y,{disabled:e.length<15,onClick:n,children:E("help.emergency.main.submit.button")})]})]})},i$=s=>{const{setActiveReport:e=null}=un(),t=()=>{e(r=>{const i=ur.SELECT_USER,n=Qt.BULLY;return{...r,currentStep:i,reportType:n}})};return _(J,{children:[_(v,{grow:!0,center:!0,gap:1,children:[a(C,{fontSize:3,children:E("help.main.frame.title")}),a(C,{children:E("help.main.self.description")})]}),_(v,{gap:1,children:[a(Y,{onClick:t,children:E("help.main.bully.subtitle")}),a(Y,{onClick:()=>zs(new Mr(Mr.CREATE_HELP_REQUEST)),disabled:!Ee("guides.enabled"),children:E("help.main.help.title")}),a(Y,{disabled:!0,children:E("help.main.self.tips.title")})]}),a(Y,{variant:"link",textColor:"black",onClick:()=>W(new _v(!1)),children:E("help.main.my.sanction.status")})]})},n$=s=>{const{username:e="",onAction:t=null}=s,[r,i]=d.exports.useState(!1),n=()=>{r||(i(!0),W(new qb(e)))};return j(K_,o=>{const l=o.getParser();l&&l.webId===ie().userId&&t("close")}),_("div",{className:"d-flex flex-column gap-4 h-100",children:[a("div",{className:"bg-muted rounded p-2 text-center",children:E("tutorial.name_change.info.confirm")}),_("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[a("div",{children:E("tutorial.name_change.confirm")}),a("div",{className:"fw-bold",children:e})]}),_("div",{className:"d-flex gap-2",children:[a("button",{className:"btn btn-success w-100",disabled:r,onClick:n,children:E("generic.ok")}),a("button",{className:"btn btn-primary w-100",onClick:()=>t("close"),children:E("cancel")})]})]})},a$=s=>{const{onAction:e=null}=s;return _("div",{className:"d-flex flex-column gap-4 h-100",children:[a("div",{className:"bg-muted rounded p-2 text-center",children:E("tutorial.name_change.info.main")}),a("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:E("tutorial.name_change.current",["name"],[ie().userName])}),_("div",{className:"d-flex gap-2",children:[a("button",{className:"btn btn-success w-100",onClick:()=>e("start"),children:E("tutorial.name_change.change")}),a("button",{className:"btn btn-primary w-100",onClick:()=>e("confirmation",ie().userName),children:E("tutorial.name_change.keep")})]})]})},o$=0,l$=2,c$=3,u$=4,h$=5,d$=6,_$=s=>{const{onAction:e=null}=s,[t,r]=d.exports.useState(""),[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState([]),m=()=>{t!==""&&(n(!1),g([]),h(null),l(!0),W(new Xb(t)))},p=f=>{n(!1),g([]),h(null),r(f)};return j(HO,f=>{l(!1);const T=f.getParser();if(T)switch(T.resultCode){case o$:n(!0);break;case l$:h("short");break;case c$:h("long");break;case u$:h("invalid");break;case h$:g(T.nameSuggestions),h("taken");break;case d$:h("change_not_allowed")}}),_("div",{className:"d-flex flex-column gap-3 h-100",children:[a("div",{children:E("tutorial.name_change.info.select")}),_("div",{className:"d-flex gap-2",children:[a("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:f=>p(f.target.value)}),a("button",{className:"btn btn-primary",disabled:t===""||o,onClick:m,children:E("tutorial.name_change.check")})]}),!c&&!i&&a("div",{className:"bg-muted rounded p-2 text-center",children:E("help.tutorial.name.info")}),c&&a("div",{className:"bg-danger rounded p-2 text-center text-white",children:E(`help.tutorial.name.${c}`,["name"],[t])}),i&&a("div",{className:"bg-success rounded p-2 text-center text-white",children:E("help.tutorial.name.available",["name"],[t])}),u&&a("div",{className:"d-flex flex-column gap-2",children:u.map((f,T)=>a("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>p(f),children:f},T))}),_("div",{className:"d-flex gap-2",children:[a("button",{className:"btn btn-success w-100",disabled:!i,onClick:()=>e("confirmation",t),children:E("tutorial.name_change.pick")}),a("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:E("cancel")})]})]})},Hh="INIT",Hg="INPUT",Wg="CONFIRMATION",g$=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(Hh),[n,o]=d.exports.useState(""),l=(h,u)=>{switch(h){case"start":i(Hg);break;case"confirmation":o(u),i(Wg);break;case"close":o(""),t(!1);break}},c=d.exports.useMemo(()=>{switch(r){case Hh:return"tutorial.name_change.title.main";case Hg:return"tutorial.name_change.title.select";case Wg:return"tutorial.name_change.title.confirm"}},[r]);return Cs(E_.INIT,h=>{i(Hh),t(!0)}),e?_(Be,{className:"nitro-change-username",theme:"primary",children:[a(He,{headerText:E(c),onCloseClick:()=>l("close")}),_(Ge,{className:"text-black",children:[r===Hh&&a(a$,{onAction:l}),r===Hg&&a(_$,{onAction:l}),r===Wg&&a(n$,{username:n,onAction:l})]})]}):null},m$=s=>{const{activeReport:e=null,setActiveReport:t=null}=un(),r=()=>{const i=[];switch(e.reportType){case Qt.BULLY:case Qt.EMERGENCY:case Qt.ROOM:{const n=e.roomId<=0?e.reportedChats[0].roomId:e.roomId;e.reportedChats.forEach(o=>i.push(o.webId,o.message)),W(new hv(e.message,e.cfhTopic,e.reportedUserId,n,i));break}case Qt.IM:e.reportedChats.forEach(n=>i.push(n.webId,n.message)),W(new cv(e.message,e.cfhTopic,e.reportedUserId,i));break;case Qt.THREAD:W(new lv(e.groupId,e.threadId,e.cfhTopic,e.message));break;case Qt.MESSAGE:W(new ov(e.groupId,e.threadId,e.messageId,e.cfhTopic,e.message));break;case Qt.PHOTO:W(new uv(e.extraData,e.roomId,e.reportedUserId,e.cfhTopic,e.roomObjectId));break}t(null)};return _(J,{children:[_(v,{gap:1,children:[a(C,{fontSize:4,children:E("help.cfh.button.send")}),a(C,{children:E("help.main.summary")})]}),a(Y,{variant:"success",onClick:r,children:E("guide.help.request.emergency.submit.button")})]})},f$=s=>{const{sanctionInfo:e=null,setSanctionInfo:t=null}=un(),r=(i,n,o)=>{let l=`help.sanction.${i}`;switch(n){case"ALERT":l=l+".alert";break;case"MUTE":l=l+".mute";break;case"BAN_PERMANENT":l=l+".permban";break;default:if(l=l+".ban",o>24)return l=l+".days",E(l,["days"],[(o/24).toString()])}return E(l,["hours"],[o.toString()])};return e?_(Be,{className:"nitro-help",theme:"primary",children:[a(He,{headerText:E("help.sanction.info.title"),onCloseClick:()=>t(null)}),a(Ge,{className:"text-black",children:_(qe,{children:[a(v,{center:!0,size:5,overflow:"hidden",children:a(K,{className:"index-image"})}),_(v,{justifyContent:"between",size:7,overflow:"hidden",children:[e.sanctionReason==="cfh.reason.EMPTY"?a("div",{className:"col-12 fw-bold",children:E("help.sanction.current.none")}):_(J,{children:[(e.probationHoursLeft>0||e.isSanctionActive)&&a("div",{className:"col-12 fw-bold",children:E("help.sanction.probation.reminder")}),_("div",{className:`col-12 fw-bold ${e.isSanctionNew?"text-danger":""}`,children:[E("help.sanction.last.sanction")," ",r("current",e.sanctionName,e.sanctionLengthHours)]}),_("div",{className:"col-12",children:[E("generic.start.time")," ",e.sanctionCreationTime]}),_("div",{className:"col-12",children:[E("generic.reason")," ",e.sanctionReason]}),_("div",{className:"col-12",children:[E("help.sanction.probation.days.left")," ",Math.trunc(e.probationHoursLeft/24)+1]})]}),e.hasCustomMute&&!e.isSanctionActive&&a("div",{className:"col-12 fw-bold",children:E("help.sanction.custom.mute")}),e.tradeLockExpiryTime&&e.tradeLockExpiryTime.length>0&&_("div",{className:"col-12 fw-bold",children:[E("trade.locked.until")," ",e.tradeLockExpiryTime]}),a("div",{className:"col-12",children:r("next",e.nextSanctionName,e.nextSanctionLengthHours)}),a(Y,{variant:"success",onClick:i=>t(null),children:E("habbo.way.ok.button")})]})]})})]}):null},p$=s=>{const[e,t]=d.exports.useState([]),{activeReport:r=null,setActiveReport:i=null}=un(),{chatHistory:n=[],messengerHistory:o=[]}=Eg(),l=d.exports.useMemo(()=>{switch(r.reportType){case Qt.BULLY:case Qt.EMERGENCY:return n.filter(g=>g.type===rn.TYPE_CHAT&&g.webId===r.reportedUserId&&g.entityType===jt.USER);case Qt.IM:return o.filter(g=>g.webId===r.reportedUserId&&g.type===rn.TYPE_IM)}return[]},[r,n,o]),c=g=>{t(m=>{const p=[...m],f=p.indexOf(g);return f>=0?p.splice(f,1):p.push(g),p})},h=()=>{!e||e.length<=0||i(g=>({...g,reportedChats:e,currentStep:ur.SELECT_TOPICS}))},u=()=>{i(g=>({...g,currentStep:g.currentStep-1}))};return _(J,{children:[_(v,{gap:1,children:[a(C,{fontSize:4,children:E("help.emergency.chat_report.subtitle")}),a(C,{children:E("help.emergency.chat_report.description")})]}),_(v,{gap:1,overflow:"hidden",children:[!l||!l.length&&a(C,{children:E("help.cfh.error.no_user_data")}),l.length>0&&a(Bt,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:l.map((g,m)=>a(yt,{onClick:p=>c(g),itemActive:e.indexOf(g)>=0,children:a(C,{children:g.message})},g.id))})]}),_(M,{gap:2,justifyContent:"between",children:[a(Y,{variant:"secondary",onClick:u,disabled:r.reportType===Qt.IM,children:E("generic.back")}),a(Y,{disabled:e.length<=0,onClick:h,children:E("help.emergency.main.submit.button")})]})]})},E$=s=>{const[e,t]=d.exports.useState(-1),{chatHistory:r=[]}=Eg(),{activeReport:i=null,setActiveReport:n=null}=un(),o=d.exports.useMemo(()=>{const u=new Map;return r.forEach(g=>{g.type===rn.TYPE_CHAT&&g.entityType===jt.USER&&g.webId!==ie().userId&&!u.has(g.webId)&&u.set(g.webId,{id:g.webId,username:g.name})}),Array.from(u.values())},[r]),l=u=>{u<=0||n(g=>({...g,reportedUserId:u,currentStep:ur.SELECT_CHATS}))},c=u=>{t(g=>u===g?-1:u)},h=()=>{n(u=>({...u,currentStep:u.currentStep-1}))};return _(J,{children:[_(v,{gap:1,children:[a(C,{fontSize:4,children:E("help.emergency.main.step.two.title")}),o.length>0&&a(C,{children:E("report.user.pick.user")})]}),_(v,{gap:1,overflow:"hidden",children:[!o.length&&a(C,{children:E("report.user.error.nolist")}),o.length>0&&a(Bt,{columnCount:1,columnMinHeight:25,gap:1,children:o.map((u,g)=>a(yt,{onClick:m=>c(u.id),itemActive:e===u.id,children:a("span",{dangerouslySetInnerHTML:{__html:u.username}})},u.id))})]}),_(M,{gap:2,justifyContent:"between",children:[a(Y,{variant:"secondary",onClick:h,children:E("generic.back")}),a(Y,{disabled:e<=0,onClick:()=>l(e),children:E("help.emergency.main.submit.button")})]})]})},I$=s=>{const[e,t]=d.exports.useState(-1),[r,i]=d.exports.useState(-1),{setActiveReport:n=null}=un(),{cfhCategories:o=[]}=Jc(),l=()=>{e<0||r<0||n(h=>({...h,cfhCategory:e,cfhTopic:o[e].topics[r].id,currentStep:ur.INPUT_REPORT_MESSAGE}))},c=()=>{n(h=>({...h,currentStep:h.currentStep-1}))};return _(J,{children:[_(v,{gap:1,children:[a(C,{fontSize:4,children:E("help.emergency.chat_report.subtitle")}),a(C,{children:E("help.cfh.pick.topic")})]}),_(v,{gap:1,overflow:"auto",children:[e<0&&o.map((h,u)=>a(Y,{variant:"danger",onClick:g=>t(u),children:E(`help.cfh.reason.${h.name}`)},u)),e>=0&&o[e].topics.map((h,u)=>a(Y,{variant:"danger",onClick:g=>i(u),active:r===u,children:E(`help.cfh.topic.${h.id}`)},u))]}),_(M,{gap:2,justifyContent:"between",children:[a(Y,{variant:"secondary",onClick:c,children:E("generic.back")}),a(Y,{disabled:r<0,onClick:l,children:E("help.emergency.main.submit.button")})]})]})},T$=s=>{const[e,t]=d.exports.useState(!1),{activeReport:r=null,setActiveReport:i=null,report:n=null}=un(),o=()=>{i(null),t(!1)};d.exports.useEffect(()=>{const c={linkReceived:h=>{const u=h.split("/");if(!(u.length<2))switch(u[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(g=>!g);return;case"tour":return;case"report":u.length>=5&&u[2]==="room"&&(parseInt(u[3]),unescape(u.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return xs(c),()=>ws(c)},[]),d.exports.useEffect(()=>{r&&t(!0)},[r]);const l=()=>{if(r)switch(r.currentStep){case ur.SELECT_USER:return a(E$,{});case ur.SELECT_CHATS:return a(p$,{});case ur.SELECT_TOPICS:return a(I$,{});case ur.INPUT_REPORT_MESSAGE:return a(r$,{});case ur.REPORT_SUMMARY:return a(m$,{})}return a(i$,{})};return _(J,{children:[e&&_(Be,{className:"nitro-help",theme:"primary",children:[a(He,{headerText:E("help.button.cfh"),onCloseClick:o}),a(Ge,{className:"text-black",children:_(qe,{children:[a(v,{center:!0,size:5,overflow:"hidden",children:a(K,{className:"index-image"})}),a(v,{justifyContent:"between",size:7,overflow:"hidden",children:a(l,{})})]})})]}),a(f$,{}),a(g$,{})]})},R$=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null);return j(tC,h=>{const u=h.getParser();t(u.productType),i(u.productClassId),o(u.totalCoinsForBonus),c(u.coinsStillRequiredToBuy)}),d.exports.useEffect(()=>{W(new ay)},[]),e?_("div",{className:"bonus-rare widget d-flex",children:[e,_("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[a("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:n-l+"/"+n}),a("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(n-l)/n*100+"%"}})]})]}):null},S$=s=>{const{data:e=null,level:t=0}=s;return _("div",{className:"hof-user-container",children:[_("div",{className:"hof-tooltip",children:[_("div",{className:"hof-header",children:[t,". ",e.userName," ",a(Ei,{userId:e.userId})]}),a("div",{className:"small text-center text-white",children:E("landing.view.competition.hof.points",["points"],[u_(e.currentScore).toString()])})]}),a(Ts,{figure:e.figure,direction:2})]})},O$=s=>{const{slot:e=-1,conf:t=null}=s,[r,i]=d.exports.useState(null);return j(PN,n=>{const o=n.getParser();i(o.data)}),d.exports.useEffect(()=>{const n=t?t.campaign:"";W(new CM(n))},[t]),r?a("div",{className:"hall-of-fame d-flex",children:r.hof&&r.hof.length>0&&r.hof.map((n,o)=>a(S$,{data:n,level:o+1},o))}):null},C$=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(0);return j(CA,n=>{const o=n.getParser();t(o.articles)}),d.exports.useEffect(()=>{W(new wv)},[]),e?_("div",{className:"promo-articles widget mb-2",children:[_("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[a("small",{className:"flex-shrink-0 pe-1",children:E("landing.view.promo.article.header")}),a("hr",{className:"w-100 my-0"})]}),a("div",{className:"d-flex flex-row mb-1",children:e&&e.length>0&&e.map((n,o)=>a("div",{className:"promo-articles-bullet cursor-pointer "+(n===e[r]?"promo-articles-bullet-active":""),onClick:l=>i(o)},n.id))}),e&&e[r]&&_("div",{className:"promo-article d-flex flex-row row mx-0",children:[a("div",{className:"promo-article-image",style:{backgroundImage:`url(${e[r].imageUrl})`}}),_("div",{className:"col-3 d-flex flex-column h-100",children:[a("h3",{className:"my-0",children:e[r].title}),a("b",{children:e[r].bodyText}),a("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:n=>Al(e[r].linkContent),children:e[r].buttonText})]})]})]}):null},A$=s=>{const{conf:e=null}=s,t=r=>{const i=e[r];if(!i)return null;switch(r){case"image":return Ke.interpolate(i)}return i};return _("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[a("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${t("image")})`}}),_("div",{className:"d-flex flex-column align-self-center",children:[a("h3",{className:"my-0",children:E(`landing.view.${t("texts")}.header`)}),a("i",{children:E(`landing.view.${t("texts")}.body`)}),a("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:r=>Al(t("btnLink")),children:E(`landing.view.${t("texts")}.button`)})]})]})},N$=s=>{switch(s.widgetType){case"promoarticle":return a(C$,{});case"achievementcompetition_hall_of_fame":return a(O$,{slot:s.slot,conf:s.widgetConf});case"bonusrare":return a(R$,{});case"widgetcontainer":return a(A$,{conf:s.widgetConf});default:return null}},Bo=s=>{const{widgetType:e=null,widgetSlot:t=0,widgetConf:r=null,className:i="",...n}=s;return a("div",{className:`widget-slot slot-${t} ${i||""}`,...n,children:a(N$,{widgetType:e,slot:t,widgetConf:r})})},b$=s=>{const[e,t]=d.exports.useState(!0),{userFigure:r=null}=za();if(es([Ve.CREATED,Ve.ENDED],g=>{switch(g.type){case Ve.CREATED:t(!1);return;case Ve.ENDED:t(g.openLandingView);return}}),!e)return null;const i=Ee("hotelview").images["background.colour"],n=Ke.interpolate(Ee("hotelview").images.background),o=Ke.interpolate(Ee("hotelview").images.sun),l=Ke.interpolate(Ee("hotelview").images.drape),c=Ke.interpolate(Ee("hotelview").images.left),h=Ke.interpolate(Ee("hotelview").images["right.repeat"]),u=Ke.interpolate(Ee("hotelview").images.right);return _("div",{className:"nitro-hotel-view",style:i&&i?{background:i}:{},children:[a("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:_("div",{className:"row h-100",children:[_("div",{className:"col-9 h-100 d-flex flex-column",children:[a(Bo,{widgetSlot:1,widgetType:Ee("hotelview").widgets["slot."+1+".widget"],widgetConf:Ee("hotelview").widgets["slot."+1+".conf"],className:"col-6"}),_("div",{className:"col-12 row mx-0",children:[a(Bo,{widgetSlot:2,widgetType:Ee("hotelview").widgets["slot."+2+".widget"],widgetConf:Ee("hotelview").widgets["slot."+2+".conf"],className:"col-7"}),a(Bo,{widgetSlot:3,widgetType:Ee("hotelview").widgets["slot."+3+".widget"],widgetConf:Ee("hotelview").widgets["slot."+3+".conf"],className:"col-5"}),a(Bo,{widgetSlot:4,widgetType:Ee("hotelview").widgets["slot."+4+".widget"],widgetConf:Ee("hotelview").widgets["slot."+4+".conf"],className:"col-7"}),a(Bo,{widgetSlot:5,widgetType:Ee("hotelview").widgets["slot."+5+".widget"],widgetConf:Ee("hotelview").widgets["slot."+5+".conf"],className:"col-5"})]}),a(Bo,{widgetSlot:6,widgetType:Ee("hotelview").widgets["slot."+6+".widget"],widgetConf:Ee("hotelview").widgets["slot."+6+".conf"],className:"mt-auto"})]}),a("div",{className:"col-3 h-100",children:a(Bo,{widgetSlot:7,widgetType:Ee("hotelview").widgets["slot."+7+".widget"],widgetConf:Ee("hotelview").widgets["slot."+7+".conf"]})})]})}),a("div",{className:"background position-absolute",style:n&&n.length?{backgroundImage:`url(${n})`}:{}}),a("div",{className:"sun position-absolute",style:o&&o.length?{backgroundImage:`url(${o})`}:{}}),a("div",{className:"drape position-absolute",style:l&&l.length?{backgroundImage:`url(${l})`}:{}}),a("div",{className:"left position-absolute",style:c&&c.length?{backgroundImage:`url(${c})`}:{}}),a("div",{className:"right-repeat position-absolute",style:h&&h.length?{backgroundImage:`url(${h})`}:{}}),a("div",{className:"right position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),Ee("hotelview")["show.avatar"]&&a("div",{className:"avatar-image",children:a(Ts,{figure:r,direction:2})})]})},qT=s=>{const{badgeCode:e=null,children:t=null,...r}=s,{selectedBadgeCode:i=null,setSelectedBadgeCode:n=null,toggleBadge:o=null,getBadgeId:l=null}=Rg(),{isUnseen:c=null}=Ci(),h=c(os.BADGE,l(e));return _(yt,{itemActive:i===e,itemUnseen:h,onMouseDown:u=>n(e),onDoubleClick:u=>o(i),...r,children:[a(as,{badgeCode:e}),t]})},y$=s=>{const[e,t]=d.exports.useState(!1),{badgeCodes:r=[],activeBadgeCodes:i=[],selectedBadgeCode:n=null,isWearingBadge:o=null,canWearBadges:l=null,toggleBadge:c=null,getBadgeId:h=null,activate:u=null,deactivate:g=null}=Rg(),{isUnseen:m=null,removeUnseen:p=null}=Ci();return d.exports.useEffect(()=>{!n||!m(os.BADGE,h(n))||p(os.BADGE,h(n))},[n,m,p,h]),d.exports.useEffect(()=>{if(!e)return;const f=u();return()=>g(f)},[e,u,g]),d.exports.useEffect(()=>(t(!0),()=>t(!1)),[]),_(qe,{children:[a(v,{size:7,overflow:"hidden",children:a(Bt,{columnCount:4,children:r&&r.length>0&&r.map((f,T)=>o(f)?null:a(qT,{badgeCode:f},T))})}),_(v,{className:"justify-content-between",size:5,overflow:"auto",children:[_(v,{overflow:"hidden",gap:2,children:[a(C,{children:E("inventory.badges.activebadges")}),a(Bt,{columnCount:3,children:i&&i.length>0&&i.map((f,T)=>a(qT,{badgeCode:f},T))})]}),!!n&&_(v,{grow:!0,justifyContent:"end",gap:2,children:[_(M,{alignItems:"center",gap:2,children:[a(as,{shrink:!0,badgeCode:n}),a(C,{children:Th(n)})]}),a(Y,{disabled:!o(n)&&!l(),onClick:f=>c(n),children:E(o(n)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},FI=s=>{const{title:e="",desc:t="",children:r=null,...i}=s;return _(qe,{...i,children:[a(v,{center:!0,size:5,overflow:"hidden",children:a("div",{className:"empty-image"})}),_(v,{justifyContent:"center",size:7,overflow:"hidden",children:[a(C,{bold:!0,fontSize:5,overflow:"unset",truncate:!0,children:e}),a(C,{overflow:"auto",children:t})]}),r]})},v$=s=>{const{botItem:e=null,children:t=null,...r}=s,[i,n]=d.exports.useState(!1),{selectedBot:o=null,setSelectedBot:l=null}=S0(),{isUnseen:c=null}=Ci(),h=c(os.BOT,e.botData.id),u=g=>{switch(g.type){case fe.MOUSE_DOWN:l(e),n(!0);return;case fe.MOUSE_UP:n(!1);return;case fe.ROLL_OUT:if(!i||o!==e)return;qf(e);return;case"dblclick":qf(e);return}};return _(yt,{itemActive:o===e,itemUnseen:h,onMouseDown:u,onMouseUp:u,onMouseOut:u,onDoubleClick:u,...r,children:[a(Ts,{figure:e.botData.figure,direction:3,headOnly:!0}),t]})},M$=s=>{const{roomSession:e=null,roomPreviewer:t=null}=s,[r,i]=d.exports.useState(!1),{botItems:n=[],selectedBot:o=null,activate:l=null,deactivate:c=null}=S0(),{isUnseen:h=null,removeUnseen:u=null}=Ci();return d.exports.useEffect(()=>{if(!o||!t)return;const g=o.botData,m=te();let p=m.getRoomInstanceVariable(m.activeRoomId,b.ROOM_WALL_TYPE),f=m.getRoomInstanceVariable(m.activeRoomId,b.ROOM_FLOOR_TYPE),T=m.getRoomInstanceVariable(m.activeRoomId,b.ROOM_LANDSCAPE_TYPE);p=p&&p.length?p:"101",f=f&&f.length?f:"101",T=T&&T.length?T:"1.1",t.reset(!1),t.updateRoomWallsAndFloorVisibility(!0,!0),t.updateObjectRoom(f,p,T),t.addAvatarIntoRoom(g.figure,0)},[t,o]),d.exports.useEffect(()=>{!o||!h(os.BOT,o.botData.id)||u(os.BOT,o.botData.id)},[o,h,u]),d.exports.useEffect(()=>{if(!r)return;const g=l();return()=>c(g)},[r,l,c]),d.exports.useEffect(()=>(i(!0),()=>i(!1)),[]),!n||!n.length?a(FI,{title:E("inventory.empty.bots.title"),desc:E("inventory.empty.bots.desc")}):_(qe,{children:[a(v,{size:7,overflow:"hidden",children:a(Bt,{columnCount:5,children:n&&n.length>0&&n.map(g=>a(v$,{botItem:g},g.botData.id))})}),_(v,{size:5,overflow:"auto",children:[a(v,{overflow:"hidden",position:"relative",children:a(Ch,{roomPreviewer:t,height:140})}),o&&_(v,{grow:!0,justifyContent:"between",gap:2,children:[a(C,{grow:!0,truncate:!0,children:o.botData.name}),!!e&&a(Y,{onClick:g=>qf(o),children:E("inventory.furni.placetoroom")})]})]})]})},D$=s=>{const{groupItem:e=null,...t}=s,[r,i]=d.exports.useState(!1),{selectedItem:n=null,setSelectedItem:o=null}=yl(),l=h=>{switch(h.type){case fe.MOUSE_DOWN:o(e),i(!0);return;case fe.MOUSE_UP:i(!1);return;case fe.ROLL_OUT:if(!r||e!==n)return;yc(e);return;case"dblclick":yc(e);return}},c=e.getUnlockedCount();return a(yt,{className:c?"":"opacity-0-5 ",itemImage:e.iconUrl,itemCount:e.getUnlockedCount(),itemActive:e===n,itemUniqueNumber:e.stuffData.uniqueNumber,itemUnseen:e.hasUnseenItems,onMouseDown:l,onMouseUp:l,onMouseOut:l,onDoubleClick:l,...t})},j0=s=>{const{groupItems:e=[],setGroupItems:t=null}=s,[r,i]=d.exports.useState("");return d.exports.useEffect(()=>{let n=[...e];if(r&&r.length){const o=r.toLocaleLowerCase();n=e.filter(l=>o&&o.length&&l.name.toLocaleLowerCase().includes(o)?l:null)}t(n)},[e,t,r]),_(M,{gap:1,children:[a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("generic.search"),value:r,onChange:n=>i(n.target.value)}),a(Y,{variant:"primary",children:a(DU,{className:"fa-icon"})})]})},P$=s=>{const e=s.getLastItem();if(!e||!e.sellable)return!1;zs(new vI(e))},L$=s=>{const{roomSession:e=null,roomPreviewer:t=null}=s,[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState([]),{groupItems:l=[],selectedItem:c=null,activate:h=null,deactivate:u=null}=yl(),{resetItems:g=null}=Ci();return d.exports.useEffect(()=>{if(!c||!t)return;const m=c.getLastItem();if(!m)return;const p=te();let f=p.getRoomInstanceVariable(p.activeRoomId,b.ROOM_WALL_TYPE),T=p.getRoomInstanceVariable(p.activeRoomId,b.ROOM_FLOOR_TYPE),I=p.getRoomInstanceVariable(p.activeRoomId,b.ROOM_LANDSCAPE_TYPE);if(f=f&&f.length?f:"101",T=T&&T.length?T:"101",I=I&&I.length?I:"1.1",t.reset(!1),t.updateObjectRoom(T,f,I),t.updateRoomWallsAndFloorVisibility(!0,!0),m.category===Pe.WALL_PAPER||m.category===Pe.FLOOR||m.category===Pe.LANDSCAPE){if(T=m.category===Pe.FLOOR?c.stuffData.getLegacyString():T,f=m.category===Pe.WALL_PAPER?c.stuffData.getLegacyString():f,I=m.category===Pe.LANDSCAPE?c.stuffData.getLegacyString():I,t.updateObjectRoom(T,f,I),m.category===Pe.LANDSCAPE){const O=ie().getWallItemDataByName("window_double_default");O&&t.addWallItemIntoRoom(O.id,new G(90,0,0),O.customParams)}}else c.isWallItem?t.addWallItemIntoRoom(c.type,new G(90),m.stuffData.getLegacyString()):t.addFurnitureIntoRoom(c.type,new G(90),c.stuffData,m.extra.toString())},[t,c]),d.exports.useEffect(()=>{!c||!c.hasUnseenItems||(g(os.FURNI,c.items.map(m=>m.id)),c.hasUnseenItems=!1)},[c,g]),d.exports.useEffect(()=>{if(!r)return;const m=h();return()=>u(m)},[r,h,u]),d.exports.useEffect(()=>(i(!0),()=>i(!1)),[]),!l||!l.length?a(FI,{title:E("inventory.empty.title"),desc:E("inventory.empty.desc")}):_(qe,{children:[_(v,{size:7,overflow:"hidden",children:[a(j0,{groupItems:l,setGroupItems:o}),a(Bt,{columnCount:5,children:n&&n.length>0&&n.map((m,p)=>a(D$,{groupItem:m},p))})]}),_(v,{size:5,overflow:"auto",children:[_(v,{overflow:"hidden",position:"relative",children:[a(Ch,{roomPreviewer:t,height:140}),c&&c.stuffData.isUnique&&a(o0,{className:"top-2 end-2",position:"absolute",uniqueNumber:c.stuffData.uniqueNumber,uniqueSeries:c.stuffData.uniqueSeries}),c&&c.stuffData.rarityLevel>-1&&a(c0,{className:"top-2 end-2",position:"absolute",level:c.stuffData.rarityLevel})]}),c&&_(v,{grow:!0,justifyContent:"between",gap:2,children:[a(C,{grow:!0,truncate:!0,children:c.name}),_(v,{gap:1,children:[!!e&&a(Y,{onClick:m=>yc(c),children:E("inventory.furni.placetoroom")}),c&&c.isSellable&&a(Y,{onClick:m=>P$(c),children:E("inventory.marketplace.sell")})]})]})]})]})},jg=9,U$=s=>{const{cancelTrade:e=null}=s,[t,r]=d.exports.useState(null),[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(null),[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(3),[m,p]=d.exports.useState(1),{ownUser:f=null,otherUser:T=null,groupItems:I=[],tradeState:O=ps.TRADING_STATE_READY,progressTrade:A=null,removeItem:N=null,setTradeState:P=null}=MI(),{simpleAlert:y=null}=$t(),D=(L,B,V,q,Z)=>{if(!f||f.accepts||!f.userItems)return!1;if(f.userItems.length<jg)return!0;if(!q)return!1;let H=B.toString();return V===Pe.POSTER?H=H+"poster"+Z.getLegacyString():V===Pe.GUILD_FURNI?H=xq(B,Z):H=(L?"I":"S")+H,!!f.userItems.getValue(H)},x=L=>{if(!t)return;const B=t.getTradeItems(L);if(!B||!B.length)return;let V=null;const q=[];for(const H of B)q.push(H.id),V||(V=H);if(f.userItems.length+q.length<=1500)if(!V.isGroupable&&q.length)W(new pf(q.pop()));else{const H=[];for(const X of q)D(V.isWallItem,V.type,V.category,V.isGroupable,V.stuffData)&&H.push(X);H.length&&(H.length===1?W(new pf(H.pop())):W(new Mv(...H)))}else y(E("trading.items.too_many_items.desc"),Ze.DEFAULT,null,null,E("trading.items.too_many_items.title"))},w=L=>L?a(JR,{className:"mt-auto pb-5 text-success fa-icon"}):a(PU,{className:"mt-auto pb-5 text-danger fa-icon"}),k=(L,B)=>{(isNaN(Number(L))||Number(L)<0||!L)&&(L=1),L=Math.max(Number(L),1),L=Math.min(Number(L),B),L!==m&&p(L)},F=L=>{k(m,L),x(m)};return d.exports.useEffect(()=>{p(1)},[t]),d.exports.useEffect(()=>{if(O!==ps.TRADING_STATE_COUNTDOWN)return;g(3);const L=setInterval(()=>{g(B=>{const V=B-1;return V===0&&clearInterval(L),V})},1e3);return()=>clearInterval(L)},[O,P]),d.exports.useEffect(()=>{u===0&&P(ps.TRADING_STATE_CONFIRMING)},[u,P]),O===ps.TRADING_STATE_READY||!f||!T?null:_(v,{children:[a(M,{children:_(v,{size:4,fullWidth:!0,overflow:"hidden",className:"trading-inventory",children:[a(j0,{groupItems:I,setGroupItems:h}),_(M,{column:!0,fullHeight:!0,fullWidth:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[a(Bt,{columnCount:3,children:c&&c.length>0&&c.map((L,B)=>{const V=L.getUnlockedCount();return a(yt,{className:V?"":"opacity-0-5 ",itemImage:L.iconUrl,itemCount:V,itemActive:t===L,itemUniqueNumber:L.stuffData.uniqueNumber,onClick:q=>V&&r(L),onDoubleClick:q=>x(1),children:V>0&&t===L&&a(Y,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:q=>x(1),children:a(qn,{className:"fa-icon"})})},B)})}),_(v,{gap:1,alignItems:"end",children:[_(qe,{overflow:"hidden",children:[a(v,{size:6,overflow:"hidden",children:a("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:E("catalog.bundlewidget.spinner.select.amount"),disabled:!t,value:m,onChange:L=>p(L.target.valueAsNumber)})}),a(v,{size:6,overflow:"hidden",children:a(Y,{variant:"secondary",disabled:!t,onClick:L=>F(t.getUnlockedCount()),children:E("inventory.trading.areoffering")})})]}),a(K,{fullWidth:!0,className:"badge bg-muted",children:t?t.name:E("catalog_selectproduct")})]})]})]})}),_(v,{fullWidth:!0,size:8,overflow:"hidden",className:"trade-bg p-2",children:[_(qe,{overflow:"hidden",children:[_(v,{size:4,overflow:"hidden",children:[a(M,{justifyContent:"between",alignItems:"center",children:_(C,{children:[E("inventory.trading.you")," ",E("inventory.trading.areoffering"),":"]})}),a(Bt,{columnCount:3,children:Array.from(Array(jg),(L,B)=>{const V=f.userItems.getWithIndex(B)||null;return V?a(yt,{itemActive:i===V,itemImage:V.iconUrl,itemCount:V.getTotalCount(),itemUniqueNumber:V.stuffData.uniqueNumber,onClick:q=>n(V),onDoubleClick:q=>N(V),children:i===V&&a(Y,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:q=>N(V),children:a(Kn,{className:"fa-icon"})})},B):a(yt,{},B)})}),a(K,{fullWidth:!0,className:"badge bg-muted",children:i?i.name:E("catalog_selectproduct")})]}),w(f.accepts),_(v,{size:4,overflow:"hidden",children:[a(M,{justifyContent:"between",alignItems:"center",children:_(C,{children:[T.userName," ",E("inventory.trading.isoffering"),":"]})}),a(Bt,{columnCount:3,children:Array.from(Array(jg),(L,B)=>{const V=T.userItems.getWithIndex(B)||null;return V?a(yt,{itemActive:o===V,itemImage:V.iconUrl,itemCount:V.getTotalCount(),itemUniqueNumber:V.stuffData.uniqueNumber,onClick:q=>l(V)},B):a(yt,{},B)})}),a(K,{fullWidth:!0,className:"badge bg-muted w-100",children:o?o.name:E("catalog_selectproduct")})]}),w(T.accepts)]}),_(M,{grow:!0,justifyContent:"between",children:[a(Y,{variant:"danger",onClick:e,children:E("generic.cancel")}),O===ps.TRADING_STATE_READY&&a(Y,{variant:"secondary",disabled:!f.itemCount&&!T.itemCount,onClick:A,children:E("inventory.trading.accept")}),O===ps.TRADING_STATE_RUNNING&&a(Y,{variant:"secondary",disabled:!f.itemCount&&!T.itemCount,onClick:A,children:E(f.accepts?"inventory.trading.modify":"inventory.trading.accept")}),O===ps.TRADING_STATE_COUNTDOWN&&a(Y,{variant:"secondary",disabled:!0,children:E("inventory.trading.countdown",["counter"],[u.toString()])}),O===ps.TRADING_STATE_CONFIRMING&&a(Y,{variant:"secondary",onClick:A,children:E("inventory.trading.button.restore")}),O===ps.TRADING_STATE_CONFIRMED&&a(Y,{variant:"secondary",children:E("inventory.trading.info.waiting")})]})]})]})},x$=s=>{const{petItem:e=null,children:t=null,...r}=s,[i,n]=d.exports.useState(!1),{selectedPet:o=null,setSelectedPet:l=null}=O0(),{isUnseen:c}=Ci(),h=c(os.PET,e.petData.id),u=g=>{switch(g.type){case fe.MOUSE_DOWN:l(e),n(!0);return;case fe.MOUSE_UP:n(!1);return;case fe.ROLL_OUT:if(!i||e!==o)return;Kf(e);return;case"dblclick":Kf(e);return}};return _(yt,{itemActive:e===o,itemUnseen:h,onMouseDown:u,onMouseUp:u,onMouseOut:u,onDoubleClick:u,...r,children:[a(Na,{figure:e.petData.figureData.figuredata,direction:3,headOnly:!0}),t]})},w$=s=>{const{roomSession:e=null,roomPreviewer:t=null}=s,[r,i]=d.exports.useState(!1),{petItems:n=null,selectedPet:o=null,activate:l=null,deactivate:c=null}=O0(),{isUnseen:h=null,removeUnseen:u=null}=Ci();return d.exports.useEffect(()=>{if(!o||!t)return;const g=o.petData,m=te();let p=m.getRoomInstanceVariable(m.activeRoomId,b.ROOM_WALL_TYPE),f=m.getRoomInstanceVariable(m.activeRoomId,b.ROOM_FLOOR_TYPE),T=m.getRoomInstanceVariable(m.activeRoomId,b.ROOM_LANDSCAPE_TYPE);p=p&&p.length?p:"101",f=f&&f.length?f:"101",T=T&&T.length?T:"1.1",t.reset(!1),t.updateRoomWallsAndFloorVisibility(!0,!0),t.updateObjectRoom(f,p,T),t.addPetIntoRoom(g.figureString)},[t,o]),d.exports.useEffect(()=>{!o||!h(os.PET,o.petData.id)||u(os.PET,o.petData.id)},[o,h,u]),d.exports.useEffect(()=>{if(!r)return;const g=l();return()=>c(g)},[r,l,c]),d.exports.useEffect(()=>(i(!0),()=>i(!1)),[]),!n||!n.length?a(FI,{title:E("inventory.empty.pets.title"),desc:E("inventory.empty.pets.desc")}):_(qe,{children:[a(v,{size:7,overflow:"hidden",children:a(Bt,{columnCount:5,children:n&&n.length>0&&n.map(g=>a(x$,{petItem:g},g.petData.id))})}),_(v,{size:5,overflow:"auto",children:[a(v,{overflow:"hidden",position:"relative",children:a(Ch,{roomPreviewer:t,height:140})}),o&&o.petData&&_(v,{grow:!0,justifyContent:"between",gap:2,children:[a(C,{grow:!0,truncate:!0,children:o.petData.name}),!!e&&a(Y,{onClick:g=>Kf(o),children:E("inventory.furni.placetoroom")})]})]})]})},Y0="inventory.furni",z0="inventory.bots",K0="inventory.furni.tab.pets",q0="inventory.badges",XT=[Y0,z0,K0,q0],F$=[os.FURNI,os.BOT,os.PET,os.BADGE],k$=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(XT[0]),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),{isTrading:h=!1,stopTrading:u=null}=MI(),{getCount:g=null,resetCategory:m=null}=Ci(),p=()=>{h&&u(),t(!1)};return _t(ye.PLACED,f=>{FL()&&(Qc(!1),f.placedInRoom||t(!0))}),es([Ve.CREATED,Ve.ENDED],f=>{switch(f.type){case Ve.CREATED:o(f.session);return;case Ve.ENDED:o(null),t(!1);return}}),j(Y_,f=>{const T=f.getParser();for(const I of T.data)uI().setBadgePointLimit(I.badgeId,I.limit)}),d.exports.useEffect(()=>{const f={linkReceived:T=>{const I=T.split("/");if(!(I.length<2))switch(I[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(O=>!O);return}},eventUrlPrefix:"inventory/"};return xs(f),()=>ws(f)},[]),d.exports.useEffect(()=>(c(new Yr(te(),++Yr.PREVIEW_COUNTER)),()=>{c(f=>(f.dispose(),null))}),[]),d.exports.useEffect(()=>{!e&&h&&t(!0)},[e,h]),e?_(Be,{uniqueKey:"inventory",className:h?"nitro-inventory trading":"nitro-inventory",theme:h?"primary":"",children:[a(He,{headerText:E("inventory.title"),onCloseClick:p}),!h&&_(J,{children:[a(ca,{children:XT.map((f,T)=>a(Dn,{isActive:r===f,onClick:I=>i(f),count:g(F$[T]),children:E(f)},T))}),_(Ge,{children:[r===Y0&&a(L$,{roomSession:n,roomPreviewer:l}),r===z0&&a(M$,{roomSession:n,roomPreviewer:l}),r===K0&&a(w$,{roomSession:n,roomPreviewer:l}),r===q0&&a(y$,{})]})]}),h&&a(Ge,{children:a(U$,{cancelTrade:p})})]}):null},Wh=new Set(["id","spriteId","width","length","stackHeight","interactionModesCount","pageId","costCredits","costPixels","costDiamonds","amount","orderNum","flatId"]),QT=new Set(["publicName","itemName","interactionType","vendingIds","variableHeights","catalogName"]),su=new Set(["pageId","catalogName","costCredits","costPixels","costDiamonds","amount","orderNum","flatId"]),G$=({onCloseClick:s})=>{const e=ie().isModerator,[t,r]=d.exports.useState({}),[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState({}),[u,g]=d.exports.useState(!1),[m,p]=d.exports.useState([]),[f,T]=d.exports.useState(!1),[I,O]=d.exports.useState(new Set),[A,N]=d.exports.useState({}),[P,y]=d.exports.useState(0),[D,x]=d.exports.useState(0),[w,k]=d.exports.useState(0),[F,L]=d.exports.useState(0);d.exports.useEffect(()=>(e&&fl().connection.send(new bf(e,!0)),()=>{e&&fl().connection.send(new bf(e,!1))}),[e]),d.exports.useEffect(()=>{f&&te().areaSelectionManager.setHighlight(P,D,w,F)},[P,D,w,F,f]),d.exports.useEffect(()=>{if(f){const $=(re,me,ge,Ae)=>{y(re),x(me),k(ge),L(Ae),Z(re,me,ge,Ae)};return te().areaSelectionManager.activate($,Di.HIGHLIGHT_DARKEN)&&te().areaSelectionManager.setHighlight(P,D,w,F),()=>{te().areaSelectionManager.deactivate()}}else te().areaSelectionManager.deactivate(),te().areaSelectionManager.clearHighlight(),y(0),x(0),k(0),L(0),p([])},[f]),j(VN,$=>{const re=$.getParser(),me={id:re.id,spriteId:re.spriteId,publicName:re.publicName,itemName:re.itemName,width:re.width,length:re.length,stackHeight:re.stackHeight,canStack:re.canStack,canSit:re.canSit,isWalkable:re.isWalkable,allowGift:re.allowGift,allowTrade:re.allowTrade,allowRecycle:re.allowRecycle,allowMarketplaceSell:re.allowMarketplaceSell,interactionType:re.interactionType,interactionModesCount:re.interactionModesCount,vendingIds:re.vendingIds,variableHeights:re.variableHeights,pageId:re.pageId,catalogName:re.catalogName,costCredits:re.costCredits,costPixels:re.costPixels,costDiamonds:re.costDiamonds,amount:re.amount,orderNum:re.orderNum,flatId:re.flatId,shouldUpdateCatalog:0};r(me);const ge={};su.forEach(Ae=>ge[Ae]=me[Ae]),h(ge),l(!1)}),j(mP,$=>{const re=$.getParser();re.success?(T(!1),p([]),O(new Set),N({}),g(!1),l(!1),y(0),x(0),k(0),L(0),te().areaSelectionManager.clearHighlight()):alert(`Error: ${re.message}`)}),d.exports.useEffect(()=>{},[i,o,c]);const B=$=>{const{name:re,value:me}=$.target;let ge;Wh.has(re)?ge=me===""?0:Number(me):(QT.has(re),ge=me),su.has(re)&&l(!0),r(Ae=>({...Ae,[re]:ge}))},V=$=>{const{name:re,checked:me}=$.target;r(ge=>({...ge,[re]:me?1:0}))},q=()=>{const $=!i;if($){const re={};su.forEach(me=>re[me]=t[me]),h(re),r(me=>({...me,shouldUpdateCatalog:1}))}n($)},Z=($,re,me,ge)=>{if(me>0&&ge>0){const Ae=ee($,re,me,ge);p(Ae)}},H=()=>{te().areaSelectionManager.startSelecting()},X=()=>{y(0),x(0),k(0),L(0),p([]),te().areaSelectionManager.clearHighlight()},ee=($,re,me,ge)=>{const Ae=mt().roomEngine,Xe=Ae.activeRoomId,je=Ae.getRoomObjects(Xe,20),se=Ae.getRoomObjects(Xe,10),Te=[...je,...se],Ce=[];return Te.forEach(Ie=>{const Ue=Ie.getLocation(),ut=Math.floor(Ue.x),De=Math.floor(Ue.y);ut>=$&&ut<$+me&&De>=re&&De<re+ge&&Ce.push({id:Ie.id,x:ut,y:De,type:Ie.type})}),Ce},Oe=$=>{const re=new Set(I);re.has($)?(re.delete($),N(me=>{const ge={...me};return delete ge[$],ge})):(re.add($),["canStack","canSit","isWalkable","allowGift","allowTrade","allowRecycle","allowMarketplaceSell"].includes($)&&N(ge=>({...ge,[$]:0}))),O(re)},de=$=>{const{name:re,value:me}=$.target;let ge;Wh.has(re)?ge=me===""?0:Number(me):(QT.has(re),ge=me),N(Ae=>({...Ae,[re]:ge}))},ve=$=>{const{name:re,checked:me}=$.target,ge=me?1:0;N(Ae=>({...Ae,[re]:ge}))},Me=()=>{if(m.length===0||I.size===0)return;const $={furniIds:m.map(re=>re.id),properties:Object.fromEntries(Array.from(I).filter(re=>A[re]!==void 0).map(re=>[re,A[re]])),shouldUpdateCatalog:o?1:0};W(new TP($))},ce=()=>{const $={...t,shouldUpdateCatalog:i?1:0};i||su.forEach(re=>delete $[re]),W(new RP($)),l(!1)};if(!e)return null;const ue=!t.id||t.id===0||t.id===-1;return _(Be,{className:"nitro-mod-tools-tickets furnifix-tool",style:{maxWidth:"950px",height:"750px"},children:[a(He,{headerText:"FurniFix Tool",onCloseClick:s}),_("div",{className:"furni-edit-form",children:[_("div",{className:"batch-controls",style:{marginBottom:"10px",padding:"10px",border:"1px solid #ccc",borderRadius:"5px"},children:[a("button",{onClick:()=>T(!f),style:{padding:"8px 16px",backgroundColor:f?"#dc3545":"#007bff",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:f?"Salir de Edicin en Lote":"Activar Edicin en Lote"}),f&&_(J,{children:[a("button",{onClick:H,style:{padding:"8px 16px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Seleccionar rea"}),a("button",{onClick:X,style:{padding:"8px 16px",backgroundColor:"#ffc107",color:"black",border:"none",borderRadius:"4px",cursor:"pointer"},children:"Limpiar rea"}),m.length>0&&_("span",{style:{color:"#28a745",fontWeight:"bold",padding:"8px 12px",backgroundColor:"#f8f9fa",borderRadius:"4px",border:"1px solid #dee2e6"},children:[m.length," furni(s) seleccionado(s)"]})]})]}),f?_("div",{className:"form-container batch-edit-mode",children:[_("div",{className:"block",children:[a("h3",{children:"Informacin Bsica"}),["publicName","itemName"].map($=>_("div",{className:"input-group",children:[_("label",{className:"checkbox-label",children:[a("input",{type:"checkbox",checked:I.has($),onChange:()=>Oe($)}),a("span",{children:$==="publicName"?"Public Name":"Item Name"})]}),I.has($)&&a("input",{type:"text",name:$,value:A[$]||"",onChange:de})]},$))]}),_("div",{className:"block",children:[a("h3",{children:"Dimensiones"}),["width","length","stackHeight"].map($=>_("div",{className:"input-group",children:[_("label",{className:"checkbox-label",children:[a("input",{type:"checkbox",checked:I.has($),onChange:()=>Oe($)}),a("span",{children:$==="stackHeight"?"Stack Height":$.charAt(0).toUpperCase()+$.slice(1)})]}),I.has($)&&a("input",{type:"number",name:$,value:A[$]??0,onChange:de})]},$))]}),_("div",{className:"block",children:[a("h3",{children:"Opciones de Interaccin"}),["canStack","canSit","isWalkable","allowGift","allowTrade","allowRecycle","allowMarketplaceSell"].map($=>_("div",{className:"input-group",children:[_("label",{className:"checkbox-label",children:[a("input",{type:"checkbox",checked:I.has($),onChange:()=>Oe($)}),_("span",{children:[$==="canStack"&&"Allow Stack",$==="canSit"&&"Allow Sit",$==="isWalkable"&&"Allow Walk",$==="allowGift"&&"Allow Gift",$==="allowTrade"&&"Allow Trade",$==="allowRecycle"&&"Allow Recycle",$==="allowMarketplaceSell"&&"Allow Marketplace Sell"]})]}),I.has($)&&a("input",{type:"checkbox",name:$,checked:A[$]===1,onChange:ve})]},$))]}),_("div",{className:"block",children:[a("h3",{children:"Otros Datos"}),["interactionType","vendingIds","variableHeights","interactionModesCount"].map($=>_("div",{className:"input-group",children:[_("label",{className:"checkbox-label",children:[a("input",{type:"checkbox",checked:I.has($),onChange:()=>Oe($)}),_("span",{children:[$==="variableHeights"&&"Multi Height",$==="interactionModesCount"&&"Interaction Modes Count",!["variableHeights","interactionModesCount"].includes($)&&$]})]}),I.has($)&&a("input",{type:$==="interactionModesCount"?"number":"text",name:$,value:A[$]??($==="interactionModesCount"?0:""),onChange:de})]},$))]}),_("div",{className:"block",style:{gridColumn:"1 / -1",textAlign:"center"},children:[_("button",{className:"save-button",onClick:Me,disabled:I.size===0,children:["Aplicar Cambios a ",m.length," Furnis"]}),a("button",{className:"cancel-button",onClick:()=>T(!1),style:{marginLeft:"10px"},children:"Cancelar"})]})]}):ue?a("div",{className:"info-message",children:'Da click en un furni para empezar o usa "Seleccionar rea" para editar mltiples furnis!'}):_("div",{className:"form-container",children:[_("div",{className:"block",children:[a("img",{src:String(Ee("furni.asset.icon.url")).replace("%libname%%param%",t.itemName),alt:"Icono"}),a("h3",{children:"Informacin Bsica"}),_("div",{className:"input-group",children:[a("label",{children:"Public Name"}),a("input",{type:"text",name:"publicName",value:t.publicName||"",onChange:B})]}),_("div",{className:"input-group",children:[a("label",{children:"Item Name"}),a("input",{type:"text",name:"itemName",value:t.itemName||"",onChange:B})]})]}),_("div",{className:"block",children:[a("h3",{children:"Dimensiones"}),_("div",{className:"input-group",children:[a("label",{children:"Width"}),a("input",{type:"number",name:"width",value:t.width??0,onChange:B})]}),_("div",{className:"input-group",children:[a("label",{children:"Length"}),a("input",{type:"number",name:"length",value:t.length??0,onChange:B})]}),_("div",{className:"input-group",children:[a("label",{children:"Stack Height"}),a("input",{type:"number",name:"stackHeight",value:t.stackHeight??0,onChange:B})]})]}),_("div",{className:"block",children:[a("h3",{children:"Opciones de Interaccin"}),["canStack","canSit","isWalkable","allowGift","allowTrade","allowRecycle","allowMarketplaceSell"].map($=>a("div",{className:"input-group",children:_("label",{className:"checkbox-label",children:[a("input",{type:"checkbox",name:$,checked:t[$]===1,onChange:V}),_("span",{children:[$==="canStack"&&"Allow Stack",$==="canSit"&&"Allow Sit",$==="isWalkable"&&"Allow Walk",$==="allowGift"&&"Allow Gift",$==="allowTrade"&&"Allow Trade",$==="allowRecycle"&&"Allow Recycle",$==="allowMarketplaceSell"&&"Allow Marketplace Sell"]})]})},$))]}),_("div",{className:"block",children:[a("h3",{children:"Otros Datos"}),["interactionType","vendingIds","variableHeights"].map($=>_("div",{className:"input-group",children:[a("label",{children:$==="variableHeights"?"Multi Height":$}),a("input",{type:"text",name:$,value:t[$]||"",onChange:B})]},$)),["interactionModesCount"].map($=>_("div",{className:"input-group",children:[a("label",{children:$==="interactionModesCount"&&"Interaction Modes Count"}),a("input",{type:$==="interactionModesCount"?"number":"text",name:$,value:t[$]??($==="interactionModesCount"?0:""),onChange:B})]},$))]}),a("button",{className:"toggle-catalog-button",onClick:q,children:i?"Ocultar Opciones de Catlogo":"Mostrar Opciones de Catlogo"}),i&&_("div",{className:"block",children:[a("h3",{children:"Opciones Catlogo"}),Array.from(su).map($=>_("div",{className:"input-group",children:[_("label",{children:[$==="orderNum"&&"Order Number",$==="flatId"&&"Offer ID",$==="costPixels"&&"Cost Pixels",$==="costDiamonds"&&"Cost Diamonds",$!=="orderNum"&&$!=="flatId"&&$!=="costPixels"&&$!=="costDiamonds"&&$]}),a("input",{type:Wh.has($)?"number":"text",name:$,value:t[$]??(Wh.has($)?0:""),onChange:B})]},$))]}),a("button",{className:"save-button",onClick:ce,children:"Guardar Cambios"})]})]})]})},kI=s=>{const{records:e=null}=s,{openRoomInfo:t=null}=Jc(),r=d.exports.useMemo(()=>{const n=[];return e.forEach(o=>{n.push({isRoomInfo:!0,roomId:o.roomId,roomName:o.roomName}),o.chatlog.forEach(l=>{n.push({timestamp:l.timestamp,habboId:l.userId,username:l.userName,hasHighlighting:l.hasHighlighting,message:l.message,isRoomInfo:!1})})}),n},[e]),i=n=>_(M,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted p-1",children:[_(M,{gap:1,children:[a(C,{gfbold:!0,children:"Room name:"}),a(C,{children:n.roomName})]}),_(M,{gap:1,children:[a(Y,{onClick:o=>Wr(n.roomId),children:"Visit Room"}),a(Y,{onClick:o=>t(n.roomId),children:"Room Tools"})]})]});return a(J,{children:_(v,{fit:!0,gap:0,overflow:"hidden",children:[a(v,{gap:2,children:_(qe,{gap:1,className:"text-black pb-1",children:[a(K,{className:"g-col-1",children:"Time"}),a(K,{className:"g-col-3",children:"User"}),a(K,{className:"g-col-7",children:"Message"})]})}),e&&e.length>0&&a(mg,{rows:r,rowRender:n=>_(J,{children:[n.isRoomInfo&&a(i,{roomId:n.roomId,roomName:n.roomName}),!n.isRoomInfo&&_(qe,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[a(C,{className:"g-col-2",children:n.timestamp}),a(C,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:o=>Le(`mod-tools/open-user-info/${n.habboId}`),children:n.username}),a(C,{textBreak:!0,wrap:!0,className:"g-col-7",children:n.message})]})]})})]})})},B$=s=>{const{roomId:e=null,onCloseClick:t=null}=s,[r,i]=d.exports.useState(null);return j(HA,n=>{const o=n.getParser();!o||o.data.roomId!==e||i(o.data)}),d.exports.useEffect(()=>{W(new qv(e))},[e]),r?_(Be,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:hr.TOP_LEFT,children:[a(He,{headerText:`Room Chatlog ${r.roomName}`,onCloseClick:t}),a(Ge,{className:"text-black",overflow:"hidden",children:r&&a(kI,{records:[r]})})]}):null},V$=s=>{const{roomId:e=null,onCloseClick:t=null}=s,[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(null),[g,m]=d.exports.useState(null),[p,f]=d.exports.useState(null),[T,I]=d.exports.useState(!1),[O,A]=d.exports.useState(0),[N,P]=d.exports.useState(!1),[y,D]=d.exports.useState(!1),[x,w]=d.exports.useState(!1),[k,F]=d.exports.useState(""),L=(B,V)=>{if(B)switch(B){case"alert_only":if(k.trim().length===0)return;W(new va(va.ACTION_ALERT,k,"")),W(new If(e,y?1:0,x?1:0,N?1:0));return;case"send_message":if(k.trim().length===0)return;W(new va(va.ACTION_MESSAGE,k,"")),W(new If(e,y?1:0,x?1:0,N?1:0));return}};return j(GA,B=>{const V=B.getParser();!V||V.data.flatId!==e||(o(V.data.flatId),c(V.data.room.name),m(V.data.ownerId),f(V.data.ownerName),I(V.data.ownerInRoom),A(V.data.userCount))}),d.exports.useEffect(()=>{r||(W(new zv(e)),i(!0))},[e,r,i]),_(Be,{className:"nitro-mod-tools-room",theme:"modtool-windows",windowPosition:hr.TOP_CENTER,children:[a(He,{headerText:"Room Info",onCloseClick:B=>t()}),_(Ge,{className:"text-black",children:[_(v,{gap:0,className:"mod-content p-2",children:[a(C,{gfbold:!0,children:l}),a(C,{children:h})]}),_(M,{gap:2,className:"mod-content p-2",children:[_(v,{justifyContent:"center",grow:!0,gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a(C,{gfbold:!0,className:"",children:"Room Owner:"}),a(C,{underline:!0,pointer:!0,truncate:!0,children:p})]}),_(M,{alignItems:"center",gap:2,children:[a(C,{gfbold:!0,className:"",children:"Users in room:"}),a(C,{children:O})]}),_(M,{alignItems:"center",gap:2,children:[a(C,{gfbold:!0,className:"",children:"Owner in room:"}),a(C,{children:T?"Yes":"No"})]})]}),_(v,{gap:1,children:[a(Y,{onClick:B=>Wr(e),children:"Visit Room"}),a(Y,{onClick:B=>Le(`mod-tools/open-room-chatlog/${e}`),children:"Chatlog"})]})]}),_(v,{className:"mod-content p-2",gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:N,onChange:B=>P(B.target.checked)}),a(C,{children:"Kick everyone out"})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:y,onChange:B=>D(B.target.checked)}),a(C,{children:"Enable the doorbell"})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:x,onChange:B=>w(B.target.checked)}),a(C,{children:"Change room name"})]})]}),a("textarea",{className:"form-control message-input p-1",placeholder:"Type a mandatory message to the users in this text box...",value:k,onChange:B=>F(B.target.value)}),_(M,{justifyContent:"between",children:[a(Y,{variant:"danger",onClick:B=>L("send_message"),children:"Send Caution"}),a(Y,{onClick:B=>L("alert_only"),children:"Send Alert only"})]})]})]})},H$=s=>{const{onCloseClick:e=null,issueId:t=null}=s,[r,i]=d.exports.useState(null);return j(DA,n=>{const o=n.getParser();!o||o.data.issueId!==t||i(o.data)}),d.exports.useEffect(()=>{W(new Yv(t))},[t]),_(Be,{className:"nitro-mod-tools-chatlog",theme:"modtool-windows",children:[a(He,{headerText:"Issue Chatlog",onCloseClick:e}),a(Ge,{className:"text-black",children:r&&a(kI,{records:[r.chatRecord]})})]})},W$=s=>{const{issueId:e=null,onIssueInfoClosed:t=null}=s,[r,i]=d.exports.useState(!1),{tickets:n=[],openUserInfo:o=null}=Jc(),l=n.find(u=>u.issueId===e),c=u=>{W(new RE([u])),t(u)},h=u=>{W(new _o([e],u)),t(e)};return _(J,{children:[_(Be,{className:"nitro-mod-tools-handle-issue",theme:"modtool-windows",children:[a(He,{headerText:"Resolving issue "+e,onCloseClick:()=>t(e)}),_(Ge,{className:"text-black",children:[a(C,{fontSize:4,children:"Issue Information"}),_(qe,{overflow:"auto",children:[a(v,{size:8,children:a("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:_("tbody",{children:[_("tr",{children:[a("th",{children:"Source"}),a("td",{children:rX(l.categoryId)})]}),_("tr",{children:[a("th",{children:"Category"}),a("td",{className:"text-break",children:E("help.cfh.topic."+l.reportedCategoryId)})]}),_("tr",{children:[a("th",{children:"Description"}),a("td",{className:"text-break",children:l.message})]}),_("tr",{children:[a("th",{children:"Caller"}),a("td",{children:a(C,{gfbold:!0,underline:!0,pointer:!0,onClick:u=>o(l.reporterUserId),children:l.reporterUserName})})]}),_("tr",{children:[a("th",{children:"Reported User"}),a("td",{children:a(C,{gfbold:!0,underline:!0,pointer:!0,onClick:u=>o(l.reportedUserId),children:l.reportedUserName})})]})]})})}),_(v,{size:4,gap:1,children:[a(Y,{variant:"secondary",onClick:()=>i(!r),children:"Chatlog"}),a(Y,{onClick:u=>h(_o.RESOLUTION_USELESS),children:"Close as useless"}),a(Y,{variant:"danger",onClick:u=>h(_o.RESOLUTION_ABUSIVE),children:"Close as abusive"}),a(Y,{variant:"success",onClick:u=>h(_o.RESOLUTION_RESOLVED),children:"Close as resolved"}),a(Y,{variant:"secondary",onClick:u=>c(e),children:"Release"})]})]})]})]}),r&&a(H$,{issueId:e,onCloseClick:()=>i(!1)})]})},j$=s=>{const{myIssues:e=null,handleIssue:t=null}=s;return _(v,{gap:0,overflow:"hidden",children:[a(v,{gap:2,children:_(qe,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[a(K,{className:"g-col-2",children:"Type"}),a(K,{className:"g-col-3",children:"Room/Player"}),a(K,{className:"g-col-3",children:"Opened"}),a(K,{className:"g-col-2"}),a(K,{className:"g-col-2"})]})}),a(v,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(r=>_(qe,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[a(K,{className:"g-col-2",children:r.categoryId}),a(K,{className:"g-col-3",children:r.reportedUserName}),a(K,{className:"g-col-3",children:new Date(Date.now()-r.issueAgeInMilliseconds).toLocaleTimeString()}),a(K,{className:"g-col-2",children:a(Y,{variant:"primary",onClick:i=>t(r.issueId),children:"Handle"})}),a(K,{className:"g-col-2",children:a(Y,{variant:"danger",onClick:i=>W(new RE([r.issueId])),children:"Release"})})]},r.issueId))})]})},Y$=s=>{const{openIssues:e=null}=s;return _(v,{gap:0,overflow:"hidden",children:[a(v,{gap:2,children:_(qe,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[a(K,{className:"g-col-2",children:"Type"}),a(K,{className:"g-col-3",children:"Room/Player"}),a(K,{className:"g-col-4",children:"Opened"}),a(K,{className:"g-col-3"})]})}),a(v,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(t=>_(qe,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[a(K,{className:"g-col-2",children:t.categoryId}),a(K,{className:"g-col-3",children:t.reportedUserName}),a(K,{className:"g-col-4",children:new Date(Date.now()-t.issueAgeInMilliseconds).toLocaleTimeString()}),a(K,{className:"g-col-3",children:a(Y,{variant:"success",onClick:r=>W(new tM([t.issueId],!1,0,"pick issue button")),children:"Pick Issue"})})]},t.issueId))})]})},z$=s=>{const{pickedIssues:e=null}=s;return _(v,{gap:0,overflow:"hidden",children:[a(v,{gap:2,children:_(qe,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[a(K,{className:"g-col-2",children:"Type"}),a(K,{className:"g-col-3",children:"Room/Player"}),a(K,{className:"g-col-4",children:"Opened"}),a(K,{className:"g-col-3",children:"Picker"})]})}),a(v,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(t=>_(qe,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[a(K,{className:"g-col-2",children:t.categoryId}),a(K,{className:"g-col-3",children:t.reportedUserName}),a(K,{className:"g-col-4",children:new Date(Date.now()-t.issueAgeInMilliseconds).toLocaleTimeString()}),a(K,{className:"g-col-3",children:t.pickerUserName})]},t.issueId))})]})},K$=["Open Issues","My Issues","Picked Issues"],q$=s=>{const{onCloseClick:e=null}=s,[t,r]=d.exports.useState(0),[i,n]=d.exports.useState([]),{tickets:o=[]}=Jc(),l=o.filter(p=>p.state===Io.STATE_OPEN),c=o.filter(p=>p.state===Io.STATE_PICKED&&p.pickerUserId===ie().userId),h=o.filter(p=>p.state===Io.STATE_PICKED),u=p=>{n(f=>{const T=[...f],I=T.indexOf(p);return I>=0&&T.splice(I,1),T})},g=p=>{n(f=>{const T=[...f],I=T.indexOf(p);return I===-1?T.push(p):T.splice(I,1),T})},m=()=>{switch(t){case 0:return a(Y$,{openIssues:l});case 1:return a(j$,{myIssues:c,handleIssue:g});case 2:return a(z$,{pickedIssues:h})}return null};return _(J,{children:[_(Be,{className:"nitro-mod-tools-tickets",children:[a(He,{headerText:"Tickets",onCloseClick:e}),a(ca,{children:K$.map((p,f)=>a(Dn,{isActive:t===f,onClick:T=>r(f),children:p},f))}),a(Ge,{gap:1,children:a(m,{})})]}),i&&i.length>0&&i.map(p=>a(W$,{issueId:p,onIssueInfoClosed:u},p))]})},X$=s=>{const{userId:e=null,onCloseClick:t=null}=s,[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(null);return j(YA,l=>{const c=l.getParser();!c||c.data.userId!==e||(o(c.data.username),i(c.data.roomChatlogs))}),d.exports.useEffect(()=>{W(new Qv(e))},[e]),_(Be,{className:"nitro-mod-tools-chatlog",theme:"modtool-windows",windowPosition:hr.TOP_CENTER,children:[a(He,{headerText:`User Chatlog: ${n||""}`,onCloseClick:t}),a(Ge,{className:"text-black h-100",children:r&&a(kI,{records:r})})]})},$T=[new Gt(1,"Alert",Gt.ALERT,1,0),new Gt(2,"Mute 1h",Gt.MUTE,2,0),new Gt(3,"Ban 18h",Gt.BAN,3,0),new Gt(4,"Ban 7 days",Gt.BAN,4,0),new Gt(5,"Ban 30 days (step 1)",Gt.BAN,5,0),new Gt(7,"Ban 30 days (step 2)",Gt.BAN,7,0),new Gt(6,"Ban 100 years",Gt.BAN,6,0),new Gt(106,"Ban avatar-only 100 years",Gt.BAN,6,0),new Gt(101,"Kick",Gt.KICK,0,0),new Gt(102,"Lock trade 1 week",Gt.TRADE_LOCK,0,168),new Gt(104,"Lock trade permanent",Gt.TRADE_LOCK,0,876e3),new Gt(105,"Message",Gt.MESSAGE,0,0)],Q$=s=>{const{user:e=null,onCloseClick:t=null}=s,[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(-1),[l,c]=d.exports.useState(""),{cfhCategories:h=null,settings:u=null}=Jc(),{simpleAlert:g=null}=$t(),m=d.exports.useMemo(()=>{const I=[];if(h&&h.length)for(const O of h)for(const A of O.topics)I.push(A);return I},[h]),p=I=>g(I,Ze.DEFAULT,null,null,"Error"),f=()=>{let I=null;const O=m[r];if(r===-1&&(I="You must select a CFH topic"),I)return p(I);const A=l.trim().length===0?E(`help.cfh.topic.${O.id}`):l;W(new jv(e.userId,r,A)),t()},T=()=>{let I=null;const O=m[r],A=$T[n];if(r===-1||n===-1?I="You must select a CFH topic and Sanction":!u||!u.cfhPermission?I="You do not have permission to do this":O?A||(I="You must select a sanction"):I="You must select a CFH topic",I){p(I);return}const N=l.trim().length===0?E(`help.cfh.topic.${O.id}`):l;switch(A.actionType){case Gt.ALERT:{if(!u.alertPermission){p("You have insufficient permissions");return}W(new $v(e.userId,N,O.id));break}case Gt.MUTE:W(new Zv(e.userId,N,O.id));break;case Gt.BAN:{if(!u.banPermission){p("You have insufficient permissions");return}W(new Wa(e.userId,N,O.id,n,A.actionId===106));break}case Gt.KICK:{if(!u.kickPermission){p("You have insufficient permissions");return}W(new Jv(e.userId,N,O.id));break}case Gt.TRADE_LOCK:{const P=A.actionLengthHours*60;W(new eM(e.userId,N,P,O.id));break}case Gt.MESSAGE:{if(l.trim().length===0){p("Please write a message to user");return}W(new TE(e.userId,l,O.id));break}}t()};return e?_(Be,{className:"nitro-mod-tools-user-action",theme:"modtool-windows",windowPosition:hr.TOP_CENTER,children:[a(He,{headerText:"Mod Action: "+(e?e.username:""),onCloseClick:()=>t()}),_(Ge,{className:"text-black",children:[_("select",{className:"form-select form-select-sm",value:r,onChange:I=>i(parseInt(I.target.value)),children:[a("option",{value:-1,disabled:!0,children:"CFH Topic"}),m.map((I,O)=>a("option",{value:O,children:E("help.cfh.topic."+I.id)},O))]}),_("select",{className:"form-select form-select-sm",value:n,onChange:I=>o(parseInt(I.target.value)),children:[a("option",{value:-1,disabled:!0,children:"Sanction Type"}),$T.map((I,O)=>a("option",{value:O,children:I.name},O))]}),_(v,{gap:1,children:[a(C,{small:!0,children:"Optional message type, overrides default"}),a("textarea",{className:"form-control",value:l,onChange:I=>c(I.target.value)})]}),_(M,{justifyContent:"between",gap:1,children:[a(Y,{variant:"primary",onClick:f,children:"Default Sanction"}),a(Y,{variant:"success",onClick:T,children:"Sanction"})]})]})]}):null},$$=s=>{const{userId:e=null,onCloseClick:t=null}=s,[r,i]=d.exports.useState(null);return j(WA,n=>{const o=n.getParser();o.data.userId===e&&i(o.data)}),d.exports.useEffect(()=>{W(new Xv(e))},[e]),e?_(Be,{className:"nitro-mod-tools-user-visits",theme:"modtool-windows",windowPosition:hr.TOP_CENTER,children:[a(He,{headerText:"User Visits",onCloseClick:t}),a(Ge,{className:"text-black",gap:1,children:_(v,{fullHeight:!0,gap:0,overflow:"hidden",children:[a(v,{gap:2,children:_(qe,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[a(K,{className:"g-col-2",children:"Time"}),a(K,{className:"g-col-7",children:"Room name"}),a(K,{className:"g-col-3",children:"Visit"})]})}),a(mg,{rows:(r==null?void 0:r.rooms)??[],rowRender:n=>_(qe,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[_(C,{className:"g-col-2",children:[n.enterHour.toString().padStart(2,"0"),": ",n.enterMinute.toString().padStart(2,"0")]}),a(C,{className:"g-col-7",children:n.roomName}),a(C,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:o=>Wr(n.roomId),children:"Visit Room"})]})})]})})]}):null},J$=s=>{const{user:e=null,onCloseClick:t=null}=s,[r,i]=d.exports.useState(""),{simpleAlert:n=null}=$t();if(!e)return null;const o=()=>{if(r.trim().length===0){n("Please write a message to user.",null,null,null,"Error",null);return}W(new TE(e.userId,r,-999)),t()};return _(Be,{className:"nitro-mod-tools-user-message",theme:"modtool-windows",windowPosition:hr.TOP_CENTER,children:[a(He,{headerText:"Send Message",onCloseClick:()=>t()}),_(Ge,{className:"text-black",children:[_(C,{children:["Message To: ",e.username]}),a("textarea",{className:"form-control",value:r,onChange:l=>i(l.target.value)}),a(Y,{fullWidth:!0,onClick:o,children:"Send message"})]})]})},Z$=s=>{const{onCloseClick:e=null,userId:t=null}=s,[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(!1),[l,c]=d.exports.useState(!1),[h,u]=d.exports.useState(!1),g=d.exports.useMemo(()=>r?[{localeKey:"modtools.userinfo.userName",value:r.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:r.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:r.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:r.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:r.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:r.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:r.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:r.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:Or.format(r.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:r.lastPurchaseDate},{localeKey:"modtools.userinfo.primaryEmailAddress",value:r.primaryEmailAddress},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:r.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:Or.format(r.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:r.userClassification}]:null,[r]);return j(VA,m=>{const p=m.getParser();!p||p.data.userId!==t||i(p.data)}),d.exports.useEffect(()=>{W(new Kv(t))},[t]),r?_(J,{children:[_(Be,{className:"nitro-mod-tools-user",theme:"modtool-windows",windowPosition:hr.TOP_CENTER,children:[a(He,{headerText:E("modtools.userinfo.title",["username"],[r.userName]),onCloseClick:()=>e()}),a(Ge,{className:"text-black",children:_(qe,{overflow:"hidden",className:"mod-content p-2",children:[a(v,{size:8,overflow:"auto",children:a("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:a("tbody",{children:g.map((m,p)=>_("tr",{children:[a("th",{scope:"row",children:E(m.localeKey)}),_("td",{children:[m.value,m.showOnline&&a("i",{className:`icon icon-pf-${r.online?"online":"offline"} ms-2`})]})]},p))})})}),_(v,{size:4,gap:1,children:[a(Y,{onClick:m=>Le(`mod-tools/open-user-chatlog/${t}`),children:"Room Chat"}),a(Y,{onClick:m=>o(!n),children:"Send Message"}),a(Y,{onClick:m=>u(!h),children:"Room Visits"}),a(Y,{onClick:m=>c(!l),children:"Mod Action"})]})]})})]}),n&&a(J$,{user:{userId:t,username:r.userName},onCloseClick:()=>o(!1)}),l&&a(Q$,{user:{userId:t,username:r.userName},onCloseClick:()=>c(!1)}),h&&a($$,{userId:t,onCloseClick:()=>u(!1)})]}):null},eJ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(!1),[h,u]=d.exports.useState(!1),{openRooms:g=[],openRoomChatlogs:m=[],openUserChatlogs:p=[],openUserInfos:f=[],openRoomInfo:T=null,closeRoomInfo:I=null,toggleRoomInfo:O=null,openRoomChatlog:A=null,closeRoomChatlog:N=null,toggleRoomChatlog:P=null,openUserInfo:y=null,closeUserInfo:D=null,toggleUserInfo:x=null,openUserChatlog:w=null,closeUserChatlog:k=null,toggleUserChatlog:F=null}=Jc(),L=d.exports.useRef(null);return _t([lt.INITIALIZED,lt.DISPOSED],B=>{if(!Zn.isRoomPreviewerId(B.roomId))switch(B.type){case lt.INITIALIZED:i(B.roomId);return;case lt.DISPOSED:i(-1);return}}),DI(B=>{if(B.category!==z.UNIT)return;const V=bt();if(!V)return;const q=V.userDataManager.getUserDataByIndex(B.id);!q||q.type!==jt.USER||o({userId:q.webID,username:q.name})}),d.exports.useEffect(()=>{const B={linkReceived:V=>{const q=V.split("/");if(!(q.length<2))switch(q[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(Z=>!Z);return;case"open-room-info":T(Number(q[2]));return;case"close-room-info":I(Number(q[2]));return;case"toggle-room-info":O(Number(q[2]));return;case"open-room-chatlog":A(Number(q[2]));return;case"close-room-chatlog":N(Number(q[2]));return;case"toggle-room-chatlog":P(Number(q[2]));return;case"open-user-info":y(Number(q[2]));return;case"close-user-info":D(Number(q[2]));return;case"toggle-user-info":x(Number(q[2]));return;case"open-user-chatlog":w(Number(q[2]));return;case"close-user-chatlog":k(Number(q[2]));return;case"toggle-user-chatlog":F(Number(q[2]));return}},eventUrlPrefix:"mod-tools/"};return xs(B),()=>ws(B)},[T,I,O,A,N,P,y,D,x,w,k,F]),_(J,{children:[e&&_(Be,{style:{width:"200px",height:"200px"},uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:hr.TOP_LEFT,theme:"primary-slim",children:[a(He,{headerText:"Mod Tools",onCloseClick:B=>t(!1)}),_(Ge,{className:"text-black",gap:1,children:[_(Y,{gap:1,onClick:B=>Le(`mod-tools/toggle-room-info/${r}`),disabled:r<=0,className:"position-relative",children:[a(K,{className:"icon icon-small-room position-absolute start-1"})," Room Tool"]}),_(Y,{innerRef:L,gap:1,onClick:B=>Le(`mod-tools/toggle-room-chatlog/${r}`),disabled:r<=0,className:"position-relative",children:[a(K,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog Tool"]}),_(Y,{gap:1,onClick:()=>Le(`mod-tools/toggle-user-info/${n.userId}`),disabled:!n,className:"position-relative",children:[a(K,{className:"icon icon-user position-absolute start-1"})," User: ",n?n.username:""]}),_(Y,{gap:1,onClick:()=>c(B=>!B),className:"position-relative",children:[a(K,{className:"icon icon-tickets position-absolute start-1"})," Report Tool"]}),_(Y,{gap:1,onClick:()=>u(B=>!B),className:"position-relative",children:[a(K,{className:"icon icon-tickets position-absolute start-1"})," FurniFix Tool"]})]})]}),g.length>0&&g.map(B=>a(V$,{roomId:B,onCloseClick:()=>Le(`mod-tools/close-room-info/${B}`)},B)),m.length>0&&m.map(B=>a(B$,{roomId:B,onCloseClick:()=>Le(`mod-tools/close-room-chatlog/${B}`)},B)),f.length>0&&f.map(B=>a(Z$,{userId:B,onCloseClick:()=>Le(`mod-tools/close-user-info/${B}`)},B)),p.length>0&&p.map(B=>a(X$,{userId:B,onCloseClick:()=>Le(`mod-tools/close-user-chatlog/${B}`)},B)),l&&a(q$,{onCloseClick:()=>c(!1)}),h&&a(G$,{onCloseClick:()=>u(!1)})]})},tJ=[Pt.START_DOORBELL,Pt.STATE_WAITING,Pt.STATE_NO_ANSWER,Pt.START_PASSWORD,Pt.STATE_WRONG_PASSWORD],sJ=[Pt.START_DOORBELL,Pt.STATE_WAITING,Pt.STATE_NO_ANSWER],rJ=s=>{const[e,t]=d.exports.useState(""),{doorData:r=null,setDoorData:i=null}=Fi(),n=()=>{r&&r.state===Pt.STATE_WAITING&&Yf(),i(null)},o=()=>{!r||!r.roomInfo||(ol(r.roomInfo.roomId),i(h=>{const u={...h};return u.state=Pt.STATE_PENDING_SERVER,u}))},l=()=>{!r||!r.roomInfo||(ol(r.roomInfo.roomId,e),i(h=>{const u={...h};return u.state=Pt.STATE_PENDING_SERVER,u}))};if(d.exports.useEffect(()=>{!r||r.state!==Pt.STATE_NO_ANSWER||Yf()},[r]),!r||r.state===Pt.NONE||tJ.indexOf(r.state)===-1)return null;const c=sJ.indexOf(r.state)>=0;return _(Be,{className:"nitro-navigator-doorbell",theme:"primary",children:[a(He,{headerText:E(c?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:n}),_(Ge,{className:"px-3 pb-4",children:[_(v,{gap:1,children:[a(C,{small:!0,bold:!0,children:r&&r.roomInfo&&r.roomInfo.roomName}),r.state===Pt.START_DOORBELL&&a(C,{small:!0,children:E("navigator.doorbell.info")}),r.state===Pt.STATE_WAITING&&a(C,{small:!0,children:E("navigator.doorbell.waiting")}),r.state===Pt.STATE_NO_ANSWER&&a(C,{small:!0,children:E("navigator.doorbell.no.answer")}),r.state===Pt.START_PASSWORD&&a(C,{small:!0,children:E("navigator.password.info")}),r.state===Pt.STATE_WRONG_PASSWORD&&a(C,{small:!0,children:E("navigator.password.retryinfo")})]}),c&&_(M,{fullWidth:!0,gap:1,className:"align-items-end mt-auto pt-3",children:[a(C,{small:!0,className:"cursor-pointer",underline:!0,onClick:n,children:E("generic.cancel")}),r.state===Pt.START_DOORBELL&&a(Y,{className:"ms-auto",onClick:o,children:E("navigator.doorbell.button.ring")})]}),!c&&_(J,{children:[_(M,{className:"pt-3 align-items-center",gap:1,children:[a(C,{small:!0,fullWidth:!0,children:E("navigator.password.enter")}),a("input",{type:"password",className:"form-control form-control-sm",onChange:h=>t(h.target.value)})]}),_(M,{fullWidth:!0,gap:1,className:"align-items-end mt-auto pt-3",children:[a(C,{small:!0,className:"cursor-pointer",underline:!0,onClick:n,children:E("generic.cancel")}),a(Y,{className:"ms-auto",onClick:l,children:E("navigator.password.button.try")})]})]})]})]})},iJ=s=>{const{itemImage:e=void 0,itemColor:t=void 0,itemActive:r=!1,itemCount:i=1,itemCountMinimum:n=1,itemUniqueSoldout:o=!1,itemUniqueNumber:l=-2,itemUnseen:c=!1,itemHighlight:h=!1,disabled:u=!1,center:g=!0,column:m=!0,style:p={},classNames:f=[],position:T="relative",overflow:I="hidden",children:O=null,...A}=s,N=d.exports.useMemo(()=>{const y=["room-creator-grid-item"];return r&&y.push("active"),(o||l>0)&&y.push("unique-item"),o&&y.push("sold-out"),c&&y.push("unseen"),h&&y.push("has-highlight"),u&&y.push("disabled"),e===null&&y.push("icon","loading-icon"),f.length&&y.push(...f),y},[r,o,l,c,h,u,e,f]),P=d.exports.useMemo(()=>{let y={...p};return e&&(y.backgroundImage=`url(${e})`),t&&(y.backgroundColor=t),Object.keys(p).length&&(y={...y,...p}),y},[p,e,t]);return _(v,{center:g,pointer:!0,position:T,overflow:I,column:m,classNames:N,style:P,...A,children:[i>n&&a(nn,{count:i}),l>0&&_(J,{children:[a(K,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),a("div",{className:"position-absolute bottom-0 unique-item-counter",children:a(ka,{value:l})})]}),O]})},nJ=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(null),[g,m]=d.exports.useState(0),[p,f]=d.exports.useState([]),[T,I]=d.exports.useState(""),{categories:O=null}=Fi(),A=Ee("hc.disabled",!1),N=D=>Ee("images.url")+`/navigator/models/model_${D}.png`,P=(D,x)=>{!D||D.clubLevel>Li()||I(p[x].name)},y=()=>{W(new iM(r,n,"model_"+T,Number(l),Number(h),g))};return d.exports.useEffect(()=>{if(!e){const D=[];for(let x=10;x<=100;x=x+10)D.push(x);t(D),u(D[0])}},[e]),d.exports.useEffect(()=>{O&&O.length&&c(O[0].id)},[O]),d.exports.useEffect(()=>{const D=Ee("navigator.room.models");D&&D.length&&(f(D),I(D[0].name))},[]),_(Be,{className:"nitro-room-creator",theme:"primary",children:[a(He,{headerText:E("navigator.createroom.title"),onCloseClick:D=>Le("navigator/close-creator")}),a(Ge,{children:a(v,{overflow:"hidden",children:_(qe,{overflow:"hidden",children:[_(v,{size:5,gap:1,overflow:"auto",className:"px-2 py-1",children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("navigator.createroom.roomnameinfo")}),a("input",{type:"text",className:"room-creator-form",maxLength:60,onChange:D=>i(D.target.value),placeholder:E("navigator.createroom.roomnameinfo")})]}),_(v,{grow:!0,gap:1,children:[a(C,{gfbold:!0,children:E("navigator.createroom.roomdescinfo")}),a("textarea",{className:"flex-grow-1 room-creator-form",maxLength:255,onChange:D=>o(D.target.value),placeholder:E("navigator.createroom.roomdescinfo")})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("navigator.category")}),a("select",{className:"form-select form-select-sm",onChange:D=>c(Number(D.target.value)),children:O&&O.length>0&&O.map(D=>a("option",{value:D.id,children:E(D.name)},D.id))})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("navigator.maxvisitors")}),a("select",{className:"form-select form-select-sm",onChange:D=>u(Number(D.target.value)),children:e&&e.map(D=>a("option",{value:D,children:D},D))})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("navigator.tradesettings")}),_("select",{className:"form-select form-select-sm",onChange:D=>m(Number(D.target.value)),children:[a("option",{value:"0",children:E("navigator.roomsettings.trade_not_allowed")}),a("option",{value:"1",children:E("navigator.roomsettings.trade_not_with_Controller")}),a("option",{value:"2",children:E("navigator.roomsettings.trade_allowed")})]})]}),_(M,{gap:2,children:[a(Y,{fullWidth:!0,className:"volter-bold-button",onClick:y,disabled:!r||r.length<3,children:E("navigator.createroom.create")}),a(Y,{fullWidth:!0,className:"volter-button",onClick:D=>Le("navigator/close-creator"),children:E("cancel")})]})]}),a(v,{size:7,gap:1,overflow:"auto",children:a(Bt,{className:"room-creator-grid",columnCount:2,columnMinWidth:100,columnMinHeight:50,overflow:"unset",children:p.map((D,x)=>_(iJ,{fullHeight:!0,onClick:()=>P(D,x),itemActive:T===D.name,overflow:"unset",gap:0,className:"py-3",disabled:Li()<D.clubLevel,children:[a(M,{fullHeight:!0,center:!0,overflow:"hidden",children:a("img",{alt:"",src:N(D.name)})}),_(C,{position:"absolute",className:"bottom-1 start-1",children:[D.tileSize," ",E("navigator.createroom.tilesize")]}),!A&&D.clubLevel>Lr.NO_CLUB&&a(Gs,{position:"absolute",className:"top-1 end-1",type:"hc"}),T&&a("i",{className:"active-arrow"})]},D.name))})})]})})})]})},aJ=s=>{const{onCloseClick:e=null}=s,[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(!1),{report:o=null}=un(),{navigatorData:l=null}=Fi(),c=u=>{switch(u){case"settings":return ie().userId===l.enteredGuestRoom.ownerId||ie().isModerator;case"staff_pick":return ie().securityLevel>=ii.COMMUNITY;default:return!1}},h=(u,g)=>{if(!(!l||!l.enteredGuestRoom))switch(u){case"set_home_room":let m=-1;l.homeRoomId!==l.enteredGuestRoom.roomId&&(m=l.enteredGuestRoom.roomId),m>0&&W(new hM(m));return;case"navigator_search_tag":Le(`navigator/search/${g}`),W(new gl("hotel_view",`tag:${g}`));return;case"open_room_thumbnail_camera":zs(new Sn(Sn.TOGGLE_THUMBNAIL));return;case"open_group_info":Sh(l.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":Le("navigator/toggle-room-link");return;case"open_room_settings":W(new AE(l.enteredGuestRoom.roomId));return;case"toggle_pick":r(p=>!p),W(new uM(l.enteredGuestRoom.roomId));return;case"toggle_mute":n(p=>!p),W(new FD);return;case"room_filter":W(new aM(l.enteredGuestRoom.roomId));return;case"open_floorplan_editor":Le("floor-editor/toggle");return;case"report_room":o(Qt.ROOM,{roomId:l.enteredGuestRoom.roomId,roomName:l.enteredGuestRoom.roomName});return;case"close":e();return}};return d.exports.useEffect(()=>{l&&(r(l.currentRoomIsStaffPick),l.enteredGuestRoom&&n(l.enteredGuestRoom.allInRoomMuted))},[l]),l.enteredGuestRoom?_(Be,{className:"nitro-room-info",theme:"primary",children:[a(He,{headerText:E("navigator.roomsettings.roominfo"),onCloseClick:()=>h("close")}),a(Ge,{className:"text-black",children:l.enteredGuestRoom&&_(J,{children:[a(M,{gap:2,overflow:"hidden",children:_(v,{grow:!0,gap:1,overflow:"hidden",children:[_(M,{gap:1,children:[_(v,{grow:!0,gap:1,children:[_(M,{gap:1,children:[a("i",{onClick:()=>h("set_home_room"),className:bo("flex-shrink-0 icon icon-house-small cursor-pointer",l.homeRoomId!==l.enteredGuestRoom.roomId&&"gray")}),a(C,{bold:!0,children:l.enteredGuestRoom.roomName})]}),l.enteredGuestRoom.showOwner&&_(M,{alignItems:"center",gap:1,children:[a(C,{small:!0,variant:"muted",children:E("navigator.roomownercaption")}),_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:l.enteredGuestRoom.ownerId}),a(C,{small:!0,children:l.enteredGuestRoom.ownerName})]})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{small:!0,variant:"muted",children:E("navigator.roomrating")}),a(C,{small:!0,children:l.currentRoomRating})]}),l.enteredGuestRoom.tags.length>0&&a(M,{alignItems:"center",gap:1,children:l.enteredGuestRoom.tags.map(u=>_(C,{pointer:!0,className:"bg-muted rounded p-1",onClick:g=>h("navigator_search_tag",u),children:["#",u]},u))})]}),_(v,{alignItems:"center",gap:1,children:[c("settings")&&a("i",{className:"icon icon-cog cursor-pointer",title:E("navigator.room.popup.info.room.settings"),onClick:u=>h("open_room_settings")}),a(LU,{title:E("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:u=>Le("navigator/toggle-room-link")})]})]}),a(C,{small:!0,overflow:"auto",style:{maxHeight:50},children:l.enteredGuestRoom.description}),a(M,{justifyContent:"center",children:a(gg,{roomId:l.enteredGuestRoom.roomId,customUrl:l.enteredGuestRoom.officialRoomPicRef,children:c("settings")&&a("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>h("open_room_thumbnail_camera")})})}),l.enteredGuestRoom.habboGroupId>0&&_(M,{pointer:!0,alignItems:"center",gap:2,onClick:()=>h("open_group_info"),children:[a(as,{className:"flex-none",badgeCode:l.enteredGuestRoom.groupBadgeCode,isGroup:!0}),a(C,{small:!0,underline:!0,children:E("navigator.guildbase",["groupName"],[l.enteredGuestRoom.groupName])})]}),_(M,{gap:1,className:"w-100 room-tool-item",onClick:()=>h("toggle_room_link"),children:[a(K,{pointer:!0,title:E("room.like.button.text"),className:"icon-width icon icon-link-room float-start"}),a(C,{underline:!0,small:!0,children:E("navigator.embed.caption")})]})]})}),_(v,{gap:1,children:[c("staff_pick")&&a(Y,{onClick:()=>h("toggle_pick"),children:E(t?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),a(Y,{variant:"danger",onClick:()=>h("report_room"),children:E("help.emergency.main.report.room")}),c("settings")&&_(J,{children:[a(Y,{onClick:()=>h("open_room_settings"),children:E("navigator.room.popup.info.room.settings")}),a(Y,{onClick:()=>h("toggle_mute"),children:E(i?"navigator.muteall_on":"navigator.muteall_off")}),a(Y,{onClick:()=>h("room_filter"),children:E("navigator.roomsettings.roomfilter")}),a(Y,{onClick:()=>h("open_floorplan_editor"),children:E("open.floor.plan.editor")})]})]})]})})]}):null},oJ=s=>{const{onCloseClick:e=null}=s,{navigatorData:t=null}=Fi();return t.enteredGuestRoom?_(Be,{className:"nitro-room-link",theme:"primary",children:[a(He,{headerText:E("navigator.embed.title"),onCloseClick:e}),a(Ge,{className:"text-black d-flex align-items-center",children:_(M,{gap:2,children:[a(gg,{roomId:t.enteredGuestRoom.roomId,customUrl:t.enteredGuestRoom.officialRoomPicRef}),_(v,{children:[a(C,{bold:!0,fontSize:5,children:E("navigator.embed.headline")}),a(C,{children:E("navigator.embed.info")}),_(C,{children:[" ",E("navigator.embed.direct.info")]}),a("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:E("navigator.embed.src",["roomId"],[t.enteredGuestRoom.roomId.toString()])})]})]})})]}):null},lJ=s=>{const{roomData:e=null,handleChange:t=null}=s,[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(""),[l,c]=d.exports.useState(!1),h=()=>{!l||r.length<=0||n.length<=0||r!==n||t("password",r)};return d.exports.useEffect(()=>{i(""),o(""),c(!1)},[e]),_(J,{children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.roomaccess.caption")}),a(C,{children:E("navigator.roomsettings.roomaccess.info")})]}),_(v,{overflow:"auto",children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.doormode")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===Ot.OPEN_STATE&&!l,onChange:u=>t("lock_state",Ot.OPEN_STATE)}),a(C,{children:E("navigator.roomsettings.doormode.open")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===Ot.DOORBELL_STATE&&!l,onChange:u=>t("lock_state",Ot.DOORBELL_STATE)}),a(C,{children:E("navigator.roomsettings.doormode.doorbell")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===Ot.INVISIBLE_STATE&&!l,onChange:u=>t("lock_state",Ot.INVISIBLE_STATE)}),a(C,{children:E("navigator.roomsettings.doormode.invisible")})]}),_(M,{fullWidth:!0,gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===Ot.PASSWORD_STATE||l,onChange:u=>c(u.target.checked)}),!l&&e.lockState!==Ot.PASSWORD_STATE&&a(C,{children:E("navigator.roomsettings.doormode.password")}),(l||e.lockState===Ot.PASSWORD_STATE)&&_(v,{gap:1,children:[a(C,{children:E("navigator.roomsettings.doormode.password")}),a("input",{type:"password",className:"form-control form-control-sm col-4",value:r,onChange:u=>i(u.target.value),placeholder:E("navigator.roomsettings.password"),onFocus:u=>c(!0)}),l&&r.length<=0&&a(C,{bold:!0,small:!0,variant:"danger",children:E("navigator.roomsettings.passwordismandatory")}),a("input",{type:"password",className:"form-control form-control-sm col-4",value:n,onChange:u=>o(u.target.value),onBlur:h,placeholder:E("navigator.roomsettings.passwordconfirm")}),l&&r.length>0&&r!==n&&a(C,{bold:!0,small:!0,variant:"danger",children:E("navigator.roomsettings.invalidconfirm")})]})]})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.pets")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:e.allowPets,onChange:u=>t("allow_pets",u.target.checked)}),a(C,{children:E("navigator.roomsettings.allowpets")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:e.allowPetsEat,onChange:u=>t("allow_pets_eat",u.target.checked)}),a(C,{children:E("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},JT=3,ZT=60,eR=255,jh=15,cJ=s=>{const{roomData:e=null,handleChange:t=null,onClose:r=null}=s,[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(""),[u,g]=d.exports.useState(""),[m,p]=d.exports.useState(0),[f,T]=d.exports.useState(""),{showConfirm:I=null}=$t(),{categories:O=null}=Fi();j(Sb,D=>{const x=D.getParser();if(x)switch(x.code){case jr.ERROR_INVALID_TAG:T("navigator.roomsettings.unacceptablewords");case jr.ERROR_NON_USER_CHOOSABLE_TAG:T("navigator.roomsettings.nonuserchoosabletag");break;default:T("");break}});const A=()=>{I(E("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[e.roomName]),()=>{W(new MM(e.roomId)),r&&r(),Le("navigator/search/myworld_view")},null,null,null,E("navigator.roomsettings.deleteroom.confirm.title"))},N=()=>{i===e.roomName||i.length<JT||i.length>ZT||t("name",i)},P=()=>{o===e.roomDescription||o.length>eR||t("description",o)},y=D=>{D===0&&c===e.tags[0]||c.length>jh||D===1&&u===e.tags[1]||u.length>jh||(c===""&&u!==""&&g(""),T(""),p(D),t("tags",c===""&&u!==""?[u]:[c,u]))};return d.exports.useEffect(()=>{n(e.roomName),l(e.roomDescription),h(e.tags.length>0&&e.tags[0]?e.tags[0]:""),g(e.tags.length>0&&e.tags[1]?e.tags[1]:"")},[e]),_(J,{children:[_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("navigator.roomname")}),_(v,{fullWidth:!0,gap:0,children:[a("input",{className:"form-control form-control-sm",value:i,maxLength:ZT,onChange:D=>n(D.target.value),onBlur:N}),i.length<JT&&a(C,{bold:!0,small:!0,variant:"danger",children:E("navigator.roomsettings.roomnameismandatory")})]})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("navigator.roomsettings.desc")}),a("textarea",{className:"form-control form-control-sm",value:o,maxLength:eR,onChange:D=>l(D.target.value),onBlur:P})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("navigator.category")}),a("select",{className:"form-select form-select-sm",value:e.categoryId,onChange:D=>t("category",D.target.value),children:O&&O.map(D=>a("option",{value:D.id,children:E(D.name)},D.id))})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("navigator.maxvisitors")}),a("select",{className:"form-select form-select-sm",value:e.userCount,onChange:D=>t("max_visitors",D.target.value),children:NT&&NT.map(D=>a("option",{value:D,children:D},D))})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("navigator.tradesettings")}),_("select",{className:"form-select form-select-sm",value:e.tradeState,onChange:D=>t("trade_state",D.target.value),children:[a("option",{value:"0",children:E("navigator.roomsettings.trade_not_allowed")}),a("option",{value:"1",children:E("navigator.roomsettings.trade_not_with_Controller")}),a("option",{value:"2",children:E("navigator.roomsettings.trade_allowed")})]})]}),_(M,{alignItems:"center",gap:1,children:[a(C,{className:"col-3",children:E("navigator.tags")}),_(v,{fullWidth:!0,gap:0,children:[a("input",{className:"form-control form-control-sm",value:c,onChange:D=>h(D.target.value),onBlur:()=>y(0)}),c.length>jh&&a(C,{bold:!0,small:!0,variant:"danger",children:E("navigator.roomsettings.toomanycharacters")}),m===0&&f!=""&&a(C,{bold:!0,small:!0,variant:"danger",children:E(f)})]}),_(v,{fullWidth:!0,gap:0,children:[a("input",{className:"form-control form-control-sm",value:u,onChange:D=>g(D.target.value),onBlur:()=>y(1)}),u.length>jh&&a(C,{bold:!0,small:!0,variant:"danger",children:E("navigator.roomsettings.toomanycharacters")}),m===1&&f!=""&&a(C,{bold:!0,small:!0,variant:"danger",children:E(f)})]})]}),_(M,{alignItems:"center",gap:1,children:[a(K,{className:"col-3"}),a("input",{className:"form-check-input",type:"checkbox",checked:e.allowWalkthrough,onChange:D=>t("allow_walkthrough",D.target.checked)}),a(C,{children:E("navigator.roomsettings.allow_walk_through")})]}),_(C,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:A,children:[a(yo,{className:"fa-icon"}),E("navigator.roomsettings.delete")]})]})},uJ=s=>{var c;const{roomData:e=null,handleChange:t=null}=s,[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState([]),l=h=>{o(u=>{const g=[...u],m=g.findIndex(p=>p.userId===h);return m>=0&&g.splice(m,1),g}),W(new UM(h,e.roomId)),i(-1)};return j(pb,h=>{const u=h.getParser();!e||e.roomId!==u.roomId||o(u.bannedUsers)}),d.exports.useEffect(()=>{W(new CE(e.roomId))},[e.roomId]),_(qe,{overflow:"auto",children:[_(v,{size:6,children:[_(C,{bold:!0,children:[E("navigator.roomsettings.moderation.banned.users")," (",n.length,")"]}),a(M,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:a(v,{fullWidth:!0,overflow:"auto",gap:1,children:n&&n.length>0&&n.map((h,u)=>_(M,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[a(Ei,{userName:h.userName}),_(C,{pointer:!0,grow:!0,onClick:g=>i(h.userId),children:[" ",h.userName]})]},u))})}),_(Y,{disabled:r<=0,onClick:h=>l(r),children:[E("navigator.roomsettings.moderation.unban")," ",r>0&&((c=n.find(h=>h.userId===r))==null?void 0:c.userName)]})]}),_(v,{size:6,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.moderation.mute.header")}),a(M,{alignItems:"center",gap:1,children:_("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMute,onChange:h=>t("moderation_mute",h.target.value),children:[a("option",{value:kr.MODERATION_LEVEL_NONE,children:E("navigator.roomsettings.moderation.none")}),a("option",{value:kr.MODERATION_LEVEL_USER_WITH_RIGHTS,children:E("navigator.roomsettings.moderation.rights")})]})})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.moderation.kick.header")}),a(M,{alignItems:"center",gap:1,children:_("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowKick,onChange:h=>t("moderation_kick",h.target.value),children:[a("option",{value:kr.MODERATION_LEVEL_NONE,children:E("navigator.roomsettings.moderation.none")}),a("option",{value:kr.MODERATION_LEVEL_USER_WITH_RIGHTS,children:E("navigator.roomsettings.moderation.rights")}),a("option",{value:kr.MODERATION_LEVEL_ALL,children:E("navigator.roomsettings.moderation.all")})]})})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.moderation.ban.header")}),a(M,{alignItems:"center",gap:1,children:_("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowBan,onChange:h=>t("moderation_ban",h.target.value),children:[a("option",{value:kr.MODERATION_LEVEL_NONE,children:E("navigator.roomsettings.moderation.none")}),a("option",{value:kr.MODERATION_LEVEL_USER_WITH_RIGHTS,children:E("navigator.roomsettings.moderation.rights")})]})})]})]})]})},hJ=s=>{const{roomData:e=null}=s,[t,r]=d.exports.useState(new Map);return j(Tb,i=>{const n=i.getParser();!e||e.roomId!==n.roomId||r(n.users)}),j(Eb,i=>{const n=i.getParser();!e||e.roomId!==n.roomId||r(o=>{const l=new Map(o);return l.set(n.data.userId,n.data.userName),l})}),j(Ib,i=>{const n=i.getParser();!e||e.roomId!==n.roomId||r(o=>{const l=new Map(o);return l.delete(n.userId),l})}),d.exports.useEffect(()=>{W(new wM(e.roomId))},[e.roomId]),_(qe,{children:[_(v,{size:6,children:[a(C,{bold:!0,children:E("navigator.flatctrls.userswithrights",["displayed","total"],[t.size.toString(),t.size.toString()])}),a(M,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:a(v,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(t.entries()).map(([i,n],o)=>_(M,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[a(Ei,{userName:n}),_(C,{pointer:!0,grow:!0,onClick:l=>W(new OE(i)),children:[" ",n]})]},o))})})]}),a(v,{size:6,justifyContent:"end",children:a(Y,{variant:"danger",disabled:!t.size,onClick:i=>W(new bM(e.roomId)),children:E("navigator.flatctrls.clear")})})]})},dJ=s=>{const{roomData:e=null,handleChange:t=null}=s,[r,i]=d.exports.useState(0);return d.exports.useEffect(()=>{i(e.chatSettings.distance)},[e.chatSettings]),_(J,{children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.vip.caption")}),a(C,{children:E("navigator.roomsettings.vip.info")})]}),_(qe,{overflow:"auto",children:[_(v,{size:6,gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.chat_settings")}),a(C,{children:E("navigator.roomsettings.chat_settings.info")}),_("select",{className:"form-select form-select-sm",value:e.chatSettings.mode,onChange:n=>t("bubble_mode",n.target.value),children:[a("option",{value:xt.CHAT_MODE_FREE_FLOW,children:E("navigator.roomsettings.chat.mode.free.flow")}),a("option",{value:xt.CHAT_MODE_LINE_BY_LINE,children:E("navigator.roomsettings.chat.mode.line.by.line")})]}),_("select",{className:"form-select form-select-sm",value:e.chatSettings.weight,onChange:n=>t("chat_weight",n.target.value),children:[a("option",{value:xt.CHAT_BUBBLE_WIDTH_NORMAL,children:E("navigator.roomsettings.chat.bubbles.width.normal")}),a("option",{value:xt.CHAT_BUBBLE_WIDTH_THIN,children:E("navigator.roomsettings.chat.bubbles.width.thin")}),a("option",{value:xt.CHAT_BUBBLE_WIDTH_WIDE,children:E("navigator.roomsettings.chat.bubbles.width.wide")})]}),_("select",{className:"form-select form-select-sm",value:e.chatSettings.speed,onChange:n=>t("bubble_speed",n.target.value),children:[a("option",{value:xt.CHAT_SCROLL_SPEED_FAST,children:E("navigator.roomsettings.chat.speed.fast")}),a("option",{value:xt.CHAT_SCROLL_SPEED_NORMAL,children:E("navigator.roomsettings.chat.speed.normal")}),a("option",{value:xt.CHAT_SCROLL_SPEED_SLOW,children:E("navigator.roomsettings.chat.speed.slow")})]}),_("select",{className:"form-select form-select-sm",value:e.chatSettings.protection,onChange:n=>t("flood_protection",n.target.value),children:[a("option",{value:xt.FLOOD_FILTER_LOOSE,children:E("navigator.roomsettings.chat.flood.loose")}),a("option",{value:xt.FLOOD_FILTER_NORMAL,children:E("navigator.roomsettings.chat.flood.normal")}),a("option",{value:xt.FLOOD_FILTER_STRICT,children:E("navigator.roomsettings.chat.flood.strict")})]}),a(C,{children:E("navigator.roomsettings.chat_settings.hearing.distance")}),a("input",{type:"number",min:"0",className:"form-control form-control-sm",value:r,onChange:n=>i(n.target.valueAsNumber),onBlur:n=>t("chat_distance",r)})]}),_(v,{size:6,gap:1,children:[a(C,{bold:!0,children:E("navigator.roomsettings.vip_settings")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:e.hideWalls,onChange:n=>t("hide_walls",n.target.checked)}),a(C,{children:E("navigator.roomsettings.hide_walls")})]}),_("select",{className:"form-select form-select-sm",value:e.wallThickness,onChange:n=>t("wall_thickness",n.target.value),children:[a("option",{value:"0",children:E("navigator.roomsettings.wall_thickness.normal")}),a("option",{value:"1",children:E("navigator.roomsettings.wall_thickness.thick")}),a("option",{value:"-1",children:E("navigator.roomsettings.wall_thickness.thin")}),a("option",{value:"-2",children:E("navigator.roomsettings.wall_thickness.thinnest")})]}),_("select",{className:"form-select form-select-sm",value:e.floorThickness,onChange:n=>t("floor_thickness",n.target.value),children:[a("option",{value:"0",children:E("navigator.roomsettings.floor_thickness.normal")}),a("option",{value:"1",children:E("navigator.roomsettings.floor_thickness.thick")}),a("option",{value:"-1",children:E("navigator.roomsettings.floor_thickness.thin")}),a("option",{value:"-2",children:E("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},Xa=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],_J=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(Xa[0]);j(Rb,l=>{const c=l.getParser();if(!c)return;const h=c.data;t({roomId:h.roomId,roomName:h.name,roomDescription:h.description,categoryId:h.categoryId,userCount:h.maximumVisitorsLimit,tags:h.tags,tradeState:h.tradeMode,allowWalkthrough:h.allowWalkThrough,lockState:h.doorMode,password:null,allowPets:h.allowPets,allowPetsEat:h.allowFoodConsume,hideWalls:h.hideWalls,wallThickness:h.wallThickness,floorThickness:h.floorThickness,chatSettings:{mode:h.chatSettings.mode,weight:h.chatSettings.weight,speed:h.chatSettings.speed,distance:h.chatSettings.distance,protection:h.chatSettings.protection},moderationSettings:{allowMute:h.roomModerationSettings.allowMute,allowKick:h.roomModerationSettings.allowKick,allowBan:h.roomModerationSettings.allowBan}}),W(new CE(h.roomId))});const n=()=>{t(null),i(Xa[0])},o=(l,c)=>{t(h=>{const u={...h};switch(l){case"name":u.roomName=String(c);break;case"description":u.roomDescription=String(c);break;case"category":u.categoryId=Number(c);break;case"max_visitors":u.userCount=Number(c);break;case"trade_state":u.tradeState=Number(c);break;case"tags":u.tags=c;break;case"allow_walkthrough":u.allowWalkthrough=Boolean(c);break;case"allow_pets":u.allowPets=Boolean(c);break;case"allow_pets_eat":u.allowPetsEat=Boolean(c);break;case"hide_walls":u.hideWalls=Boolean(c);break;case"wall_thickness":u.wallThickness=Number(c);break;case"floor_thickness":u.floorThickness=Number(c);break;case"lock_state":u.lockState=Number(c);break;case"password":u.lockState=Ot.PASSWORD_STATE,u.password=String(c);break;case"moderation_mute":u.moderationSettings.allowMute=Number(c);break;case"moderation_kick":u.moderationSettings.allowKick=Number(c);break;case"moderation_ban":u.moderationSettings.allowBan=Number(c);break;case"bubble_mode":u.chatSettings.mode=Number(c);break;case"chat_weight":u.chatSettings.weight=Number(c);break;case"bubble_speed":u.chatSettings.speed=Number(c);break;case"flood_protection":u.chatSettings.protection=Number(c);break;case"chat_distance":u.chatSettings.distance=Number(c);break}return W(new FM(u.roomId,u.roomName,u.roomDescription,u.lockState,u.password,u.userCount,u.categoryId,u.tags.length,u.tags,u.tradeState,u.allowPets,u.allowPetsEat,u.allowWalkthrough,u.hideWalls,u.wallThickness,u.floorThickness,u.moderationSettings.allowMute,u.moderationSettings.allowKick,u.moderationSettings.allowBan,u.chatSettings.mode,u.chatSettings.weight,u.chatSettings.speed,u.chatSettings.distance,u.chatSettings.protection)),u})};return e?_(Be,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[a(He,{headerText:E("navigator.roomsettings"),onCloseClick:n}),a(ca,{children:Xa.map(l=>a(Dn,{isActive:r===l,onClick:c=>i(l),children:E(l)},l))}),_(Ge,{children:[r===Xa[0]&&a(cJ,{roomData:e,handleChange:o,onClose:n}),r===Xa[1]&&a(lJ,{roomData:e,handleChange:o}),r===Xa[2]&&a(hJ,{roomData:e,handleChange:o}),r===Xa[3]&&a(dJ,{roomData:e,handleChange:o}),r===Xa[4]&&a(uJ,{roomData:e,handleChange:o})]})]}):null},tR=s=>{const{roomData:e=null}=s,[t,r]=d.exports.useState(!1),i=d.exports.useRef(),n=()=>{const o=100*(e.userCount/e.maxUserCount);let l="bg-primary";return o>=92?l="bg-danger":o>=50?l="bg-warning":o>0&&(l="bg-success"),l};return _(J,{children:[a(K,{pointer:!0,innerRef:i,className:"icon icon-navigator-info",onMouseOver:o=>r(!0),onMouseLeave:o=>r(!1)}),a(nS,{show:t,target:i.current,placement:"right",children:a(yd,{children:_(Ge,{overflow:"hidden",className:"room-info bg-transparent",children:[_(M,{gap:2,overflow:"hidden",className:"room-info-bg p-2",children:[_(gg,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&a(as,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1 "}),e.doorMode!==Ot.OPEN_STATE&&a("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===Ot.DOORBELL_STATE?"locked":e.doorMode===Ot.PASSWORD_STATE?"password":e.doorMode===Ot.INVISIBLE_STATE?"invisible":"")})]}),_(v,{gap:1,children:[a(C,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:13},children:e.roomName}),_(M,{gap:2,children:[a(C,{italics:!0,variant:"muted",children:E("navigator.roomownercaption")}),_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:e.ownerId}),a(C,{italics:!0,children:e.ownerName})]})]}),a(C,{className:"flex-grow-1",children:e.description}),_(M,{className:"badge p-1 position-absolute m-1 bottom-0 end-0 m-2 "+n(),gap:1,children:[a(aS,{className:"fa-icon"}),e.userCount]})]})]}),_(v,{children:[_(M,{children:[_(M,{gap:1,className:"align-items-center",children:[a(Ei,{userId:e.ownerId}),a(C,{bold:!0,underline:!0,children:e.ownerName})]}),_(M,{gap:1,className:"align-items-center",justifyContent:"end",fullWidth:!0,children:[a("i",{className:"icon icon-navigator-room-group"}),a(C,{bold:!0,underline:!0,children:e.groupName})]})]}),_(M,{gap:1,children:[a(C,{bold:!0,children:E("navigator.roompopup.property.max_users")}),a(C,{children:e.maxUserCount})]})]})]})})})]})},sR=s=>{const{roomData:e=null,children:t=null,thumbnail:r=!1,...i}=s,{setDoorData:n=null}=Fi(),o=()=>{const c=100*(e.userCount/e.maxUserCount);let h="badge-empty";return c>=92?h="badge-danger":c>=50?h="badge-warning":c>0&&(h="badge-success"),h},l=c=>{if(e.ownerId!==ie().userId){if(e.habboGroupId!==0){Wr(e.roomId);return}switch(e.doorMode){case Ot.DOORBELL_STATE:n(h=>{const u={...h};return u.roomInfo=e,u.state=Pt.START_DOORBELL,u});return;case Ot.PASSWORD_STATE:n(h=>{const u={...h};return u.roomInfo=e,u.state=Pt.START_PASSWORD,u});return}}ol(e.roomId)};return r?_(v,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:l,gap:0,className:"nav-thumbnail p-1 rounded-3 small mb-1 flex-column",...i,children:[_(gg,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&a(as,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),_(M,{center:!0,className:"badge p-1 position-absolute m-1 "+o(),gap:1,children:[a(aS,{className:"fa-icon"}),e.userCount]}),e.doorMode!==Ot.OPEN_STATE&&a("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===Ot.DOORBELL_STATE?"locked":e.doorMode===Ot.PASSWORD_STATE?"password":e.doorMode===Ot.INVISIBLE_STATE?"invisible":"")})]}),_(M,{className:"w-100",children:[a(C,{truncate:!0,className:"flex-grow-1",children:e.roomName}),a(M,{reverse:!0,alignItems:"center",gap:1,children:a(tR,{roomData:e})}),t]})]}):_(M,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:l,gap:2,className:"navigator-item px-2 small",...i,children:[_(M,{center:!0,className:"p-1 fw-bold "+o(),gap:1,children:[a("div",{className:"nav-avatar-icon"}),e.userCount]}),a(C,{truncate:!0,grow:!0,children:e.roomName}),_(M,{reverse:!0,alignItems:"center",gap:1,children:[a(tR,{roomData:e}),e.habboGroupId>0&&a("i",{className:"icon icon-navigator-room-group"}),e.doorMode!==Ot.OPEN_STATE&&a("i",{className:"icon icon-navigator-room-"+(e.doorMode===Ot.DOORBELL_STATE?"locked":e.doorMode===Ot.PASSWORD_STATE?"password":e.doorMode===Ot.INVISIBLE_STATE?"invisible":"")})]}),t]})},gJ=s=>{const{searchResult:e=null,...t}=s,[r,i]=d.exports.useState(!0),[n,o]=d.exports.useState(0),{topLevelContext:l=null}=Fi(),c=()=>{let m=e.code;return!m||!m.length||E("navigator.searchcode.title."+m)=="navigator.searchcode.title."+m?e.data:m.startsWith("${")?m.slice(2,m.length-1):"navigator.searchcode.title."+m},h=()=>{o(m=>m===Ra.LIST?Ra.THUMBNAILS:Ra.LIST)},u=()=>{e.action==1?W(new gl(e.code,"")):e.action==2&&l&&W(new gl(l.code,""))};d.exports.useEffect(()=>{e&&(i(!e.closed),o(e.mode))},[e]);const g=n>=Ra.THUMBNAILS;return _(v,{className:"bg-white",gap:0,children:[_(M,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[_(M,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:m=>i(p=>!p),children:[r&&a(UU,{className:"text-secondary fa-icon"}),!r&&a(Lc,{className:"text-secondary fa-icon"}),_("div",{className:"nav-category",children:[" ",E(c())]})]}),_(M,{gap:2,children:[n===Ra.LIST&&a(xU,{className:"text-secondary fa-icon",onClick:h}),n>=Ra.THUMBNAILS&&a(wU,{className:"text-secondary fa-icon",onClick:h}),e.action>0&&e.action===1&&a(FU,{className:"text-secondary fa-icon",onClick:u}),e.action>0&&e.action!==1&&a(kU,{className:"text-secondary fa-icon",onClick:u})]})]})," ",r&&a(J,{children:g?a(Bt,{columnCount:3,...t,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:e.rooms.length>0&&e.rooms.map((m,p)=>a(sR,{roomData:m,thumbnail:!0},p))}):a(qe,{columnCount:1,className:"navigator-grid",gap:0,children:e.rooms.length>0&&e.rooms.map((m,p)=>a(sR,{roomData:m},p))})})]})},mJ=s=>{const{sendSearch:e=null}=s,[t,r]=d.exports.useState(0),[i,n]=d.exports.useState(""),{topLevelContext:o=null,searchResult:l=null}=Fi(),c=()=>{if(!o)return;let u=Pl[t];u||(u=Pl[0]);const g=(u.query?u.query+":":"")+i;e(g||"",o.code)},h=u=>{u.key==="Enter"&&c()};return d.exports.useEffect(()=>{if(!l)return;const u=l.data.split(":");let g=null,m="";if(u.length>=2){const[p,...f]=u;g=Pl.find(T=>T.query===p),m=f.join(":")}else m=l.data;g||(g=Pl[0]),r(Pl.findIndex(p=>p===g)),n(m)},[l]),_(M,{fullWidth:!0,gap:1,children:[a(M,{shrink:!0,children:a("select",{className:"form-select form-select-sm",value:t,onChange:u=>r(parseInt(u.target.value)),children:Pl.map((u,g)=>a("option",{value:g,children:E("navigator.filter."+u.name)},g))})}),_(M,{fullWidth:!0,gap:2,children:[a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("navigator.filter.input.placeholder"),value:i,onChange:u=>n(u.target.value),onKeyDown:u=>h(u)}),a("i",{className:"icon icon-pen navigator-search-button position-absolute",onClick:c})]})]})},fJ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState(!1),[l,c]=d.exports.useState(!1),[h,u]=d.exports.useState(!1),[g,m]=d.exports.useState(!1),[p,f]=d.exports.useState(!0),[T,I]=d.exports.useState(!1),{searchResult:O=null,topLevelContext:A=null,topLevelContexts:N=null,navigatorData:P=null}=Fi(),y=d.exports.useRef(null),D=d.exports.useRef();es(Ve.CREATED,k=>{t(!1),o(!1)});const x=d.exports.useCallback((k,F)=>{W(new gl(F,k)),m(!0)},[]),w=d.exports.useCallback(()=>{if(!r){I(!0);return}if(y.current){x(y.current.value,y.current.code),y.current=null;return}if(O){x(O.data,O.code);return}A&&x("",A.code)},[r,O,A,x]);return d.exports.useEffect(()=>{const k={linkReceived:F=>{const L=F.split("/");if(!(L.length<2))switch(L[1]){case"show":{t(!0),I(!0);return}case"hide":t(!1);return;case"toggle":{if(e){t(!1);return}t(!0),I(!0);return}case"toggle-room-info":c(B=>!B);return;case"toggle-room-link":u(B=>!B);return;case"goto":if(L.length<=2)return;switch(L[2]){case"home":if(P.homeRoomId<=0)return;Wr(P.homeRoomId);break;default:{const B=parseInt(L[2]);Wr(B)}}return;case"create":o(B=>!B);return;case"close-creator":o(!1);return;case"search":if(L.length>2){const B=L[2];let V="";L.length>3&&(V=L[3]),y.current={value:V,code:B},t(!0),I(!0)}return}},eventUrlPrefix:"navigator/"};return xs(k),()=>ws(k)},[e,P]),d.exports.useEffect(()=>{O&&(m(!1),D&&D.current&&(D.current.scrollTop=0))},[O]),d.exports.useEffect(()=>{!e||!r||!T||(w(),I(!1))},[e,r,T,w]),d.exports.useEffect(()=>{r||!A||i(!0)},[r,A]),d.exports.useEffect(()=>{!e||!p||(W(new lM),f(!1))},[e,p]),d.exports.useEffect(()=>{It.addCallback(an.OPENROOM,(k,F=!1,L=null)=>W(new rM(k)))},[]),_(J,{children:[e&&_(Be,{uniqueKey:"navigator",className:"nitro-navigator",children:[a(He,{headerText:E("navigator.title"),onCloseClick:k=>t(!1)}),a(ca,{children:N&&N.length>0&&N.map((k,F)=>a(Dn,{isActive:A===k,onClick:L=>x("",k.code),children:E("navigator.toplevelview."+k.code)},F))}),_(Ge,{position:"relative",children:[g&&a(K,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),_(J,{children:[a(mJ,{sendSearch:x}),a(v,{overflow:"auto",children:O&&O.results.map((k,F)=>a(gJ,{searchResult:k},F))})]}),a(M,{className:"nav-bottom",children:_(M,{className:"nav-bottom-buttons position-absolute",children:[a(M,{className:"nav-create-room",onClick:k=>o(F=>!F),children:a(C,{variant:"white",bold:!0,className:"nav-bottom-buttons-text",children:E("navigator.createroom.create")})}),a(M,{className:"nav-random-room",children:a(C,{variant:"white",bold:!0,className:"nav-bottom-buttons-text",children:E("navigator.random.room")})})]})})]})]}),n&&a(nJ,{}),a(rJ,{}),l&&a(aJ,{onCloseClick:()=>c(!1)}),h&&a(oJ,{onCloseClick:()=>u(!1)}),a(_J,{})]})},pJ=/\n\r|\n|\r/mg,EJ=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(null),l=d.exports.useRef(null);return d.exports.useEffect(()=>{const c=async u=>{try{const g=await fetch(u);if(!g)return;const p=(await g.text()).split(pJ),f=p.shift().split("|");i(f[0]),o(T=>f[1]&&f[1].split(";").length===2?{width:parseInt(f[1].split(";")[0]),height:parseInt(f[1].split(";")[1])}:null),t(p.join(""))}catch{xe.error(`Failed to fetch ${u}`)}},h={linkReceived:u=>{const g=u.split("/");g.length<2||(g.shift(),c(Ee("habbopages.url")+g.join("/")))},eventUrlPrefix:"habbopages/"};return xs(h),()=>ws(h)},[]),d.exports.useEffect(()=>{const c=h=>{if(!(h.target instanceof HTMLAnchorElement))return;h.preventDefault();const u=h.target.href;!u||!u.length||Al(u)};return document.addEventListener("click",c),()=>{document.removeEventListener("click",c)}},[]),e?_(Be,{className:"nitropedia",theme:"primary",style:n?{width:n.width,height:n.height}:{},children:[a(He,{headerText:r,onCloseClick:()=>t(null)}),a(Ge,{children:a(K,{fit:!0,innerRef:l,className:"text-black",dangerouslySetInnerHTML:{__html:e}})})]}):null},IJ=s=>{const{offer:e=null,setOpen:t=null}=s;if(e)return _(yI,{fadesOut:!1,onClose:null,onClick:r=>t(!0),gap:2,children:[a(K,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${Ee("image.library.url")+e.iconImageUrl})`}}),a(C,{variant:"light",className:"ubuntu-bold",children:e.title})]})},TJ=s=>{const{offer:e=null,setOpen:t=null}=s,{getCurrencyAmount:r}=vl(),[i,n]=d.exports.useState(1),o=d.exports.useMemo(()=>{let h=!1,u=!1,g=!1;return e.priceInCredits>0&&(h=r(-1)>=e.priceInCredits),e.priceInActivityPoints>0?u=r(e.activityPointType)>=e.priceInActivityPoints:u=!0,e.purchaseLimit>0&&(g=!0),h&&u&&g},[e,r]),l=()=>{let h=Math.max(0,(e.expirationTime-Date.now())/1e3);return Or.format(h)},c=()=>{W(new fy(e.id,i)),W(new EE)};if(e)return _(Be,{theme:"primary-slim",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[a(He,{headerText:E(e.title),onCloseClick:h=>t(!1)}),a(i0,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:E("targeted.offer.timeleft",["timeleft"],[l()])}),_(Ge,{gap:1,children:[_(M,{gap:1,fullHeight:!0,children:[_(M,{gap:1,column:!0,className:"w-75 text-black",children:[_(v,{className:"bg-warning p-2",fullHeight:!0,children:[a("h4",{children:E(e.title)}),a(K,{dangerouslySetInnerHTML:{__html:e.description}})]}),_(M,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[e.purchaseLimit>1&&_(M,{gap:1,children:[a(C,{variant:"muted",children:E("catalog.bundlewidget.quantity")}),a("input",{type:"number",value:i,onChange:h=>n(parseInt(h.target.value)),min:1,max:e.purchaseLimit})]}),a(Y,{variant:"primary",disabled:!o,onClick:()=>c(),children:E("targeted.offer.button.buy")})]})]}),a(K,{className:"w-50",fullHeight:!0,style:{background:`url(${Ee("image.library.url")+e.imageUrl}) no-repeat center`}})]}),_(M,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[a(C,{children:E("targeted.offer.price.label")}),e.priceInCredits>0&&_(M,{gap:1,children:[a(C,{variant:"light",children:e.priceInCredits}),a(Gs,{type:-1})]}),e.priceInActivityPoints>0&&_(M,{gap:1,children:[_(C,{className:"ubuntu-bold",variant:"light",children:["+",e.priceInActivityPoints]})," ",a(Gs,{type:e.activityPointType})]})]})]})]})},RJ=()=>{const[s,e]=d.exports.useState(null),[t,r]=d.exports.useState(!1);if(j(EC,i=>{let n=i.getParser();n&&e(n.data)}),v0(()=>{W(new EE)}),!!s)return a(J,{children:t?a(TJ,{offer:s,setOpen:r}):a(IJ,{offer:s,setOpen:r})})},SJ=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(!0),{showConfirm:l=null}=$t();j(Fu,m=>{t(0),i(null)}),j(lE,m=>{t(0),i(null)}),j(wa,m=>{const p=m.getParser();p.roomEnter&&(p.data.habboGroupId>0?(t(p.data.habboGroupId),W(new Rc(p.data.habboGroupId,!1))):(t(0),i(null)))}),j(BC,m=>{const p=m.getParser();!r||p.groupId!==r.id&&p.groupId!==e||(t(0),i(null))}),j(kc,m=>{const p=m.getParser();p.id===e&&i(p)});const c=()=>{l(E("group.leaveconfirm.desc"),()=>{W(new X_(r.id,ie().userId))},null)},h=r&&r.ownerName===ie().userName,u=()=>{if(h)return"group.manage";if(r.type===hi.PRIVATE)return"";if(r.membershipType===Zs.MEMBER)return"group.leave";if(r.membershipType===Zs.NOT_MEMBER&&r.type===hi.REGULAR)return"group.join";if(r.membershipType===Zs.REQUEST_PENDING)return"group.membershippending";if(r.membershipType===Zs.NOT_MEMBER&&r.type===hi.EXCLUSIVE)return"group.requestmembership"},g=()=>{if(h)return jL(r.id);if(!(r.type===hi.PRIVATE&&r.membershipType===Zs.NOT_MEMBER)){if(r.membershipType===Zs.MEMBER){c();return}RI(r.id)}};return r?a(K,{className:"nitro-notification-bubble",children:_(v,{children:[_(M,{className:"grouproom-header",alignItems:"center",justifyContent:"between",pointer:!0,onClick:m=>o(p=>!p),children:[a(C,{bold:!0,small:!0,className:"header-text p-1",variant:"white",children:E("group.homeroominfo.title")}),n&&a(A_,{className:"fa-icon"}),!n&&a(N_,{className:"fa-icon"})]}),n&&a(J,{children:_(v,{className:"px-2 pb-2",children:[_(M,{pointer:!0,alignItems:"center",gap:2,onClick:m=>Sh(r.id),children:[a(K,{className:"group-badge",children:a(as,{badgeCode:r.badge,isGroup:!0})}),a(C,{bold:!0,variant:"white",children:r.title})]}),(r.type!==hi.PRIVATE||h)&&a(Y,{fullWidth:!0,className:"btn-flash fw-bold",disabled:r.membershipType===Zs.REQUEST_PENDING,onClick:g,children:E(u())})]})})]})}):null},rR="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=<>?/|",OJ=`







































`,Cg=30,xl=Cg,da=Cg,Yh=Cg,zh=Cg,CJ=3,AJ=({item:s,onClose:e})=>{const[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(!0),[u,g]=d.exports.useState(!1),[m,p]=d.exports.useState(!1),[f,T]=d.exports.useState(!1),[I,O]=d.exports.useState(null),A=d.exports.useRef(null),[N,P]=d.exports.useState(!1),[y,D]=d.exports.useState(null),x=d.exports.useRef(null),w=d.exports.useRef(null),k=d.exports.useRef(null),F=d.exports.useRef(1);d.exports.useEffect(()=>{ce(),setTimeout(()=>p(!0),20)},[]),d.exports.useEffect(()=>{const se=Te=>{f?(Te.preventDefault(),V(Te.key)):N&&(Te.preventDefault(),Oe(Te.key))};return window.addEventListener("keydown",se),()=>{window.removeEventListener("keydown",se)}},[f,I,N,y]);const L=se=>{const Te=xl,Ce=da;let Ie=new Array(Ce).fill(null).map(()=>new Array(Te).fill(" "));for(let De=0;De<Te;De++)Ie[0][De]="-",Ie[Ce-1][De]="-";for(let De=1;De<Ce-1;De++)Ie[De][0]="|",Ie[De][Te-1]="|";for(let De=1;De<Ce-1;De+=2)Ie[De][Math.floor(Te/2)]="|";for(let De=0;De<3;De++){const zt=se.playerPaddleY+De;zt>=1&&zt<Ce-1&&(Ie[zt][1]="");const ss=se.aiPaddleY+De;ss>=1&&ss<Ce-1&&(Ie[ss][Te-2]="")}se.ballY>=1&&se.ballY<Ce-1&&se.ballX>=1&&se.ballX<Te-1&&(Ie[se.ballY][se.ballX]="");const Ue=`Jugador: ${se.playerScore}  Mxima: ${se.aiScore}`,ut=Math.floor((Te-Ue.length)/2);for(let De=0;De<Ue.length;De++)ut+De<Te&&(Ie[0][ut+De]=Ue[De]);return Ie.map(De=>De.join("")).join(`
`)},B=se=>{T(!0);const Te={ballX:Math.floor(xl/2),ballY:Math.floor(da/2),ballDirX:Math.random()<.5?-1:1,ballDirY:Math.random()<.5?-1:1,playerPaddleY:Math.floor(da/2)-1,aiPaddleY:Math.floor(da/2)-1,playerScore:0,aiScore:0};O(Te),r(Ce=>[...Ce,{id:se,type:"pong",content:L(Te)}]),A.current=setInterval(()=>{O(Ce=>{if(!Ce)return Ce;let{ballX:Ie,ballY:Ue,ballDirX:ut,ballDirY:De,playerPaddleY:zt,aiPaddleY:ss,playerScore:cs,aiScore:Nr}=Ce,Hs=Ie+ut,Fs=Ue+De;Fs<=1&&(Fs=1,De=1),Fs>=da-2&&(Fs=da-2,De=-1),Hs===2&&Fs>=zt&&Fs<zt+3&&(ut=1),Hs===xl-3&&Fs>=ss&&Fs<ss+3&&(ut=-1);let Fn=cs,hn=Nr,dn=!1;Hs<=0?(hn++,dn=!0,ut=1):Hs>=xl-1&&(Fn++,dn=!0,ut=-1),dn?(Hs=Math.floor(xl/2),Fs=Math.floor(da/2),De=Math.random()<.5?-1:1):(Ie=Hs,Ue=Fs);let $s=ss;Math.random()>.3&&Ie>xl/2&&(Ue>ss+1?$s=Math.min(da-4,ss+1):Ue<ss+1&&($s=Math.max(1,ss-1)));const Ai={ballX:Ie,ballY:Ue,ballDirX:ut,ballDirY:De,playerPaddleY:zt,aiPaddleY:$s,playerScore:Fn,aiScore:hn};return r(kn=>{const ni=kn.findIndex(_n=>_n.type==="pong");if(ni===-1)return kn;const Zc=[...kn];return Zc[ni]={...Zc[ni],content:L(Ai)},Zc}),Ai})},150)},V=se=>{if(!I)return;const Te=1;let Ce=I.playerPaddleY;if(se==="w"||se==="W")Ce=Math.max(1,I.playerPaddleY-Te);else if(se==="s"||se==="S")Ce=Math.min(da-4,I.playerPaddleY+Te);else if(se==="q"||se==="Q"){q();return}Ce!==I.playerPaddleY&&O({...I,playerPaddleY:Ce})},q=()=>{T(!1),O(null),A.current&&(clearInterval(A.current),A.current=null),r(Te=>Te.filter(Ce=>Ce.type!=="pong"));const se=F.current++;r(Te=>[...Te,{id:se,type:"output",content:a("div",{children:"Has salido del juego Pong."})}]),w.current&&w.current.focus()},Z=se=>{let Te;do Te={x:Math.floor(Math.random()*(Yh-2))+1,y:Math.floor(Math.random()*(zh-2))+1};while(se.some(Ce=>Ce.x===Te.x&&Ce.y===Te.y));return Te},H=se=>{const Te=Yh,Ce=zh;let Ie=new Array(Ce).fill(null).map(()=>new Array(Te).fill(" "));for(let De=0;De<Te;De++)Ie[0][De]="-",Ie[Ce-1][De]="-";for(let De=1;De<Ce-1;De++)Ie[De][0]="|",Ie[De][Te-1]="|";Ie[se.food.y][se.food.x]="";for(let De=0;De<se.snake.length;De++){const zt=se.snake[De];Ie[zt.y][zt.x]=De===0?"":""}const Ue=`SCORE: ${se.score}`,ut=Math.floor((Te-Ue.length)/2);for(let De=0;De<Ue.length;De++)ut+De<Te&&(Ie[0][ut+De]=Ue[De]);return Ie.map(De=>De.join("")).join(`
`)},X=()=>{const se=[],Te=Math.floor(Yh/2),Ce=Math.floor(zh/2);for(let Ie=0;Ie<CJ;Ie++)se.push({x:Te-Ie,y:Ce});return{snake:se,food:Z(se),direction:"RIGHT",score:0,gameOver:!1}},ee=se=>{P(!0);const Te=X();D(Te),r(Ce=>[...Ce,{id:se,type:"snake",content:H(Te)}]),x.current&&clearInterval(x.current),x.current=setInterval(()=>{D(Ce=>{if(!Ce)return Ce;const Ie=Ce.snake[0];let Ue={x:Ie.x,y:Ie.y};switch(Ce.direction){case"UP":Ue.y-=1;break;case"DOWN":Ue.y+=1;break;case"LEFT":Ue.x-=1;break;case"RIGHT":Ue.x+=1;break}if(Ue.x<=0||Ue.x>=Yh-1||Ue.y<=0||Ue.y>=zh-1||Ce.snake.some(cs=>cs.x===Ue.x&&cs.y===Ue.y)){const cs=X();return r(Nr=>{const Hs=Nr.findIndex(Fn=>Fn.type==="snake");if(Hs===-1)return Nr;const Fs=[...Nr];return Fs[Hs]={...Fs[Hs],content:H(cs)},Fs}),cs}let ut=[Ue,...Ce.snake],De=Ce.food,zt=Ce.score;Ue.x===Ce.food.x&&Ue.y===Ce.food.y?(zt++,De=Z(ut)):ut.pop();const ss={snake:ut,food:De,direction:Ce.direction,score:zt,gameOver:!1};return r(cs=>{const Nr=cs.findIndex(Fs=>Fs.type==="snake");if(Nr===-1)return cs;const Hs=[...cs];return Hs[Nr]={...Hs[Nr],content:H(ss)},Hs}),ss})},150)},Oe=se=>{if(!y||y.gameOver){(se==="q"||se==="Q")&&de();return}let Te=y.direction;if((se==="w"||se==="W")&&y.direction!=="DOWN")Te="UP";else if((se==="s"||se==="S")&&y.direction!=="UP")Te="DOWN";else if((se==="a"||se==="A")&&y.direction!=="RIGHT")Te="LEFT";else if((se==="d"||se==="D")&&y.direction!=="LEFT")Te="RIGHT";else if(se==="q"||se==="Q"){de();return}Te!==y.direction&&D({...y,direction:Te})},de=()=>{P(!1),D(null),x.current&&(clearInterval(x.current),x.current=null),r(Te=>Te.filter(Ce=>Ce.type!=="snake"));const se=F.current++;r(Te=>[...Te,{id:se,type:"output",content:a("div",{children:"Has salido del juego Snake."})}]),w.current&&w.current.focus()},ve=()=>{const se=F.current++,Te=ge();r(Ce=>[...Ce,{id:se,type:"credits",content:Te,isAnimating:!0}]),setTimeout(()=>{r(Ce=>Ce.map(Ie=>Ie.id===se?{...Ie,isAnimating:!1}:Ie))},500)},Me=se=>{const Te=F.current++,Ce=_("div",{className:"welcomeMessage",style:{marginBottom:10},children:[a("div",{children:"Bienvenido a la terminal de Habbo."}),_("div",{children:["Escribe ",a("span",{className:"highlight",children:"'help'"})," para ver los comandos disponibles."]})]});r(Ie=>[...Ie,{id:Te,type:"welcome",content:Ce}]),setTimeout(se,1500)},ce=()=>{h(!0),Me(()=>{Ae("neofetch",!0,()=>{setTimeout(()=>{ve(),setTimeout(()=>{l(!0),h(!1),w.current&&w.current.focus()},1e3)},500)})})},ue=(se,Te)=>{const Ce=OJ;let Ie=Ce.split("").map(De=>De===`
`?`
`:" ").join(""),Ue=!1;const ut=()=>{if(Ue)return;let De="",zt=!0;for(let ss=0;ss<Ce.length;ss++){if(Ce[ss]===`
`){De+=`
`;continue}Ie[ss]===Ce[ss]?De+=Ie[ss]:(zt=!1,Math.random()<.1?De+=Ce[ss]:De+=rR[Math.floor(Math.random()*rR.length)])}r(ss=>ss.map(cs=>cs.id===se&&cs.neofetchData?{...cs,neofetchData:{...cs.neofetchData,logo:De}}:cs)),Ie=De,zt?(Ue=!0,Te()):setTimeout(ut,30)};ut()},$=(se,Te)=>{const Ie=[`${s.username}@${s.hotelName}`,`OS: ${s.hotelName}`,`Version: ${s.version}`,`Online: ${s.onlineUsers} usuarios`,`Rooms: ${s.activeRooms} activas`,`Uptime: ${s.uptime}`,`RAM: ${s.ramUsage} MB usados`,`CPU: ${s.cpuCores} ncleos`,`Memory: ${s.totalMemory} MB totales`].join(`
`);let Ue="",ut=0,De=!1;const zt=()=>{De||(ut<Ie.length?(Ue+=Ie.charAt(ut),r(ss=>ss.map(cs=>cs.id===se&&cs.neofetchData?{...cs,neofetchData:{...cs.neofetchData,info:Ue}}:cs)),ut++,setTimeout(zt,5)):(De=!0,Te()))};zt()},re=(se,Te)=>{r(Ce=>[...Ce,{id:se,type:"neofetch",content:"",isAnimating:!0,neofetchData:{logo:"",info:""}}]),ue(se,()=>{$(se,()=>{r(Ce=>Ce.map(Ie=>Ie.id===se?{...Ie,isAnimating:!1}:Ie)),Te()})})},me=se=>a("div",{className:"serverInfo",children:se.split(`
`).map((Te,Ce)=>{const Ie=Te.split(":");return Ie.length>1?_("div",{children:[_("span",{className:"label",children:[Ie[0],":"]}),a("span",{children:Ie.slice(1).join(":")})]},Ce):a("div",{children:Te},Ce)})}),ge=()=>_("div",{className:`credits ${t.some(se=>se.isAnimating)?"animating":""}`,children:[a("div",{className:"creditsTitle",children:"CRDITOS"}),a("div",{className:"creditsContent",children:_("div",{className:"creditsText",children:[a("div",{className:"thanks",children:"Gracias a las siguientes personas que han contribuido o motivado el desarrollo de este proyecto:"}),_("ul",{children:[_("li",{children:[a("span",{className:"creditName",children:"meis y Loon"}),"  Por su ayuda en general."]}),_("li",{children:[a("span",{className:"creditName",children:"OldKing & Invicta"}),"  Por sus explicaciones relacionadas con wireds."]}),_("li",{children:[a("span",{className:"creditName",children:"Kaory & Kev"}),"  Por la motivacin y el esfuerzo que siempre aportan innovando en la comunidad; eso tambin nos motiva a seguir."]}),_("li",{children:["La ",a("span",{className:"highlightCommunity",children:"comunidad espaola de Habbo"})," al completo."]})]}),_("div",{className:"personalThanks",children:["Y gracias a ti tambin, ",a("span",{className:"usernameHighlight",children:s.username}),", por formar parte de esta comunidad ",a("span",{className:"heart",children:""})]})]})})]}),Ae=(se,Te=!1,Ce)=>{const Ie=F.current++;Te||r(ut=>[...ut,{id:Ie,type:"command",content:se}]);let Ue=null;switch(se.trim().toLowerCase()){case"neofetch":re(Ie,()=>{Ce&&Ce()});break;case"help":Ue=_("div",{className:"helpOutput",style:{marginTop:10},children:[a("div",{children:"Comandos disponibles:"}),_("ul",{children:[_("li",{children:[a("span",{className:"commandHighlight",children:"neofetch"})," - Muestra informacin del servidor"]}),_("li",{children:[a("span",{className:"commandHighlight",children:"credits"})," - Muestra los crditos"]}),_("li",{children:[a("span",{className:"commandHighlight",children:"clear"})," - Limpia la terminal"]}),_("li",{children:[a("span",{className:"commandHighlight",children:"help"})," - Muestra esta ayuda"]}),_("li",{children:[a("span",{className:"commandHighlight",children:"exit"})," - Cierra la terminal"]}),_("li",{children:[a("span",{className:"commandHighlight",children:"pong"})," - Juega al Pong contra la mquina"]}),_("li",{children:[a("span",{className:"commandHighlight",children:"snake"})," - Juega al Snake"]})]})]}),r(ut=>[...ut,{id:Ie,type:"output",content:Ue}]),Ce&&Ce();break;case"clear":r([]),Ce&&Ce();break;case"credits":Ue=ge(),r(ut=>[...ut,{id:Ie,type:"output",content:Ue}]),Ce&&Ce();break;case"exit":je(),Ce&&Ce();break;case"pong":B(Ie),Ce&&Ce();break;case"snake":ee(Ie),Ce&&Ce();break;case"":Ce&&Ce();break;default:Ue=_("div",{className:"notFound",style:{marginTop:10},children:[_("div",{children:["Comando no encontrado: ",a("span",{className:"errorText",children:se})]}),_("div",{children:["Escribe ",a("span",{className:"commandHighlight",children:"'help'"})," para ver los comandos disponibles"]})]}),r(ut=>[...ut,{id:Ie,type:"output",content:Ue}]),Ce&&Ce()}Te||n("")},Xe=se=>{if(f||N){se.preventDefault();return}se.key==="Enter"&&Ae(i)};d.exports.useEffect(()=>{k.current&&(k.current.scrollTop=k.current.scrollHeight)},[t]);const je=()=>{g(!0),A.current&&(clearInterval(A.current),A.current=null),x.current&&(clearInterval(x.current),x.current=null),setTimeout(()=>{e()},550)};return a("div",{onClick:()=>{!f&&!N&&w.current&&w.current.focus()},className:`aboutAlertOverlay ${m&&!u?"visible":""}`,children:_(Be,{theme:"primary-slim",overflow:"visible",className:`aboutAlertCard ${u?"closing":m?"mounted":""}`,children:[_("div",{className:"terminalHeader",children:[a("div",{className:"circle red"}),a("div",{className:"circle yellow"}),a("div",{className:"circle green"}),_("span",{className:"terminalPrompt",children:[s.username,"@",s.hotelName,":~$"]})]}),_("div",{ref:k,className:`terminalOutput ${f||N?"noSelect preMode":"preWrap"}`,children:[a("style",{children:`
              @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
              }
              @keyframes flicker {
                0% { opacity: 0.8; }
                50% { opacity: 0.9; }
                100% { opacity: 0.8; }
              }
            `}),t.map(se=>se.type==="command"?_("div",{className:"commandLine",children:[_("span",{className:"terminalPrompt",children:[s.username,"@",s.hotelName,":~$"]})," ",se.content]},se.id):se.type==="output"||se.type==="welcome"||se.type==="credits"?a("div",{className:"outputLine",style:{animation:se.isAnimating?"fadeIn 0.5s forwards":"none",opacity:se.isAnimating?0:1},children:se.content},se.id):se.type==="neofetch"&&se.neofetchData?_("div",{className:"neofetchContainer",style:{opacity:se.isAnimating?.92:1,animation:se.isAnimating?"flicker 0.1s infinite":"none"},children:[a("div",{className:"neofetchLogo",children:se.neofetchData.logo}),a("div",{className:"neofetchInfo",children:me(se.neofetchData.info)})]},se.id):se.type==="pong"||se.type==="snake"?a("pre",{className:"gameScreen",children:se.content},se.id):null),!f&&!N&&o&&_("div",{className:"inputLine",children:[_("span",{className:"terminalPrompt",children:[s.username,"@",s.hotelName,":~$"]}),a("input",{ref:w,type:"text",value:i,onChange:se=>n(se.target.value),onKeyDown:Xe,className:"terminalInput",autoFocus:!0,disabled:c})]}),f&&_("div",{className:"gameInstructions",children:["Usa ",a("b",{children:"W"})," y ",a("b",{children:"S"})," para mover tu paleta, ",a("b",{children:"Q"})," para salir del juego."]}),N&&_("div",{className:"gameInstructions",children:["Usa ",a("b",{children:"W"}),", ",a("b",{children:"A"}),", ",a("b",{children:"S"}),", ",a("b",{children:"D"})," para mover la serpiente, ",a("b",{children:"Q"})," para salir del juego."]})]}),a("button",{onClick:je,"aria-label":"Cerrar",className:"closeButton",children:""})]})})},NJ=s=>{const{title:e="Nitro",onClose:t=null,...r}=s;return a(_g,{title:e,onClose:t,...r,children:_(qe,{children:[a(v,{center:!0,size:5,children:a("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:""})}),_(v,{size:7,children:[_(v,{alignItems:"center",gap:0,children:[a(C,{bold:!0,fontSize:4,children:"Nitro React"}),_(C,{children:["v",WL()]})]}),_(v,{alignItems:"center",children:[_(C,{children:[a("b",{children:"Renderer:"})," v",$q()]}),_(v,{fullWidth:!0,gap:1,children:[a(Y,{fullWidth:!0,variant:"success",onClick:i=>window.open("https://discord.nitrodev.co"),children:"Discord"}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,onClick:i=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),a(Y,{fullWidth:!0,onClick:i=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]}),a(v,{center:!0,size:5,children:a(v,{className:"flashui-logo"})}),_(v,{size:7,children:[_(v,{alignItems:"center",gap:0,children:[a(C,{bold:!0,fontSize:4,children:"Flash UI-edit"}),a(C,{small:!0,children:"is created by Robbis"})]}),_(v,{fullWidth:!0,gap:1,children:[a(Y,{fullWidth:!0,variant:"success",onClick:i=>window.open("https://discord.gg/j3bqtZKAF3"),children:"Flash-UI Discord"}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,onClick:i=>window.open("https://git.krews.org/robbis1111/nitro-react-flashUI"),children:"Git"}),a(Y,{fullWidth:!0,onClick:i=>window.open("https://git.krews.org/robbis1111/nitro-react-flashUI/-/issues"),children:"Bug Report"})]})]})]})]})})},bJ=s=>{const{item:e=null,title:t=s.item&&s.item.title||"",onClose:r=null,...i}=s,[n,o]=d.exports.useState(!1),l=()=>{Al(e.clickUrl),r()},c=e.alertType===Ze.DEFAULT;return _(_g,{title:t,onClose:r,...i,type:c?Ze.DEFAULT:e.alertType,children:[_(M,{fullHeight:!0,overflow:"auto",gap:c||e.imageUrl&&!n?2:0,children:[e.imageUrl&&!n&&a("img",{src:e.imageUrl,alt:e.title,onError:()=>{o(!0)},className:"align-self-baseline"}),_(K,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",e.clickUrl&&!c?"justify-content-center":""],children:[e.messages.length>0&&e.messages.map((h,u)=>{const g=h.replace(/\r\n|\r|\n/g,"<br />");return a(K,{dangerouslySetInnerHTML:{__html:g}},u)}),e.clickUrl&&e.clickUrl.length>0&&e.imageUrl&&!n&&_(J,{children:[a("hr",{className:"my-2 w-100"}),a(Y,{onClick:l,className:"align-self-center px-3",children:E(e.clickUrlText)})]})]})]}),(!e.imageUrl||e.imageUrl&&n)&&a(J,{children:_(v,{alignItems:"center",center:!0,gap:0,children:[a("hr",{className:"my-2 w-100"}),!e.clickUrl&&a(Y,{onClick:r,children:E("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&a(Y,{onClick:l,children:E(e.clickUrlText)})]})})]})},yJ=s=>{const{item:e=null,title:t=s.item&&s.item.title||"",onClose:r=null,...i}=s,[n,o]=d.exports.useState(""),[l,c]=d.exports.useState([]),h=()=>{Al(e.clickUrl),r()},u=m=>{let p=JSON.parse(e.messages[0]);c(p.filter(f=>f.includes(m))),o(m)};d.exports.useEffect(()=>{c(JSON.parse(e.messages[0]))},[e]);const g=e.clickUrl&&e.clickUrl.startsWith("event:");return _(_g,{title:t,onClose:r,...i,children:[a(M,{fullWidth:!0,alignItems:"center",position:"relative",children:a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("generic.search"),value:n,onChange:m=>u(m.target.value)})}),a(v,{fullHeight:!0,className:"py-1",overflow:"hidden",children:a(Bt,{gap:1,columnCount:1,children:l&&l.map((m,p)=>a("span",{children:m},p))})}),a("hr",{className:"my-2"}),_(v,{alignItems:"center",center:!0,gap:1,children:[!g&&!e.clickUrl&&a(Y,{onClick:r,children:E("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&a(Y,{onClick:h,children:E(e.clickUrlText)})]})]})},vJ=(s,e)=>{if(!s)return null;const t={key:s.id,item:s,onClose:e};switch(s.alertType){case Ze.NITRO:return a(NJ,{...t});case Ze.SEARCH:return a(yJ,{...t});case Ze.ABOUT_ALERT:return a(AJ,{...t});default:return a(bJ,{...t})}},MJ=s=>{const{item:e=null,onClose:t=null,...r}=s;return _(yI,{fadesOut:!1,className:"flex-column nitro-notification club-gift",onClose:t,...r,children:[_("div",{className:"d-flex gap-1 mb-2",children:[a(Gs,{type:"hc",className:"flex-shrink-0"}),a("span",{className:"ms-1",children:E("notifications.text.club_gift")})]}),_("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[a("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>Al(e.linkUrl),children:E("notifications.button.show_gift_list")}),a("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:t,children:E("notifications.button.later")})]})]})},DJ=s=>{const{item:e=null,onClose:t=null,...r}=s,i=e.message.replace(/\r\n|\r|\n/g,"<br />");return _(yI,{onClose:t,gap:2,alignItems:"center",onClick:n=>e.linkUrl&&e.linkUrl.length&&Al(e.linkUrl),...r,children:[a(M,{center:!0,className:"bubble-image-container",children:e.iconUrl&&e.iconUrl.length&&a("img",{className:"no-select",src:e.iconUrl,alt:""})}),a(C,{wrap:!0,className:"notification-bubble-text",variant:"white",dangerouslySetInnerHTML:{__html:i}})]})},PJ=(s,e)=>{if(!s)return null;const t={key:s.id,item:s,onClose:e};switch(s.notificationType){case ls.CLUBGIFT:return a(MJ,{...t});default:return a(DJ,{...t})}},LJ=s=>{const{item:e=null,onClose:t=null,...r}=s,{message:i=null,onConfirm:n=null,onCancel:o=null,confirmText:l=null,cancelText:c=null,title:h=null}=e,u=()=>{n&&n(),t()},g=()=>{o&&o(),t()};return _(_g,{title:h,onClose:t,...r,type:Ze.ALERT,children:[a(M,{grow:!0,center:!0,children:a(C,{children:i})}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,variant:"danger",onClick:g,children:c}),a(Y,{fullWidth:!0,onClick:u,children:l})]})]})},UJ=(s,e)=>{if(!s)return null;const t={key:s.id,item:s,onClose:e};switch(s.confirmType){default:return a(LJ,{...t})}},xJ=s=>{const{alerts:e=[],bubbleAlerts:t=[],confirms:r=[],closeAlert:i=null,closeBubbleAlert:n=null,closeConfirm:o=null}=$t(),l=d.exports.useMemo(()=>{if(!e||!e.length)return null;const u=[];for(const g of e){const m=vJ(g,()=>i(g));u.push(m)}return u},[e,i]),c=d.exports.useMemo(()=>{if(!t||!t.length)return null;const u=[];for(const g of t){const m=PJ(g,()=>n(g));if(g.notificationType===ls.CLUBGIFT){u.unshift(m);continue}u.push(m)}return u},[t,n]),h=d.exports.useMemo(()=>{if(!r||!r.length)return null;const u=[];for(const g of r){const m=UJ(g,()=>o(g));u.push(m)}return u},[r,o]);return _(J,{children:[a(v,{gap:1,children:c}),h,l]})},iR=s=>{const{type:e=-1,amount:t=-1,short:r=!1}=s,i=d.exports.useMemo(()=>_(M,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[a(C,{bold:!0,truncate:!0,textEnd:!0,variant:"white",grow:!0,children:r?Nq(t):u_(t)}),a(Gs,{type:e})]}),[t,r,e]);return r?a(iS,{placement:"left",overlay:a(GU,{id:`tooltip-${e}`,children:u_(t)}),children:i}):i},wJ=s=>{const{type:e=-1,amount:t=-1}=s;return a(M,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency nitro-notification "+Ee("currency.seasonal.color"),children:_(M,{fullWidth:!0,children:[a(C,{bold:!0,truncate:!0,fullWidth:!0,className:"seasonal-padding seasonal-bold",children:E(`purse.seasonal.currency.${e}`)}),a(C,{bold:!0,truncate:!0,variant:"white",className:"seasonal-amount text-end",children:u_(t)}),a(M,{className:"nitro-seasonal-box seasonal-padding",children:a(Gs,{type:e})})]})})},FJ=s=>{const{purse:e=null,hcDisabled:t=!1}=vl(),r=d.exports.useMemo(()=>Ee("system.currency.types",[]),[]),i=d.exports.useMemo(()=>Ee("currency.display.number.short",!1),[]),n=(()=>{if(!e)return null;const l=e.clubPeriods*31+e.clubDays,c=e.minutesUntilExpiration;return e.clubLevel===Lr.NO_CLUB?E("purse.clubdays.zero.amount.text"):c>-1&&c<60*24?Or.shortFormat(c*60):Or.shortFormat(l*86400)})(),o=(l,c=-1,h=!1)=>{if(!e||!e.activityPoints||!e.activityPoints.size)return null;const u=Array.from(e.activityPoints.keys()).filter(p=>r.indexOf(p)>=0);let g=0;for(;g<l;)u.shift(),g++;g=0;const m=[];for(const p of u){if(c>-1&&g===c)break;h?m.push(a(wJ,{type:p,amount:e.activityPoints.get(p)},p)):m.push(a(iR,{type:p,amount:e.activityPoints.get(p),short:i},p)),g++}return m};return e?_(v,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[a(M,{className:"nitro-purse rounded-bottom p-1",children:_(qe,{fullWidth:!0,gap:1,children:[_(v,{justifyContent:"center",size:t?10:6,gap:0,children:[a(iR,{type:-1,amount:e.credits,short:i}),o(0,2)]}),!t&&_(v,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded",onClick:l=>Le("habboUI/open/hccenter"),children:[a(Gs,{type:"hc"}),a(C,{variant:"white",children:n})]}),_(v,{justifyContent:"center",size:2,gap:0,children:[a(M,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:l=>Le("help/show"),children:a("i",{className:"icon icon-help"})}),a(M,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:l=>Le("user-settings/toggle"),children:a("i",{className:"icon icon-cog"})})]})]})}),o(2,-1,!0)]}):null},kJ={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},GJ=s=>{const[e,t]=d.exports.useState(!0),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState("");MX(Tp.MYSTERY_BOX_KEYS_UPDATE,c=>{i(c.keyColor),o(c.boxColor)});const l=c=>{const h=kJ[c];return si.int2rgb(h)};return r===""&&n===""?null:a(K,{className:"nitro-notification-bubble rounded mysterybox-extension",children:_(v,{children:[_(M,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:c=>t(h=>!h),children:[a(C,{variant:"white",children:E("mysterybox.tracker.title")}),e&&a(A_,{className:"fa-icon"}),!e&&a(N_,{className:"fa-icon"})]}),e&&_(J,{children:[a(C,{variant:"white",children:E("mysterybox.tracker.description")}),_(M,{justifyContent:"center",alignItems:"center",gap:2,children:[a(yt,{className:"mysterybox-container",children:a("div",{className:"box-image flex-shrink-0",style:{backgroundColor:l(n)},children:a("div",{className:"chain-overlay-image"})})}),a(yt,{className:"mysterybox-container",children:a("div",{className:"key-image flex-shrink-0",style:{backgroundColor:l(r)},children:a("div",{className:"key-overlay-image"})})})]})]})]})})},BJ=s=>{const{eventId:e=-1,eventName:t="",eventDescription:r="",setIsEditingPromote:i=null}=s,[n,o]=d.exports.useState(t),[l,c]=d.exports.useState(r),h=()=>{W(new nM(e,n,l)),i(!1)};return _(Be,{className:"nitro-guide-tool",theme:"primary-slim",children:[a(He,{headerText:E("navigator.eventsettings.editcaption"),onCloseClick:()=>i(!1)}),_(Ge,{className:"text-black",children:[_(v,{children:[a(C,{bold:!0,children:E("navigator.eventsettings.name")}),a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("navigator.eventsettings.name"),maxLength:64,value:n,onChange:u=>o(u.target.value)})]}),_(v,{children:[a(C,{bold:!0,children:E("navigator.eventsettings.desc")}),a("textarea",{className:"form-control form-control-sm",placeholder:E("navigator.eventsettings.desc"),maxLength:64,value:l,onChange:u=>c(u.target.value)})]}),a(v,{children:a(Y,{fullWidth:!0,disabled:!n||!l,variant:!n||!l?"danger":"success",onClick:u=>h(),children:E("navigator.eventsettings.edit")})})]})]})},VJ=s=>{const{eventDescription:e="",setIsEditingPromote:t=null}=s,{setIsExtended:r}=PI(),i=()=>{r(!0),Le("catalog/open/room_event")};return _(J,{children:[a(M,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:a(C,{variant:"white",children:e})}),a("br",{}),a("br",{}),_(qe,{className:"d-flex align-items-center justify-content-end gap-2",children:[a(Y,{className:"btn btn-primary w-100 btn-sm",onClick:n=>t(!0),children:E("navigator.roominfo.editevent")}),a(Y,{className:"btn btn-success w-100 btn-sm",onClick:n=>i(),children:E("roomad.extend.event")})]})]})},HJ=s=>{const{eventDescription:e=""}=s;return _(J,{children:[a(M,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:a(C,{variant:"white",children:e})}),a("br",{}),a("br",{}),a(v,{alignItems:"center",gap:1,children:_(K,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[a(M,{fit:!0,center:!0,position:"absolute",children:a(C,{variant:"white",center:!0,children:E("navigator.eventinprogress")})}),a(C,{children:""})]})})]})},WJ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(!0),{promoteInformation:n,setPromoteInformation:o}=PI();return j(Fu,l=>{o(null)}),n?a(J,{children:n.data.adId!==-1&&a(K,{className:"nitro-notification-bubble rounded",children:_(v,{children:[_(M,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:l=>i(c=>!c),children:[a(C,{variant:"white",overflow:"hidden",children:n.data.eventName}),r&&a(A_,{className:"fa-icon"}),!r&&a(N_,{className:"fa-icon"})]}),r&&ie().userId!==n.data.ownerAvatarId&&a(HJ,{eventDescription:n.data.eventDescription}),r&&ie().userId===n.data.ownerAvatarId&&a(VJ,{eventDescription:n.data.eventDescription,setIsEditingPromote:()=>t(!0)}),e&&a(BJ,{eventId:n.data.adId,eventName:n.data.eventName,eventDescription:n.data.eventDescription,setIsEditingPromote:()=>t(!1)})]})})}):null},jJ=s=>a("div",{className:"nitro-right-side",children:_(v,{position:"relative",gap:1,children:[a(FJ,{}),a(SJ,{}),a(GJ,{}),a(RJ,{}),a(WJ,{}),a(xJ,{})]})}),YJ=s=>a("div",{className:"room-spectator"}),zJ=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(null),{chatStyleId:n=0}=za(),{roomSession:o=null}=Yt();j(ON,c=>{const h=c.getParser();if(!h)return;const u=o.userDataManager.getPetData(h.petId);u&&(t(u),i(h))});const l=(c,h)=>{!c||!h||o==null||o.sendChatMessage(`${c} ${h}`,n)};return!e||!r?null:_(Be,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary-slim",children:[a(He,{headerText:E("widgets.pet.commands.title"),onCloseClick:()=>i(null)}),_(Ge,{className:"text-black",children:[a(M,{alignItems:"center",justifyContent:"center",gap:2,children:_(qe,{columnCount:2,children:[a(v,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:a(Na,{figure:e.figure,posture:"std",direction:2})}),a(C,{variant:"black",small:!0,wrap:!0,children:e.name})]})}),a(qe,{columnCount:2,children:r.commands&&r.commands.length>0&&r.commands.map((c,h)=>a(Y,{disabled:!r.enabledCommands.includes(c),onClick:()=>l(e.name,E(`pet.command.${c}`)),children:E(`pet.command.${c}`)},h))})]})]})},Gr=s=>{const{justifyContent:e="center",alignItems:t="center",classNames:r=[],...i}=s,n=d.exports.useMemo(()=>{const o=["menu-header","pb-1"];return r.length&&o.push(...r),o},[r]);return a(M,{justifyContent:e,alignItems:t,classNames:n,...i})},KJ=s=>{const{chatEvent:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(e.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":e.chat),[n,o]=d.exports.useState(e.automaticChat),[l,c]=d.exports.useState(e.mixSentences),[h,u]=d.exports.useState(e.chatDelay),g=d.exports.useMemo(()=>_I(bt().roomId,e.objectId,e.category,1),[e]),m=f=>f.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),p=()=>{const f=m(r)+";#;"+n+";#;"+h+";#;"+l;W(new jn(e.botId,St.SETUP_CHAT,f)),t()};return a(wo,{windowPosition:hr.NOTHING,handleSelector:".drag-handler",dragStyle:{top:g.y,left:g.x},children:_(K,{className:"nitro-context-menu bot-chat",children:[a(Gr,{className:"drag-handler",children:E("bot.skill.chatter.configuration.title")}),_(v,{className:"p-1",children:[_(v,{gap:1,children:[a(C,{variant:"white",children:E("bot.skill.chatter.configuration.chat.text")}),a("textarea",{className:"form-control form-control-sm",placeholder:E("bot.skill.chatter.configuration.text.placeholder"),value:r,rows:7,onChange:f=>i(f.target.value)})]}),_(v,{gap:1,children:[_(M,{gap:1,alignItems:"center",justifyContent:"between",children:[a(C,{fullWidth:!0,variant:"white",children:E("bot.skill.chatter.configuration.automatic.chat")}),a("input",{type:"checkbox",className:"form-check-input",checked:n,onChange:f=>o(f.target.checked)})]}),_(M,{gap:1,alignItems:"center",justifyContent:"between",children:[a(C,{fullWidth:!0,variant:"white",children:E("bot.skill.chatter.configuration.markov")}),a("input",{type:"checkbox",className:"form-check-input",checked:l,onChange:f=>c(f.target.checked)})]}),_(M,{gap:1,alignItems:"center",justifyContent:"between",children:[a(C,{fullWidth:!0,variant:"white",children:E("bot.skill.chatter.configuration.chat.delay")}),a("input",{type:"number",className:"form-control form-control-sm",value:h,onChange:f=>u(f.target.valueAsNumber)})]})]}),_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(Y,{fullWidth:!0,variant:"primary",onClick:t,children:E("cancel")}),a(Y,{fullWidth:!0,variant:"success",onClick:p,children:E("save")})]})]})]})})},nR=-1,aR=0,oR=1,lR=2,cR=3,uR=4,hR=5,dR=6,qJ=s=>{const{item:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(nR),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),{roomSession:h=null}=Yt(),u=()=>{n&&te().selectRoomObject(h.roomId,n.roomIndex,z.UNIT)},g=()=>{h.usePetProduct(e.requestRoomObjectId,n.webID),t()},m=d.exports.useMemo(()=>{if(!n||!l)return null;const p=new ra(n.figure),f=l.customParams.split(" "),T=parseInt(f[0]);switch(l.specialType){case Pe.PET_SHAMPOO:{if(f.length<2)return null;const I=te().getPetColorResult(T,p.paletteId),O=te().getPetColorResultsForTag(T,f[1]);let A=-1;for(const N of O)if(N.breed===I.breed){A=parseInt(N.id);break}return a(Na,{typeId:p.typeId,paletteId:A,petColor:p.color,customParts:p.customParts,direction:2})}case Pe.PET_CUSTOM_PART:{if(f.length<4)return null;const I=[],O=f[1].split(",").map(y=>parseInt(y)),A=f[2].split(",").map(y=>parseInt(y)),N=f[3].split(",").map(y=>parseInt(y));let P=0;for(;P<O.length;){const y=O[P],D=p.getCustomPart(y);let x=N[P];D!=null&&(x=D.paletteId),I.push(new Cd(y,A[P],x)),P++}return a(Na,{typeId:p.typeId,paletteId:p.paletteId,petColor:p.color,customParts:I,direction:2})}case Pe.PET_CUSTOM_PART_SHAMPOO:{if(f.length<3)return null;const I=[],O=f[1].split(",").map(P=>parseInt(P)),A=f[2].split(",").map(P=>parseInt(P));let N=0;for(;N<O.length;){const P=O[N],y=p.getCustomPart(P);let D=-1;y!=null&&(D=y.partId),I.push(new Cd(O[N],D,A[N])),N++}return a(Na,{typeId:p.typeId,paletteId:p.paletteId,petColor:p.color,customParts:I,direction:2})}case Pe.PET_SADDLE:{if(f.length<4)return null;const I=[],O=f[1].split(",").map(y=>parseInt(y)),A=f[2].split(",").map(y=>parseInt(y)),N=f[3].split(",").map(y=>parseInt(y));let P=0;for(;P<O.length;)I.push(new Cd(O[P],A[P],N[P])),P++;for(const y of p.customParts)O.indexOf(y.layerId)===-1&&I.push(y);return a(Na,{typeId:p.typeId,paletteId:p.paletteId,petColor:p.color,customParts:I,direction:2})}case Pe.MONSTERPLANT_REBREED:case Pe.MONSTERPLANT_REVIVAL:case Pe.MONSTERPLANT_FERTILIZE:{let I="rip";const O=te().getRoomObject(h.roomId,n.roomIndex,z.UNIT);if(O&&(I=O.model.getValue(b.FIGURE_POSTURE),I==="rip")){const A=n.petLevel;A<7?I=`grw${A}`:I="std"}return a(Na,{typeId:p.typeId,paletteId:p.paletteId,petColor:p.color,customParts:p.customParts,posture:I,direction:2})}}},[n,l,h]);return d.exports.useEffect(()=>{const p=h.userDataManager.getUserDataByIndex(e.id);o(p);const f=Ih(h.roomId,e.requestRoomObjectId,z.FLOOR);if(!f)return;c(f);let T=nR;switch(f.specialType){case Pe.PET_SHAMPOO:T=aR;break;case Pe.PET_CUSTOM_PART:T=oR;break;case Pe.PET_CUSTOM_PART_SHAMPOO:T=lR;break;case Pe.PET_SADDLE:T=cR;break;case Pe.MONSTERPLANT_REVIVAL:T=uR;break;case Pe.MONSTERPLANT_REBREED:T=hR;break;case Pe.MONSTERPLANT_FERTILIZE:T=dR;break}i(T)},[h,e]),n?_(Be,{className:"nitro-use-product-confirmation",children:[a(He,{headerText:E("useproduct.widget.title",["name"],[n.name]),onCloseClick:t}),a(Ge,{center:!0,children:_(M,{gap:2,overflow:"hidden",children:[a(v,{children:a(K,{pointer:!0,className:"product-preview",onClick:u,children:m})}),_(v,{justifyContent:"between",overflow:"auto",children:[_(v,{gap:2,children:[r===aR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.shampoo",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.shampoo")})]}),r===oR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.custompart",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.custompart")})]}),r===lR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.custompartshampoo",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.custompartshampoo")})]}),r===cR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.saddle",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.saddle")})]}),r===uR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.revive_monsterplant",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.revive_monsterplant")})]}),r===hR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.rebreed_monsterplant",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.rebreed_monsterplant")})]}),r===dR&&_(J,{children:[a(C,{children:E("useproduct.widget.text.fertilize_monsterplant",["productName"],[l.name])}),a(C,{children:E("useproduct.widget.info.fertilize_monsterplant")})]})]}),_(M,{alignItems:"center",justifyContent:"between",children:[a(Y,{variant:"danger",onClick:t,children:E("useproduct.widget.cancel")}),a(Y,{variant:"success",onClick:g,children:E("useproduct.widget.use")})]})]})]})})]}):null},oe=s=>{const{disabled:e=!1,fullWidth:t=!0,justifyContent:r="center",alignItems:i="center",classNames:n=[],onClick:o=null,...l}=s,c=u=>{e||o&&o(u)},h=d.exports.useMemo(()=>{const u=["menu-item","list-item"];return e&&u.push("disabled"),n.length&&u.push(...n),u},[e,n]);return a(M,{fullWidth:t,justifyContent:r,alignItems:i,classNames:h,onClick:c,...l})},XJ=s=>{const{justifyContent:e="center",alignItems:t="center",classNames:r=[],collapsed:i=!0,...n}=s,o=d.exports.useMemo(()=>{const l=["menu-bottom"];return r.length&&l.push(...r),l},[r]);return a(M,{justifyContent:e,alignItems:t,classNames:o,...n,children:a("i",{className:i?"icon icon-context-menu-arrow-up":"icon icon-context-menu-arrow-down"})})},QJ=25,_R=3,$J=5e3,JJ=75,wl=10;let Yg=!1,Kh=null,qh=-1e6,zg=1;const ua=s=>{const{objectId:e=-1,category:t=-1,userType:r=-1,fades:i=!1,onClose:n=null,position:o="absolute",classNames:l=[],style:c={},children:h=null,collapsable:u=!1,...g}=s,[m,p]=d.exports.useState({x:null,y:null}),[f,T]=d.exports.useState(1),[I,O]=d.exports.useState(!1),[A,N]=d.exports.useState(Yg),P=d.exports.useRef(),y=d.exports.useCallback(k=>{if(!I)return;zg+=k;let F=(1-zg/JJ)*1;if(F<=0)return n(),!1;T(F)},[I,n]),D=d.exports.useCallback((k,F)=>{if(!k||!F||!Kh)return;let L=-P.current.offsetHeight;r>-1&&(r===jt.USER||r===jt.BOT||r===jt.RENTABLE_BOT)?L=L+(k.height>50?15:0):L=L-14,Kh.addValue(F.y-k.top);let B=Kh.getMax();B<qh-_R&&(B=qh-_R),qh=B;const V=F.y-B;let q=~~(F.x-P.current.offsetWidth/2),Z=~~(V+L);const H=mt().width-P.current.offsetWidth-wl,X=mt().height-P.current.offsetHeight-wl;q<wl?q=wl:q>H&&(q=H),Z<wl?Z=wl:Z>X&&(Z=X),p({x:q,y:Z})},[r]),x=d.exports.useMemo(()=>{const k=["nitro-context-menu"];return A&&k.push("menu-hidden"),k.push(m.x!==null?"visible":"invisible"),l.length&&k.push(...l),k},[m,l,A]),w=d.exports.useMemo(()=>{let k={};return k.left=m.x||0,k.top=m.y||0,k.opacity=f,Object.keys(c).length&&(k={...k,...c}),k},[m,f,c]);return d.exports.useEffect(()=>{if(!P.current)return;const k=F=>{if(!P.current)return;y(F);const L=_I(bt().roomId,e,t),B=PL(bt().roomId,e,t);D(L,B)};return Rr().add(k),()=>{Rr().remove(k)}},[e,t,y,D]),d.exports.useEffect(()=>{if(!i)return;const k=setTimeout(()=>O(!0),$J);return()=>clearTimeout(k)},[i]),d.exports.useEffect(()=>{Yg=A},[A]),d.exports.useEffect(()=>{Kh=new Gx(QJ),qh=-1e6,zg=1},[]),_(K,{innerRef:P,position:o,classNames:x,style:w,...g,children:[!(u&&Yg)&&h,u&&a(XJ,{onClick:()=>N(!A),collapsed:A})]})},gR=0,mR=1,fR=2,pR=3,ER=4,IR=5,TR=6,RR=7,ZJ=s=>{const{item:e=null,updateConfirmingProduct:t=null,onClose:r=null}=s,[i,n]=d.exports.useState(0),{roomSession:o=null}=Yt(),l=c=>{if(c)switch(c){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":t(e);break}};return d.exports.useEffect(()=>{if(!e)return;const c=Ih(o.roomId,e.requestRoomObjectId,z.FLOOR);if(!c)return;let h=gR;switch(c.specialType){case Pe.PET_SHAMPOO:h=mR;break;case Pe.PET_CUSTOM_PART:h=fR;break;case Pe.PET_CUSTOM_PART_SHAMPOO:h=pR;break;case Pe.PET_SADDLE:h=ER;break;case Pe.MONSTERPLANT_REVIVAL:h=IR;break;case Pe.MONSTERPLANT_REBREED:h=TR;break;case Pe.MONSTERPLANT_FERTILIZE:h=RR;break}n(h)},[o,e]),_(ua,{objectId:e.id,category:z.UNIT,userType:jt.PET,onClose:r,collapsable:!0,children:[a(Gr,{children:e.name}),i===gR&&a(oe,{onClick:c=>l("use_product"),children:E("infostand.button.useproduct")}),i===mR&&a(oe,{onClick:c=>l("use_product_shampoo"),children:E("infostand.button.useproduct_shampoo")}),i===fR&&a(oe,{onClick:c=>l("use_product_custom_part"),children:E("infostand.button.useproduct_custom_part")}),i===pR&&a(oe,{onClick:c=>l("use_product_custom_part_shampoo"),children:E("infostand.button.useproduct_custom_part_shampoo")}),i===ER&&_(J,{children:[e.replace&&a(oe,{onClick:c=>l("replace_product_saddle"),children:E("infostand.button.replaceproduct_saddle")}),!e.replace&&a(oe,{onClick:c=>l("use_product_saddle"),children:E("infostand.button.useproduct_saddle")})]}),i===IR&&a(oe,{onClick:c=>l("revive_monsterplant"),children:E("infostand.button.revive_monsterplant")}),i===TR&&a(oe,{onClick:c=>l("rebreed_monsterplant"),children:E("infostand.button.rebreed_monsterplant")}),i===RR&&a(oe,{onClick:c=>l("fertilize_monsterplant"),children:E("infostand.button.fertilize_monsterplant")})]})},eZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s;return e?a(v,{className:"nitro-infostand rounded",children:_(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[_(v,{gap:1,children:[_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(C,{variant:"white",small:!0,wrap:!0,children:e.name}),a(yo,{className:"cursor-pointer fa-icon",onClick:t})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{gap:1,children:[a(v,{fullWidth:!0,className:"body-image bot",children:a(Ts,{figure:e.figure,direction:4})}),a(v,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(r=>a(as,{badgeCode:r,showInfo:!0},r))})]}),a("hr",{className:"m-0"})]}),a(M,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:a(C,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),e.carryItem>0&&_(v,{gap:1,children:[a("hr",{className:"m-0"}),a(C,{variant:"white",small:!0,wrap:!0,children:E("infostand.text.handitem",["item"],[E("handitem"+e.carryItem)])})]})]})}):null},Kg=0,SR=1,OR=2,tZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,{roomSession:r=null}=Yt(),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(!1),[u,g]=d.exports.useState(!1),[m,p]=d.exports.useState([]),[f,T]=d.exports.useState([]),[I,O]=d.exports.useState([]),[A,N]=d.exports.useState([]),[P,y]=d.exports.useState(!1),[D,x]=d.exports.useState(0),[w,k]=d.exports.useState(0),[F,L]=d.exports.useState(!1),[B,V]=d.exports.useState(!1),[q,Z]=d.exports.useState(null),[H,X]=d.exports.useState(!1),[ee,Oe]=d.exports.useState(!1),[de,ve]=d.exports.useState(-1),[Me,ce]=d.exports.useState(""),[ue,$]=d.exports.useState("");tl(An.NPE_SONG_CHANGED,je=>{ve(je.id)},H||ee),tl(Nc.SIR_TRAX_SONG_INFO_RECEIVED,je=>{if(je.id!==de)return;const se=mt().soundManager.musicController.getSongInfo(je.id);se&&(ce(se.name),$(se.creator))},H||ee),d.exports.useEffect(()=>{let je=Kg,se=!1,Te=!1,Ce=!1,Ie=[],Ue=[],ut=[],De=[],zt=!1,ss=0,cs=0,Nr=!1,Hs=!1,Fs=!1,Fn=!1,hn=-1;const dn=e.roomControllerLevel>=Rt.GUEST;if((dn||e.isOwner||e.isRoomOwner||e.isAnyRoomController)&&(se=!0,Te=!e.isWallItem,e.roomControllerLevel>=Rt.MODERATOR&&(Nr=!0)),e.isAnyRoomController&&(Hs=!0),(e.usagePolicy===Uu.EVERYBODY||e.usagePolicy===Uu.CONTROLLER&&dn||e.extraParam===ms.JUKEBOX&&dn||e.extraParam===ms.USABLE_PRODUCT&&dn)&&(Ce=!0),e.extraParam){if(e.extraParam===ms.CRACKABLE_FURNI){const $s=e.stuffData;Ce=!0,zt=!0,ss=$s.hits,cs=$s.target}else if(e.extraParam===ms.JUKEBOX){const $s=mt().soundManager.musicController.getRoomItemPlaylist();$s&&(hn=$s.nowPlayingSongId),Fs=!0}else e.extraParam.indexOf(ms.SONGDISK)===0&&(hn=parseInt(e.extraParam.substr(ms.SONGDISK.length)),Fn=!0);if(Nr){const $s=e.extraParam.substr(ms.BRANDING_OPTIONS.length);if($s){const Ai=$s.split("	");for(const kn of Ai){const ni=kn.split("=");ni&&ni.length===2&&(Ie.push(ni[0]),Ue.push(ni[1]))}}}}if(Nr){const $s=te().getRoomObject(r.roomId,e.id,e.isWallItem?z.WALL:z.FLOOR);if($s){const Ai=$s.model.getValue(b.FURNITURE_CUSTOM_VARIABLES),kn=$s.model.getValue(b.FURNITURE_DATA);if(Ai&&Ai.length)for(const ni of Ai)ut.push(ni),De.push(kn[ni]||"")}}e.isOwner||e.isAnyRoomController?je=OR:(e.isRoomOwner||e.roomControllerLevel>=Rt.GUILD_ADMIN)&&(je=SR),e.isStickie&&(je=Kg),n(je),l(se),h(Te),g(Ce),p(Ie),T(Ue),O(ut),N(De),y(zt),x(ss),k(cs),L(Nr),V(Hs),Z(null),X(Fs),Oe(Fn),ve(hn),e.groupId&&W(new Rc(e.groupId,!1))},[r,e]),j(kc,je=>{const se=je.getParser();!e||e.groupId!==se.id||se.flag||(q&&Z(null),Z(se.title))}),d.exports.useEffect(()=>{const je=mt().soundManager.musicController.getSongInfo(de);ce((je==null?void 0:je.name)??""),$((je==null?void 0:je.creator)??"")},[de]);const re=d.exports.useCallback((je,se)=>{const Te=Array.from(f);Te[je]=se,T(Te)},[f]),me=d.exports.useCallback((je,se)=>{const Te=Array.from(A);Te[je]=se,N(Te)},[A]),ge=d.exports.useCallback(()=>{if(m.length===0||f.length===0)return"";let je="",se=0;for(;se<m.length;){const Te=m[se],Ce=f[se];je=je+(Te+"="+Ce+"	"),se++}return je},[m,f]),Ae=d.exports.useCallback(je=>{if(!(!je||je===""))switch(je){case"buy_one":Le(`catalog/open/offerId/${e.purchaseOfferId}`);return;case"move":te().processRoomObjectOperation(e.id,e.category,Qe.OBJECT_MOVE);break;case"rotate":te().processRoomObjectOperation(e.id,e.category,Qe.OBJECT_ROTATE_POSITIVE);break;case"pickup":i===OR?te().processRoomObjectOperation(e.id,e.category,Qe.OBJECT_PICKUP):te().processRoomObjectOperation(e.id,e.category,Qe.OBJECT_EJECT);break;case"use":te().useRoomObject(e.id,e.category);break;case"save_branding_configuration":{const se=new Map,Te=ge().split("	");if(Te)for(const Ce of Te){const[Ie,Ue]=Ce.split("=",2);se.set(Ie,Ue)}te().modifyRoomObjectDataWithMap(e.id,e.category,Qe.OBJECT_SAVE_STUFF_DATA,se);break}case"save_custom_variables":{const se=new Map;for(let Te=0;Te<I.length;Te++){const Ce=I[Te],Ie=A[Te];Ce&&Ce.length&&Ie&&Ie.length&&se.set(Ce,Ie)}W(new NE(e.id,se));break}}},[e,i,I,A,ge]),Xe=d.exports.useCallback(()=>{const je=e.stuffData;return!je||!(je instanceof vn)?null:je.getValue(2)},[e]);return e?_(v,{gap:1,alignItems:"end",children:[a(v,{className:"nitro-infostand",children:_(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[_(v,{gap:1,children:[_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(C,{gfbold:!0,variant:"white",wrap:!0,children:e.name}),a("i",{className:"infostand-close",onClick:t})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{position:"relative",gap:1,children:[e.stuffData.isUnique&&a("div",{className:"position-absolute end-0",children:a(o0,{uniqueNumber:e.stuffData.uniqueNumber,uniqueSeries:e.stuffData.uniqueSeries})}),e.stuffData.rarityLevel>-1&&a("div",{className:"position-absolute end-0",children:a(c0,{level:e.stuffData.rarityLevel})}),e.image&&e.image.src.length&&a("img",{className:"d-block mx-auto",src:e.image.src,alt:""})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[a(C,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",children:e.description}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:e.ownerId}),a(C,{variant:"white",wrap:!0,children:E("furni.owner",["name"],[e.ownerName])})]}),e.purchaseOfferId>0&&a(M,{children:a(Y,{className:"volter-button",onClick:je=>Ae("buy_one"),children:E("infostand.button.buy")})})]}),(H||ee)&&_(v,{gap:1,children:[a("hr",{className:"m-0"}),de===-1&&a(C,{variant:"white",small:!0,wrap:!0,children:E("infostand.jukebox.text.not.playing")}),!!Me.length&&_(M,{alignItems:"center",gap:1,children:[a(K,{className:"icon disk-icon"}),a(C,{variant:"white",small:!0,wrap:!0,children:Me})]}),!!ue.length&&_(M,{alignItems:"center",gap:1,children:[a(K,{className:"icon disk-creator"}),a(C,{variant:"white",small:!0,wrap:!0,children:ue})]})]}),_(v,{gap:1,children:[P&&_(J,{children:[a("hr",{className:"m-0"}),a(C,{variant:"white",wrap:!0,children:E("infostand.crackable_furni.hits_remaining",["hits","target"],[D.toString(),w.toString()])})]}),e.groupId>0&&_(J,{children:[a("hr",{className:"m-0"}),_(M,{pointer:!0,alignItems:"center",gap:2,onClick:()=>Sh(e.groupId),children:[a(as,{badgeCode:Xe(),isGroup:!0}),a(C,{variant:"white",underline:!0,children:q})]})]}),F&&_(J,{children:[a("hr",{className:"m-0"}),B&&_(C,{wrap:!0,variant:"white",children:["ID: ",e.id]}),m.length>0&&_(J,{children:[a("hr",{className:"m-0"}),a(v,{gap:1,children:m.map((je,se)=>_(M,{alignItems:"center",gap:1,children:[a(C,{wrap:!0,align:"end",variant:"white",className:"col-4",children:je}),a("input",{type:"text",className:"form-control form-control-sm",value:f[se],onChange:Te=>re(se,Te.target.value)})]},se))})]})]}),I.length>0&&_(J,{children:[a("hr",{className:"m-0 my-1"}),a(v,{gap:1,children:I.map((je,se)=>_(M,{alignItems:"center",gap:1,children:[a(C,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:je}),a("input",{type:"text",className:"form-control form-control-sm",value:A[se],onChange:Te=>me(se,Te.target.value)})]},se))})]})]})]})}),_(M,{gap:2,justifyContent:"end",children:[o&&a(Y,{className:"infostand-buttons px-2",onClick:je=>Ae("move"),children:E("infostand.button.move")}),c&&a(Y,{className:"infostand-buttons px-2",onClick:je=>Ae("rotate"),children:E("infostand.button.rotate")}),i!==Kg&&a(Y,{className:"infostand-buttons px-2",onClick:je=>Ae("pickup"),children:E(i===SR?"infostand.button.eject":"infostand.button.pickup")}),u&&a(Y,{className:"infostand-buttons px-2",onClick:je=>Ae("use"),children:E("infostand.button.use")}),m.length>0&&f.length>0&&m.length===f.length&&a(Y,{className:"infostand-buttons px-2",onClick:()=>Ae("save_branding_configuration"),children:E("save")}),I.length>0&&A.length>0&&I.length===A.length&&a(Y,{className:"infostand-buttons px-2",onClick:()=>Ae("save_custom_variables"),children:E("save")})]})]}):null},sZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(0),[n,o]=d.exports.useState(0);return Yt(),za(),d.exports.useEffect(()=>{i(e.remainingGrowTime),o(e.remainingTimeToLive)},[e]),d.exports.useEffect(()=>{if(e.petType!==ht.MONSTERPLANT||e.dead)return;const l=setInterval(()=>{i(c=>c-1),o(c=>c-1)},1e3);return()=>clearInterval(l)},[e]),e?a(v,{className:"nitro-infostand rounded",children:_(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[_(v,{gap:1,children:[_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(C,{variant:"white",small:!0,wrap:!0,children:e.name}),a(Lc,{className:"fa-icon",onClick:t})]}),a(C,{variant:"white",small:!0,wrap:!0,children:E(`pet.breed.${e.petType}.${e.petBreed}`)}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{gap:1,children:[a(v,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:a(Na,{figure:e.petFigure,posture:e.posture,direction:4})}),_(v,{grow:!0,gap:1,children:[a(C,{variant:"white",center:!0,small:!0,wrap:!0,children:E("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])}),_(v,{alignItems:"center",gap:1,children:[a(C,{variant:"white",truncate:!0,children:E("infostand.pet.text.happiness")}),_(K,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[a(M,{fit:!0,center:!0,position:"absolute",children:a(C,{variant:"white",small:!0,children:e.happyness+"/"+e.maximumHappyness})}),a(K,{className:"bg-info rounded pet-stats",style:{width:e.happyness/e.maximumHappyness*100+"%"}})]})]}),_(v,{alignItems:"center",gap:1,children:[a(C,{variant:"white",truncate:!0,children:E("infostand.pet.text.experience")}),_(K,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[a(M,{fit:!0,center:!0,position:"absolute",children:a(C,{variant:"white",small:!0,children:e.experience+"/"+e.levelExperienceGoal})}),a(K,{className:"bg-purple rounded pet-stats",style:{width:e.experience/e.levelExperienceGoal*100+"%"}})]})]}),_(v,{alignItems:"center",gap:1,children:[a(C,{variant:"white",truncate:!0,children:E("infostand.pet.text.energy")}),_(K,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[a(M,{fit:!0,center:!0,position:"absolute",children:a(C,{variant:"white",small:!0,children:e.energy+"/"+e.maximumEnergy})}),a(K,{className:"bg-success rounded pet-stats",style:{width:e.energy/e.maximumEnergy*100+"%"}})]})]})]})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[a(C,{variant:"white",small:!0,wrap:!0,children:E("infostand.text.petrespect",["count"],[e.respect.toString()])}),a(C,{variant:"white",small:!0,wrap:!0,children:E("pet.age",["age"],[e.age.toString()])}),a("hr",{className:"m-0"})]}),a(v,{gap:1,children:_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:e.ownerId}),a(C,{variant:"white",small:!0,wrap:!0,children:E("infostand.text.petowner",["name"],[e.ownerName])})]})})]})}):null},rZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,r=d.exports.useMemo(()=>!(e.botSkills.indexOf(St.NO_PICK_UP)>=0||!e.amIOwner&&!e.amIAnyRoomController),[e]),i=()=>W(new $_(e.webID));if(e)return _(v,{gap:1,children:[a(v,{className:"nitro-infostand rounded",children:_(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[_(v,{gap:1,children:[_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(C,{variant:"white",small:!0,wrap:!0,children:e.name}),a(yo,{className:"cursor-pointer fa-icon",onClick:t})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{gap:1,children:[a(v,{fullWidth:!0,className:"body-image bot",children:a(Ts,{figure:e.figure,direction:4})}),a(v,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(n=>a(as,{badgeCode:n,showInfo:!0},n))})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[a(M,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:a(C,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",className:"motto-content",children:e.motto})}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:e.ownerId}),a(C,{variant:"white",wrap:!0,children:E("infostand.text.botowner",["name"],[e.ownerName])})]}),e.carryItem>0&&_(J,{children:[a("hr",{className:"m-0"}),a(C,{variant:"white",wrap:!0,children:E("infostand.text.handitem",["item"],[E("handitem"+e.carryItem)])})]})]})]})}),r&&a(M,{justifyContent:"end",children:a(Y,{className:"infostand-buttons",onClick:i,children:E("infostand.button.pickup")})})]})},iZ=s=>{const{relationships:e=null}=s,t=({type:r})=>{const i=e&&e.relationshipStatusMap.hasKey(r)?e.relationshipStatusMap.getValue(r):null;if(!i||!i.friendCount)return null;const n=Jr.RELATIONSHIP_NAMES[r].toLocaleLowerCase();return _(M,{alignItems:"center",gap:1,children:[a("i",{className:`nitro-friends-spritesheet icon-${n}`}),a(M,{alignItems:"center",gap:0,children:_(C,{gfbold:!0,variant:"white",onClick:o=>ri(i.randomFriendId),children:[a("u",{children:i.randomFriendName}),i.friendCount>1&&" "+E(`extendedprofile.relstatus.others.${n}`,["count"],[(i.friendCount-1).toString()])]})})]})};return _(J,{children:[a(t,{type:Jr.HEART}),a(t,{type:Jr.SMILE}),a(t,{type:Jr.BOBBA})]})},nZ=s=>{Le(`navigator/search/${s}`),W(new gl("hotel_view",`tag:${s}`))},aZ=s=>{const{tags:e=null}=s;return!e||!e.length?null:_(J,{children:[a("hr",{className:"m-0"}),a(M,{className:"flex-tags",children:e&&e.length>0&&e.map((t,r)=>a(C,{variant:"white",className:"text-tags",onClick:i=>nZ(t),children:t},r))})]})},oZ=s=>{const{avatarInfo:e=null,setAvatarInfo:t=null,onClose:r=null}=s,[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(null),{roomSession:u=null}=Yt(),g=f=>{!o||f.length>Ee("motto.max.length",38)||(u.sendMottoMessage(f),l(!1))},m=f=>g(f.target.value),p=f=>{switch(f.stopPropagation(),f.key){case"Enter":g(f.target.value);return}};return es(Ap.RSUBE_BADGES,f=>{!e||e.webID!==f.userId||e.badges.join("")===f.badges.join("")||t(I=>{const O=Hr(I);return O.badges=f.badges,O})}),es(bp.USER_FIGURE,f=>{!e||e.roomIndex!==f.roomIndex||t(T=>{const I=Hr(T);return I.figure=f.figure,I.motto=f.customInfo,I.achievementScore=f.activityPoints,I})}),es(Sp.FAVOURITE_GROUP_UPDATE,f=>{!e||e.roomIndex!==f.roomIndex||t(T=>{const I=Hr(T),O=f.status===-1||f.habboGroupId<=0;return I.groupId=O?-1:f.habboGroupId,I.groupName=O?null:f.habboGroupName,I.groupBadgeId=O?null:ie().getGroupBadge(f.habboGroupId),I})}),j(dE,f=>{const T=f.getParser();!e||e.webID!==T.userId||h(T)}),d.exports.useEffect(()=>(l(!1),n(e.motto),W(new wE(e.webID)),()=>{l(!1),n(null),h(null)}),[e]),e?a(v,{className:"nitro-infostand rounded",children:_(v,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[_(v,{gap:1,children:[_(M,{alignItems:"center",justifyContent:"between",children:[_(M,{alignItems:"center",gap:1,children:[a(Ei,{userId:e.webID}),a(C,{variant:"white",small:!0,wrap:!0,children:e.name})]}),a(yo,{className:"cursor-pointer fa-icon",onClick:r})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{gap:1,children:[a(v,{fullWidth:!0,className:"body-image",onClick:f=>ri(e.webID),children:a(Ts,{figure:e.figure,direction:4})}),_(v,{grow:!0,alignItems:"center",gap:0,children:[_(M,{gap:1,children:[a(M,{center:!0,className:"badge-image",children:e.badges[0]&&a(as,{badgeCode:e.badges[0],showInfo:!0})}),a(M,{center:!0,pointer:e.groupId>0,className:"badge-image",onClick:f=>Sh(e.groupId),children:e.groupId>0&&a(as,{badgeCode:e.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:e.groupName})})]}),_(M,{center:!0,gap:1,children:[a(M,{center:!0,className:"badge-image",children:e.badges[1]&&a(as,{badgeCode:e.badges[1],showInfo:!0})}),a(M,{center:!0,className:"badge-image",children:e.badges[2]&&a(as,{badgeCode:e.badges[2],showInfo:!0})})]}),_(M,{center:!0,gap:1,children:[a(M,{center:!0,className:"badge-image",children:e.badges[3]&&a(as,{badgeCode:e.badges[3],showInfo:!0})}),a(M,{center:!0,className:"badge-image",children:e.badges[4]&&a(as,{badgeCode:e.badges[4],showInfo:!0})})]})]})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[_(M,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[e.type!==fs.OWN_USER&&a(M,{grow:!0,alignItems:"center",className:"motto-content",children:a(C,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:i})}),e.type===fs.OWN_USER&&_(M,{grow:!0,alignItems:"center",gap:2,children:[a(BU,{className:"small fa-icon"}),_(M,{grow:!0,alignItems:"center",className:"motto-content",children:[!o&&_(C,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:f=>l(!0),children:[i,""]}),o&&a("input",{type:"text",className:"motto-input",maxLength:Ee("motto.max.length",38),value:i,onChange:f=>n(f.target.value),onBlur:m,onKeyDown:p,autoFocus:!0})]})]})]}),a("hr",{className:"m-0"})]}),_(v,{gap:1,children:[a(C,{variant:"white",small:!0,wrap:!0,children:E("infostand.text.achievement_score")+" "+e.achievementScore}),e.carryItem>0&&_(J,{children:[a("hr",{className:"m-0"}),a(C,{variant:"white",small:!0,wrap:!0,children:E("infostand.text.handitem",["item"],[E("handitem"+e.carryItem)])})]})]}),a(v,{gap:1,children:a(iZ,{relationships:c})}),Ee("user.tags.enabled")&&a(v,{gap:1,className:"mt-1",children:a(aZ,{tags:ie().tags})})]})}):null},Xh=0,qg=1,CR=2,AR=3,Xg=4,NR=5,bR=6,lZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(Xh),{canRequestFriend:n=null}=Oi(),{report:o=null}=un(),{roomSession:l=null}=Yt(),{userRespectRemaining:c=0,respectUser:h=null}=za(),u=d.exports.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel<Rt.GUEST&&!e.isGuildRoom,[e]),g=d.exports.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel===Rt.GUEST&&!e.isGuildRoom,[e]),m=d.exports.useMemo(()=>e.canBeKicked||e.canBeBanned||e.canBeMuted||u||g,[u,g,e]),p=d.exports.useMemo(()=>{let T=!1;const I=bl();if(I){const O=I.model.getValue(b.FIGURE_CARRY_OBJECT);O>0&&O<999999&&(T=!0)}return T},[]),f=T=>{let I=!0;if(T)switch(T){case"moderate":I=!1,i(qg);break;case"ban":I=!1,i(CR);break;case"mute":I=!1,i(AR);break;case"ambassador":I=!1,i(Xg);break;case"ambassador_mute":I=!1,i(NR);break;case"back_moderate":I=!1,i(qg);break;case"back_ambassador":I=!1,i(Xg);break;case"back":I=!1,i(Xh);break;case"whisper":zs(new Oo(Oo.WHISPER,e.name));break;case"friend":Le(`friends/request/${e.webID}/${e.name}`);break;case"relationship":I=!1,i(bR);break;case"respect":{h(e.webID),c-1>=1&&(I=!1);break}case"ignore":ie().ignoreUser(e.name);break;case"unignore":ie().unignoreUser(e.name);break;case"kick":l.sendKickMessage(e.webID);break;case"ban_hour":l.sendBanMessage(e.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":l.sendBanMessage(e.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":l.sendBanMessage(e.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":l.sendMuteMessage(e.webID,2);break;case"mute_5min":l.sendMuteMessage(e.webID,5);break;case"mute_10min":l.sendMuteMessage(e.webID,10);break;case"give_rights":l.sendGiveRightsMessage(e.webID);break;case"remove_rights":l.sendTakeRightsMessage(e.webID);break;case"trade":W(new Pv(e.roomIndex));break;case"report":o(Qt.BULLY,{reportedUserId:e.webID});break;case"pass_hand_item":W(new DD(e.webID));break;case"ambassador_alert":l.sendAmbassadorAlertMessage(e.webID);break;case"ambassador_kick":l.sendKickMessage(e.webID);break;case"ambassador_mute_2min":l.sendMuteMessage(e.webID,2);break;case"ambassador_mute_10min":l.sendMuteMessage(e.webID,10);break;case"ambassador_mute_60min":l.sendMuteMessage(e.webID,60);break;case"ambassador_mute_18hour":l.sendMuteMessage(e.webID,1080);break;case"rship_heart":W(new ac(e.webID,Pr.RELATIONSHIP_HEART));break;case"rship_smile":W(new ac(e.webID,Pr.RELATIONSHIP_SMILE));break;case"rship_bobba":W(new ac(e.webID,Pr.RELATIONSHIP_BOBBA));break;case"rship_none":W(new ac(e.webID,Pr.RELATIONSHIP_NONE));break}I&&t()};return d.exports.useEffect(()=>{i(Xh)},[e]),_(ua,{objectId:e.roomIndex,category:z.UNIT,userType:e.userType,onClose:t,collapsable:!0,children:[a(Gr,{className:"cursor-pointer",onClick:T=>ri(e.webID),children:e.name}),r===Xh&&_(J,{children:[n(e.webID)&&a(oe,{onClick:T=>f("friend"),children:E("infostand.button.friend")}),a(oe,{onClick:T=>f("trade"),children:E("infostand.button.trade")}),a(oe,{onClick:T=>f("whisper"),children:E("infostand.button.whisper")}),c>0&&a(oe,{onClick:T=>f("respect"),children:E("infostand.button.respect",["count"],[c.toString()])}),!n(e.webID)&&_(oe,{onClick:T=>f("relationship"),children:[E("infostand.link.relationship"),a(qn,{className:"right fa-icon"})]}),!e.isIgnored&&a(oe,{onClick:T=>f("ignore"),children:E("infostand.button.ignore")}),e.isIgnored&&a(oe,{onClick:T=>f("unignore"),children:E("infostand.button.unignore")}),a(oe,{onClick:T=>f("report"),children:E("infostand.button.report")}),m&&_(oe,{onClick:T=>f("moderate"),children:[a(qn,{className:"right fa-icon"}),E("infostand.link.moderate")]}),e.isAmbassador&&_(oe,{onClick:T=>f("ambassador"),children:[a(qn,{className:"right fa-icon"}),E("infostand.link.ambassador")]}),p&&a(oe,{onClick:T=>f("pass_hand_item"),children:E("avatar.widget.pass_hand_item")})]}),r===qg&&_(J,{children:[a(oe,{onClick:T=>f("kick"),children:E("infostand.button.kick")}),_(oe,{onClick:T=>f("mute"),children:[a(qn,{className:"right fa-icon"}),E("infostand.button.mute")]}),_(oe,{onClick:T=>f("ban"),children:[a(qn,{className:"right fa-icon"}),E("infostand.button.ban")]}),u&&a(oe,{onClick:T=>f("give_rights"),children:E("infostand.button.giverights")}),g&&a(oe,{onClick:T=>f("remove_rights"),children:E("infostand.button.removerights")}),_(oe,{onClick:T=>f("back"),children:[a(Kn,{className:"left fa-icon"}),E("generic.back")]})]}),r===CR&&_(J,{children:[a(oe,{onClick:T=>f("ban_hour"),children:E("infostand.button.ban_hour")}),a(oe,{onClick:T=>f("ban_day"),children:E("infostand.button.ban_day")}),a(oe,{onClick:T=>f("perm_ban"),children:E("infostand.button.perm_ban")}),_(oe,{onClick:T=>f("back_moderate"),children:[a(Kn,{className:"left fa-icon"}),E("generic.back")]})]}),r===AR&&_(J,{children:[a(oe,{onClick:T=>f("mute_2min"),children:E("infostand.button.mute_2min")}),a(oe,{onClick:T=>f("mute_5min"),children:E("infostand.button.mute_5min")}),a(oe,{onClick:T=>f("mute_10min"),children:E("infostand.button.mute_10min")}),_(oe,{onClick:T=>f("back_moderate"),children:[a(Kn,{className:"left fa-icon"}),E("generic.back")]})]}),r===Xg&&_(J,{children:[a(oe,{onClick:T=>f("ambassador_alert"),children:E("infostand.button.alert")}),a(oe,{onClick:T=>f("ambassador_kick"),children:E("infostand.button.kick")}),_(oe,{onClick:T=>f("ambassador_mute"),children:[E("infostand.button.mute"),a(qn,{className:"right fa-icon"})]}),_(oe,{onClick:T=>f("back"),children:[a(Kn,{className:"left fa-icon"}),E("generic.back")]})]}),r===NR&&_(J,{children:[a(oe,{onClick:T=>f("ambassador_mute_2min"),children:E("infostand.button.mute_2min")}),a(oe,{onClick:T=>f("ambassador_mute_10min"),children:E("infostand.button.mute_10min")}),a(oe,{onClick:T=>f("ambassador_mute_60min"),children:E("infostand.button.mute_60min")}),a(oe,{onClick:T=>f("ambassador_mute_18hr"),children:E("infostand.button.mute_18hour")}),_(oe,{onClick:T=>f("back_ambassador"),children:[a(Kn,{className:"left fa-icon"}),E("generic.back")]})]}),r===bR&&_(J,{children:[_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:T=>f("rship_heart"),children:a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),a(oe,{onClick:T=>f("rship_smile"),children:a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),a(oe,{onClick:T=>f("rship_bobba"),children:a(K,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),a(oe,{onClick:T=>f("rship_none"),children:E("avatar.widget.clear_relationship")}),_(oe,{onClick:T=>f("back"),children:[a(Kn,{className:"left fa-icon"}),E("generic.back")]})]})]})},GI=s=>{const{classNames:e=[],...t}=s,r=d.exports.useMemo(()=>{const i=["menu-list"];return e.length&&i.push(...e),i},[e]);return a(v,{classNames:r,...t})},cZ=s=>{const{userId:e=-1,userName:t="",roomIndex:r=-1,setIsDecorating:i=null}=s;return a(ua,{objectId:r,category:z.UNIT,onClose:null,children:a(GI,{children:a(oe,{onClick:n=>i(!1),children:E("widget.avatar.stop_decorating")})})})},uZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,r=i=>{if(i)switch(i){case"move":cc(e.id,e.category,Qe.OBJECT_MOVE);break;case"rotate":cc(e.id,e.category,Qe.OBJECT_ROTATE_POSITIVE);break;case"pickup":cc(e.id,e.category,Qe.OBJECT_PICKUP);break;case"eject":cc(e.id,e.category,Qe.OBJECT_EJECT);break}};return _(ua,{objectId:e.id,category:e.category,onClose:t,collapsable:!0,children:[a(Gr,{children:e.name}),_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:i=>r("move"),children:a(VU,{className:"center fa-icon"})}),a(oe,{onClick:i=>r("rotate"),disabled:e.isWallItem,children:a(HU,{className:"center fa-icon"})}),(e.isOwner||e.isAnyRoomController)&&a(oe,{onClick:i=>r("pickup"),children:a(jI,{className:"center fa-icon"})}),!e.isOwner&&!e.isAnyRoomController&&(e.isRoomOwner||e.roomControllerLevel>=Rt.GUILD_ADMIN)&&a(oe,{onClick:i=>r("eject"),children:a(jI,{className:"center fa-icon"})})]})]})},yR=s=>{const{nameInfo:e=null,onClose:t=null}=s,r=d.exports.useMemo(()=>{const i=["name-only"];return e.isFriend&&i.push("is-friend"),i},[e]);return a(ua,{objectId:e.roomIndex,category:e.category,userType:e.userType,fades:e.id!==ie().userId,classNames:r,onClose:t,children:a("div",{className:"text-shadow",children:e.name})})},Qg=0,$g=1,vR=3,MR=4,hZ=s=>{const{avatarInfo:e=null,isDancing:t=!1,setIsDecorating:r=null,onClose:i=null}=s,[n,o]=d.exports.useState(t&&ll()?$g:Qg),{roomSession:l=null}=Yt(),[c,h]=d.exports.useState(!1),u=p=>{let f=!0;if(p)if(p.startsWith("sign_")){const T=parseInt(p.split("_")[1]);l.sendSignMessage(T)}else switch(p){case"decorate":r(!0);break;case"change_name":zs(new E_(E_.INIT));break;case"change_looks":Le("avatar-editor/show");break;case"expressions":f=!1,o(vR);break;case"sit":l.sendPostureMessage(__.POSTURE_SIT);break;case"stand":l.sendPostureMessage(__.POSTURE_STAND);break;case"wave":l.sendExpressionMessage(Tr.WAVE.ordinal);break;case"blow":l.sendExpressionMessage(Tr.BLOW.ordinal);break;case"laugh":l.sendExpressionMessage(Tr.LAUGH.ordinal);break;case"idle":l.sendExpressionMessage(Tr.IDLE.ordinal);break;case"dance_menu":f=!1,o($g);break;case"dance":l.sendDanceMessage(1);break;case"dance_stop":l.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":l.sendDanceMessage(parseInt(p.charAt(p.length-1)));break;case"signs":f=!1,o(MR);break;case"back":f=!1,o(Qg);break;case"drop_carry_item":W(new MD);break}f&&i()},g=()=>e.amIOwner||e.amIAnyRoomController||e.roomControllerLevel>Rt.GUEST,m=Tq();return _(ua,{objectId:e.roomIndex,category:z.UNIT,userType:e.userType,onClose:i,collapsable:!0,children:[a(Gr,{className:"cursor-pointer",onClick:p=>ri(e.webID),children:e.name}),!c&&_(v,{gap:0,children:[n===Qg&&_(J,{children:[e.allowNameChange&&a(oe,{onClick:p=>u("change_name"),children:E("widget.avatar.change_name")}),g()&&a(oe,{onClick:p=>u("decorate"),children:E("widget.avatar.decorate")}),a(oe,{onClick:p=>u("change_looks"),children:E("widget.memenu.myclothes")}),ll()&&!m&&a(oe,{onClick:p=>u("dance_menu"),children:_(M,{gap:1,children:[E("widget.memenu.dance"),a("i",{className:"icon icon-context-arrow-right mt-auto mb-auto"})]})}),!t&&!ll()&&!m&&a(oe,{onClick:p=>u("dance"),children:_(M,{gap:1,children:[E("widget.memenu.dance"),a("i",{className:"icon icon-context-arrow-right mt-auto mb-auto"})]})}),t&&!ll()&&!m&&a(oe,{onClick:p=>u("dance_stop"),children:E("widget.memenu.dance.stop")}),a(oe,{onClick:p=>u("expressions"),children:_(M,{gap:1,children:[E("infostand.link.expressions"),a("i",{className:"icon icon-context-arrow-right mt-auto mb-auto"})]})}),a(oe,{onClick:p=>u("signs"),children:_(M,{gap:1,children:[E("infostand.show.signs"),a("i",{className:"icon icon-context-arrow-right mt-auto mb-auto"})]})}),e.carryItem>0&&a(oe,{onClick:p=>u("drop_carry_item"),children:E("avatar.widget.drop_hand_item")})]}),n===$g&&_(J,{children:[t&&a(oe,{onClick:p=>u("dance_stop"),children:E("widget.memenu.dance.stop")}),a(oe,{onClick:p=>u("dance_1"),children:E("widget.memenu.dance1")}),a(oe,{onClick:p=>u("dance_2"),children:E("widget.memenu.dance2")}),a(oe,{onClick:p=>u("dance_3"),children:E("widget.memenu.dance3")}),a(oe,{onClick:p=>u("dance_4"),children:E("widget.memenu.dance4")}),a(oe,{onClick:p=>u("back"),children:_(M,{gap:1,children:[a("i",{className:"icon icon-context-arrow-left mt-auto mb-auto"}),E("generic.back")]})})]}),n===vR&&_(J,{children:[Eq()===he.POSTURE_STAND&&a(oe,{onClick:p=>u("sit"),children:E("widget.memenu.sit")}),aq()&&a(oe,{onClick:p=>u("stand"),children:E("widget.memenu.stand")}),kg()&&a(oe,{onClick:p=>u("wave"),children:E("widget.memenu.wave")}),kg()&&_(oe,{disabled:!Uh(),onClick:p=>u("laugh"),children:[!Uh()&&a(Gs,{type:"hc"}),E("widget.memenu.laugh")]}),kg()&&_(oe,{disabled:!Uh(),onClick:p=>u("blow"),children:[!Uh()&&a(Gs,{type:"hc"}),E("widget.memenu.blow")]}),a(oe,{onClick:p=>u("idle"),children:E("widget.memenu.idle")}),a(oe,{onClick:p=>u("back"),children:_(M,{gap:1,children:[a("i",{className:"icon icon-context-arrow-left mt-auto mb-auto"}),E("generic.back")]})})]}),n===MR&&_(J,{children:[_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:p=>u("sign_1"),children:"1"}),a(oe,{onClick:p=>u("sign_2"),children:"2"}),a(oe,{onClick:p=>u("sign_3"),children:"3"})]}),_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:p=>u("sign_4"),children:"4"}),a(oe,{onClick:p=>u("sign_5"),children:"5"}),a(oe,{onClick:p=>u("sign_6"),children:"6"})]}),_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:p=>u("sign_7"),children:"7"}),a(oe,{onClick:p=>u("sign_8"),children:"8"}),a(oe,{onClick:p=>u("sign_9"),children:"9"})]}),_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:p=>u("sign_10"),children:"10"}),a(oe,{onClick:p=>u("sign_11"),children:a("i",{className:"icon icon-sign-heart"})}),a(oe,{onClick:p=>u("sign_12"),children:a("i",{className:"icon icon-sign-skull"})})]}),_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:p=>u("sign_0"),children:"0"}),a(oe,{onClick:p=>u("sign_13"),children:a("i",{className:"icon icon-sign-exclamation"})}),a(oe,{onClick:p=>u("sign_15"),children:a("i",{className:"icon icon-sign-smile"})})]}),_(M,{className:"menu-list-split-3",children:[a(oe,{onClick:p=>u("sign_14"),children:a("i",{className:"icon icon-sign-soccer"})}),a(oe,{onClick:p=>u("sign_17"),children:a("i",{className:"icon icon-sign-yellow"})}),a(oe,{onClick:p=>u("sign_16"),children:a("i",{className:"icon icon-sign-red"})})]}),a(oe,{onClick:p=>u("back"),children:_(M,{gap:1,children:[a("i",{className:"icon icon-context-arrow-left mt-auto mb-auto"}),E("generic.back")]})})]})]})]})},Jg=0,DR=1,PR=2,LR=3,dZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(Jg),{roomSession:n=null}=Yt(),{petRespectRemaining:o=0,respectPet:l=null}=za(),c=d.exports.useMemo(()=>{let u=!1;const g=bl();if(g){const m=g.model.getValue(b.FIGURE_CARRY_OBJECT);m>0&&m<999999&&(u=!0)}return u},[]),h=u=>{let g=!0;if(u)switch(u){case"respect":l(e.id),o-1>=1&&(g=!1);break;case"treat":W(new Q_(e.id));break;case"pass_handitem":W(new DE(e.id));break;case"train":n.requestPetCommands(e.id);break;case"pick_up":n.pickupPet(e.id);break;case"mount":n.mountPet(e.id);break;case"toggle_riding_permission":n.togglePetRiding(e.id);break;case"toggle_breeding_permission":n.togglePetBreeding(e.id);break;case"dismount":n.dismountPet(e.id);break;case"saddle_off":n.removePetSaddle(e.id);break;case"breed":break;case"harvest":n.harvestPet(e.id);break;case"revive":break;case"compost":n.compostPlant(e.id);break;case"buy_saddle":Le("catalog/open/"+Ee("catalog.links")["pets.buy_saddle"]);break}g&&t()};return d.exports.useEffect(()=>{i(u=>e.petType===ht.MONSTERPLANT?LR:e.saddle&&!e.rider?DR:e.rider?PR:Jg)},[e]),_(ua,{objectId:e.roomIndex,category:z.UNIT,userType:jt.PET,onClose:t,collapsable:!0,children:[a(Gr,{children:e.name}),r===Jg&&_(J,{children:[o>0&&a(oe,{onClick:u=>h("respect"),children:E("infostand.button.petrespect",["count"],[o.toString()])}),a(oe,{onClick:u=>h("train"),children:E("infostand.button.train")}),a(oe,{onClick:u=>h("pick_up"),children:E("infostand.button.pickup")}),e.petType===ht.HORSE&&a(oe,{onClick:u=>h("buy_saddle"),children:E("infostand.button.buy_saddle")}),[ht.BEAR,ht.TERRIER,ht.CAT,ht.DOG,ht.PIG].indexOf(e.petType)>-1&&a(oe,{onClick:u=>h("breed"),children:E("infostand.button.breed")})]}),r===DR&&_(J,{children:[a(oe,{onClick:u=>h("mount"),children:E("infostand.button.mount")}),_(oe,{onClick:u=>h("toggle_riding_permission"),gap:1,children:[a("input",{type:"checkbox",checked:!!e.publiclyRideable,readOnly:!0}),E("infostand.button.toggle_riding_permission")]}),o>0&&a(oe,{onClick:u=>h("respect"),children:E("infostand.button.petrespect",["count"],[o.toString()])}),a(oe,{onClick:u=>h("train"),children:E("infostand.button.train")}),a(oe,{onClick:u=>h("pick_up"),children:E("infostand.button.pickup")}),a(oe,{onClick:u=>h("saddle_off"),children:E("infostand.button.saddleoff")})]}),r===PR&&_(J,{children:[a(oe,{onClick:u=>h("dismount"),children:E("infostand.button.dismount")}),o>0&&a(oe,{onClick:u=>h("respect"),children:E("infostand.button.petrespect",["count"],[o.toString()])})]}),r===LR&&_(J,{children:[a(oe,{onClick:u=>h("pick_up"),children:E("infostand.button.pickup")}),e.dead&&a(oe,{onClick:u=>h("revive"),children:E("infostand.button.revive")}),n.isRoomOwner&&a(oe,{onClick:u=>h("compost"),children:E("infostand.button.compost")}),!e.dead&&e.energy/e.maximumEnergy<.98&&a(oe,{onClick:u=>h("treat"),children:E("infostand.button.pettreat")}),!e.dead&&e.level===e.maximumLevel&&e.breedable&&_(J,{children:[_(oe,{onClick:u=>h("toggle_breeding_permission"),gap:1,children:[a("input",{type:"checkbox",checked:e.publiclyBreedable,readOnly:!0}),E("infostand.button.toggle_breeding_permission")]}),a(oe,{onClick:u=>h("breed"),children:E("infostand.button.breed")})]})]}),c&&a(oe,{onClick:u=>h("pass_hand_item"),children:E("infostand.button.pass_hand_item")})]})},Zg=0,UR=1,xR=2,wR=3,_Z=s=>{const{avatarInfo:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(Zg),{roomSession:n=null}=Yt(),{petRespectRemaining:o=0,respectPet:l=null}=za(),c=d.exports.useMemo(()=>n.isRoomOwner||n.controllerLevel>=Rt.GUEST||ie().isModerator,[n]),h=d.exports.useMemo(()=>{let g=!1;const m=bl();if(m){const p=m.model.getValue(b.FIGURE_CARRY_OBJECT);p>0&&p<999999&&(g=!0)}return g},[]),u=g=>{let m=!0;if(g)switch(g){case"respect":l(e.id),o-1>=1&&(m=!1);break;case"treat":W(new Q_(e.id));break;case"pass_handitem":W(new DE(e.id));break;case"pick_up":n.pickupPet(e.id);break;case"mount":n.mountPet(e.id);break;case"dismount":n.dismountPet(e.id);break}m&&t()};return d.exports.useEffect(()=>{i(g=>e.petType===ht.MONSTERPLANT?wR:e.saddle&&!e.rider?UR:e.rider?xR:Zg)},[e]),_(ua,{objectId:e.roomIndex,category:z.UNIT,userType:jt.PET,onClose:t,collapsable:!0,children:[a(Gr,{children:e.name}),r===Zg&&o>0&&a(oe,{onClick:g=>u("respect"),children:E("infostand.button.petrespect",["count"],[o.toString()])}),r===UR&&_(J,{children:[!!e.publiclyRideable&&a(oe,{onClick:g=>u("mount"),children:E("infostand.button.mount")}),o>0&&a(oe,{onClick:g=>u("respect"),children:E("infostand.button.petrespect",["count"],[o.toString()])})]}),r===xR&&_(J,{children:[a(oe,{onClick:g=>u("dismount"),children:E("infostand.button.dismount")}),o>0&&a(oe,{onClick:g=>u("respect"),children:E("infostand.button.petrespect",["count"],[o.toString()])})]}),r===wR&&!e.dead&&e.energy/e.maximumEnergy<.98&&a(oe,{onClick:g=>u("treat"),children:E("infostand.button.pettreat")}),c&&a(oe,{onClick:g=>u("pick_up"),children:E("infostand.button.pickup")}),h&&a(oe,{onClick:g=>u("pass_hand_item"),children:E("infostand.button.pass_hand_item")})]})},em=0,FR=1,kR=2,gZ=s=>{const{avatarInfo:e=null,onClose:t=null}=s,[r,i]=d.exports.useState(em),[n,o]=d.exports.useState(""),[l,c]=d.exports.useState("");j(xN,m=>{const p=m.getParser();if(p.botId===e.webID)switch(p.commandId){case St.CHANGE_BOT_NAME:o(p.data),i(FR);return;case St.CHANGE_BOT_MOTTO:c(p.data),i(kR);return;case St.SETUP_CHAT:{const f=p.data,T=f.split(f.indexOf(";#;")===-1?";":";#;");(T.length===3||T.length===4)&&(zs(new OI(e.roomIndex,z.UNIT,e.webID,T[0],T[1].toLowerCase()==="true"||T[1]==="1",parseInt(T[2]),T[3]?T[3].toLowerCase()==="true"||T[3]==="1":!1)),t());return}}});const h=m=>W(new xM(e.webID,m)),u=m=>{let p=!0;if(m)switch(m){case"donate_to_all":h(St.DONATE_TO_ALL),W(new jn(e.webID,St.DONATE_TO_ALL,""));break;case"donate_to_user":h(St.DONATE_TO_USER),W(new jn(e.webID,St.DONATE_TO_USER,""));break;case"change_bot_name":h(St.CHANGE_BOT_NAME),p=!1;break;case"save_bot_name":W(new jn(e.webID,St.CHANGE_BOT_NAME,n));break;case"change_bot_motto":h(St.CHANGE_BOT_MOTTO),p=!1;break;case"save_bot_motto":W(new jn(e.webID,St.CHANGE_BOT_MOTTO,l));break;case"dress_up":W(new jn(e.webID,St.DRESS_UP,""));break;case"random_walk":W(new jn(e.webID,St.RANDOM_WALK,""));break;case"setup_chat":h(St.SETUP_CHAT),p=!1;break;case"dance":W(new jn(e.webID,St.DANCE,""));break;case"nux_take_tour":mt().createLinkEvent("help/tour"),W(new jn(e.webID,St.NUX_TAKE_TOUR,""));break;case"pick":W(new $_(e.webID));break}p&&t()};d.exports.useEffect(()=>{i(em)},[e]);const g=e.amIOwner||e.amIAnyRoomController;return _(ua,{objectId:e.roomIndex,category:z.UNIT,userType:jt.RENTABLE_BOT,onClose:t,collapsable:!0,children:[a(Gr,{children:e.name}),r===em&&g&&_(J,{children:[e.botSkills.indexOf(St.DONATE_TO_ALL)>=0&&a(oe,{onClick:m=>u("donate_to_all"),children:E("avatar.widget.donate_to_all")}),e.botSkills.indexOf(St.DONATE_TO_USER)>=0&&a(oe,{onClick:m=>u("donate_to_user"),children:E("avatar.widget.donate_to_user")}),e.botSkills.indexOf(St.CHANGE_BOT_NAME)>=0&&a(oe,{onClick:m=>u("change_bot_name"),children:E("avatar.widget.change_bot_name")}),e.botSkills.indexOf(St.CHANGE_BOT_MOTTO)>=0&&a(oe,{onClick:m=>u("change_bot_motto"),children:E("avatar.widget.change_bot_motto")}),e.botSkills.indexOf(St.DRESS_UP)>=0&&a(oe,{onClick:m=>u("dress_up"),children:E("avatar.widget.dress_up")}),e.botSkills.indexOf(St.RANDOM_WALK)>=0&&a(oe,{onClick:m=>u("random_walk"),children:E("avatar.widget.random_walk")}),e.botSkills.indexOf(St.SETUP_CHAT)>=0&&a(oe,{onClick:m=>u("setup_chat"),children:E("avatar.widget.setup_chat")}),e.botSkills.indexOf(St.DANCE)>=0&&a(oe,{onClick:m=>u("dance"),children:E("avatar.widget.dance")}),e.botSkills.indexOf(St.NO_PICK_UP)===-1&&a(oe,{onClick:m=>u("pick"),children:E("avatar.widget.pick_up")})]}),r===FR&&_(v,{className:"menu-item context-input-bg",onClick:null,gap:1,children:[a(C,{variant:"white",children:E("bot.skill.name.configuration.new.name")}),a("input",{type:"text",className:"form-control form-control-sm",value:n,maxLength:Ee("bot.name.max.length",15),onChange:m=>o(m.target.value)}),_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(Y,{fullWidth:!0,variant:"secondary",onClick:m=>u(null),children:E("cancel")}),a(Y,{fullWidth:!0,variant:"success",onClick:m=>u("save_bot_name"),children:E("save")})]})]}),r===kR&&_(v,{className:"menu-item context-input-bg",onClick:null,gap:1,children:[a(C,{variant:"white",children:E("bot.skill.name.configuration.new.motto")}),a("input",{type:"text",className:"form-control form-control-sm",value:l,maxLength:Ee("motto.max.length",38),onChange:m=>c(m.target.value)}),_(M,{alignItems:"center",justifyContent:"between",gap:1,children:[a(Y,{fullWidth:!0,variant:"secondary",onClick:m=>u(null),children:E("cancel")}),a(Y,{fullWidth:!0,variant:"success",onClick:m=>u("save_bot_motto"),children:E("save")})]})]})]})},mZ=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState(null),{avatarInfo:l=null,setAvatarInfo:c=null,activeNameBubble:h=null,setActiveNameBubble:u=null,nameBubbles:g=[],removeNameBubble:m=null,productBubbles:p=[],confirmingProduct:f=null,updateConfirmingProduct:T=null,removeProductBubble:I=null,isDecorating:O=!1,setIsDecorating:A=null}=f8(),{roomSession:N=null}=Yt();_t(lt.NORMAL_MODE,D=>{e&&t(!1)}),_t(lt.GAME_MODE,D=>{e||t(!0)}),es(Rp.RSDE_DANCE,D=>{D.roomIndex===N.ownRoomIndex&&i(D.danceId!==0)}),Cs(OI.UPDATE_CHAT,D=>o(D));const P=()=>{if(!N||e)return null;if(h)return a(yR,{nameInfo:h,onClose:()=>u(null)});if(l)switch(l.type){case vc.FURNI:{const D=l;return O?a(uZ,{avatarInfo:D,onClose:()=>c(null)}):null}case fs.OWN_USER:case fs.PEER:{const D=l;return Ee("user.tags.enabled")&&ie().getUserTags(D.roomIndex),D.isSpectatorMode?null:D.isOwnUser?tr.isRunning()?null:a(hZ,{avatarInfo:D,isDancing:r,setIsDecorating:A,onClose:()=>c(null)}):a(lZ,{avatarInfo:D,onClose:()=>c(null)})}case Mc.PET_INFO:{const D=l;return D.isOwner?a(dZ,{avatarInfo:D,onClose:()=>c(null)}):a(_Z,{avatarInfo:D,onClose:()=>c(null)})}case Dc.RENTABLE_BOT:return a(gZ,{avatarInfo:l,onClose:()=>c(null)})}return null},y=()=>{if(!l)return null;switch(l.type){case vc.FURNI:return a(tZ,{avatarInfo:l,onClose:()=>c(null)});case fs.OWN_USER:case fs.PEER:return a(oZ,{avatarInfo:l,setAvatarInfo:c,onClose:()=>c(null)});case fs.BOT:return a(eZ,{avatarInfo:l,onClose:()=>c(null)});case Dc.RENTABLE_BOT:return a(rZ,{avatarInfo:l,onClose:()=>c(null)});case Mc.PET_INFO:return a(sZ,{avatarInfo:l,onClose:()=>c(null)})}};return _(J,{children:[O&&a(cZ,{userId:ie().userId,userName:ie().userName,roomIndex:N.ownRoomIndex,setIsDecorating:A}),P(),l&&a(v,{alignItems:"end",className:"nitro-infostand-container",children:y()}),g.length>0&&g.map((D,x)=>a(yR,{nameInfo:D,onClose:()=>m(x)},x)),p.length>0&&p.map((D,x)=>a(ZJ,{item:D,updateConfirmingProduct:T,onClose:()=>I(x)},D.id)),n&&a(KJ,{chatEvent:n,onClose:()=>o(null)}),f&&a(qJ,{item:f,onClose:()=>T(null)}),a(zJ,{})]})},fZ=s=>{const{chatStyleId:e=0,chatStyleIds:t=null,selectChatStyleId:r=null}=s,[i,n]=d.exports.useState(null),[o,l]=d.exports.useState(!1),c=u=>{r(u),l(!1)},h=u=>{let g=!1;l(m=>(g=!m,g)),g&&n(u.target)};return d.exports.useEffect(()=>{o||n(null)},[o]),_(J,{children:[a(K,{pointer:!0,className:"chatstyles-selector cursor-pointer",onClick:h}),a(nS,{show:o,target:i,placement:"top",children:a(yd,{className:"nitro-chat-style-selector-container",children:a(Ge,{overflow:"hidden",className:"bg-transparent bubble-window image-rendering-pixelated",children:a(qe,{gap:1,columnCount:3,overflow:"auto",children:t&&t.length>0&&t.map(u=>a(M,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:g=>c(u),children:a(K,{className:"bubble-container",children:a(K,{className:`chat-bubble bubble-${u}`,children:""})},u)},u))})})})})]})},pZ=s=>{const[e,t]=d.exports.useState(""),{chatStyleId:r=0,updateChatStyleId:i=null}=za(),{selectedUsername:n="",floodBlocked:o=!1,floodBlockedSeconds:l=0,setIsTyping:c=null,setIsIdle:h=null,sendChat:u=null}=E8(),{roomSession:g=null}=Yt(),m=d.exports.useRef(),p=d.exports.useMemo(()=>E("widgets.chatinput.mode.whisper"),[]),f=d.exports.useMemo(()=>E("widgets.chatinput.mode.shout"),[]),T=d.exports.useMemo(()=>E("widgets.chatinput.mode.speak"),[]),I=d.exports.useMemo(()=>Ee("chat.input.maxlength",100),[]),O=d.exports.useCallback(()=>{const w=document.activeElement;return!(!w||m&&m.current===w||!(w instanceof HTMLInputElement)&&!(w instanceof HTMLTextAreaElement))},[m]),A=d.exports.useCallback(()=>{m.current.focus(),m.current.setSelectionRange(m.current.value.length*2,m.current.value.length*2)},[m]),N=d.exports.useCallback(()=>{t(w=>w!==p||!n.length?w:`${w} ${n}`)},[n,p]),P=d.exports.useCallback((w,k=!1)=>{if(!w||w==="")return;let F=k?Cn.CHAT_SHOUT:Cn.CHAT_DEFAULT,L=w;const B=L.split(" ");let V="",q="";switch(B[0]){case p:F=Cn.CHAT_WHISPER,V=B[1],q=p+" "+V+" ",B.shift(),B.shift();break;case f:F=Cn.CHAT_SHOUT,B.shift();break;case T:F=Cn.CHAT_DEFAULT,B.shift();break}L=B.join(" "),c(!1),h(!1),L.length<=I&&(/%CC%/g.test(encodeURIComponent(L))?t(""):(t(""),u(L,F,V,r))),t(q)},[p,f,T,I,r,c,h,u]),y=d.exports.useCallback(w=>{!w||!w.length?c(!1):(c(!0),h(!0)),t(w)},[c,h]),D=d.exports.useCallback(w=>{if(o||!m.current||O())return;document.activeElement!==m.current&&A();const k=w.target.value;switch(w.key){case" ":case"Space":N();return;case"NumpadEnter":case"Enter":P(k,w.shiftKey);return;case"Backspace":if(k){const F=k.split(" ");F[0]===p&&F.length===3&&F[2]===""&&t("")}return}},[o,m,p,O,A,N,P]);Cs(Oo.CHAT_INPUT_CONTENT,w=>{switch(w.chatMode){case Oo.WHISPER:{t(`${p} ${w.userName} `);return}case Oo.SHOUT:return}});const x=d.exports.useMemo(()=>{let w=[];const k=Ee("chat.styles");for(const F of k)if(F){if(F.minRank>0){ie().hasSecurity(F.minRank)&&w.push(F.styleId);continue}if(F.isSystemStyle&&ie().hasSecurity(Rt.MODERATOR)){w.push(F.styleId);continue}if(!(Ee("chat.styles.disabled").indexOf(F.styleId)>=0)){if(F.isHcOnly&&Li()>=Lr.CLUB){w.push(F.styleId);continue}if(F.isAmbassadorOnly&&ie().isAmbassador){w.push(F.styleId);continue}!F.isHcOnly&&!F.isAmbassadorOnly&&w.push(F.styleId)}}return w},[]);return d.exports.useEffect(()=>(document.body.addEventListener("keydown",D),()=>{document.body.removeEventListener("keydown",D)}),[D]),d.exports.useEffect(()=>{m.current&&(m.current.parentElement.dataset.value=e)},[e]),!g||g.isSpectator?null:up.exports.createPortal(_("div",{className:"nitro-chat-input-container",children:[a(fZ,{chatStyleId:r,chatStyleIds:x,selectChatStyleId:i}),_("div",{className:"input-sizer align-items-center",children:[!o&&a("input",{ref:m,type:"text",className:"chat-input",placeholder:E("widgets.chatinput.default"),value:e,maxLength:I,onChange:w=>y(w.target.value),onMouseDown:w=>A()}),o&&_(C,{variant:"danger",children:[E("chat.input.alert.flood",["time"],[l.toString()])," "]})]})]}),document.getElementById("toolbar-chat-input-container"))},EZ=()=>{let s=null;self.onmessage=e=>{if(!e)return;const t=e.data;switch(t.action){case"START":s=setInterval(()=>postMessage(null),t.content);break;case"STOP":s&&(clearInterval(s),s=null);break}}};class IZ extends Worker{constructor(e){const t=e.toString(),r=new Blob([`(${t})()`]);super(URL.createObjectURL(r))}}const TZ=s=>{var D;const{chat:e=null,makeRoom:t=null,bubbleWidth:r=xt.CHAT_BUBBLE_WIDTH_NORMAL}=s,[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),c=d.exports.useRef(),h=d.exports.useMemo(()=>{switch(r){case xt.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case xt.CHAT_BUBBLE_WIDTH_THIN:return 240;case xt.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[r]),u=x=>/https:\/\/tetr\.io\/#\w+/i.test(x),g=x=>{const w=/https?:\/\/(?:prnt\.sc|prntscr\.com|prnt\.scr)\/([a-zA-Z0-9_-]{4,})/i,k=x.match(w);return k?k[1]:null},m=x=>x?[`https://i.prnt.sc/${x}.png`,`https://i.prnt.sc/${x}.jpg`,`https://image.prntscr.com/image/${x}.png`,`https://image.prntscr.com/image/${x}.jpg`,`https://prnt.sc/${x}`]:[],p=d.exports.useMemo(()=>g((e==null?void 0:e.formattedText)??""),[e==null?void 0:e.formattedText]),f=d.exports.useMemo(()=>p?m(p):[],[p]),[T,I]=d.exports.useState(0),[O,A]=d.exports.useState(null),[N,P]=d.exports.useState(!1);d.exports.useEffect(()=>{I(0)},[p]);const y=()=>{if(O){A(null);return}const x=T+1;x<f.length&&I(x)};return d.exports.useEffect(()=>{var L,B;let x=!1;if(A(null),!p)return;const w=(B=(L=e==null?void 0:e.formattedText)==null?void 0:L.match(/https?:\/\/(?:prnt\.sc|prntscr\.com|prnt\.scr)\/[a-zA-Z0-9_-]{4,}/i))==null?void 0:B[0];if(!w)return;const k=new AbortController;P(!0);const F=V=>{if(x)return null;const q=V.match(/<meta\s+property=["']og:image["']\s+content=["']([^"']+)["']/i)||V.match(/<meta\s+name=["']twitter:image["']\s+content=["']([^"']+)["']/i);return q?q[1]:null};return fetch(w,{signal:k.signal}).then(V=>V.text()).then(V=>{if(x)return;const q=F(V);return q&&A(q),q}).catch(()=>null).then(async V=>{if(!x&&!V)try{const q=`https://api.allorigins.win/raw?url=${encodeURIComponent(w)}`,H=await(await fetch(q,{signal:k.signal})).text(),X=F(H);X&&!x&&A(X)}catch{}}).finally(()=>{x||P(!1)}),()=>{x=!0,k.abort()}},[p,e==null?void 0:e.formattedText]),d.exports.useEffect(()=>{n(!1);const x=c.current;if(!x)return;const w=x.offsetWidth,k=x.offsetHeight;e.width=w,e.height=k,e.elementRef=x;let F=e.left,L=e.top;return!F&&!L&&(F=e.location.x-w/2,L=x.parentElement.offsetHeight-k,e.left=F,e.top=L),l(!0),()=>{e.elementRef=null,l(!1)}},[e]),d.exports.useEffect(()=>{!o||!e||i||(t&&t(e),n(!0))},[e,o,i,t]),_("div",{ref:c,className:`bubble-container ${i?"visible":"invisible"}`,onClick:x=>te().selectRoomObject(e.roomId,e.senderId,z.UNIT),children:[e.styleId===0&&a("div",{className:"user-container-bg",style:{backgroundColor:e.color}}),_("div",{className:`chat-bubble bubble-${e.styleId} type-${e.type}`,style:{maxWidth:h},children:[a("div",{className:"user-container",children:e.imageUrl&&e.imageUrl.length>0&&a("div",{className:"user-image",style:{backgroundImage:`url(${e.imageUrl})`}})}),_("div",{className:"chat-content",children:[a("span",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${e.username}: `}}),p&&(e.username==="g6re"||e.username==="Yogurt")?_("div",{className:"prntscr-embed",style:{display:"flex",flexDirection:"column",gap:8,alignItems:"flex-start"},onClick:x=>x.stopPropagation(),children:[a("a",{href:((D=e.formattedText.match(/https?:\/\/(?:prnt\.sc|prntscr\.com|prnt\.scr)\/[a-zA-Z0-9_-]{4,}/i))==null?void 0:D[0])??"#",target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},onClick:x=>x.stopPropagation(),children:a("img",{src:O??f[T],alt:"PrntScr preview",onError:y,style:{maxWidth:Math.min(500,h-20),maxHeight:500,width:"auto",height:"auto",borderRadius:6,display:"block",objectFit:"contain"}})}),a("div",{style:{fontSize:12,color:"var(--text-muted, #666)"},children:e.formattedText})]}):u(e.formattedText)&&e.username==="g6re"?_("a",{href:e.formattedText.match(/https:\/\/tetr\.io\/#\w+/i)[0],target:"_blank",rel:"noopener noreferrer",className:"tetrio-invite-embed",style:{display:"flex",alignItems:"center",border:"1px solid #4CAF50",backgroundColor:"#E8F5E9",padding:"10px",borderRadius:"8px",fontStyle:"italic",color:"#2E7D32",maxWidth:h-20,textDecoration:"none",cursor:"pointer",gap:"10px"},onClick:x=>x.stopPropagation(),children:[a("img",{src:"https://txt.osk.sh/branding/tetrio-anim.gif",alt:"TETR.IO Logo",style:{width:50,height:50,borderRadius:4,objectFit:"contain",display:"block"}}),_("div",{children:[a("strong",{children:"Invitacin para jugar TETR.IO!"}),a("br",{}),"Haz clic para unirte a la partida "]})]}):a("span",{className:"message",dangerouslySetInnerHTML:{__html:`${e.formattedText}`}})]}),a("div",{className:"pointer"})]})]})},RZ=s=>{const{chatMessages:e=[],setChatMessages:t=null,chatSettings:r=null,getScrollSpeed:i=6e3}=T8(),n=d.exports.useRef(),o=d.exports.useCallback(()=>{t(h=>{if(h){const u=h.filter(g=>g.top>-g.height*2);if(u.length!==h.length)return u}return h})},[t]),l=d.exports.useCallback((h,u,g)=>{for(let m=e.indexOf(h)-1;m>=0;m--){const p=e[m];if(!(!p||h===p||g.indexOf(p)>=0||p.top+p.height-u>h.top+h.height)&&nX(h,p,-u,0)){const f=Math.abs(p.top+p.height-h.top);g.push(p),p.top-=f,p.skipMovement=!0,l(p,f,g)}}},[e]),c=d.exports.useCallback(h=>{if(r.mode===xt.CHAT_MODE_FREE_FLOW)h.skipMovement=!0,l(h,0,[h]),o();else{const u=h.top+h.height,g=h.height,m=n.current.offsetHeight-u,p=g-m;m<g&&(t(f=>(f.forEach(T=>{T!==h&&(T.top-=p)}),f)),o())}},[r,l,o,t]);return d.exports.useEffect(()=>{const h=(u=null)=>{if(!n||!n.current)return;const g=n.current.offsetHeight,m=Math.round(document.body.offsetHeight*Ee("chat.viewer.height.percentage"));n.current.style.height=`${m}px`,t(p=>(p&&p.forEach(f=>f.top-=g-m),p))};return window.addEventListener("resize",h),h(),()=>{window.removeEventListener("resize",h)}},[t]),d.exports.useEffect(()=>{const h=g=>{t(m=>(m.forEach(p=>{if(p.skipMovement){p.skipMovement=!1;return}p.top-=g}),m)),o()},u=new IZ(EZ);return u.onmessage=()=>h(15),u.postMessage({action:"START",content:i}),()=>{u.postMessage({action:"STOP"})}},[i,o,t]),a("div",{ref:n,className:"nitro-chat-widget",children:e.map(h=>a(TZ,{chat:h,makeRoom:c,bubbleWidth:r.weight},h.id))})},X0=s=>{const{title:e=null,items:t=[],selectItem:r=null,onClose:i=null}=s,[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(""),h=ie().isModerator,u=d.exports.useMemo(()=>{const g=l.toLocaleLowerCase();return t.filter(m=>{var p;return(p=m.name)==null?void 0:p.toLocaleLowerCase().includes(g)})},[t,l]);return d.exports.useEffect(()=>{n&&r(n)},[n,r]),_(Be,{className:"nitro-chooser-widget",theme:"primary",children:[a(He,{headerText:e,onCloseClick:i}),_(Ge,{overflow:"hidden",gap:2,children:[a("input",{type:"text",className:"form-control form-control-sm",placeholder:E("generic.search"),value:l,onChange:g=>c(g.target.value)}),a(mg,{rows:u,rowRender:g=>a(M,{alignItems:"center",className:bo("rounded p-1",n===g&&"bg-muted"),pointer:!0,onClick:m=>o(g),children:_(C,{truncate:!0,children:[g.name," ",h&&" - "+g.id]})})})]})]})},SZ=s=>{const{items:e=null,onClose:t=null,selectItem:r=null,populateChooser:i=null}=y8();return d.exports.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),i()},eventUrlPrefix:"furni-chooser/"};return xs(n),()=>ws(n)},[i]),e?a(X0,{title:E("widget.chooser.furni.title"),items:e,selectItem:r,onClose:t}):null},OZ=s=>{const{items:e=null,onClose:t=null,selectItem:r=null,populateChooser:i=null}=U8();return d.exports.useEffect(()=>{const n={linkReceived:o=>{o.split("/"),i()},eventUrlPrefix:"user-chooser/"};return xs(n),()=>ws(n)},[i]),e?a(X0,{title:E("widget.chooser.user.title"),items:e,selectItem:r,onClose:t}):null},CZ=s=>{const[e,t]=d.exports.useState(!1),{users:r=[],answer:i=null}=S8();return d.exports.useEffect(()=>{t(!!r.length)},[r]),e?_(Be,{className:"nitro-widget-doorbell",theme:"primary",children:[a(He,{headerText:E("navigator.doorbell.title"),onCloseClick:n=>t(!1)}),_(Ge,{overflow:"hidden",gap:0,children:[a(v,{gap:2,children:a(qe,{gap:1,className:"px-1 pb-1",children:a(C,{small:!0,className:"g-col-10",children:E("widgets.doorbell.info")})})}),a(v,{overflow:"auto",className:"striped-children",gap:0,children:r&&r.length>0&&r.map(n=>_(qe,{gap:1,alignItems:"center",className:"text-black p-1",children:[a(C,{small:!0,className:"g-col-6",children:n}),a(K,{className:"g-col-6",children:_(M,{alignItems:"center",justifyContent:"end",gap:1,children:[a("i",{className:"icon icon-accept-check cursor-pointer",onClick:()=>i(n,!0)}),a("i",{className:"icon icon-decline-x cursor-pointer",onClick:()=>i(n,!1)})]})})]},n))})]})]}):null},Ag=s=>{const{objectId:e=-1,category:t=-1,noFollow:r=!1,position:i="absolute",...n}=s,[o,l]=d.exports.useState({x:-1,y:-1}),c=d.exports.useRef();return d.exports.useEffect(()=>{let h=!1;const u=()=>{const m=bt();return _I(m.roomId,e,t,1)},g=()=>{const m=u();!m||!c.current||l({x:Math.round(m.left+m.width/2-c.current.offsetWidth/2),y:Math.round(m.top-c.current.offsetHeight+10)})};return r?g():(h=!0,Rr().add(g)),()=>{h&&Rr().remove(g)}},[e,t,r]),a(K,{innerRef:c,position:i,visible:o.x+(c.current?c.current.offsetWidth:0)>-1,className:"object-location",style:{left:o.x,top:o.y},...n})},AZ=s=>{const{roomIndex:e=-1,request:t=null,hideFriendRequest:r=null,requestResponse:i=null}=s;return a(Ag,{objectId:e,category:z.UNIT,children:a(K,{className:"nitro-friend-request-dialog p-2",children:_(v,{children:[_(M,{alignItems:"center",justifyContent:"between",gap:2,children:[a(C,{small:!0,bold:!0,variant:"white",className:"w-75",children:E("widget.friendrequest.from",["username"],[t.name])}),a("i",{className:"friend-req-close",onClick:n=>r(t.requesterUserId)})]}),_(M,{children:[a(C,{small:!0,className:"mt-2 cursor-pointer",underline:!0,onClick:n=>i(t.requesterUserId,!1),children:E("widget.friendrequest.decline")}),a(Y,{className:"accept-friend-btn",onClick:n=>i(t.requesterUserId,!0),children:E("widget.friendrequest.accept")})]})]})})})},NZ=s=>{const{displayedRequests:e=[],hideFriendRequest:t=null}=N8(),{requestResponse:r=null}=Oi();return e.length?a(J,{children:e.map((i,n)=>a(AZ,{roomIndex:i.roomIndex,request:i.request,hideFriendRequest:t,requestResponse:r},n))}):null},bZ=s=>{const{productType:e=nt.FLOOR,classId:t=-1,extraParam:r=void 0}=s;switch(e){case nt.WALL:case nt.FLOOR:return a(NI,{productType:e,productClassId:t});case nt.BADGE:return a(as,{badgeCode:r});case nt.HABBO_CLUB:return a(Gs,{type:"hc"})}return null},yZ=s=>{const{ownerId:e=-1}=s,[t,r]=d.exports.useState(0),[i,n]=d.exports.useState(void 0),o=()=>{t===1&&W(new sM(e)),r(0),n(void 0)};j(XA,c=>{r(1)}),j(zA,c=>{r(0),n(void 0)}),j(KA,c=>{const h=c.getParser();n({contentType:h.contentType,classId:h.classId}),r(2)});const l=ie().userId===e;return t===0?null:_(Be,{className:"nitro-mysterybox-dialog",theme:"primary-slim",children:[a(He,{headerText:E(t===1?`mysterybox.dialog.${l?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:o}),_(Ge,{children:[t===1&&_(J,{children:[_(C,{variant:"primary",children:[" ",E(`mysterybox.dialog.${l?"owner":"other"}.subtitle`)," "]}),_(C,{children:[" ",E(`mysterybox.dialog.${l?"owner":"other"}.description`)," "]}),_(C,{children:[" ",E(`mysterybox.dialog.${l?"owner":"other"}.waiting`)]}),_(Y,{variant:"danger",onClick:o,className:"mt-auto",children:[" ",E(`mysterybox.dialog.${l?"owner":"other"}.cancel`)," "]})]}),t===2&&i&&_(J,{children:[_(C,{variant:"black",children:[" ",E("mysterybox.reward.text")," "]}),a(M,{className:"prize-container justify-content-center mx-auto",children:a(bZ,{classId:i.classId,productType:i.contentType})}),_(Y,{variant:"success",onClick:o,className:"mt-auto",children:[" ",E("mysterybox.reward.close")," "]})]})]})]})},vZ=s=>{const{objectId:e=-1,onClose:t=null}=s,[r,i]=d.exports.useState(""),n=()=>{W(new _D(e,r)),t()};return e===-1?null:_(Be,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary-slim",children:[a(He,{center:!0,headerText:E("mysterytrophy.header.title"),onCloseClick:t}),_(Ge,{children:[_(M,{className:"mysterytrophy-dialog-top p-3",children:[a("div",{className:"mysterytrophy-image flex-shrink-0"}),a("div",{className:"m-2",children:a(C,{variant:"white",className:"mysterytrophy-text-big",children:E("mysterytrophy.header.description")})})]}),a(M,{className:"mysterytrophy-dialog-bottom p-2",children:_(v,{gap:1,children:[_(M,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[a("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:r,onChange:o=>i(o.target.value)}),a("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),_(M,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[a(C,{pointer:!0,className:"text-decoration",onClick:()=>t(),children:E("cancel")}),a(Y,{variant:"success",onClick:()=>n(),children:E("generic.ok")})]})]})})]})]})},MZ=s=>{const{objectId:e=-1,onClose:t=null}=s,{roomSession:r=null}=Yt(),i=()=>{r.useMultistateItem(e),t()};return _(Be,{className:"nitro-use-product-confirmation",children:[a(He,{headerText:E("effectbox.header.title"),onCloseClick:t}),a(Ge,{center:!0,children:a(M,{gap:2,children:_(v,{justifyContent:"between",children:[a(C,{children:E("effectbox.header.description")}),_(M,{alignItems:"center",justifyContent:"between",children:[a(Y,{variant:"danger",onClick:t,children:E("generic.cancel")}),a(Y,{variant:"success",onClick:i,children:E("generic.ok")})]})]})})})]})},Qh=-1,DZ=0,PZ=s=>{const{objectId:e=-1,onClose:t=null}=s,[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(Qh),{roomSession:l=null}=Yt(),c=()=>{l.useMultistateItem(e),t()};return d.exports.useEffect(()=>{if(!l||e===-1)return;const h=Ih(l.roomId,e,z.FLOOR);if(!h)return;i(h);let u=Qh;switch(h.specialType){case Pe.MONSTERPLANT_SEED:u=DZ;break}if(u===Qh){t();return}o(u)},[l,e,t]),n===Qh?null:_(Be,{className:"nitro-use-product-confirmation",children:[a(He,{headerText:E("useproduct.widget.title.plant_seed",["name"],[r.name]),onCloseClick:t}),a(Ge,{center:!0,children:_(M,{gap:2,overflow:"hidden",children:[a(v,{children:a(K,{className:"product-preview",children:a(K,{className:"monsterplant-image"})})}),_(v,{justifyContent:"between",overflow:"auto",children:[_(v,{gap:2,children:[a(C,{children:E("useproduct.widget.text.plant_seed",["productName"],[r.name])}),a(C,{children:E("useproduct.widget.info.plant_seed")})]}),_(M,{alignItems:"center",justifyContent:"between",children:[a(Y,{variant:"danger",onClick:t,children:E("useproduct.widget.cancel")}),a(Y,{variant:"success",onClick:c,children:E("widget.monsterplant_seed.button.use")})]})]})]})})]})},$h=-1,LZ=0,UZ=s=>{const{objectId:e=-1,onClose:t=null}=s,[r,i]=d.exports.useState($h),[n,o]=d.exports.useState(Je.MALE),[l,c]=d.exports.useState(null),{roomSession:h=null}=Yt(),u=()=>{jf().send(new TD(e)),jf().send(new xE(n,l)),t()};return d.exports.useEffect(()=>{let g=$h;const m=ie().figure,p=ie().gender,f=[];if(h&&e>=0){const T=Ih(h.roomId,e,z.FLOOR);if(T)switch(T.specialType){case Pe.FIGURE_PURCHASABLE_SET:g=LZ;const I=T.customParams.split(",").map(O=>parseInt(O));for(const O of I)Ks().isValidFigureSetForGender(O,p)&&f.push(O);break}}if(g===$h){t();return}o(p),c(Ks().getFigureStringWithFigureIds(m,p,f)),i(g)},[h,e,t]),r===$h?null:_(Be,{className:"nitro-use-product-confirmation",children:[a(He,{headerText:E("useproduct.widget.title.bind_clothing"),onCloseClick:t}),a(Ge,{center:!0,children:_(M,{gap:2,overflow:"hidden",children:[a(v,{children:a(K,{className:"mannequin-preview",children:a(Ts,{figure:l,direction:2})})}),_(v,{justifyContent:"between",overflow:"auto",children:[_(v,{gap:2,children:[a(C,{children:E("useproduct.widget.text.bind_clothing")}),a(C,{children:E("useproduct.widget.info.bind_clothing")})]}),_(M,{alignItems:"center",justifyContent:"between",children:[a(Y,{variant:"danger",onClick:t,children:E("useproduct.widget.cancel")}),a(Y,{variant:"success",onClick:u,children:E("useproduct.widget.bind_clothing")})]})]})]})})]})},xZ=s=>{const{closeConfirm:e=null,processAction:t=null,onClose:r=null,objectId:i=-1,mode:n=null,confirmMode:o=null,confirmingObjectId:l=-1,groupData:c=null,isGroupMember:h=!1,objectOwnerId:u=-1}=R7(),{simpleAlert:g=null}=$t();j(GN,p=>{const f=p.getParser();if(f)switch(f.count){case 1:g(E("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",E("costumehopper.costumerequired.buy"),E("costumehopper.costumerequired.header"),null);break;case 2:g(E("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",E("viprequired.buy.vip"),E("viprequired.header"),null);break;case 3:g(E("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",E("viprequired.buy.vip"),E("gate.viprequired.title"),null);break}});const m=ie().userId===u;return _(J,{children:[o===Zf&&a(PZ,{objectId:l,onClose:e}),o===ep&&a(UZ,{objectId:l,onClose:e}),o===b0&&a(MZ,{objectId:l,onClose:e}),o===tp&&a(vZ,{objectId:l,onClose:e}),a(yZ,{ownerId:u}),i>=0&&n&&_(ua,{objectId:i,category:z.FLOOR,onClose:r,fades:!0,children:[n===Wt.FRIEND_FURNITURE&&_(J,{children:[a(Gr,{children:E("friendfurni.context.title")}),a(oe,{onClick:p=>t("use_friend_furni"),children:E("friendfurni.context.use")})]}),n===Wt.MONSTERPLANT_SEED&&_(J,{children:[a(Gr,{children:E("furni.mnstr_seed.name")}),a(oe,{onClick:p=>t("use_monsterplant_seed"),children:E("widget.monsterplant_seed.button.use")})]}),n===Wt.RANDOM_TELEPORT&&_(J,{children:[a(Gr,{children:E("furni.random_teleport.name")}),a(oe,{onClick:p=>t("use_random_teleport"),children:E("widget.random_teleport.button.use")})]}),n===Wt.PURCHASABLE_CLOTHING&&_(J,{children:[a(Gr,{children:E("furni.generic_usable.name")}),a(oe,{onClick:p=>t("use_purchaseable_clothing"),children:E("widget.generic_usable.button.use")})]}),n===Wt.MYSTERY_BOX&&_(J,{children:[a(Gr,{children:E("mysterybox.context.title")}),a(oe,{onClick:p=>t("use_mystery_box"),children:E("mysterybox.context."+(m?"owner":"other")+".use")})]}),n===Wt.MYSTERY_TROPHY&&_(J,{children:[a(Gr,{children:E("mysterytrophy.header.title")}),a(oe,{onClick:p=>t("use_mystery_trophy"),children:E("friendfurni.context.use")})]}),n===N0&&c&&_(J,{children:[a(Gr,{className:"cursor-pointer text-truncate",onClick:()=>Sh(c.guildId),children:c.guildName}),!h&&a(oe,{onClick:p=>t("join_group"),children:E("widget.furniture.button.join.group")}),a(oe,{onClick:p=>t("go_to_group_homeroom"),children:E("widget.furniture.button.go.to.group.home.room")}),c.guildHasReadableForum&&a(oe,{onClick:p=>t("open_forum"),children:E("widget.furniture.button.open_group_forum")})]})]})]})},wZ=s=>{const{objectId:e=-1,color:t=0,setColor:r=null,applyToner:i=null,toggleToner:n=null,onClose:o=null}=p7();return e===-1?null:_(Be,{theme:"primary",className:"nitro-room-widget-toner",children:[a(He,{headerText:E("widget.backgroundcolor.info"),onCloseClick:o}),_(Ge,{overflow:"hidden",justifyContent:"between",children:[a(v,{overflow:"auto",gap:1,children:a("input",{type:"color",className:"form-control",value:si.makeColorNumberHex(t),onChange:l=>r(si.convertFromHex(l.target.value))})}),_(v,{gap:1,children:[a(Y,{fullWidth:!0,variant:"primary",onClick:n,children:E("widget.backgroundcolor.button.on")}),a(Y,{fullWidth:!0,variant:"primary",onClick:i,children:E("widget.backgroundcolor.button.apply")})]})]})]})},FZ=s=>{const{objectId:e=-1,color:t="1",badgeName:r="",badgeDesc:i="",date:n="",senderName:o="",onClose:l=null}=I7();return e===-1?null:a(u0,{color:t,message:i,date:n,senderName:o,customTitle:r,onCloseClick:l})},kZ=s=>{const{objectId:e=-1,recipes:t=[],ingredients:r=[],selectedRecipe:i=null,requiredIngredients:n=null,isCrafting:o=!1,craft:l=null,selectRecipe:c=null,onClose:h=null}=O7(),{roomSession:u=null}=Yt(),[g,m]=d.exports.useState(!1),p=d.exports.useMemo(()=>{const I=te().getRoomObject(u.roomId,e,z.FLOOR);return Dr(I)},[e,u.roomId]),f=d.exports.useMemo(()=>{if(!n||!n.length)return!1;for(const I of n){const O=r.find(A=>A.name===I.itemName);if(!O||O.count<I.count)return!1}return!0},[r,n]),T=()=>{if(!g){m(!0);return}l(),m(!1)};return d.exports.useEffect(()=>{m(!1)},[i]),e===-1?null:_(Be,{className:"nitro-widget-crafting",theme:"primary-slim",children:[a(He,{headerText:E("crafting.title"),onCloseClick:h}),a(Ge,{children:_(M,{grow:!0,overflow:"hidden",gap:2,children:[_(M,{column:!0,fullWidth:!0,gap:2,children:[_(v,{overflow:"hidden",fullHeight:!0,children:[a("div",{className:"bg-muted rounded py-1 text-center",children:E("crafting.title.products")}),a(Bt,{columnCount:5,children:t.length>0&&t.map(I=>a(yt,{itemImage:I.iconUrl,itemActive:i&&i.name===I.name,onClick:()=>c(I)},I.name))})]}),_(v,{overflow:"hidden",fullHeight:!0,children:[a("div",{className:"bg-muted rounded py-1 text-center",children:E("crafting.title.mixer")}),a(Bt,{columnCount:5,children:r.length>0&&r.map(I=>a(yt,{itemImage:I.iconUrl,itemCount:I.count,itemCountMinimum:0,className:(I.count?"":"opacity-0-5 ")+"cursor-default"},I.name))})]})]}),_(M,{column:!0,fullWidth:!0,gap:2,children:[!i&&a(v,{center:!0,fullHeight:!0,className:"text-black text-center",children:E("crafting.info.start")}),i&&_(J,{children:[_(v,{overflow:"hidden",fullHeight:!0,children:[a("div",{className:"bg-muted rounded py-1 text-center",children:E("crafting.current_recipe")}),a(Bt,{columnCount:5,children:!!n&&n.length>0&&n.map(I=>{const O=r.find(N=>N.name===I.itemName),A=[];for(let N=0;N<I.count;N++)A.push(a(yt,{itemImage:O.iconUrl,className:(O.count-N<=0?"opacity-0-5 ":"")+"cursor-default"},N));return A})})]}),_(M,{gap:2,column:!0,fullHeight:!0,children:[_(M,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[a("div",{className:"py-1 text-center",children:E("crafting.result")}),_(M,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[a(v,{fullHeight:!0,children:a("img",{src:i.iconUrl})}),a("div",{className:"text-black",children:i.localizedName})]})]}),_(Y,{variant:!p||!f?"danger":g?"warning":o?"primary":"success",disabled:!p||!f||o,onClick:T,children:[!o&&E(p?f?g?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),o&&a(bI,{})]})]})]})]})]})})]})},GZ=s=>{const[e,t]=d.exports.useState(!1),{presets:r=[],dimmerState:i=0,selectedPresetId:n=0,color:o=16777215,brightness:l=255,effectId:c=0,selectedColor:h=0,setSelectedColor:u=null,selectedBrightness:g=0,setSelectedBrightness:m=null,selectedEffectId:p=0,setSelectedEffectId:f=null,selectPresetId:T=null,applyChanges:I}=A7(),O=()=>{li.previewDimmer(o,l,c===2),t(!1)};_t(ne.REMOVE_DIMMER,N=>t(!1)),d.exports.useEffect(()=>{!r||!r.length||t(!0)},[r]);const A=d.exports.useMemo(()=>Ee("widget.dimmer.colorwheel",!1),[]);return e?_(Be,{className:"nitro-room-widget-dimmer",children:[a(He,{headerText:E("widget.dimmer.title"),onCloseClick:O}),i===1&&a(ca,{children:r.map(N=>a(Dn,{isActive:n===N.id,onClick:P=>T(N.id),children:E(`widget.dimmer.tab.${N.id}`)},N.id))}),_(Ge,{children:[i===0&&_(v,{alignItems:"center",children:[a(K,{className:"dimmer-banner"}),a(C,{center:!0,className:"bg-muted rounded p-1",children:E("widget.dimmer.info.off")}),a(Y,{fullWidth:!0,variant:"success",onClick:()=>li.changeState(),children:E("widget.dimmer.button.on")})]}),i===1&&_(J,{children:[_(v,{gap:1,children:[a(C,{fontWeight:"bold",children:E("widget.backgroundcolor.hue")}),A&&a("input",{type:"color",className:"form-control",value:si.makeColorNumberHex(h),onChange:N=>u(si.convertFromHex(N.target.value))}),!A&&a(qe,{gap:1,columnCount:7,children:li.AVAILABLE_COLORS.map((N,P)=>a(v,{fullWidth:!0,pointer:!0,className:bo("color-swatch rounded",N===h&&"active"),onClick:()=>u(N),style:{backgroundColor:li.HTML_COLORS[P]}},P))})]}),_(v,{gap:1,children:[a(C,{fontWeight:"bold",children:E("widget.backgroundcolor.lightness")}),a(ts,{className:"nitro-slider",min:li.MIN_BRIGHTNESS,max:li.MAX_BRIGHTNESS,value:g,onChange:N=>m(N),thumbClassName:"thumb percent",renderThumb:(N,P)=>a("div",{...N,children:li.scaleBrightness(P.valueNow)})})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:p===2,onChange:N=>f(N.target.checked?2:1)}),a(C,{children:E("widget.dimmer.type.checkbox")})]}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,variant:"danger",onClick:()=>li.changeState(),children:E("widget.dimmer.button.off")}),a(Y,{fullWidth:!0,variant:"success",onClick:I,children:E("widget.dimmer.button.apply")})]})]})]})]}):null},BZ=s=>{const{objectId:e=-1,value:t=0,onClose:r=null,redeem:i=null}=b7();return e===-1?null:_(Be,{className:"nitro-widget-exchange-credit",theme:"primary",children:[a(He,{headerText:E("catalog.redeem.dialog.title"),onCloseClick:r}),a(Ge,{center:!0,children:_(M,{overflow:"hidden",gap:2,children:[a(v,{center:!0,children:a(K,{className:"exchange-image"})}),_(v,{grow:!0,justifyContent:"between",overflow:"hidden",children:[_(v,{gap:1,overflow:"auto",children:[a(C,{fontWeight:"bold",children:E("creditfurni.description",["credits"],[t.toString()])}),a(C,{children:E("creditfurni.prompt")})]}),a(Y,{variant:"success",onClick:i,children:E("catalog.redeem.dialog.button.exchange")})]})]})})]})},VZ=s=>{const{currentIndex:e=-1,currentPhotos:t=null}=s,[r,i]=d.exports.useState(0),n=t&&t.length?t[r]:null,o=()=>{i(c=>{let h=c+1;return h>=t.length&&(h=0),h})},l=()=>{i(c=>{let h=c-1;return h<0&&(h=t.length-1),h})};return d.exports.useEffect(()=>{i(e)},[e]),n?_(qe,{style:{display:"flex",flexDirection:"column"},children:[a(M,{center:!0,className:"picture-preview border border-black",style:n.w?{backgroundImage:"url("+n.w+")"}:{},children:!n.w&&a(C,{bold:!0,children:E("camera.loading")})}),n.m&&n.m.length&&a(C,{center:!0,children:n.m}),_(M,{alignItems:"center",justifyContent:"between",children:[a(C,{children:n.n||""}),a(C,{children:new Date(n.t*1e3).toLocaleDateString()})]}),t.length>1&&_(M,{className:"picture-preview-buttons",children:[a(sS,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:l}),a(C,{underline:!0,className:"cursor-pointer",onClick:c=>ri(n.oi),children:n.o}),a(rS,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:o})]})]}):null},HZ=s=>{const{objectId:e=-1,currentPhotoIndex:t=-1,currentPhotos:r=null,onClose:i=null}=v7(),{report:n=null}=un();return e===-1||t===-1?null:_(Be,{className:"nitro-external-image-widget",theme:"primary-slim",children:[a(He,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>n(Qt.PHOTO,{extraData:r[t].w,roomId:r[t].s,reportedUserId:ie().userId,roomObjectId:Number(r[t].u)}),onCloseClick:i}),a(Ge,{children:a(VZ,{currentIndex:t,currentPhotos:r})})]})},WZ=s=>{const{objectId:e=-1,type:t=0,stage:r=0,usernames:i=[],figures:n=[],date:o=null,onClose:l=null,respond:c=null}=D7();if(e===-1)return null;if(r>0)return _(Be,{className:"nitro-engraving-lock",theme:"primary",children:[a(He,{headerText:E("friend.furniture.confirm.lock.caption"),onCloseClick:l}),_(Ge,{children:[a("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:E("friend.furniture.confirm.lock.subtitle")}),a("div",{className:"d-flex justify-content-center mb-2",children:a("div",{className:`engraving-lock-stage-${r}`})}),r===2&&a("div",{className:"text-small text-black text-center mb-2",children:E("friend.furniture.confirm.lock.other.locked")}),_(M,{gap:1,children:[a(Y,{fullWidth:!0,onClick:h=>c(!1),children:E("friend.furniture.confirm.lock.button.cancel")}),a(Y,{fullWidth:!0,variant:"success",onClick:h=>c(!0),children:E("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(i.length>0)return a(wo,{handleSelector:".nitro-engraving-lock-view",children:_("div",{className:`nitro-engraving-lock-view engraving-lock-${t}`,children:[a("div",{className:"engraving-lock-close",onClick:l}),_(M,{justifyContent:"center",children:[a("div",{className:"engraving-lock-avatar",children:a(Ts,{figure:n[0],direction:2})}),a("div",{className:"engraving-lock-avatar",children:a(Ts,{figure:n[1],direction:4})})]}),_(v,{justifyContent:"between",className:"mt-1",children:[_(v,{alignItems:"center",justifyContent:"center",gap:1,children:[_("div",{children:[t===0&&E("lovelock.engraving.caption"),t===3&&E("wildwest.engraving.caption")]}),a("div",{children:o})]}),_(M,{justifyContent:"center",gap:4,children:[a("div",{children:i[0]}),a("div",{children:i[1]})]})]})]})})},jZ=s=>{const{objectId:e=-1,classId:t=-1,itemType:r=null,text:i=null,isOwnerOfFurniture:n=!1,senderName:o=null,senderFigure:l=null,placedItemId:c=-1,placedItemType:h=null,placedInRoom:u=!1,imageUrl:g=null,openPresent:m=null,onClose:p=null}=z7(),{groupItems:f=[]}=yl();if(e===-1)return null;const T=I=>{const O=f.find(A=>{var N;return((N=A.getItemById(I))==null?void 0:N.id)===I});O&&yc(O),p()};return _(Be,{className:"nitro-gift-opening",theme:"primary",children:[a(He,{headerText:E(o?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[o]),onCloseClick:p}),_(Ge,{children:[c===-1&&_(v,{overflow:"hidden",children:[a(M,{center:!0,overflow:"auto",children:a(a0,{userName:o,figure:l,message:i})}),n&&_(M,{gap:1,children:[o&&a(Y,{fullWidth:!0,onClick:I=>Le("catalog/open"),children:E("widget.furni.present.give_gift",["name"],[o])}),a(Y,{fullWidth:!0,variant:"success",onClick:m,children:E("widget.furni.present.open_gift")})]})]}),c>-1&&_(M,{gap:2,overflow:"hidden",children:[a(v,{center:!0,className:"p-2",children:a(ja,{imageUrl:g})}),_(v,{grow:!0,children:[_(v,{center:!0,gap:1,children:[a(C,{wrap:!0,small:!0,children:E("widget.furni.present.message_opened")}),a(C,{bold:!0,fontSize:5,children:i})]}),_(v,{grow:!0,gap:1,children:[_(M,{gap:1,children:[u&&a(Y,{fullWidth:!0,onClick:null,children:E("widget.furni.present.put_in_inventory")}),a(Y,{fullWidth:!0,variant:"success",onClick:I=>T(c),children:E(u?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),o&&o.length&&a(Y,{fullWidth:!0,onClick:I=>Le("catalog/open"),children:E("widget.furni.present.give_gift",["name"],[o])})]})]})]})]})]})},YZ=s=>{const{stuffDatas:e=null,getScoreType:t=null,getClearType:r=null}=x7();return!e||!e.size?null:a(J,{children:Array.from(e.entries()).map(([i,n],o)=>a(Ag,{objectId:i,category:z.FLOOR,children:_(v,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[a(Gr,{children:E("high.score.display.caption",["scoretype","cleartype"],[E(`high.score.display.scoretype.${t(n.scoreType)}`),E(`high.score.display.cleartype.${r(n.clearType)}`)])}),_(GI,{overflow:"hidden",gap:1,className:"h-100",children:[_(v,{gap:1,children:[_(M,{alignItems:"center",children:[a(C,{center:!0,bold:!0,variant:"white",className:"col-8",children:E("high.score.display.users.header")}),a(C,{center:!0,bold:!0,variant:"white",className:"col-4",children:E("high.score.display.score.header")})]}),a("hr",{className:"m-0"})]}),a(v,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:n.entries.map((l,c)=>_(M,{alignItems:"center",children:[a(C,{center:!0,variant:"white",className:"col-8",children:l.users.join(", ")}),a(C,{center:!0,variant:"white",className:"col-4",children:l.score})]},c))})]})]})},o))})},zZ=s=>(k7(),null),KZ=-1,Jh=0,tm=1,sm=2,rm=3,im=4,qZ=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState(KZ),{objectId:n=-1,figure:o=null,gender:l=null,clubLevel:c=Lr.NO_CLUB,name:h=null,setName:u=null,saveFigure:g=null,wearFigure:m=null,saveName:p=null,onClose:f=null}=B7();return d.exports.useEffect(()=>{if(n===-1)return;const T=bt();if(T.isRoomOwner||T.controllerLevel>=Rt.GUEST||ie().isModerator){i(Jh);return}if(ie().gender.toLowerCase()!==l.toLowerCase()){i(im);return}if(Li()<c){i(rm);return}i(sm)},[n,l,c]),d.exports.useEffect(()=>{switch(r){case Jh:case im:{const T=Ks().createFigureContainer(o);mc.transformAsMannequinFigure(T),t(T.getFigureString());break}case tm:{const T=Ks().createFigureContainer(ie().figure);mc.transformAsMannequinFigure(T),t(T.getFigureString());break}case sm:case rm:{const T=mc.getMergedMannequinFigureContainer(ie().figure,o);t(T.getFigureString());break}}},[r,o,c]),n===-1?null:_(Be,{className:"nitro-mannequin no-resize",theme:"primary",children:[a(He,{headerText:E("mannequin.widget.title"),onCloseClick:f}),a(Ge,{center:!0,children:_(M,{fullWidth:!0,gap:2,overflow:"hidden",children:[a(v,{children:_(K,{position:"relative",className:"mannequin-preview",children:[a(Ts,{position:"absolute",figure:e,direction:2}),c>0&&a(Gs,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),_(v,{grow:!0,justifyContent:"between",overflow:"auto",children:[r===Jh&&_(J,{children:[a("input",{type:"text",className:"form-control form-control-sm",value:h,onChange:T=>u(T.target.value),onBlur:p}),_(v,{gap:1,children:[a(Y,{variant:"success",onClick:T=>i(tm),children:E("mannequin.widget.style")}),a(Y,{variant:"success",onClick:m,children:E("mannequin.widget.wear")})]})]}),r===tm&&_(J,{children:[_(v,{gap:1,children:[a(C,{bold:!0,children:h}),a(C,{wrap:!0,children:E("mannequin.widget.savetext")})]}),_(M,{alignItems:"center",justifyContent:"between",children:[a(C,{underline:!0,pointer:!0,onClick:T=>i(Jh),children:E("mannequin.widget.back")}),a(Y,{variant:"success",onClick:g,children:E("mannequin.widget.save")})]})]}),r===sm&&_(J,{children:[_(v,{gap:1,children:[a(C,{bold:!0,children:h}),a(C,{children:E("mannequin.widget.weartext")})]}),a(Y,{variant:"success",onClick:m,children:E("mannequin.widget.wear")})]}),r===rm&&a(M,{center:!0,grow:!0,children:a(C,{children:E("mannequin.widget.clubnotification")})}),r===im&&a(C,{children:E("mannequin.widget.wronggender")})]})]})})]})},XZ=s=>(X7(),null),Q0=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],QZ=["blue","pink","green","yellow"],$Z=s=>{let e=Q0.indexOf(s);return e===-1&&(e=0),QZ[e]},JZ=s=>{const{objectId:e=-1,color:t="0",setColor:r=null,text:i="",setText:n=null,canModify:o=!1,onClose:l=null}=$7();return e===-1?null:a(wo,{handleSelector:".drag-handler",windowPosition:hr.TOP_LEFT,children:_("div",{className:"nitro-stickie nitro-stickie-image stickie-"+$Z(t),children:[_("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[a("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:o&&_(J,{children:[a("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:l}),Q0.map(c=>a("div",{className:"stickie-color ms-1",onClick:h=>r(c),style:{backgroundColor:si.makeColorHex(c)}},c))]})}),a("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:l})]}),a("div",{className:"stickie-context",children:a("textarea",{className:"context-text",value:i,onChange:c=>n(c.target.value),tabIndex:0,autoFocus:!0})})]})})},ZZ=()=>(h7(s=>{const{roomId:e,id:t,category:r}=s,i=Ih(e,t,r);if(!i)return;const n=(i.className||"").toLowerCase(),o=(i.name||"").toLowerCase(),l=n.startsWith("tile_stackmagic")||o.includes("stackmagic"),c=n.includes("walking_floor")||o.includes("walking_floor")||n.includes("walk_magic")||o.includes("walk_magic");(l||c)&&te().events.dispatchEvent(new ne(ne.REQUEST_STACK_HEIGHT,e,t,r))}),null),eee=s=>{const{objectId:e=-1,height:t=0,maxHeight:r=40,onClose:i=null,updateHeight:n=null}=Z7(),[o,l]=d.exports.useState(""),c=h=>{l(h);const u=parseFloat(h);isNaN(u)||u===t||n(u)};return d.exports.useEffect(()=>{l(t.toString())},[t]),e===-1?null:_(Be,{className:"nitro-widget-custom-stack-height",theme:"primary",children:[a(He,{headerText:E("widget.custom.stack.height.title"),onCloseClick:i}),_(Ge,{justifyContent:"between",children:[a(C,{children:E("widget.custom.stack.height.text")}),_(M,{gap:2,children:[a(ts,{className:"nitro-slider",min:0,max:r,step:.01,value:t,onChange:h=>n(h),renderThumb:(h,u)=>a("div",{...h,children:u.valueNow})}),a("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:r,value:o,onChange:h=>c(h.target.value)})]}),_(v,{gap:1,children:[a(Y,{onClick:h=>W(new t_(e,-100)),children:E("furniture.above.stack")}),a(Y,{onClick:h=>W(new t_(e,0)),children:E("furniture.floor.level")})]})]})]})},$0=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],tee=["blue","pink","green","yellow"],see=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],ree=["post_it","shakesp","dreams","christmas","heart","juninas"],iee=s=>{let e=$0.indexOf(s);return e===-1&&(e=0),tee[e]},nee=s=>{let e=see.indexOf(s);return e===-1&&(e=0),ree[e]},aee=s=>{const{objectId:e=-1,color:t="0",text:r="",type:i="",canModify:n=!1,updateColor:o=null,updateText:l=null,trash:c=null,onClose:h=null}=t8(),[u,g]=d.exports.useState(!1);return d.exports.useEffect(()=>{g(!1)},[e,t,r,i]),e===-1?null:a(wo,{handleSelector:".drag-handler",windowPosition:hr.TOP_LEFT,children:_("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(i=="post_it"?iee(t):nee(i)),children:[_("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[a("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:n&&_(J,{children:[a("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:c}),i=="post_it"&&a(J,{children:$0.map(m=>a("div",{className:"stickie-color ms-1",onClick:p=>o(m),style:{backgroundColor:si.makeColorHex(m)}},m))})]})}),a("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:h})]}),a("div",{className:"stickie-context",children:!u||!n?a("div",{className:"context-text",onClick:m=>n&&g(!0),children:r}):a("textarea",{className:"context-text",defaultValue:r,tabIndex:0,onBlur:m=>l(m.target.value),autoFocus:!0})})]})})},oee=s=>{const{objectId:e=-1,color:t="1",senderName:r="",date:i="",message:n="",onClose:o=null}=r8();return e===-1?null:a(u0,{color:t,message:n,date:i,senderName:r,onCloseClick:o})},lee=s=>{const{displayData:e}=o8();return!e||e.size===0?null:a(J,{children:Array.from(e.entries()).map(([t,r],i)=>a(Ag,{objectId:t,category:z.FLOOR,children:a(v,{className:"nitro-widget-variable-display nitro-context-menu",gap:0,style:{minWidth:"110px"},children:a(GI,{overflow:"hidden",gap:1,className:"h-100",children:a(M,{alignItems:"center",justifyContent:"center",style:{padding:"4px 8px"},children:a(C,{center:!0,bold:!0,variant:"white",fontSize:3,children:r.label??(r.value!==null?r.value:"No Value")})})})})},`var-display-${t}`))})},cee=s=>{const[e,t]=d.exports.useState(null),{objectId:r=-1,videoId:i=null,videoStart:n=0,videoEnd:o=0,currentVideoState:l=null,selectedVideo:c=null,playlists:h=[],onClose:u=null,previous:g=null,next:m=null,pause:p=null,play:f=null,selectVideo:T=null}=_8(),I=A=>{if(t(A.target),r!==-1)switch(A.target.getPlayerState()){case-1:case 1:l!==1&&f();return;case 2:l!==2&&p()}};if(d.exports.useEffect(()=>{if(!(l===null||!e)){if(l===tn.PLAYING&&e.getPlayerState()!==tn.PLAYING){e.playVideo();return}if(l===tn.PAUSED&&e.getPlayerState()!==tn.PAUSED){e.pauseVideo();return}}},[l,e]),r===-1)return null;const O={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:n,end:o}};return _(Be,{className:"youtube-tv-widget",children:[a(He,{headerText:E("catalog.page.youtube_tvs"),onCloseClick:u}),a(Ge,{children:_("div",{className:"row w-100 h-100",children:[_("div",{className:"youtube-video-container col-9 overflow-hidden",children:[i&&i.length>0&&a(WU,{videoId:i,opts:O,onReady:A=>t(A.target),onStateChange:I,containerClassName:"youtubeContainer"}),(!i||i.length===0)&&a("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:E("widget.furni.video_viewer.no_videos")})]}),_("div",{className:"playlist-container col-3 d-flex flex-column",children:[_("span",{className:"playlist-controls justify-content-center d-flex",children:[a("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:g}),a("i",{className:"icon icon-youtube-next cursor-pointer",onClick:m})]}),a("div",{className:"mb-1",children:E("widget.furni.video_viewer.playlists")}),a(Bt,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:h&&h.map((A,N)=>a(yt,{onClick:P=>T(A.video),itemActive:A.video===c,children:a("b",{children:A.title})},N))})]})]})})]})},uee=s=>{const{diskInventory:e=null,addToPlaylist:t=null}=s,[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(-1),l=d.exports.useCallback((u,g)=>{u.stopPropagation(),o(m=>m===g?-1:g)},[]),c=d.exports.useCallback((u,g)=>{var m,p;u.stopPropagation(),t(g,(p=(m=mt().soundManager.musicController)==null?void 0:m.getRoomItemPlaylist())==null?void 0:p.length)},[t]),h=()=>{Le("catalog/open/"+Ms.TRAX_SONGS)};return d.exports.useEffect(()=>{var u;if(n!==-1)return(u=mt().soundManager.musicController)==null||u.playSong(n,er.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var g;(g=mt().soundManager.musicController)==null||g.stop(er.PRIORITY_SONG_PLAY)}},[n]),d.exports.useEffect(()=>()=>o(-1),[]),_(J,{children:[_("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[a("img",{src:Ee("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),a("h2",{className:"ms-4",children:E("playlist.editor.my.music")})]}),a("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:a(Bt,{columnCount:3,columnMinWidth:95,gap:1,children:e&&e.getKeys().map((u,g)=>{var T;const m=e.getKey(g),p=e.getWithIndex(g),f=(T=mt().soundManager.musicController)==null?void 0:T.getSongInfo(p);return _(yt,{itemActive:r===g,onClick:()=>i(I=>I===g?-1:g),classNames:["text-black"],children:[a("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:ZL(f==null?void 0:f.songData)}}),a(C,{truncate:!0,fullWidth:!0,className:"text-center",children:f==null?void 0:f.name}),r===g&&_(M,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[a(Y,{onClick:I=>l(I,p),variant:"light",children:a(K,{className:n===p?"pause-btn":"preview-song"})}),a(Y,{onClick:I=>c(I,m),variant:"light",children:a(K,{className:"move-disk"})})]})]},g)})})}),_("div",{className:"playlist-bottom text-black p-1",children:[a("h5",{children:E("playlist.editor.text.get.more.music")}),a("div",{children:E("playlist.editor.text.you.have.no.songdisks.available")}),a("div",{children:E("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),a("button",{className:"btn btn-primary btn-sm",onClick:()=>h(),children:E("playlist.editor.button.open.catalogue")})]}),a("img",{src:Ee("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},hee=s=>{var u,g;const{furniId:e=-1,playlist:t=null,currentPlayingIndex:r=-1,removeFromPlaylist:i=null,togglePlayPause:n=null}=s,[o,l]=d.exports.useState(-1),c=m=>{o===m&&i(m)},h=(m,p)=>{n(m,p!==-1?p:0)};return _(J,{children:[_("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[a("img",{src:Ee("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),a("h2",{className:"ms-4",children:E("playlist.editor.playlist")})]}),a("div",{className:"h-100 overflow-y-scroll py-2",children:a(M,{column:!0,gap:2,children:t&&t.map((m,p)=>_(M,{gap:1,className:"text-black cursor-pointer "+(o===p?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>l(f=>f===p?-1:p),children:[a(K,{onClick:()=>c(p),className:"disk-2 "+(o===p?"selected-song":""),style:{backgroundColor:o===p?"":ZL(m.songData)}}),m.name]},p))})}),(!t||t.length===0)&&_(J,{children:[_("div",{className:"playlist-bottom text-black p-1 ms-5",children:[a("h5",{children:E("playlist.editor.add.songs.to.your.playlist")}),a("div",{children:E("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),a("img",{src:Ee("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),t&&t.length>0&&_(J,{children:[r===-1&&a(Y,{variant:"success",size:"lg",onClick:()=>h(e,o),children:E("playlist.editor.button.play.now")}),r!==-1&&_(M,{gap:1,children:[a(Y,{variant:"danger",onClick:()=>h(e,o),children:a(K,{className:"pause-song"})}),_(M,{column:!0,children:[a(C,{bold:!0,display:"block",children:E("playlist.editor.text.now.playing.in.your.room")}),a(C,{children:((u=t[r])==null?void 0:u.name)+" - "+((g=t[r])==null?void 0:g.creator)})]})]})]})]})},dee=s=>{const{objectId:e=-1,currentPlayingIndex:t=-1,playlist:r=null,diskInventory:i=null,onClose:n=null,togglePlayPause:o=null,removeFromPlaylist:l=null,addToPlaylist:c=null}=H7();return e===-1?null:_(Be,{className:"nitro-playlist-editor-widget",theme:"primary-slim",children:[a(He,{headerText:E("playlist.editor.title"),onCloseClick:n}),a(Ge,{children:_("div",{className:"d-flex flex-row gap-1 h-100",children:[a("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:a(uee,{addToPlaylist:c,diskInventory:i})}),a("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:a(hee,{furniId:e,removeFromPlaylist:l,playlist:r,togglePlayPause:o,currentPlayingIndex:t})})]})})]})},_ee=s=>_(K,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[a(wZ,{}),a(FZ,{}),a(kZ,{}),a(GZ,{}),a(BZ,{}),a(HZ,{}),a(WZ,{}),a(jZ,{}),a(YZ,{}),a(zZ,{}),a(qZ,{}),a(dee,{}),a(XZ,{}),a(JZ,{}),a(eee,{}),a(ZZ,{}),a(aee,{}),a(oee,{}),a(xZ,{}),a(cee,{}),a(lee,{})]}),gee=s=>{const{isVisible:e=!1,errorResult:t=null,petName:r=null,objectType:i=null,onChangePetName:n=null,onConfirm:o=null,onClose:l=null}=M8();return a(J,{children:e&&_(Be,{className:"nitro-pet-package no-resize",theme:"primary-slim",children:[a(He,{center:!0,headerText:E(i==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>l()}),_(Ge,{children:[_(M,{className:"pet-package-container-top p-3",children:[a("div",{className:`package-image-${i} flex-shrink-0`}),a("div",{className:"m-2",children:a(C,{variant:"white",className:"package-text-big",children:E(i==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),a(M,{className:"pet-package-container-bottom p-2",children:_(v,{gap:1,children:[_(M,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[a("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:Ee("pet.package.name.max.length"),placeholder:E(i==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:r,onChange:c=>n(c.target.value)}),a("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),t.length>0&&a(K,{className:"invalid-feedback d-block m-0",children:t}),_(M,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[a(C,{pointer:!0,className:"text-decoration",onClick:()=>l(),children:E("cancel")}),a(jU,{variant:r.length<3?"danger":"success",disabled:r.length<3,onClick:()=>o(),children:E(i==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},mee=s=>{const[e,t]=d.exports.useState("bobba"),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(!1),{wordsFilter:l=[],isVisible:c=null,setWordsFilter:h,onClose:u=null}=C8(),{navigatorData:g=null}=Fi(),m=T=>{(n?!r:!e)||(W(new dM(g.enteredGuestRoom.roomId,T,n?r:e)),i(""),t("bobba"),o(!1),!(T&&l.includes(n?r:e))&&h(I=>{const O=[...I];return T?O.push(n?r:e):O.splice(O.indexOf(n?r:e),1),O}))},p=T=>{t(T),o(!1)},f=T=>{i(T),o(!0)};return c?_(Be,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[a(He,{headerText:E("navigator.roomsettings.roomfilter"),onCloseClick:()=>u()}),_(Ge,{className:"text-black",children:[_(qe,{className:"d-flex align-items-center justify-content-end gap-2",children:[a("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:e,onChange:T=>p(T.target.value)}),a(Y,{onClick:()=>m(!0),children:E("navigator.roomsettings.roomfilter.addword")})]}),a(v,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:l&&l.length>0&&l.map((T,I)=>a(M,{alignItems:"center",className:bo("rounded p-1",r===T&&"bg-muted"),pointer:!0,onClick:O=>f(T),children:a(C,{truncate:!0,children:T})},I))}),a(qe,{className:"d-flex align-items-center justify-content-end gap-2",children:a(Y,{variant:"danger",onClick:()=>m(!1),disabled:l.length===0||!n,children:E("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},fee=s=>{const[e,t]=d.exports.useState(!1),{roomSession:r=null}=Yt();Cs([Sn.SHOW_THUMBNAIL,Sn.HIDE_THUMBNAIL,Sn.TOGGLE_THUMBNAIL],n=>{switch(n.type){case Sn.SHOW_THUMBNAIL:t(!0);return;case Sn.HIDE_THUMBNAIL:t(!1);return;case Sn.TOGGLE_THUMBNAIL:t(o=>!o);return}});const i=n=>{te().saveTextureAsScreenshot(n,!0),t(!1)};return e?a(SX,{roomId:r.roomId,textureReceiver:i,onClose:()=>t(!1)}):null},pee=s=>{var y,D,x,w;const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(null),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(!1),[g,m]=d.exports.useState(!1),[p,f]=d.exports.useState(!0),[T,I]=d.exports.useState([]),{navigatorData:O=null}=Fi(),{roomSession:A=null}=Yt(),N=(k,F)=>{switch(k){case"settings":Le("navigator/toggle-room-info");return;case"zoom":t(L=>{let B=te().getRoomInstanceRenderingCanvasScale(A.roomId,1);return L?B*=2:B/=2,te().setRoomInstanceRenderingCanvasScale(A.roomId,1,B),!L});return;case"chat_history":Le("chat-history/toggle");return;case"like_room":W(new cM(1));return;case"toggle_room_link":Le("navigator/toggle-room-link");return;case"navigator_search_tag":Le(`navigator/search/${F}`),W(new gl("hotel_view",`tag:${F}`));return;case"room_history":T.length>0&&m(L=>!L);return;case"room_history_back":Wr(T[T.findIndex(L=>L.roomId===O.currentRoomId)-1].roomId);return;case"room_history_next":Wr(T[T.findIndex(L=>L.roomId===O.currentRoomId)+1].roomId);return}},P=(k,F)=>{let L=JSON.parse(window.localStorage.getItem("nitro.room.history"));if(L&&L.filter(V=>V.roomId===k).length>0)return;L&&L.length>=10&&L.shift();const B=L?[...L,{roomId:k,roomName:F}]:[{roomId:k,roomName:F}];return I(B),II("nitro.room.history",B)};return j(wa,k=>{const F=k.getParser();!F.roomEnter||F.data.roomId!==A.roomId||(r!==F.data.roomName&&i(F.data.roomName),n!==F.data.ownerName&&o(F.data.ownerName),l!==F.data.tags&&c(F.data.tags),P(F.data.roomId,F.data.roomName))}),d.exports.useEffect(()=>{const k=()=>{JSON.parse(window.localStorage.getItem("nitro.room.history"))&&window.localStorage.removeItem("nitro.room.history")};return window.addEventListener("beforeunload",k),()=>{window.removeEventListener("beforeunload",k)}},[]),d.exports.useEffect(()=>{u(!0);const k=setTimeout(()=>u(!1),5e3);return()=>clearTimeout(k)},[r,n,l,p]),d.exports.useEffect(()=>{I(JSON.parse(window.localStorage.getItem("nitro.room.history"))??[])},[]),_(M,{className:"nitro-room-tools-container",gap:2,children:[a("div",{className:"btn-toggle toggle-roomtool d-flex align-items-center",onClick:()=>f(!p),children:a("div",{className:"toggle-icon "+(p?"left":"right")})}),p&&_(J,{children:[_(v,{gap:0,center:!0,className:"nitro-room-tools p-3 px-3",children:[_(M,{children:[_(v,{center:!0,className:"margin-icons p-2",children:[a(K,{pointer:!0,title:E("room.settings.button.text"),className:"icon icon-cog",onClick:()=>N("settings")}),a(K,{pointer:!0,title:E("room.zoom.button.text"),onClick:()=>N("zoom"),className:bo("icon",!e&&"icon-zoom-less",e&&"icon-zoom-more")}),a(K,{pointer:!0,title:E("room.chathistory.button.text"),onClick:()=>N("chat_history"),className:"icon icon-chat-history"}),O.canRate&&a(K,{pointer:!0,title:E("room.like.button.text"),onClick:()=>N("like_room"),className:"icon icon-like-room"}),a(K,{pointer:!0,onClick:()=>N("toggle_room_link"),className:"icon icon-room-link"})]}),_(v,{children:[a(M,{className:"w-100 room-tool-item",children:a(C,{variant:"muted",underline:!0,small:!0,onClick:()=>N("settings"),children:E("room.settings.button.text")})}),a(M,{className:"w-100 room-tool-item",children:a(C,{variant:"muted",underline:!0,small:!0,onClick:()=>N("zoom"),children:E("room.zoom.button.text")})}),a(M,{className:"w-100 room-tool-item",children:a(C,{variant:"muted",underline:!0,small:!0,onClick:()=>N("chat_history"),children:E("room.chathistory.button.text")})}),O.canRate&&a(M,{className:"w-100 room-tool-item",children:a(C,{variant:"muted",underline:!0,small:!0,onClick:()=>N("like_room"),children:E("room.like.button.text")})}),a(M,{className:"w-100 room-tool-item",children:a(C,{variant:"muted",underline:!0,small:!0,onClick:()=>N("toggle_room_link"),children:E("navigator.embed.caption")})})]})]}),_(M,{justifyContent:"center",children:[a(K,{pointer:T.length>1&&((y=T[0])==null?void 0:y.roomId)!==O.currentRoomId,title:E("room.history.button.back.tooltip"),className:`icon ${(T==null?void 0:T.length)===0||((D=T[0])==null?void 0:D.roomId)===O.currentRoomId?"icon-room-history-back-disabled":"icon-room-history-back-enabled"}`,onClick:()=>{var k;return(T==null?void 0:T.length)===0||((k=T[0])==null?void 0:k.roomId)===O.currentRoomId?null:N("room_history_back")}}),a(K,{pointer:(T==null?void 0:T.length)>0,title:E("room.history.button.tooltip"),className:`icon ${(T==null?void 0:T.length)===0?"icon-room-history-disabled":"icon-room-history-enabled"} margin-button-history`,onClick:()=>(T==null?void 0:T.length)===0?null:N("room_history")}),a(K,{pointer:T.length>1&&((x=T[T.length-1])==null?void 0:x.roomId)!==O.currentRoomId,title:E("room.history.button.forward.tooltip"),className:`icon ${(T==null?void 0:T.length)===0||((w=T[T.length-1])==null?void 0:w.roomId)===O.currentRoomId?"icon-room-history-next-disabled":"icon-room-history-next-enabled"}`,onClick:()=>{var k;return(T==null?void 0:T.length)===0||((k=T[T.length-1])==null?void 0:k.roomId)===O.currentRoomId?null:N("room_history_next")}})]})]}),a(M,{className:"nitro-room-tools-history",style:{bottom:O.canRate?"210px":"180px"},children:a(Pc,{type:Ys.SLIDE_LEFT,inProp:g,children:a(v,{center:!0,children:a(v,{className:"nitro-room-history rounded py-2 px-3",children:a(v,{gap:1,children:T.length>0&&T.map(k=>a(C,{bold:k.roomId===O.currentRoomId,variant:k.roomId===O.currentRoomId?"white":"muted",pointer:!0,onClick:()=>Wr(k.roomId),children:k.roomName},k.roomId))})})})})}),a(v,{justifyContent:"center",children:a(Pc,{type:Ys.SLIDE_LEFT,inProp:h,timeout:300,children:a(v,{center:!0,children:_(v,{className:"nitro-room-tools-info rounded py-2 px-3",children:[_(v,{gap:1,children:[a(C,{wrap:!0,variant:"white",fontSize:4,children:r}),a(C,{variant:"muted",fontSize:5,children:n})]}),l&&l.length>0&&a(M,{gap:2,children:l.map((k,F)=>_(C,{small:!0,pointer:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>N("navigator_search_tag",k),children:["#",k]},F))})]})})})})]})]})},Eee=s=>{const{question:e=null,canVote:t=null,vote:r=null,noVotes:i=null,yesVotes:n=null}=s;return _(v,{gap:2,className:"wordquiz-question p-2",children:[!t&&_(M,{fullWidth:!0,alignItems:"center",gap:2,children:[a(M,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:a(C,{variant:"white",children:i})}),a(C,{variant:"white",center:!0,textBreak:!0,children:e}),a(M,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:a(C,{variant:"white",children:n})})]}),t&&_(v,{children:[a(C,{variant:"white",center:!0,textBreak:!0,children:e}),_(M,{fullWidth:!0,justifyContent:"center",gap:1,children:[a(M,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:o=>r(g_),children:a(K,{className:"word-quiz-dislike"})}),a(M,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:o=>r(e0),children:a(K,{className:"word-quiz-like"})})]})]})]})},Iee=s=>{const{userIndex:e=null,vote:t=null,...r}=s;return a(Ag,{objectId:e,category:z.UNIT,...r,children:a(M,{center:!0,pointer:!0,className:`bg-${t===g_?"danger":"success"} rounded p-1`,children:a(K,{className:`word-quiz-${t===g_?"dislike":"like"}-sm`})})})},Tee=s=>{const{question:e=null,answerSent:t=!1,answerCounts:r=null,userAnswers:i=null,vote:n=null}=F8();return _(J,{children:[e&&a(Eee,{question:e.content,canVote:!t,vote:n,noVotes:r.get(g_)||0,yesVotes:r.get(e0)||0}),i&&Array.from(i.entries()).map(([o,l],c)=>a(Iee,{userIndex:o,vote:l.value},c))]})},Ree=s=>{const{roomSession:e=null}=Yt(),{simpleAlert:t=null}=$t();return _t(Ld.ROOM_ZOOM,r=>te().setRoomInstanceRenderingCanvasScale(r.roomId,1,r.level,null,null,!1,r.asDelta)),_t([ne.REQUEST_TEASER,ne.REQUEST_ECOTRONBOX,ne.REQUEST_CLOTHING_CHANGE,ne.REQUEST_PLAYLIST_EDITOR,ne.OPEN_WIDGET,ne.CLOSE_WIDGET,Ji.FURNI_CLICK,Ji.FURNI_DOUBLE_CLICK,Ji.TOOLTIP_SHOW,Ji.TOOLTIP_HIDE],r=>{if(e)switch(r.objectId,r.category,r.type){}}),es([ot.RSEME_KICKED,ot.RSEME_PETS_FORBIDDEN_IN_HOTEL,ot.RSEME_PETS_FORBIDDEN_IN_FLAT,ot.RSEME_MAX_PETS,ot.RSEME_MAX_NUMBER_OF_OWN_PETS,ot.RSEME_NO_FREE_TILES_FOR_PET,ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,ot.RSEME_BOTS_FORBIDDEN_IN_HOTEL,ot.RSEME_BOTS_FORBIDDEN_IN_FLAT,ot.RSEME_BOT_LIMIT_REACHED,ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,ot.RSEME_BOT_NAME_NOT_ACCEPTED],r=>{let i=E("error.title"),n="";switch(r.type){case ot.RSEME_MAX_PETS:n=E("room.error.max_pets");break;case ot.RSEME_MAX_NUMBER_OF_OWN_PETS:n=E("room.error.max_own_pets");break;case ot.RSEME_KICKED:n=E("room.error.kicked"),i=E("generic.alert.title");break;case ot.RSEME_PETS_FORBIDDEN_IN_HOTEL:n=E("room.error.pets.forbidden_in_hotel");break;case ot.RSEME_PETS_FORBIDDEN_IN_FLAT:n=E("room.error.pets.forbidden_in_flat");break;case ot.RSEME_NO_FREE_TILES_FOR_PET:n=E("room.error.pets.no_free_tiles");break;case ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:n=E("room.error.pets.selected_tile_not_free");break;case ot.RSEME_BOTS_FORBIDDEN_IN_HOTEL:n=E("room.error.bots.forbidden_in_hotel");break;case ot.RSEME_BOTS_FORBIDDEN_IN_FLAT:n=E("room.error.bots.forbidden_in_flat");break;case ot.RSEME_BOT_LIMIT_REACHED:n=E("room.error.max_bots");break;case ot.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:n=E("room.error.bots.selected_tile_not_free");break;case ot.RSEME_BOT_NAME_NOT_ACCEPTED:n=E("room.error.bots.name.not.accepted");break;default:return}t(n,Ze.DEFAULT,null,null,i)}),_(J,{children:[a(mZ,{}),a(RZ,{}),a(pZ,{}),a(CZ,{}),a(_ee,{}),a(pee,{}),a(mee,{}),a(fee,{}),a(SZ,{}),a(gee,{}),a(OZ,{}),a(Tee,{}),a(NZ,{})]})},See=s=>{const{roomSession:e=null}=Yt(),t=d.exports.useRef();return d.exports.useEffect(()=>{const r=mt().application.renderer.view;if(!r)return;r.onclick=n=>Mh(n),r.onmousemove=n=>Mh(n),r.onmousedown=n=>Mh(n),r.onmouseup=n=>Mh(n),r.ontouchstart=n=>Lh(n),r.ontouchmove=n=>Lh(n),r.ontouchend=n=>Lh(n),r.ontouchcancel=n=>Lh(n);const i=t.current;i&&i.appendChild(r)},[]),a(K,{fit:!0,innerRef:t,className:!e&&"d-none",children:e&&_(J,{children:[a(Ree,{}),e.isSpectator&&a(YJ,{})]})})},Oee=s=>{const{useGuideTool:e=!1,unseenAchievementCount:t=0,setMeExpanded:r=null,children:i=null,...n}=s,o=d.exports.useRef();return d.exports.useEffect(()=>{const l=bt();l&&te().selectRoomObject(l.roomId,l.ownRoomIndex,z.UNIT)},[]),d.exports.useEffect(()=>{const l=c=>r(!1);return document.addEventListener("click",l),()=>document.removeEventListener(fe.MOUSE_CLICK,l)},[r]),_(M,{innerRef:o,alignItems:"center",className:"nitro-toolbar-me p-2",gap:3,children:[Ee("guides.enabled")&&e&&_(v,{gap:1,alignItems:"center",onClick:l=>zs(new Mr(Mr.TOGGLE_GUIDE_TOOL)),children:[a(K,{pointer:!0,className:"navigation-item icon icon-me-helper-tool"}),a(C,{className:"me-text",children:E("widget.memenu.guide")})]}),_(v,{gap:1,alignItems:"center",onClick:l=>Le("achievements/toggle"),children:[a(K,{pointer:!0,className:"navigation-item icon icon-me-achievements",children:t>0&&a(nn,{count:t})}),a(C,{className:"me-text",children:E("widget.memenu.achievements")})]}),_(v,{gap:1,alignItems:"center",onClick:l=>ri(ie().userId),children:[a(K,{pointer:!0,className:"navigation-item icon icon-me-profile"}),a(C,{className:"me-text",children:E("widget.memenu.profile")})]}),_(v,{gap:1,alignItems:"center",onClick:l=>Le("navigator/search/myworld_view"),children:[a(K,{pointer:!0,className:"navigation-item icon icon-me-rooms"}),a(C,{className:"me-text",children:E("widget.memenu.myrooms")})]}),_(v,{gap:1,alignItems:"center",onClick:l=>Le("avatar-editor/toggle"),children:[a(K,{pointer:!0,className:"navigation-item icon icon-me-clothing"}),a(C,{className:"me-text",children:E("widget.memenu.myclothes")})]}),i]})},Cee=new Set(["wf_trg_mobi_ssortants"]),GR=s=>s?Cee.has(s.toLowerCase()):!1,Aee=s=>{const{isInRoom:e}=s,[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(!1),u=d.exports.useRef(new Set),{userFigure:g=null}=za(),{getFullCount:m=0}=Ci(),{getTotalUnseen:p=0}=fg(),{requests:f=[]}=Oi(),{iconState:T=Nn.HIDDEN}=R0(),{roomSession:I=null}=Yt(),O=ie().isModerator,A=d.exports.useCallback(()=>{if(!I){u.current.clear(),h(!1);return}const N=te();if(!N){u.current.clear(),h(!1);return}const P=I.roomId,y=N.getRoomObjectCount(P,z.FLOOR)||0,D=new Set;for(let x=0;x<y;x++){const w=N.getRoomObjectByIndex(P,x,z.FLOOR);w&&GR(w.type)&&D.add(w.id)}u.current=D,h(D.size>0)},[I]);return d.exports.useEffect(()=>{if(!I){u.current.clear(),h(!1);return}A()},[I,A]),j(aE,N=>{const P=N.getParser();n(P.isAllowed(Si.USE_GUIDE_TOOL))}),_t(Dd.ANIMATE_ICON,N=>{((y,D,x,w)=>{const k=document.body.getElementsByClassName(y)[0];if(!k)return;D.className="toolbar-icon-animation",D.style.visibility="visible",D.style.left=x+"px",D.style.top=w+"px",document.body.append(D);const F=k.getBoundingClientRect(),L=D.getBoundingClientRect(),B=L.x-F.x,V=L.y-F.y,q=Math.sqrt(B*B+V*V),Z=500-Math.abs(1/q*100*500*.5),H=20,X=`ToolbarBouncing_${y}`;So.getMotionByTag(X)||(So.runMotion(new uT(new rq(Z+8),new J6(k,400,12))).tag=X);const ee=new uT(new tq(new sq(D,Z,F.x-L.x+H,F.y-L.y,100,1),1),new $6(D));So.runMotion(ee)})("icon-inventory",N.image,N.x,N.y)}),_t(lt.INITIALIZED,N=>{!I||N.roomId!==I.roomId||A()}),_t(lt.DISPOSED,N=>{!I||N.roomId!==I.roomId||(u.current.clear(),h(!1))}),_t([ye.ADDED,ye.REMOVED],N=>{if(!(!I||N.roomId!==I.roomId||N.category!==z.FLOOR)){if(N.type===ye.ADDED){const P=te();if(!P)return;const y=P.getRoomObject(N.roomId,N.objectId,N.category);y&&GR(y.type)&&(u.current.add(N.objectId),h(!0));return}if(N.type===ye.REMOVED){if(!u.current.size)return;u.current.delete(N.objectId),u.current.size||h(!1)}}}),j(Gu,N=>{if(!I)return;const P=N.getParser().controllerLevel;l(P>=Rt.GUEST||I.isRoomOwner||O)}),j(ku,N=>{I&&l(I.isRoomOwner||O)}),j(Hd,N=>{l(!0)}),d.exports.useEffect(()=>{if(!I){l(!1);return}l(I.isRoomOwner||O||I.controllerLevel>=Rt.GUEST)},[I,O]),d.exports.useEffect(()=>{if(!c||!I)return;const N=P=>{let y="";if(window.vimKeysEnabled)switch(P.key.toLowerCase()){case"h":y="h";break;case"j":y="j";break;case"k":y="k";break;case"l":y="l";break;case" ":y="space";break;default:return}else if(["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","w","W","s","S","a","A","d","D"," ","Alt","Control","Shift"].includes(P.key))y=P.key===" "?"space":P.key.toLowerCase();else return;W(new jM(y))};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[c,I]),_(J,{children:[a(Pc,{type:Ys.FADE_IN,inProp:t,timeout:300,children:a(Oee,{useGuideTool:i,unseenAchievementCount:p,setMeExpanded:r})}),_(M,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[_(M,{gap:2,alignItems:"center",children:[_(M,{alignItems:"center",gap:2,children:[_(M,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(t?"active ":""),onClick:()=>r(!t),children:[a(Ts,{figure:g,direction:2,position:"absolute"}),p>0&&a(nn,{count:p})]}),e&&a(K,{pointer:!0,className:"navigation-item icon icon-habbo",onClick:()=>dI()}),!e&&a(K,{pointer:!0,className:"navigation-item icon icon-house",onClick:()=>Le("navigator/goto/home")}),a(K,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:()=>Le("navigator/toggle")}),Ee("game.center.enabled")&&a(K,{pointer:!0,className:"navigation-item icon icon-game",onClick:()=>Le("games/toggle")}),a(K,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:()=>Le("catalog/toggle")}),a(K,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:()=>Le("inventory/toggle"),children:m>0&&a(nn,{count:m})}),e&&a(K,{pointer:!0,className:"navigation-item icon icon-camera",onClick:()=>Le("camera/toggle")}),o&&e&&a(K,{pointer:!0,className:"navigation-item icon icon-wired-monitor",onClick:()=>Le("wired-monitor/toggle")}),O&&a(K,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:()=>Le("mod-tools/toggle")})]}),a(M,{alignItems:"center",id:"toolbar-chat-input-container"})]}),_(M,{alignItems:"center",gap:2,children:[_(M,{gap:2,children:[a(K,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:()=>Le("friends/toggle"),children:f.length>0&&a(nn,{count:f.length})}),(T===Nn.SHOW||T===Nn.UNREAD)&&a(K,{pointer:!0,className:`navigation-item icon icon-message ${T===Nn.UNREAD&&"is-unseen"}`,onClick:()=>dg()})]}),a(K,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"})]})]})]})},Nee=s=>{const{badges:e=null,gap:t=1,justifyContent:r="between",...i}=s;return a(J,{children:e&&e.length>0&&e.map((n,o)=>a(v,{center:!0,children:a(as,{badgeCode:n},n)},n))})},bee=s=>{const{relationships:e=null}=s,t=({type:r})=>{const i=e&&e.relationshipStatusMap.hasKey(r)?e.relationshipStatusMap.getValue(r):null,n=Jr.RELATIONSHIP_NAMES[r].toLocaleLowerCase();return _(M,{fullWidth:!0,gap:1,children:[a(M,{center:!0,className:"user-relationship",children:a("i",{className:`nitro-friends-spritesheet icon-${n}`})}),_(v,{grow:!0,gap:0,children:[_(M,{alignItems:"center",justifyContent:"between",className:"profile-white-bg px-2 py-1 user-relationship",children:[_(C,{small:!0,underline:!0,pointer:!0,onClick:o=>i&&i.randomFriendId>=1&&ri(i.randomFriendId),children:[(!i||i.friendCount===0)&&E("extendedprofile.add.friends"),i&&i.friendCount>=1&&i.randomFriendName]}),i&&i.friendCount>=1&&a(M,{center:!0,position:"relative",className:"avatar-image-container",children:a(Ts,{figure:i.randomFriendFigure,headOnly:!0,direction:4})})]}),_(C,{small:!0,italics:!0,className:"user-relationship-count",children:[(!i||i.friendCount===0)&&E("extendedprofile.no.friends.in.this.category"),i&&i.friendCount>1&&E(`extendedprofile.relstatus.others.${n}`,["count"],[(i.friendCount-1).toString()]),""]})]})]})};return _(J,{children:[a(t,{type:Jr.HEART}),a(t,{type:Jr.SMILE}),a(t,{type:Jr.BOBBA})]})},yee=s=>{const{relationships:e=null,friendsCount:t=null}=s;return _(v,{gap:1,children:[_(C,{small:!0,children:[a("b",{children:E("extendedprofile.friends.count")})," ",t]}),a(C,{bold:!0,small:!0,children:E("extendedprofile.relstatus")}),a(v,{children:a(bee,{relationships:e})})]})},vee=s=>{const{itsMe:e=null,groups:t=null,onLeaveGroup:r=null,overflow:i="hidden",gap:n=2,...o}=s,[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(null);return j(kc,g=>{const m=g.getParser();!l||l!==m.id||m.flag||u(m)}),d.exports.useEffect(()=>{l&&W(new Rc(l,!1))},[l]),d.exports.useEffect(()=>{u(null),t.length>0&&c(g=>(g===t[0].groupId&&W(new Rc(t[0].groupId,!1)),t[0].groupId))},[t]),!t||!t.length?a(v,{center:!0,fullHeight:!0,children:_(v,{className:"profile-grey-bg py-3 px-4",children:[_(C,{small:!0,children:[" ",E("extendedprofile.nogroups.user")]}),_(M,{justifyContent:"center",gap:4,children:[a(K,{className:"no-group-spritesheet image-1"}),a(K,{className:"no-group-spritesheet image-2"}),a(K,{className:"no-group-spritesheet image-3"})]}),a(C,{small:!0,children:E("extendedprofile.nogroups.info")})]})}):_(qe,{overflow:i,gap:2,...o,children:[a(v,{alignItems:"center",size:2,overflow:"auto",children:a(Bt,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:t.map((g,m)=>_(yt,{overflow:"unset",itemActive:l===g.groupId,onClick:()=>c(g.groupId),className:"p-1",children:[e&&a("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(g.favourite?"favorite":"not-favorite"),onClick:()=>Jq(g)}),a(as,{badgeCode:g.badgeCode,isGroup:!0})]},m))})}),a(v,{size:10,overflow:"hidden",children:h&&a(W0,{groupInformation:h,onClose:r})})]})},Mee=s=>{const{userProfile:e=null}=s,[t,r]=d.exports.useState(e.requestSent),i=e.id===ie().userId,n=!t&&!i&&!e.isMyFriend&&!e.requestSent,o=()=>{r(!0),W(new IE(e.username))};return d.exports.useEffect(()=>{r(e.requestSent)},[e]),_(M,{gap:2,children:[a(v,{center:!0,className:"avatar-container",children:a(Ts,{figure:e.figure,direction:2})}),_(v,{children:[_(v,{gap:0,children:[a(C,{bold:!0,small:!0,children:e.username}),_(C,{italics:!0,textBreak:!0,small:!0,children:[e.motto,""]})]}),_(v,{gap:1,children:[_(C,{small:!0,children:[a("b",{children:E("extendedprofile.created")})," ",e.registration]}),_(C,{small:!0,children:[a("b",{children:E("extendedprofile.last.login")})," ",Or.format(e.secondsSinceLastVisit,".ago",2)]}),_(C,{small:!0,children:[a("b",{children:E("extendedprofile.achievementscore")})," ",e.achievementPoints]})]}),_(M,{gap:1,children:[e.isOnline&&a("i",{className:"icon icon-pf-online"}),!e.isOnline&&a("i",{className:"icon icon-pf-offline"}),_(M,{alignItems:"center",gap:1,children:[n&&a(C,{small:!0,underline:!0,pointer:!0,onClick:o,children:E("extendedprofile.addasafriend")}),!n&&_(J,{children:[a("i",{className:"icon icon-pf-tick"}),i&&a(C,{bold:!0,small:!0,children:E("extendedprofile.me")}),e.isMyFriend&&a(C,{children:E("extendedprofile.friend")}),(t||e.requestSent)&&a(C,{children:E("extendedprofile.friendrequestsent")})]})]})]})]})]})},Dee=s=>{const[e,t]=d.exports.useState(null),[r,i]=d.exports.useState([]),[n,o]=d.exports.useState(null),l=()=>{t(null),i([]),o(null)},c=()=>{!e||e.id!==ie().userId||ri(e.id)};return j(_E,h=>{const u=h.getParser();!e||u.userId!==e.id||i(u.badges)}),j(dE,h=>{const u=h.getParser();!e||u.userId!==e.id||o(u)}),j(Pb,h=>{const u=h.getParser();let g=!1;t(m=>(m&&m.id&&(g=m.id===u.id),u)),g||(i([]),o(null)),W(new UE(u.id)),W(new wE(u.id))}),j(xb,h=>{const u=h.getParser();u.userId==(e==null?void 0:e.id)&&ri(u.userId)}),_t(ye.SELECTED,h=>{if(!e||h.category!==z.UNIT)return;const u=bt().userDataManager.getUserDataByIndex(h.objectId);u.type===jt.USER&&ri(u.webID)}),e?_(Be,{uniqueKey:"nitro-user-profile",theme:"primary",className:"user-profile",children:[a(He,{headerText:E("extendedprofile.caption"),onCloseClick:l}),_(Ge,{overflow:"hidden",children:[_(qe,{fullHeight:!1,gap:2,children:[_(v,{size:7,gap:1,className:"user-container pe-2",children:[a(Mee,{userProfile:e}),e.id===ie().userId&&_(M,{className:"p-0",children:[a(C,{small:!0,underline:!0,className:"cursor-pointer",onClick:h=>Le("avatar-editor/toggle"),children:"Change Clothes"}),a(C,{className:"cursor-pointer badge-text",small:!0,underline:!0,onClick:h=>Le("inventory/toggle"),children:"Change Badges"})]}),a(qe,{columnCount:5,fullHeight:!0,className:"profile-grey-bg p-1",children:a(Nee,{fullWidth:!0,center:!0,badges:r})})]}),a(v,{size:5,children:n&&a(yee,{relationships:n,friendsCount:e.friendsCount})})]}),a(M,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:_(M,{alignItems:"center",gap:1,onClick:h=>Le(`navigator/search/hotel_view/owner:${e.username}`),children:[a("i",{className:"icon icon-rooms"}),a(C,{bold:!0,small:!0,underline:!0,pointer:!0,children:E("extendedprofile.rooms")})]})}),a(vee,{fullWidth:!0,itsMe:e.id===ie().userId,groups:e.groups,onLeaveGroup:c})]})]}):null},Pee=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(null),[n,o]=I0(),[l,c]=T0(),h=(g,m)=>{let p=!0;const f=r.clone();switch(g){case"close_view":t(!1),p=!1;return;case"oldchat":f.oldChat=m,W(new lP(f.oldChat));break;case"room_invites":f.roomInvites=m,W(new cP(f.roomInvites));break;case"camera_follow":f.cameraFollow=m,W(new oP(f.cameraFollow));break;case"system_volume":f.volumeSystem=m,f.volumeSystem=Math.max(0,f.volumeSystem),f.volumeSystem=Math.min(100,f.volumeSystem);break;case"furni_volume":f.volumeFurni=m,f.volumeFurni=Math.max(0,f.volumeFurni),f.volumeFurni=Math.min(100,f.volumeFurni);break;case"trax_volume":f.volumeTrax=m,f.volumeTrax=Math.max(0,f.volumeTrax),f.volumeTrax=Math.min(100,f.volumeTrax);break}p&&i(f),zf(f)},u=g=>{switch(g){case"volume":W(new uP(Math.round(r.volumeSystem),Math.round(r.volumeFurni),Math.round(r.volumeTrax)));break}};return j(gE,g=>{const m=g.getParser(),p=new ul;p.volumeSystem=m.volumeSystem,p.volumeFurni=m.volumeFurni,p.volumeTrax=m.volumeTrax,p.oldChat=m.oldChat,p.roomInvites=m.roomInvites,p.cameraFollow=m.cameraFollow,p.flags=m.flags,p.chatType=m.chatType,i(p),zf(p)}),d.exports.useEffect(()=>{const g={linkReceived:m=>{const p=m.split("/");if(!(p.length<2))switch(p[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(f=>!f);return}},eventUrlPrefix:"user-settings/"};return xs(g),()=>ws(g)},[]),d.exports.useEffect(()=>{r&&zs(r)},[r]),!e||!r?null:_(Be,{uniqueKey:"user-settings",className:"user-settings-window",theme:"settings",children:[a(He,{headerText:E("widget.memenu.settings.title"),onCloseClick:g=>h("close_view")}),_(Ge,{gap:3,className:"text-white",children:[_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"flash-form-check-input",type:"checkbox",checked:r.oldChat,onChange:g=>h("oldchat",g.target.checked)}),a(C,{children:E("memenu.settings.chat.prefer.old.chat")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"flash-form-check-input",type:"checkbox",checked:r.roomInvites,onChange:g=>h("room_invites",g.target.checked)}),a(C,{children:E("memenu.settings.other.ignore.room.invites")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"flash-form-check-input",type:"checkbox",checked:r.cameraFollow,onChange:g=>h("camera_follow",g.target.checked)}),a(C,{children:E("memenu.settings.other.disable.room.camera.follow")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"flash-form-check-input",type:"checkbox",checked:n,onChange:g=>o(g.target.checked)}),a(C,{children:E("memenu.settings.other.place.multiple.objects")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"flash-form-check-input",type:"checkbox",checked:l,onChange:g=>c(g.target.checked)}),a(C,{children:E("memenu.settings.other.skip.purchase.confirmation")})]})]}),_(v,{children:[a(C,{center:!0,children:E("widget.memenu.settings.volume")}),_(M,{gap:2,children:[a(C,{className:"w-25",children:E("widget.memenu.settings.volume.ui")}),_(M,{alignItems:"center",gap:1,children:[a("i",{className:r.volumeSystem>1?"icon icon-sound-off":"icon icon-sound-off-active"}),_(v,{gap:0,children:[a(M,{className:"number-range"}),a("input",{type:"range",className:"custom-range",min:"0",max:"100",step:"1",id:"volumeSystem",value:r.volumeSystem,onChange:g=>h("system_volume",g.target.value),onMouseUp:()=>u("volume")})]}),a("i",{className:r.volumeSystem<1?"icon icon-sound-on":"icon icon-sound-on-active"})]})]}),_(M,{gap:2,children:[a(C,{className:"w-25",children:E("widget.memenu.settings.volume.furni")}),_(M,{alignItems:"center",gap:1,children:[a("i",{className:r.volumeFurni>1?"icon icon-sound-off":"icon icon-sound-off-active"}),_(v,{gap:0,children:[a(M,{className:"number-range"}),a("input",{type:"range",className:"custom-range",min:"0",max:"100",step:"1",id:"volumeFurni",value:r.volumeFurni,onChange:g=>h("furni_volume",g.target.value),onMouseUp:()=>u("volume")})]}),a("i",{className:r.volumeFurni<1?"icon icon-sound-on":"icon icon-sound-on-active"})]})]}),_(M,{gap:2,children:[a(C,{className:"w-25",children:E("widget.memenu.settings.volume.trax")}),_(M,{alignItems:"center",gap:1,children:[a("i",{className:r.volumeTrax>1?"icon icon-sound-off":"icon icon-sound-off-active"}),_(v,{gap:0,children:[a(M,{className:"number-range"}),a("input",{type:"range",className:"custom-range",min:"0",max:"100",step:"1",id:"volumeTrax",value:r.volumeTrax,onChange:g=>h("trax_volume",g.target.value),onMouseUp:()=>u("volume")})]}),a("i",{className:r.volumeTrax<1?"icon icon-sound-on":"icon icon-sound-on-active"})]})]})]}),a(M,{alignItems:"end",children:a(Y,{onClick:g=>h("close_view"),children:E("generic.back")})})]})]})},Lee=s=>{const{roomData:e,handleChange:t,isOwner:r=!1}=s,[i,n]=d.exports.useState("users_with_rights"),[o,l]=d.exports.useState("everyone");return d.exports.useEffect(()=>{e&&(e.modify_wired===0?n("users_with_rights"):e.modify_wired===1?n("nobody"):n("users_with_rights"),e.inspect_wired===0?l("everyone"):e.inspect_wired===1?l("users_with_rights"):e.inspect_wired===2?l("nobody"):l("everyone"))},[e]),_(M,{className:"global-grid",column:!0,gap:4,style:{justifyContent:"center",alignItems:"center",height:"100%"},children:["jeje diseo provisional",_(M,{column:!0,gap:2,style:{width:"80%",backgroundColor:"#f0f0f0",padding:"16px",borderRadius:"8px"},children:[a(C,{bold:!0,children:"Room settings:"}),_(M,{column:!0,gap:2,children:[_(M,{column:!0,style:{flex:1},children:[a(C,{children:"Who can modify Wired:"}),_("select",{value:i,onChange:u=>{if(!r)return;const g=u.target.value;n(g);const m=g==="users_with_rights"?0:1;t==null||t("modify_wired",m)},disabled:!r,style:{width:"100%"},children:[a("option",{value:"users_with_rights",children:"Users with rights"}),a("option",{value:"nobody",children:"Nobody"})]})]}),_(M,{column:!0,style:{flex:1},children:[a(C,{children:"Who can inspect Wired:"}),_("select",{value:o,onChange:u=>{if(!r)return;const g=u.target.value;l(g);const m=g==="everyone"?0:g==="users_with_rights"?1:2;t==null||t("inspect_wired",m)},disabled:!r,style:{width:"100%"},children:[a("option",{value:"everyone",children:"Everyone"}),a("option",{value:"users_with_rights",children:"Users with rights"}),a("option",{value:"nobody",children:"Nobody"})]})]})]})]})]})};const Uee=s=>{const{roomPreviewer:e=null}=s,[t,r]=d.exports.useState("furni"),[i,n]=d.exports.useState(new Map),[o,l]=d.exports.useState(new Map),[c,h]=d.exports.useState(new Map),[u,g]=d.exports.useState(null),[m,p]=d.exports.useState(null),[f,T]=d.exports.useState(!1),[I,O]=d.exports.useState(null),A=d.exports.useRef(null),N=d.exports.useRef(null),P=d.exports.useRef(null),y=d.exports.useRef(null),D=d.exports.useRef(null),x=d.exports.useRef(null),w=d.exports.useRef(!1),k=t==="entity"?o:t==="global"?c:i,F=t==="entity"?m!==null:t==="furni"?u!==null:!1,L=t!=="global",B=()=>{W(new vf(!0)),w.current=!0},V=()=>{w.current&&(W(new vf(!1)),w.current=!1)},q=de=>{if(de){if(de==="global"){V();return}W(de==="furni"?new yf(!1):new Mf(!1))}},Z=de=>{if(!e||!de)return;const ve=c_(de,"s");ve&&(e.reset(!1),e.updateObjectRoom("101","101","1.1"),e.updateRoomWallsAndFloorVisibility(!0,!0),e.addFurnitureIntoRoom(de,new G(90),ve,""),e.updatePreviewRoomView())},H=de=>{const ve=de.toLowerCase();return de.indexOf(" ")>=0||ve.startsWith("pet")||ve.startsWith("mnstr")},X=(de,ve=null)=>{if(!e||!de)return;if((ve?ve.toUpperCase():null)==="PET"||H(de)){e.addPetIntoRoom(de),e.updatePreviewRoomView();return}e.reset(!1),e.updateObjectRoom("101","101","1.1"),e.updateRoomWallsAndFloorVisibility(!0,!0),e.addAvatarIntoRoom(de,0),e.updatePreviewRoomView()},ee=de=>{if(de!==t){if(t==="global"&&V(),f&&(q(I),T(!1),O(null)),r(de),de==="global"){e==null||e.reset(!1),B();return}if(de==="furni"){N.current?Z(N.current):e==null||e.reset(!1);return}de==="entity"&&(y.current?X(y.current,D.current):e==null||e.reset(!1))}},Oe=de=>{if(t==="global")return;let ve=null;if(t==="furni"?ve=A.current:ve=P.current,de){if(ve===null)return;T(!0),O(t),W(t==="furni"?new yf(!0,ve):new Mf(!0,ve));return}q(I),T(!1),O(null)};return j(fP,de=>{const ve=de.getParser();if(f&&I==="furni"&&A.current!==null&&ve.furniId!==A.current)return;const ce=A.current!==ve.furniId;A.current=ve.furniId,N.current=ve.virtualId,g(ue=>ue===ve.furniId?ue:ve.furniId),n(new Map(ve.variables)),ce&&t==="furni"&&Z(ve.virtualId)}),j(EP,de=>{const ve=de.getParser();if(f&&I==="entity"&&P.current!==null&&ve.userId!==P.current)return;const ce=P.current!==ve.userId;P.current=ve.userId,y.current=ve.figure;const ue=new Map(ve.variables),$=ue.get("@type_user")??null,re=$?$.toUpperCase():null;D.current=re,p(me=>me===ve.userId?me:ve.userId),l(ue),ce&&t==="entity"&&X(ve.figure,re)}),j(pP,de=>{const ve=de.getParser();h(new Map(ve.variables))}),_t(ye.SELECTED,de=>{var ce;if(de.category!==z.UNIT||f&&I==="entity"&&P.current!==null)return;const ve=bt();if(!ve)return;const Me=(ce=ve.userDataManager)==null?void 0:ce.getUserDataByIndex(de.objectId);Me&&(t!=="entity"&&ee("entity"),Me.type===gt.getTypeNumber(gt.PET)?D.current="PET":Me.type===gt.getTypeNumber(gt.BOT)?D.current="BOT":D.current="PLAYER",W(new CP(Me.webID)))}),d.exports.useEffect(()=>{f&&(I==="furni"&&u===null&&(q("furni"),T(!1),O(null)),I==="entity"&&m===null&&(q("entity"),T(!1),O(null)))},[f,I,u,m]),d.exports.useEffect(()=>{x.current=I},[I]),d.exports.useEffect(()=>()=>{q(x.current),V()},[]),_("div",{className:"global-grid",children:["diseo provisional btw",_("div",{className:"grid-container2-props",children:[_("div",{children:[_("div",{className:"container-selector",children:[a("label",{style:{display:"block",marginBottom:6},children:"Variable holder type:"}),_("div",{className:"container-buttons-var",style:{display:"flex",gap:8},children:[a("button",{type:"button",title:"Furni",className:`button-var icon-furni-var${t==="furni"?" is-active":""}`,onClick:()=>ee("furni")}),a("button",{type:"button",title:"Entidad",className:`button-var icon-user-var${t==="entity"?" is-active":""}`,onClick:()=>ee("entity")}),a("button",{type:"button",title:"Global",className:`button-var icon-global-var${t==="global"?" is-active":""}`,onClick:()=>ee("global")}),a("button",{type:"button",title:"Context",className:"button-var icon-context-var",disabled:!0})]})]}),_("div",{style:{marginTop:8},children:[a("label",{style:{display:"block",marginBottom:6},children:"Preview:"}),a(Ch,{roomPreviewer:e,height:230}),a("div",{style:{marginTop:8},children:_("label",{style:{display:"flex",alignItems:"center",gap:8},children:[a("input",{type:"checkbox",checked:L?f:!1,disabled:!L||!F,onChange:de=>Oe(de.target.checked)}),a("span",{children:"Keep furni/entity selected"})]})})]})]}),a("div",{}),_("div",{children:[a("label",{style:{display:"block",marginBottom:6},children:"Variables:"}),a("div",{className:"container-values-prop",children:_("table",{style:{width:"100%",borderCollapse:"collapse"},children:[a("thead",{children:_("tr",{children:[a("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"Variable"}),a("th",{style:{textAlign:"left",padding:"6px 8px",borderBottom:"1px solid #ccc"},children:"Value"})]})}),a("tbody",{children:Array.from(k.entries()).map(([de,ve])=>_("tr",{children:[a("td",{style:{padding:"6px 8px",borderBottom:"1px solid #eee",width:"60%"},children:de}),a("td",{style:{padding:"6px 8px",borderBottom:"1px solid #eee"},children:ve})]},de))})]})})]})]})]})},xee=s=>{const[e,t]=d.exports.useState([]),[r,i]=d.exports.useState([]),[n,o]=d.exports.useState([]),[l,c]=d.exports.useState([]),[h,u]=d.exports.useState([]),[g,m]=d.exports.useState([]),[p,f]=d.exports.useState("furni"),[T,I]=d.exports.useState(null),{activeHighlight:O,clearHighlights:A}=y0(),N=D=>D.slice().sort((x,w)=>(x.creationTimestamp??0)-(w.creationTimestamp??0));d.exports.useEffect(()=>{W(new eg),W(new WE),W(new jE)},[]),d.exports.useEffect(()=>{(!T||T.kind!=="user")&&(O?O.userAssignments&&O.userAssignments.length>0&&T&&T.kind==="internal"&&(A(),W(new Qn(!1))):(A(),W(new Qn(!1))))},[T,A,O]),j(Z_,D=>{const w=D.getParser().vars||[],k=N(w);t(k),I(F=>{if(!F||F.kind!=="user")return F;const L=k.find(B=>B.name===F.var.name);return L?{kind:"user",var:L}:null})}),j(kE,D=>{const w=D.getParser().vars||[],k=N(w);i(k),I(F=>{if(!F||F.kind!=="internal")return F;const L=k.find(B=>B.name===F.var.name);return L?{kind:"internal",var:L}:null})}),j(GE,D=>{const w=D.getParser().vars||[],k=N(w);o(k),I(F=>{if(!F||F.kind!=="user")return F;const L=k.find(B=>B.name===F.var.name);return L?{kind:"user",var:L}:null})}),j(BE,D=>{const w=D.getParser().vars||[],k=N(w);c(k),I(F=>{if(!F||F.kind!=="internal")return F;const L=k.find(B=>B.name===F.var.name);return L?{kind:"internal",var:L}:null})}),j(VE,D=>{const w=D.getParser().vars||[],k=N(w);u(k),I(F=>{if(!F||F.kind!=="user")return F;const L=k.find(B=>B.name===F.var.name);return L?{kind:"user",var:L}:null})}),j(HE,D=>{const w=D.getParser().vars||[],k=N(w);m(k),I(F=>{if(!F||F.kind!=="internal")return F;const L=k.find(B=>B.name===F.var.name);return L?{kind:"internal",var:L}:null})});const P=()=>{if(T&&T.kind==="user"){const D=T.var.name;O&&O.variableName===D?(A(),W(new Qn(!1))):(O&&(A(),W(new Qn(!1))),W(new Qn(!0,D)),p==="furni"?W(new SP(D)):p==="user"?W(new OP(D)):p==="global"&&W(new AP(D)))}},y=()=>{if(T&&T.kind==="user"){const D=T.var.name;return O&&O.variableName===D?"Eliminar Highlight":"Agregar Highlight"}return"Agregar Highlight"};return _(M,{className:"global-grid",gap:4,children:[_(M,{column:!0,className:"w-50 bg-red",style:{width:"100%"},children:[_(M,{column:!0,justifyContent:"start",style:{width:"100%"},children:[a(C,{style:{width:"100%"},children:"Tipo de variable"}),_(M,{gap:2,className:"container-buttons-var",style:{width:"100%"},children:[a("button",{className:`button-var icon-furni-var ${p==="furni"?"selected":""}`,onClick:()=>f("furni")}),a("button",{className:`button-var icon-user-var ${p==="user"?"selected":""}`,onClick:()=>f("user")}),a("button",{className:`button-var icon-global-var ${p==="global"?"selected":""}`,onClick:()=>f("global")}),a("button",{className:"button-var icon-context-var"})]})]}),_(M,{column:!0,justifyContent:"start",style:{width:"100%"},children:[a(C,{style:{width:"100%"},className:"container-selector",children:"Selector de variables"}),_(M,{className:"container-var-selector",column:!0,style:{overflowY:"auto",width:"100%"},children:[p==="furni"&&e.map(D=>a(M,{className:`button-var ${T&&T.kind==="user"&&T.var===D?"selected":""}`,style:{margin:"2px 4px",borderRadius:4,cursor:"pointer"},onClick:()=>I({kind:"user",var:D}),children:a(C,{small:!0,children:D.name})},"fu-"+D.name+"-"+D.furniId)),p==="furni"&&r.map(D=>a(M,{className:`button-var ${T&&T.kind==="internal"&&T.var===D?"selected":""}`,style:{margin:"2px 4px",borderRadius:4,cursor:"pointer"},onClick:()=>I({kind:"internal",var:D}),children:a(C,{small:!0,children:D.name})},"fi-"+D.name+"-"+D.furniId)),p==="user"&&n.map(D=>a(M,{className:`button-var ${T&&T.kind==="user"&&T.var===D?"selected":""}`,style:{margin:"2px 4px",borderRadius:4,cursor:"pointer"},onClick:()=>I({kind:"user",var:D}),children:a(C,{small:!0,children:D.name})},"uu-"+D.name+"-"+D.userId)),p==="user"&&l.map(D=>a(M,{className:`button-var ${T&&T.kind==="internal"&&T.var===D?"selected":""}`,style:{margin:"2px 4px",borderRadius:4,cursor:"pointer"},onClick:()=>I({kind:"internal",var:D}),children:a(C,{small:!0,children:D.name})},"ui-"+D.name+"-"+D.userId)),p==="global"&&h.map(D=>a(M,{className:`button-var ${T&&T.kind==="user"&&T.var===D?"selected":""}`,style:{margin:"2px 4px",borderRadius:4,cursor:"pointer"},onClick:()=>I({kind:"user",var:D}),children:a(C,{small:!0,children:D.name})},"gu-"+D.name)),p==="global"&&g.map(D=>a(M,{className:`button-var ${T&&T.kind==="internal"&&T.var===D?"selected":""}`,style:{margin:"2px 4px",borderRadius:4,cursor:"pointer"},onClick:()=>I({kind:"internal",var:D}),children:a(C,{small:!0,children:D.name})},"gi-"+D.name))]})]}),a(Y,{style:{marginTop:"10px",padding:"8px",width:"230px"},onClick:P,disabled:!T||T.kind!=="user",children:y()})]}),_(M,{column:!0,className:"w-50 bg-blue",style:{width:"100%"},children:[a(M,{style:{marginBottom:"10px"},children:a(C,{children:"Propiedades"})}),a(M,{className:"container-values-prop",children:_("div",{className:"grid-container-props",children:[_("div",{className:"grid-container2-props",children:[a(C,{children:"Propiedad"}),a("div",{}),a(C,{children:"Valor"})]}),!T&&_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"-"}),a("div",{}),a(C,{children:"Selecciona una variable..."})]}),T&&(()=>{const D=T.var,x=T.kind==="internal",w=de=>de?"Yes":"No",k=de=>de?new Date(de).toLocaleString():"-",F=D.availability||"/",L=!!D.hasValue,B=!!D.canWriteTo,V=!!D.canCreateDelete,q=!!D.isAlwaysAvailable,Z=!!D.hasCreationTime,H=!!D.hasUpdateTime,X=!!D.isTextConnected;(D.hasRuntimeValue||L)&&D.runtimeValue;const ee=k(D.creationTimestamp),Oe=k(D.updateTimestamp);return _(J,{children:[_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Name"}),a("div",{}),a(C,{children:D.name})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Type"}),a("div",{}),a(C,{children:x?"Internal":"Created by User"})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Target"}),a("div",{}),a(C,{children:p==="furni"?"Furni":p==="user"?"User":"Global"})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Availability"}),a("div",{}),a(C,{children:F})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Has value"}),a("div",{}),a(C,{children:w(L)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Can write to"}),a("div",{}),a(C,{children:w(B)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Can create/delete"}),a("div",{}),a(C,{children:w(V)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Is always available"}),a("div",{}),a(C,{children:w(q)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Has creation time"}),a("div",{}),a(C,{children:w(Z)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Has update time"}),a("div",{}),a(C,{children:w(H)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Is text connected"}),a("div",{}),a(C,{children:w(X)})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Created at"}),a("div",{}),a(C,{children:ee})]}),_("div",{className:"grid-container2-props",style:{marginTop:"10px"},children:[a(C,{children:"Updated at"}),a("div",{}),a(C,{children:Oe})]})]})})()]})}),a(M,{style:{marginTop:"10px"},children:a(C,{children:"Valores de texto"})}),a(M,{className:"container-values-prop",style:{height:"140px",marginTop:"10px",overflowY:"auto"},children:(()=>{if(!T)return a(C,{style:{padding:"10px",width:"100%"},children:"Selecciona una variable para consultar los textos conectados."});const D=T.var,x=!!(D!=null&&D.isTextConnected);if(!(T.kind==="user"||T.kind==="internal"))return a(C,{style:{padding:"10px",width:"100%"},children:"Esta variable no soporta textos conectados."});if(!x)return a(C,{style:{padding:"10px",width:"100%"},children:"Esta variable no tiene textos conectados."});const k=Array.isArray(D.textEntries)?[...D.textEntries]:[];return k.sort((F,L)=>F.index-L.index),k.length?a(M,{column:!0,style:{width:"100%",padding:"6px 10px",gap:4},children:k.map(F=>_(M,{justifyContent:"space-between",className:"text-entry-row",gap:6,children:[a(C,{small:!0,style:{width:"50px"},children:F.index}),a(C,{small:!0,style:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:F.text})]},F.index))}):a(C,{style:{padding:"10px",width:"100%"},children:"Esta variable no tiene textos conectados."})})()})]})]})},J0="wired-monitor.variables",Z0="wired-monitor.inspection",eU="wired-monitor.configuration",BR=[J0,Z0,eU],wee=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(BR[0]),[n,o]=d.exports.useState(null),[l,c]=d.exports.useState(null),[h,u]=d.exports.useState(null),{isTrading:g=!1,stopTrading:m=null}=MI();Ci();const{clearHighlights:p}=y0(),{navigatorData:f=null}=Fi(),T=(f==null?void 0:f.currentRoomOwner)||!1,I=(A,N)=>{u(P=>{const y={...P};switch(A){case"modify_wired":y.modify_wired=Number(N);break;case"inspect_wired":y.inspect_wired=Number(N);break}return W(new kM(y.roomId,y.modify_wired,y.inspect_wired)),y})},O=()=>{g&&m(),p(),W(new Qn(!1)),t(!1)};return _t(ye.PLACED,A=>{FL()&&(Qc(!1),A.placedInRoom||t(!0))}),es([Ve.CREATED,Ve.ENDED],A=>{switch(A.type){case Ve.CREATED:o(A.session),u({roomId:A.session.roomId,roomName:"",roomDescription:"",categoryId:0,userCount:0,tags:[],tradeState:0,allowWalkthrough:!1,lockState:0,password:null,allowPets:!1,allowPetsEat:!1,hideWalls:!1,wallThickness:0,floorThickness:0,ownerId:ie().userId,modify_wired:0,inspect_wired:0,chatSettings:{mode:0,weight:0,speed:0,distance:0,protection:0},moderationSettings:{allowMute:0,allowKick:0,allowBan:0}});return;case Ve.ENDED:o(null),u(null),p(),W(new Qn(!1)),t(!1);return}}),j(Y_,A=>{const N=A.getParser();for(const P of N.data)uI().setBadgePointLimit(P.badgeId,P.limit)}),d.exports.useEffect(()=>{const A={linkReceived:N=>{const P=N.split("/");if(!(P.length<2))switch(P[1]){case"show":t(!0);return;case"hide":t(!1);return;case"toggle":t(y=>!y);return}},eventUrlPrefix:"wired-monitor/"};return xs(A),()=>ws(A)},[]),d.exports.useEffect(()=>(c(new Yr(te(),++Yr.PREVIEW_COUNTER)),()=>{c(A=>(A.dispose(),null))}),[]),d.exports.useEffect(()=>{!e&&g&&t(!0)},[e,g]),j(Gu,A=>{if(!e)return;const P=A.getParser().controllerLevel,y=(n==null?void 0:n.isRoomOwner)||!1,D=ie().isModerator;P<Rt.GUEST&&!y&&!D&&(p(),W(new Qn(!1)),t(!1))}),j(ku,A=>{if(!e)return;const N=(n==null?void 0:n.isRoomOwner)||!1,P=ie().isModerator;!N&&!P&&(p(),W(new Qn(!1)),t(!1))}),e?_(Be,{uniqueKey:"inventory",theme:g?"primary-slim":"",children:[a(He,{headerText:E("wired-monitor.title"),onCloseClick:O}),!g&&_(J,{children:[a(ca,{children:BR.map((A,N)=>a(Dn,{isActive:r===A,onClick:P=>i(A),children:E(A)},N))}),_(Ge,{children:[r===J0&&a(xee,{}),r===Z0&&a(Uee,{roomPreviewer:l}),r===eU&&a(Lee,{roomData:h,handleChange:I,isOwner:T})]})]})]}):null},Fee=s=>{const{trigger:e=null,furniIds:t=[]}=Ne();return _(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.pickfurnis.caption",["count","limit"],[t.length.toString(),e.maximumItemSelectionCount.toString()])}),a(C,{children:E("wiredfurni.pickfurnis.desc")})]})},bh=s=>{const{wiredType:e="",requiresFurni:t=Se.STUFF_SELECTION_OPTION_NONE,save:r=null,validate:i=null,children:n=null,hasSpecialInput:o=!1,allowFurniSelectionIfNone:l=!1}=s,[c,h]=d.exports.useState(null),[u,g]=d.exports.useState(null),[m,p]=d.exports.useState(!1),{trigger:f=null,setTrigger:T=null,setIntParams:I=null,setStringParam:O=null,setFurniIds:A=null,setDestFurniIds:N=null,setAllowsFurni:P=null,saveWired:y=null,setPreferredSelectionColor:D=null,setAllowYellowSelection:x=null}=Ne(),w=()=>(T(null),qt.hideSelectedWired(f.id)),k=()=>{i&&!i()||(r&&r(),p(!0),qt.hideSelectedWired(f.id))};return d.exports.useEffect(()=>{m&&(y(),qt.hideSelectedWired(f.id),p(!1))},[m,y]),d.exports.useEffect(()=>{if(qt.showSelectedWired(f.id),!f)return;const F=f.spriteId||-1,L=ie().getFloorItemData(F);L?(h(L.name),g(L.description)):(h("NAME: "+F),g("NAME: "+F)),D&&D(0),x&&x(!1),o&&(I(f.intData),O(f.stringData));const B=t>Se.STUFF_SELECTION_OPTION_NONE||l&&t===Se.STUFF_SELECTION_OPTION_NONE;B&&A(V=>(V&&V.length&&qt.clearSelectionShaderFromFurni(V),f.selectedItems&&f.selectedItems.length?(qt.applySelectionShaderToFurni(f.selectedItems),N(q=>(q&&q.length&&qt.clearSelectionShaderFromFurniBlue(q),f.destinationSelectedItems&&f.destinationSelectedItems.length?(qt.applySelectionShaderToFurniBlue(f.destinationSelectedItems),f.destinationSelectedItems):[])),f.selectedItems):[])),B&&t===Se.STUFF_SELECTION_OPTION_NONE?P(Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT):(D&&!B&&D(0),x&&!B&&x(!1),B&&t===Se.STUFF_SELECTION_OPTION_NONE?P(Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT):P(t))},[f,o,t,I,O,A,P]),_(Be,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary-slim",children:[a(He,{headerText:E("wiredfurni.title"),onCloseClick:w}),_(Ge,{children:[_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("i",{className:`icon icon-wired-${e}`}),a(C,{bold:!0,children:c})]}),a(C,{small:!0,children:u})]}),!!n&&a("hr",{className:"m-0 bg-dark"}),n,t>Se.STUFF_SELECTION_OPTION_NONE&&_(J,{children:[a("hr",{className:"m-0 bg-dark"}),a(Fee,{})]}),_(M,{alignItems:"center",gap:1,children:[a(Y,{fullWidth:!0,variant:"success",onClick:k,children:E("wiredfurni.ready")}),a(Y,{fullWidth:!0,variant:"secondary",onClick:w,children:E("cancel")})]})]})]})},Ut=s=>{const{requiresFurni:e=Se.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:r=!1,allowFurniSelectionIfNone:i=!1,children:n=null}=s,{trigger:o=null,actionDelay:l=0,setActionDelay:c=null,furniOptions:h=0,setFurniOptions:u=null,furniType:g=0,setFurniType:m=null,userOptions:p=0,setUserOptions:f=null,userType:T=0,setUserType:I=null}=Ne();return d.exports.useEffect(()=>{c(o.delayInPulses),u(o.furniOptions),m(o.furniType),f(o.userOptions),I(o.userType)},[o,c,u,m,f,I]),_(bh,{wiredType:"action",requiresFurni:e,allowFurniSelectionIfNone:i,save:t,hasSpecialInput:r,children:[n,!!n&&a("hr",{className:"m-0 bg-dark"}),_(v,{children:[a(C,{bold:!0,children:E("wiredfurni.params.delay",["seconds"],[$c(l)])}),a(ts,{className:"nitro-slider",min:0,max:20,value:l,onChange:O=>c(O)})]}),h===1&&_(v,{children:[a(C,{bold:!0,children:"Furni"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>m(0),className:` icon-neighbor-1 ${g===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>m(1),className:` icon-neighbor-5 ${g===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>m(2),className:` icon-neighbor-3 ${g===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>m(3),className:` icon-neighbor-2 ${g===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),g!==void 0&&a(C,{style:{textAlign:"center"},children:["Seleccionados","Selector","Usar Item Desencadenante","Items de Seal"][g]})]}),p===1&&_(v,{children:[a(C,{bold:!0,children:"Users"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>I(0),className:` icon-neighbor-0 ${T===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>I(1),className:` icon-neighbor-5 ${T===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>I(2),className:` icon-neighbor-2 ${T===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),T!==void 0&&a(C,{style:{textAlign:"center"},children:["Usuario Accionador","Usuario de Selector","Usuario de Seal","Usar Items de Seal"][T]})]})]})},kee="hd-180-1.ch-210-66.lg-270-82.sh-290-81",Gee=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(""),{trigger:n=null,setStringParam:o=null}=Ne(),l=()=>o(e+on+r);return d.exports.useEffect(()=>{const c=n.stringData.split(on);c.length>0&&t(c[0]),c.length>1&&i(c[1].length>0?c[1]:kee)},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>t(c.target.value)})]}),_(M,{center:!0,children:[a(Ts,{figure:r,direction:4}),a(Y,{onClick:c=>i(ie().figure),children:E("wiredfurni.params.capture.figure")})]})]})},Bee=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=Ne(),c=()=>{o(e),l([r])};return d.exports.useEffect(()=>{t(n.stringData),i(n.intData.length>0?n.intData[0]:0)},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:h=>t(h.target.value)})]}),_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:r===1,onChange:h=>i(1)}),a(C,{children:E("wiredfurni.params.start.following")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:r===0,onChange:h=>i(0)}),a(C,{children:E("wiredfurni.params.stop.following")})]})]})]})},Vee=[2,5,7,8,9,10,27],Hee=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(-1),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=Ne(),c=()=>{o(e),l([r])};return d.exports.useEffect(()=>{t(n.stringData),i(n.intData.length>0?n.intData[0]:0)},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:h=>t(h.target.value)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.handitem")}),_("select",{className:"form-select form-select-sm",value:r,onChange:h=>i(parseInt(h.target.value)),children:[a("option",{value:"0",children:"------"}),Vee.map(h=>a("option",{value:h,children:E(`handitem${h}`)},h))]})]})]})},Wee=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:o=>t(o.target.value)})]})})},jee=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(-1),{trigger:l=null,setStringParam:c=null,setIntParams:h=null}=Ne(),u=()=>{c(e+on+r),h([n])};return d.exports.useEffect(()=>{const g=l.stringData.split(on);g.length>0&&t(g[0]),g.length>1&&i(g[1].length>0?g[1]:""),o(l.intData.length>0?l.intData[0]:0)},[l]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:g=>t(g.target.value)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.message")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:r,onChange:g=>i(g.target.value)})]}),_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:g=>o(0)}),a(C,{children:E("wiredfurni.params.talk")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:g=>o(1)}),a(C,{children:E("wiredfurni.params.whisper")})]})]})]})},Yee=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(-1),{trigger:l=null,setStringParam:c=null,setIntParams:h=null}=Ne(),u=()=>{c(e+on+r),h([n])};return d.exports.useEffect(()=>{const g=l.stringData.split(on);g.length>0&&t(g[0]),g.length>1&&i(g[1].length>0?g[1]:""),o(l.intData.length>0?l.intData[0]:0)},[l]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:g=>t(g.target.value)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.message")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:Ee("wired.action.bot.talk.max.length",64),value:r,onChange:g=>i(g.target.value)})]}),_(v,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:n===0,onChange:g=>o(0)}),a(C,{children:E("wiredfurni.params.talk")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:n===1,onChange:g=>o(1)}),a(C,{children:E("wiredfurni.params.shout")})]})]})]})},zee=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:o=>t(o.target.value)})]})})},Kee=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),qee=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Xee=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.message")}),a("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value),maxLength:Ee("wired.action.chat.max.length",100)})]})})},Qee=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:null}),$ee=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Jee=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState(!1),{trigger:l=null,setIntParams:c=null,furniType:h=0,setFurniType:u=null,furniIds:g=[],setFurniIds:m=null,destFurniIds:p=[],setDestFurniIds:f=null,selectMode:T=0,setSelectMode:I=null,setAllowsFurni:O=null,setFurniOptions:A=null,setPreferredSelectionColor:N=null,setAllowYellowSelection:P=null}=Ne(),y=()=>c([e]);return d.exports.useEffect(()=>{l?(l.selectedItems&&l.selectedItems.length&&(m(l.selectedItems),qt.applySelectionShaderToFurniYellow(l.selectedItems)),l.destinationSelectedItems&&l.destinationSelectedItems.length&&(f(l.destinationSelectedItems),qt.applySelectionShaderToFurniBlue(l.destinationSelectedItems)),t(l.intData&&l.intData.length>0?l.intData[0]:0),N&&N(1),P&&P(!0),A&&A(0)):(N&&N(0),P&&P(!1))},[l]),_(Ut,{allowFurniSelectionIfNone:!0,requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:y,children:[a("hr",{className:"m-0 bg-dark"}),a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),_("div",{className:"align-advancedoptionsone",children:[_("div",{className:"button-group",children:[a("button",{onClick:()=>u(0),className:` icon-neighbor-1 ${h===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>u(1),className:` icon-neighbor-5 ${h===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>u(2),className:` icon-neighbor-3 ${h===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>u(3),className:` icon-neighbor-2 ${h===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]}),h===0&&a("div",{className:"button-group mt-2",children:a("button",{onClick:()=>{r?(i(!1),I(0),O(Se.STUFF_SELECTION_OPTION_NONE),qt.clearSelectionShaderFromFurniYellow(g)):(o(!1),I(1),i(!0),O(Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT),qt.applySelectionShaderToFurniYellow(g),qt.clearSelectionShaderFromFurniBlue(p))},className:` ${r?"button-icons-selector-general-selected":"button-icons-selector-general"}`,style:{backgroundColor:r?"rgba(255,235,170,0.9)":void 0},children:a("i",{className:"icon icon-holy-plus"})})})]}),a("hr",{className:"m-0 bg-dark"}),_("div",{className:"align-advancedoptionsone",children:[_("div",{className:"button-group",children:[a("button",{onClick:()=>t(0),className:` icon-neighbor-1 ${e===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>t(1),className:` icon-neighbor-5 ${e===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>t(2),className:` icon-neighbor-3 ${e===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>t(3),className:` icon-neighbor-2 ${e===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]}),e===0&&a("div",{className:"button-group mt-2",children:a("button",{onClick:()=>{n?(o(!1),I(0),O(Se.STUFF_SELECTION_OPTION_NONE),qt.clearSelectionShaderFromFurniBlue(p)):(i(!1),I(2),o(!0),O(Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT),qt.applySelectionShaderToFurniBlue(p),qt.clearSelectionShaderFromFurniYellow(g))},className:` ${n?"button-icons-selector-general-selected":"button-icons-selector-general"}`,style:{backgroundColor:n?"rgba(170,205,255,0.9)":void 0},children:a("i",{className:"icon icon-holy-plus"})})}),a(C,{style:{textAlign:"center"},children:["Fuente: Seleccionados","Fuente: Selector","Fuente: Item de activacin","Fuente: Seal"][h]})]}),a(C,{style:{textAlign:"center"},children:["Seleccionados","Selector","Item de activacin","Seal"][e]})]})},Zee=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(1),[n,o]=d.exports.useState(!1),[l,c]=d.exports.useState(1),[h,u]=d.exports.useState(1),[g,m]=d.exports.useState([]),{trigger:p=null,setIntParams:f=null,setStringParam:T=null}=Ne(),I=()=>m(P=>[...P,{isBadge:!1,itemCode:"",probability:null}]),O=P=>{m(y=>{const D=Array.from(y);return D.splice(P,1),D})},A=(P,y,D,x)=>{const w=Array.from(g),k=w[P];k&&(k.isBadge=y,k.itemCode=D,k.probability=x,m(w))},N=()=>{let P=[];for(const y of g){if(!y.itemCode)continue;const D=[y.isBadge?"0":"1",y.itemCode,y.probability.toString()];P.push(D.join(","))}P.length>0&&(T(P.join(";")),f([r,n?1:0,l,h]))};return d.exports.useEffect(()=>{const P=[];if(p.stringData.length>0&&p.stringData.includes(";")){const y=p.stringData.split(";");for(const D of y){const x=D.split(",");x.length===3&&P.push({isBadge:x[0]==="0",itemCode:x[1],probability:Number(x[2])})}}P.length===0&&P.push({isBadge:!1,itemCode:"",probability:null}),i(p.intData.length>0?p.intData[0]:0),o(p.intData.length>1?p.intData[1]===1:!1),c(p.intData.length>2?p.intData[2]:0),u(p.intData.length>3?p.intData[3]:0),t(p.intData.length>3?p.intData[3]>0:!1),m(P)},[p]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:N,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:P=>t(P.target.checked)}),a(C,{children:E("wiredfurni.params.prizelimit",["amount"],[e?l.toString():""])})]}),!e&&a(C,{center:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),e&&a(ts,{className:"nitro-slider",min:1,max:1e3,value:l,onChange:P=>c(P)}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:"How often can a user be rewarded?"}),_(M,{gap:1,children:[_("select",{className:"form-select form-select-sm w-100",value:r,onChange:P=>i(Number(P.target.value)),children:[a("option",{value:"0",children:"Once"}),_("option",{value:"3",children:["Once every ",h," minutes"]}),_("option",{value:"2",children:["Once every ",h," hours"]}),_("option",{value:"1",children:["Once every ",h," days"]})]}),r>0&&a("input",{type:"number",className:"form-control form-control-sm",value:h,onChange:P=>u(Number(P.target.value))})]})]}),a("hr",{className:"m-0 bg-dark"}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:n,onChange:P=>o(P.target.checked)}),a(C,{children:"Unique rewards"})]}),a(C,{center:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),a("hr",{className:"m-0 bg-dark"}),_(M,{justifyContent:"between",alignItems:"center",children:[a(C,{gfbold:!0,children:"Rewards"}),a(Y,{variant:"success",onClick:I,children:a(Lc,{className:"fa-icon"})})]}),a(v,{gap:1,children:g&&g.map((P,y)=>_(M,{gap:1,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",checked:P.isBadge,onChange:D=>A(y,D.target.checked,P.itemCode,P.probability)}),a(C,{children:"Badge?"})]}),a("input",{type:"text",className:"form-control form-control-sm",value:P.itemCode,onChange:D=>A(y,P.isBadge,D.target.value,P.probability),placeholder:"Item Code"}),a("input",{type:"number",className:"form-control form-control-sm",value:P.probability,onChange:D=>A(y,P.isBadge,P.itemCode,Number(D.target.value)),placeholder:"Probability"}),y>0&&a(Y,{variant:"danger",onClick:D=>O(y),children:a(hp,{className:"fa-icon"})})]},y))})]})},ete=s=>{const[e,t]=d.exports.useState(1),[r,i]=d.exports.useState(1),[n,o]=d.exports.useState(1),{trigger:l=null,setIntParams:c=null}=Ne(),h=()=>c([e,r,n]);return d.exports.useEffect(()=>{l.intData.length>=2?(t(l.intData[0]),i(l.intData[1]),o(l.intData[2])):(t(1),i(1),o(1))},[l]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.setpoints",["points"],[e.toString()])}),a(ts,{className:"nitro-slider",min:1,max:100,value:e,onChange:u=>t(u)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.settimesingame",["times"],[r.toString()])}),a(ts,{className:"nitro-slider",min:1,max:10,value:r,onChange:u=>i(u)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.team")}),[1,2,3,4].map(u=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${u}`,checked:n===u,onChange:g=>o(u)}),a(C,{children:E("wiredfurni.params.team."+u)})]},u))]})]})},tte=s=>{const[e,t]=d.exports.useState(1),[r,i]=d.exports.useState(1),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>o([e,r]);return d.exports.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),i(n.intData[1])):(t(1),i(1))},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.setpoints",["points"],[e.toString()])}),a(ts,{className:"nitro-slider",min:1,max:100,value:e,onChange:c=>t(c)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.settimesingame",["times"],[r.toString()])}),a(ts,{className:"nitro-slider",min:1,max:10,value:r,onChange:c=>i(c)})]})]})},ste=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.team")}),[1,2,3,4].map(o=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:e===o,onChange:l=>t(o)}),a(C,{children:E(`wiredfurni.params.team.${o}`)})]},o))]})})},rte=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.message")}),a("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value),maxLength:Ee("wired.action.kick.from.room.max.length",100)})]})})},ite=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),nte=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],ate=[0,1,2,3,4,5,6],ote=s=>{const[e,t]=d.exports.useState(-1),[r,i]=d.exports.useState(-1),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>o([e,r]);return d.exports.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),i(n.intData[1])):(t(-1),i(-1))},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{children:E("wiredfurni.params.startdir")}),a(M,{gap:1,children:nte.map(c=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:e===c.value,onChange:h=>t(c.value)}),a(C,{children:a("i",{className:`icon icon-${c.icon}`})})]},c.value))})]}),_(v,{gap:1,children:[a(C,{children:E("wiredfurni.params.turn")}),ate.map(c=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:r===c,onChange:h=>i(c)}),a(C,{children:E(`wiredfurni.params.turn.${c}`)})]},c))]})]})},lte=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],cte=s=>{const[e,t]=d.exports.useState(-1),[r,i]=d.exports.useState(-1),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>o([r,e]);return d.exports.useEffect(()=>{n.intData.length>=2?(t(n.intData[1]),i(n.intData[0])):(t(-1),i(-1))},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.emptytiles",["tiles"],[e.toString()])}),a(ts,{className:"nitro-slider",min:1,max:5,value:e,onChange:c=>t(c)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.startdir")}),a(M,{gap:1,children:lte.map(c=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:r===c.value,onChange:h=>i(c.value)}),a(C,{children:a("i",{className:`icon icon-${c.icon}`})})]},c.value))})]})]})},ute=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],hte=[0,1,2,3],dte=s=>{const[e,t]=d.exports.useState(-1),[r,i]=d.exports.useState(-1),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>o([e,r]);return d.exports.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),i(n.intData[1])):(t(-1),i(-1))},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.movefurni")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:e===0,onChange:c=>t(0)}),a(C,{children:E("wiredfurni.params.movefurni.0")})]}),_(M,{gap:1,children:[ute.map(c=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${c.value}`,checked:e===c.value,onChange:h=>t(c.value)}),a("i",{className:`icon icon-${c.icon}`})]},c.value)),a("div",{className:"col"})]})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.rotatefurni")}),hte.map(c=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${c}`,checked:r===c,onChange:h=>i(c)}),_(C,{children:[[1,2].includes(c)&&a("i",{className:`icon icon-rot-${c}`}),E(`wiredfurni.params.rotatefurni.${c}`)]})]},c))]})]})},_te=s=>{const[e,t]=d.exports.useState(-1),[r,i]=d.exports.useState(""),{trigger:n=null,setIntParams:o=null,setStringParam:l=null}=Ne(),c=()=>{o([e]),l(r)};return d.exports.useEffect(()=>{t(n.intData.length>0?n.intData[0]:0),i(n.stringData)},[n]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:c,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.length.minutes",["minutes"],[e.toString()])}),a(ts,{className:"nitro-slider",min:1,max:10,value:e,onChange:h=>t(h)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.message")}),a("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:h=>i(h.target.value),maxLength:Ee("wired.action.mute.user.max.length",100)})]})]})},gte=()=>{const[s,e]=d.exports.useState(0),[t,r]=d.exports.useState(0),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(0),{trigger:c=null,setIntParams:h=null}=Ne(),u=()=>{h([s,t,i,o])};return d.exports.useEffect(()=>{var g;c?((g=c.intData)==null?void 0:g.length)>=4&&(e(c.intData[0]),r(c.intData[1]),n(c.intData[2]),l(c.intData[3])):(e(0),r(0),n(0),l(0))},[c]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:u,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.x")}),_("div",{children:[_("label",{style:{marginLeft:"10px"},children:[a("input",{type:"radio",name:"xType",value:1,checked:i===1,onChange:()=>n(1)}),a("i",{className:"icon icon-se"})]}),_("label",{children:[a("input",{type:"radio",name:"xType",value:0,checked:i===0,onChange:()=>n(0)}),a("i",{className:"icon icon-nw"})]})]}),a(ts,{className:"nitro-slider",min:0,max:20,value:o,onChange:g=>l(g)}),a(C,{children:o})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.y")}),_("div",{children:[_("label",{style:{marginLeft:"10px"},children:[a("input",{type:"radio",name:"yType",value:1,checked:s===1,onChange:()=>e(1)}),a("i",{className:"icon icon-sw"})]}),_("label",{children:[a("input",{type:"radio",name:"yType",value:0,checked:s===0,onChange:()=>e(0)}),a("i",{className:"icon icon-ne"})]})]}),a(ts,{className:"nitro-slider",min:0,max:20,value:t,onChange:g=>r(g)}),a(C,{children:t})]})]})},mte=()=>{const[s,e]=d.exports.useState(0),[t,r]=d.exports.useState(""),{trigger:i=null,setIntParams:n=null,setStringParam:o=null}=Ne(),l=()=>{n([s]),o(s===0?t:"")};return d.exports.useEffect(()=>{var c;i&&(((c=i.intData)==null?void 0:c.length)>=1&&e(i.intData[0]),i.stringData&&r(i.stringData))},[i]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[_("label",{children:[a("input",{type:"radio",name:"actionType",value:0,checked:s===0,onChange:()=>e(0)}),E("wired.action.reset_points")]}),_("label",{children:[a("input",{type:"radio",name:"actionType",value:1,checked:s===1,onChange:()=>e(1)}),E("wired.action.substract_points")]})]}),s===0&&_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.points")}),a("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>r(c.target.value),maxLength:6})]})]})},fte=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),pte=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState("first"),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(0),{trigger:g=null,setIntParams:m=null}=Ne(),p=()=>m([e,r,l,h]);return d.exports.useEffect(()=>{g&&g.intData&&(t(g.intData.length>0?g.intData[0]:0),i(g.intData.length>1?g.intData[1]:0),c(g.intData.length>2?g.intData[2]:0),u(g.intData.length>3?g.intData[3]:0))},[g]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:p,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("Furnis")}),a(M,{alignItems:"center",gap:1,justifyContent:"center",alignSelf:"center",children:(n==="first"?[0,1,2]:[3,4]).map(f=>a("button",{className:`button-icons-selector-general icon-furnis-${f}`,onClick:()=>c(f),style:{backgroundColor:l===f?"rgb(236, 236, 236)":"#cdd3d9",border:l===f?"2px solid white":"2px solid #b6bec5"}},f))}),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:a(C,{bold:!0,children:E(`wiredfurni.params.textmode.furni.${l+5}`)})}),a("hr",{className:"m-0 bg-dark"}),a(C,{bold:!0,children:E("Usuarios")}),a(M,{alignItems:"center",gap:1,justifyContent:"center",alignSelf:"center",children:(n==="first"?[0,1,2]:[3,4]).map(f=>a("button",{className:`button-icons-selector-general icon-furnis-${f}`,onClick:()=>u(f),style:{backgroundColor:h===f?"rgb(236, 236, 236)":"#cdd3d9",border:h===f?"2px solid white":"2px solid #b6bec5"}},f))}),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:a(C,{bold:!0,children:E(`wiredfurni.params.textmode.user.${h+5}`)})}),a("hr",{className:"m-0 bg-dark"}),a(C,{bold:!0,children:E("wiredfurni.params.conditions")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"signalForEachFurni",checked:!!e,onChange:f=>t(f.target.checked?1:0)}),a(C,{children:"Enviar seal por cada furni"})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"signalForEachUser",checked:!!r,onChange:f=>i(f.target.checked?1:0)}),a(C,{children:"Enviar seal por cada usuario"})]})]})})},Ete=()=>{const[s,e]=d.exports.useState(0),[t,r]=d.exports.useState(""),{trigger:i=null,setIntParams:n=null,setStringParam:o=null}=Ne(),l=()=>{n([s]),o(t)};return d.exports.useEffect(()=>{var c;i&&(((c=i.intData)==null?void 0:c.length)>=1&&e(i.intData[0]),i.stringData&&r(i.stringData))},[i]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[_("label",{children:[a("input",{type:"radio",name:"actionType",value:0,checked:s===0,onChange:()=>e(0)}),E("wired.action.add_points")]}),_("label",{children:[a("input",{type:"radio",name:"actionType",value:1,checked:s===1,onChange:()=>e(1)}),E("wired.action.set_points")]})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.points")}),a("input",{type:"text",className:"form-control form-control-sm",value:t,onChange:c=>r(c.target.value),maxLength:6})]})]})},Ite=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),{trigger:h=null,setIntParams:u=null}=Ne(),g=()=>u([e,r,n,l]),m=()=>W(new PE(h.id));return d.exports.useEffect(()=>{t(h.getBoolean(0)?1:0),i(h.getBoolean(1)?1:0),o(h.getBoolean(2)?1:0),c(h.getBoolean(3)?1:0)},[h]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.conditions")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:p=>t(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.state")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:p=>i(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.direction")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:p=>o(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.position")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"heightFlag",checked:!!l,onChange:p=>c(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.height")})]})]}),a("hr",{className:"m-0 bg-dark"}),a(v,{children:a(Y,{onClick:m,children:"Apply Snapshot Now"})})]})},Tte=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState("0.00"),{trigger:l=null,setIntParams:c=null,setStringParam:h=null}=Ne();d.exports.useEffect(()=>{o(r.toFixed(2))},[r]);const u=()=>{const m=parseFloat(n);if(!isNaN(m)){const p=Math.max(0,Math.min(40,m));i(p)}},g=()=>{c([e]),h(r.toString())};return d.exports.useEffect(()=>{var m;((m=l==null?void 0:l.intData)==null?void 0:m.length)>=1?(t(l.intData[0]),i(parseFloat(l.stringData||"0"))):t(0)},[l]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:g,children:[a(C,{children:"Selecciona el modo de altura:"}),_(v,{gap:1,children:[_("label",{children:[a("input",{type:"radio",name:"timerMode",value:0,checked:e===0,onChange:()=>t(0)}),"Aumentar"]}),_("label",{children:[a("input",{type:"radio",name:"timerMode",value:1,checked:e===1,onChange:()=>t(1)}),"Disminuir"]}),_("label",{children:[a("input",{type:"radio",name:"timerMode",value:3,checked:e===3,onChange:()=>t(3)}),"Establecer"]}),_(M,{alignItems:"center",justifyContent:"between",children:[a(C,{bold:!0,children:E("Altura:")}),_(M,{gap:1,children:[a("input",{type:"text",value:n,onChange:m=>o(m.target.value),onBlur:u,onKeyPress:m=>m.key==="Enter"&&u(),style:{width:"80px",textAlign:"center"}}),a(C,{children:"m"})]})]}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"10px 0"},children:[a(Y,{onClick:()=>i(m=>Number(Math.max(0,m-.01).toFixed(2))),children:"-"}),a(ts,{className:"nitro-slider",min:0,max:40,step:.01,value:r,onChange:m=>i(Number((Array.isArray(m)?m[0]:m).toFixed(2))),renderThumb:(m,p)=>a("div",{...m,children:p.valueNow.toFixed(2)})}),a(Y,{onClick:()=>i(m=>Number(Math.min(40,m+.01).toFixed(2))),children:"+"})]})]})]})},Rte=s=>{var u,g;const{trigger:e=null,setIntParams:t=null}=Ne(),r=((u=e==null?void 0:e.intData)==null?void 0:u[0])??1,i=((g=e==null?void 0:e.intData)==null?void 0:g[1])??3,[n,o]=d.exports.useState(Math.min(Math.max(r,1),40)),[l,c]=d.exports.useState(i),h=()=>t([n,l]);return d.exports.useEffect(()=>{var m;if((m=e==null?void 0:e.intData)!=null&&m.length){const[p,f]=e.intData;o(Math.min(Math.max(p,1),40)),c(f)}},[e]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired.fastwalk.mode.title")}),a(v,{gap:1,children:[0,1].map(m=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"fastWalkMode",checked:l===m,onChange:()=>c(m)}),a(C,{children:E(`wired.fastwalk.mode.${m}`)})]},m))}),l===1&&_(J,{children:[a(C,{bold:!0,children:E("wiredfurni.params.delay",["miliseconds"],[$c(n*50/1e3)])}),a(ts,{className:"nitro-slider",min:1,max:40,step:1,value:n,onChange:m=>o(m),renderThumb:m=>a("div",{...m,children:n})})]})]})})},Ste=s=>{const[e,t]=d.exports.useState(!0),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>{i([e?1:0])};return d.exports.useEffect(()=>{var o;((o=r==null?void 0:r.intData)==null?void 0:o.length)>=1?t(r.intData[0]===1):t(!0)},[r]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.teleport.use_effect")}),_("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"checkbox",id:"teleportWithEffect",checked:e,onChange:o=>t(o.target.checked)}),a("label",{className:"form-check-label",htmlFor:"teleportWithEffect",children:E("wiredfurni.params.teleport.use_effect.label")})]})]})})},Ote=s=>{const[e,t]=d.exports.useState(0),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>{i([e])};return d.exports.useEffect(()=>{var o;((o=r==null?void 0:r.intData)==null?void 0:o.length)>=1?t(r.intData[0]):t(0)},[r]),_(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:n,children:[a(C,{children:"Selecciona el modo del temporizador:"}),_(v,{gap:1,children:[_("label",{children:[a("input",{type:"radio",name:"timerMode",value:0,checked:e===0,onChange:()=>t(0)}),"Comenzar"]}),_("label",{children:[a("input",{type:"radio",name:"timerMode",value:1,checked:e===1,onChange:()=>t(1)}),"Parar"]}),_("label",{children:[a("input",{type:"radio",name:"timerMode",value:3,checked:e===3,onChange:()=>t(3)}),"Reiniciar"]})]})]})},Cte=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>{o(e===3?[e,r]:[e])};return d.exports.useEffect(()=>{var c;((c=n==null?void 0:n.intData)==null?void 0:c.length)>=1?(t(n.intData[0]),n.intData.length>=2?i(n.intData[1]):i(0)):(t(0),i(0))},[n]),a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:l,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.togglefurnistate.mode",[""],[""])}),_("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"radio",id:"modeNormal",checked:e===0,onChange:()=>t(0)}),a("label",{className:"form-check-label",htmlFor:"modeNormal",children:"Normal"})]}),_("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"radio",id:"modeInverse",checked:e===1,onChange:()=>t(1)}),a("label",{className:"form-check-label",htmlFor:"modeInverse",children:"Inverso"})]}),_("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"radio",id:"modeRandom",checked:e===2,onChange:()=>t(2)}),a("label",{className:"form-check-label",htmlFor:"modeRandom",children:"Aleatorio"})]}),_("div",{className:"form-check",children:[a("input",{className:"form-check-input",type:"radio",id:"modeSpecific",checked:e===3,onChange:()=>t(3)}),a("label",{className:"form-check-label",htmlFor:"modeSpecific",children:"Estado especfico"})]}),e===3&&_("div",{children:[a("label",{htmlFor:"specificState",children:"Estado:"}),a("input",{type:"number",id:"specificState",value:r,onChange:c=>i(parseInt(c.target.value)||0),min:"0",step:"1",maxLength:2})]})]})})},Ate=s=>a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:null}),Cr=({selectedVariable:s,onVariableChange:e,targetType:t,onTargetTypeChange:r,typeOfAdvancedOption:i,onAdvancedOptionChange:n,label:o="Selecciona una variable:",showAdvancedOptions:l=!0,placeholder:c="-- variable --",showInternal:h=!0,showOnlyWithValue:u=!1,filterType:g,showGlobal:m=!0,showTargetButtons:p=!0})=>{const f=d.exports.useRef({user:[],furni:[],userInternal:[],userUser:[],global:[],internalGlobal:[]}),[T,I]=d.exports.useState(0),O=x=>x.slice().sort((w,k)=>(w.creationTimestamp??0)-(k.creationTimestamp??0));d.exports.useEffect(()=>{W(new eg),W(new WE),W(new jE)},[]);const A=d.exports.useRef(null),N=()=>{A.current||(A.current=setTimeout(()=>{A.current=null,I(x=>x+1)},300))};j(Z_,x=>{const w=x.parser.vars;f.current.user=O(w||[]),N()}),j(kE,x=>{f.current.furni=x.parser.vars,N()}),j(BE,x=>{f.current.userInternal=x.parser.vars,N()}),j(GE,x=>{const w=x.parser.vars;f.current.userUser=O(w||[]),N()}),j(VE,x=>{const w=x.parser.vars;f.current.global=O(w||[]),N()}),j(HE,x=>{f.current.internalGlobal=x.parser.vars,N()});const P=d.exports.useMemo(()=>{const x=[],{user:w,furni:k,userInternal:F,userUser:L,global:B,internalGlobal:V}=f.current;t===0?(w.forEach(X=>{X.display=X.name,x.push(X)}),h&&k.forEach(X=>{const ee=x.some(Oe=>Oe.name===X.name);X.display=ee?`${X.name} (int)`:X.name,X.hasValue=!0,x.push(X)})):t===1?(F.forEach(X=>{X.display=X.name,X.hasValue=!0,x.push(X)}),L.forEach(X=>{X.display=X.name,x.push(X)})):t===2&&(B.forEach(X=>{X.display=X.name,x.push(X)}),h&&V.forEach(X=>{const ee=x.some(Oe=>Oe.name===X.name);X.display=ee?`${X.name} (int)`:X.name,X.hasValue=!0,x.push(X)}));const q=x.filter(X=>X.canCreateDelete),Z=x.filter(X=>!X.canCreateDelete).sort((X,ee)=>X.name.localeCompare(ee.name));x.length=0,x.push(...q),x.push(...Z);let H=x;return g==="userCreated"?H=x.filter(X=>X.canCreateDelete):g==="hasValue"&&(H=x.filter(X=>X.hasValue&&X.canWriteTo)),H},[t,T,h,g]);d.exports.useMemo(()=>P.find(x=>x.name===s),[s,P]);const y=x=>{e(x)},D=x=>["Usuario Accionador","Usuarios de Selector","Usuarios de Seal","Item Desencadenante","Items seleccionados","Items de selector","Items de Seal"][x]||"";return _(v,{gap:1,children:[_(M,{className:"red",children:[a(M,{gap:1,alignItems:"center",children:a(C,{bold:!0,children:o})}),p&&_(M,{className:"container-buttons-var",children:[a("i",{className:"button-icon icon-var-furni",style:{backgroundColor:t===0?"rgb(186, 152, 22)":"transparent",transition:"all 0.2s ease"},onClick:()=>r(0)}),a("i",{className:"button-icon icon-var-user",style:{backgroundColor:t===1?"rgb(38, 142, 41)":"transparent",transition:"all 0.2s ease"},onClick:()=>r(1)}),m&&a("i",{className:"button-icon icon-var-global",style:{backgroundColor:t===2?"rgb(131, 29, 141)":"transparent",transition:"all 0.2s ease"},onClick:()=>r(2)}),a("i",{className:"button-icon icon-var-context",style:{backgroundColor:t===3?"rgb(176, 94, 30)":"transparent",transition:"all 0.2s ease"},onClick:()=>r(3)})]})]}),_("select",{className:"form-select",style:{width:"100%",appearance:"menulist",paddingLeft:"5px"},value:s,onChange:x=>y(x.target.value),children:[a("option",{value:"",children:c}),P.map(x=>a("option",{value:x.name,children:x.display||x.name},x.name))]}),l&&t!==2&&_(J,{children:[a(C,{bold:!0,children:"Opciones avanzadas"}),a("div",{className:"align-advancedoptionsone",children:t===1?_("div",{className:"button-group",children:[a("button",{onClick:()=>n(0),className:` icon-neighbor-3 ${i===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(1),className:` icon-neighbor-5 ${i===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(2),className:` icon-neighbor-2 ${i===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]}):_("div",{className:"button-group",children:[a("button",{onClick:()=>n(3),className:` icon-neighbor-3 ${i===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(4),className:` icon-neighbor-1 ${i===4?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(5),className:` icon-neighbor-5 ${i===5?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(6),className:` icon-neighbor-2 ${i===6?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),i!==void 0&&a(C,{style:{textAlign:"center"},children:D(i)})]})]})},Nte=()=>{const{trigger:s=null,setStringParam:e=null,setIntParams:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(!1),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(0),[g,m]=d.exports.useState(4),[p,f]=d.exports.useState(0);d.exports.useEffect(()=>{if(!s)return;i(s.stringData||"");const O=s.intData.length>0?s.intData[0]===1:!1,A=s.intData.length>1?s.intData[1]:0,N=s.intData.length>2?s.intData[2]:0,P=s.intData.length>3?s.intData[3]:0,y=s.intData.length>4?s.intData[4]:4;o(O),c(A),f(N),u(P),m(y)},[s==null?void 0:s.id]);const T=!0;d.exports.useEffect(()=>{},[r]);const I=()=>{e(r||""),t([n?1:0,l,p,h,g])};return a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:I,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:r,onVariableChange:i,targetType:h,onTargetTypeChange:u,typeOfAdvancedOption:g,onAdvancedOptionChange:m,label:"Variable a asignar:",showAdvancedOptions:!0,placeholder:"-- Selecciona variable --",filterType:"userCreated",showGlobal:!1}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"checkbox",checked:n,onChange:O=>o(O.target.checked)}),a(C,{small:!0,children:"Sustituir variable existente"})]}),a(C,{bold:!0,children:"Valor inicial"}),a("input",{type:"number",className:"form-control form-control-sm",style:{paddingLeft:"5px"},disabled:!T,value:l,onChange:O=>c(parseInt(O.target.value)||0)}),!r&&a(C,{small:!0,children:"Selecciona una variable creada en la sala (addon variable)."}),r&&!T&&a(C,{small:!0,children:"Esta variable no almacena valor. Se usar -1."})]})})},bte=()=>{const{trigger:s=null,setStringParam:e=null,setIntParams:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(4),[h,u]=d.exports.useState(0);d.exports.useEffect(()=>{if(!s)return;i(s.stringData||"");const m=s.intData.length>2?s.intData[2]:0,p=s.intData.length>3?s.intData[3]:0,f=s.intData.length>4?s.intData[4]:4;u(m),o(p),c(f)},[s==null?void 0:s.id]);const g=()=>{e(r||""),t([0,-1,h,n,l])};return a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:r,onVariableChange:i,targetType:n,onTargetTypeChange:o,typeOfAdvancedOption:l,onAdvancedOptionChange:c,label:"Variable a remover:",showAdvancedOptions:!0,placeholder:"-- Selecciona variable --",showInternal:!1,filterType:"userCreated",showGlobal:!1}),!r&&a(C,{small:!0,children:"Selecciona una variable creada en la sala (addon variable)."})]})})},yte=[{code:0,label:"Asignar"},{code:1,label:"Sumar"},{code:2,label:"Restar"},{code:3,label:"Multiplicar"},{code:4,label:"Dividir"},{code:5,label:"Potencia"},{code:6,label:"Mdulo"},{code:7,label:"Configurar mnimo"},{code:8,label:"Configurar mximo"},{code:9,label:"Aleatorio (0..valor)"},{code:10,label:"Valor absoluto"},{code:11,label:"Bitwise AND"},{code:12,label:"Bitwise OR"},{code:13,label:"Bitwise XOR"},{code:14,label:"Bitwise NOT"},{code:15,label:"Desplazar izquierda <<"},{code:16,label:"Desplazar derecha >>"}],vte=()=>{const{trigger:s=null,setStringParam:e=null,setIntParams:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(0),[g,m]=d.exports.useState(0),[p,f]=d.exports.useState(""),[T,I]=d.exports.useState(0),[O,A]=d.exports.useState(4),[N,P]=d.exports.useState(4);d.exports.useEffect(()=>{if(s){if(s.stringData){const[D,x]=s.stringData.split("::");i(D||""),x&&f(x)}s.intData.length>=5&&(o(s.intData[0]??0),c(s.intData[1]??0),u(s.intData[2]??0),m(s.intData[3]??0),I(s.intData[4]??0)),s.intData.length>=6&&A(s.intData[5]??4),s.intData.length>=7&&P(s.intData[6]??4)}},[s==null?void 0:s.id]);const y=()=>{const D=l===1?`${r}::${p}`:r;e(D),t([n,l,h,g,T,O,N])};return a(Ut,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:y,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:r,onVariableChange:i,targetType:g,onTargetTypeChange:m,typeOfAdvancedOption:O,onAdvancedOptionChange:A,label:"Variable objetivo:",showAdvancedOptions:!0,placeholder:"-- variable --",filterType:"hasValue"}),a(C,{bold:!0,children:"Operacin"}),a("select",{className:"form-select",style:{width:"100%",appearance:"menulist",paddingLeft:"5px"},value:n,onChange:D=>o(parseInt(D.target.value)),children:yte.map(D=>a("option",{value:D.code,children:D.label},D.code))}),a(C,{bold:!0,children:"Fuente del valor"}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"mode",checked:l===0,onChange:()=>c(0)}),a(C,{small:!0,children:"Definir valor"}),a("input",{type:"radio",name:"mode",checked:l===1,onChange:()=>c(1)}),a(C,{small:!0,children:"A partir de variable"})]}),l===0&&a("input",{type:"number",className:"form-control form-control-sm",style:{paddingLeft:"5px"},value:h,onChange:D=>u(parseInt(D.target.value)||0)}),l===1&&a(Cr,{selectedVariable:p,onVariableChange:f,targetType:T,onTargetTypeChange:I,typeOfAdvancedOption:N,onAdvancedOptionChange:P,label:"Variable fuente:",showAdvancedOptions:!0,placeholder:"-- variable fuente --",filterType:"hasValue"})]})})},Mte=s=>{switch(s){case we.BOT_CHANGE_FIGURE:return a(Gee,{});case we.BOT_FOLLOW_AVATAR:return a(Bee,{});case we.BOT_GIVE_HAND_ITEM:return a(Hee,{});case we.BOT_MOVE:return a(Wee,{});case we.BOT_TALK:return a(Yee,{});case we.BOT_TALK_DIRECT_TO_AVTR:return a(jee,{});case we.BOT_TELEPORT:return a(zee,{});case we.CALL_ANOTHER_STACK:return a(Kee,{});case we.CHASE:return a(qee,{});case we.CHAT:return a(Xee,{});case we.FLEE:return a($ee,{});case we.GIVE_REWARD:return a(Zee,{});case we.GIVE_SCORE:return a(tte,{});case we.GIVE_SCORE_TO_PREDEFINED_TEAM:return a(ete,{});case we.JOIN_TEAM:return a(ste,{});case we.KICK_FROM_ROOM:return a(rte,{});case we.LEAVE_TEAM:return a(ite,{});case we.MOVE_FURNI:return a(dte,{});case we.MOVE_AND_ROTATE_FURNI:return a(ote,{});case we.MOVE_FURNI_TO:return a(cte,{});case we.MUTE_USER:return a(_te,{});case we.RESET:return a(fte,{});case we.SET_FURNI_STATE:return a(Ite,{});case we.TELEPORT:return a(Ste,{});case we.TOGGLE_FURNI_STATE:return a(Cte,{});case we.WALK_TO_FURNI:return a(Ate,{});case we.SET_ADD_POINTS:return a(Ete,{});case we.RESET_SUBSTRACT_POINTS:return a(mte,{});case we.RELATIVE_MOVES:return a(gte,{});case we.CLOSE_DICE:return a(Qee,{});case we.FURNI_TO_FURNI:return a(Jee,{});case we.TIMER_CONTROL:return a(Ote,{});case we.SET_HEIGHT:return a(Tte,{});case we.SEND_SIGNAL:return a(pte,{});case we.SPEED_USER:return a(Rte,{});case we.GIVE_VARIABLE:return a(Nte,{});case we.REMOVE_VARIABLE:return a(bte,{});case we.CHANGE_VARIABLE_VALUE:return a(vte,{})}return null},Gi=s=>{const{requiresFurni:e=Se.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:r=!1,children:i=null}=s;return Ne(),a(bh,{wiredType:"addon",requiresFurni:e,save:t,hasSpecialInput:r,children:i})},Dte=()=>{const[s,e]=d.exports.useState(1),{trigger:t=null,setIntParams:r=null}=Ne(),i=()=>r([s]);return d.exports.useEffect(()=>{t.intData.length>=1?e(t.intData[0]):e(50)},[t]),_(Gi,{hasSpecialInput:!0,save:i,requiresFurni:0,children:[a(v,{gap:1,children:a(C,{gfbold:!0,children:E("wiredfurni.params.usercountmax",["value"],[s.toString()])})}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"10px 0"},children:[a(Y,{onClick:()=>e(n=>Math.max(50,n-50)),children:"-"}),a(ts,{className:"nitro-slider",min:50,max:2e3,step:50,value:s,onChange:n=>e(n)}),a(Y,{onClick:()=>e(n=>Math.min(2e3,n+50)),children:"+"})]})]})},Pte=()=>a(Gi,{hasSpecialInput:!0,save:null,requiresFurni:0}),Lte=()=>{const[s,e]=d.exports.useState(-1),[t,r]=d.exports.useState(0),{trigger:i=null,setIntParams:n=null}=Ne(),o=()=>n([s,t]);return d.exports.useEffect(()=>{e(i.intData.length>0?i.intData[0]:0),r(i.intData[1]||0)},[i]),_(Gi,{hasSpecialInput:!0,save:o,requiresFurni:0,children:[[0,1].map(l=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"selectedMode",id:`selectedMode${l}`,checked:s===l,onChange:c=>e(l)}),a(C,{children:E(`wiredfurni.params.mode.${l}`)})]},l)),a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>r(0),className:` icon-neighbor-1 ${t===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(1),className:` icon-neighbor-3 ${t===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(2),className:` icon-neighbor-5 ${t===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(3),className:` icon-neighbor-2 ${t===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),t!==void 0&&a(C,{style:{textAlign:"center"},children:["Todos en la Sala","Usuario Accionador","Usuario de Selector","Usuario de Seal"][t]})]})},Ute=()=>{const{trigger:s=null,setIntParams:e=null,setStringParam:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),h=()=>{e([n,l]),t(r)};return d.exports.useEffect(()=>{i(s.stringData||""),o(s.intData.length>0?s.intData[0]:0),c(s.intData.length>1?s.intData[1]:0)},[s]),_(Gi,{hasSpecialInput:!0,save:h,requiresFurni:0,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:"Nombre de la variable:"}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:Ee("wired.action.bot.talk.max.length",64),value:r,onChange:u=>i(u.target.value)})]}),a(C,{bold:!0,children:"Opciones de la variable:"}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!n,onChange:u=>o(u.target.checked?1:0)}),a(C,{children:E("wired_var_furni_has_value")})]}),a(C,{bold:!0,children:"Opciones de disponibilidad:"}),[0,1].map(u=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"wiredMode",id:`wiredMode${u}`,checked:l===u,onChange:()=>c(u)}),a(C,{children:E("wired_var_furni_"+u)})]},u))]})},xte=()=>{const{trigger:s=null,setIntParams:e=null,setStringParam:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),h=()=>{e([n,l]),t(r)};return d.exports.useEffect(()=>{i(s.stringData||""),o(s.intData.length>0?s.intData[0]:0),c(s.intData.length>1?s.intData[1]:0)},[s]),_(Gi,{hasSpecialInput:!0,save:h,requiresFurni:0,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:"Nombre de la variable:"}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:Ee("wired.action.bot.talk.max.length",64),value:r,onChange:u=>i(u.target.value)})]}),a(C,{bold:!0,children:"Opciones de la variable:"}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!n,onChange:u=>o(u.target.checked?1:0)}),a(C,{children:E("wired_var_user_has_value")})]}),a(C,{bold:!0,children:"Opciones de disponibilidad:"}),[0,1].map(u=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"wiredMode",id:`wiredMode${u}`,checked:l===u,onChange:()=>c(u)}),a(C,{children:E("wired_var_user_"+u)})]},u))]})},wte=()=>{const{trigger:s=null,setIntParams:e=null,setStringParam:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),l=()=>{e([n]),t(r)};return d.exports.useEffect(()=>{i(s.stringData||""),o(s.intData.length>0?s.intData[0]:0)},[s]),_(Gi,{hasSpecialInput:!0,save:l,requiresFurni:0,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:"Nombre de la variable:"}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:Ee("wired.action.bot.talk.max.length",64),value:r,onChange:c=>i(c.target.value)})]}),a(C,{bold:!0,children:"Opciones de disponibilidad:"}),[0,1].map(c=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"wiredMode",id:`wiredMode${c}`,checked:n===c,onChange:()=>o(c)}),a(C,{children:E("wired_var_global_"+c)})]},c))]})},Fte=()=>{const{trigger:s=null,setStringParam:e=null,setIntParams:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(1),[g,m]=d.exports.useState(""),[p,f]=d.exports.useState(2);return d.exports.useEffect(()=>{s&&(i((s.stringData||"").split("::",2)[0]||""),s.intData.length>0&&o(s.intData[0]),s.intData.length>1&&c(s.intData[1]),s.intData.length>2&&u(s.intData[2]),s.intData.length>3&&f(s.intData[3]),m((s.stringData||"").split("::",2)[1]||""))},[s]),a(Gi,{hasSpecialInput:!0,save:()=>{e(r+(l===1?"::"+g:"")),t([n,l,h,p])},requiresFurni:0,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:r,onVariableChange:i,targetType:0,onTargetTypeChange:()=>{},typeOfAdvancedOption:4,onAdvancedOptionChange:()=>{},label:"Variable a filtrar:",showAdvancedOptions:!1,placeholder:"-- variable --",showGlobal:!1}),a(C,{bold:!0,children:"Ordenar por"}),_("div",{children:[_("label",{children:[a("input",{type:"radio",checked:n===0,onChange:()=>o(0)})," Mayor valor"]}),_("label",{children:[a("input",{type:"radio",checked:n===1,onChange:()=>o(1)})," Menor valor"]}),_("label",{children:[a("input",{type:"radio",checked:n===2,onChange:()=>o(2)})," Fecha creacin (antigua)"]}),_("label",{children:[a("input",{type:"radio",checked:n===3,onChange:()=>o(3)})," Fecha creacin (reciente)"]}),_("label",{children:[a("input",{type:"radio",checked:n===4,onChange:()=>o(4)})," Fecha modificacin (antigua)"]}),_("label",{children:[a("input",{type:"radio",checked:n===5,onChange:()=>o(5)})," Fecha modificacin (reciente)"]})]}),a(C,{bold:!0,children:"Cantidad a filtrar"}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"cm",checked:l===0,onChange:()=>c(0)}),a(C,{children:"Definir valor"}),a("input",{type:"number",value:h,onChange:I=>u(parseInt(I.target.value)||0)})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"cm",checked:l===1,onChange:()=>c(1)}),a(C,{children:"A partir de variable"})]}),l===1&&a(Cr,{selectedVariable:g,onVariableChange:m,targetType:p,onTargetTypeChange:f,typeOfAdvancedOption:4,onAdvancedOptionChange:()=>{},label:"Variable para cantidad:",showAdvancedOptions:!0,placeholder:"-- variable --",showGlobal:!0,showTargetButtons:!0})]})})},kte=()=>{const{trigger:s=null,setStringParam:e=null,setIntParams:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(1),[g,m]=d.exports.useState(""),[p,f]=d.exports.useState(2);return d.exports.useEffect(()=>{s&&(i((s.stringData||"").split("::",2)[0]||""),s.intData.length>0&&o(s.intData[0]),s.intData.length>1&&c(s.intData[1]),s.intData.length>2&&u(s.intData[2]),s.intData.length>3&&f(s.intData[3]),m((s.stringData||"").split("::",2)[1]||""))},[s]),a(Gi,{hasSpecialInput:!0,save:()=>{e(r+(l===1?"::"+g:"")),t([n,l,h,p])},requiresFurni:0,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:r,onVariableChange:i,targetType:1,onTargetTypeChange:()=>{},typeOfAdvancedOption:4,onAdvancedOptionChange:()=>{},label:"Variable a filtrar:",showAdvancedOptions:!1,placeholder:"-- variable --",showGlobal:!1}),a(C,{bold:!0,children:"Ordenar por"}),_("div",{children:[_("label",{children:[a("input",{type:"radio",checked:n===0,onChange:()=>o(0)})," Mayor valor"]}),_("label",{children:[a("input",{type:"radio",checked:n===1,onChange:()=>o(1)})," Menor valor"]}),_("label",{children:[a("input",{type:"radio",checked:n===2,onChange:()=>o(2)})," Fecha creacin (antigua)"]}),_("label",{children:[a("input",{type:"radio",checked:n===3,onChange:()=>o(3)})," Fecha creacin (reciente)"]}),_("label",{children:[a("input",{type:"radio",checked:n===4,onChange:()=>o(4)})," Fecha modificacin (antigua)"]}),_("label",{children:[a("input",{type:"radio",checked:n===5,onChange:()=>o(5)})," Fecha modificacin (reciente)"]})]}),a(C,{bold:!0,children:"Cantidad a filtrar"}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"cmu",checked:l===0,onChange:()=>c(0)}),a(C,{children:"Definir valor"}),a("input",{type:"number",value:h,onChange:I=>u(parseInt(I.target.value)||0)})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"cmu",checked:l===1,onChange:()=>c(1)}),a(C,{children:"A partir de variable"})]}),l===1&&a(Cr,{selectedVariable:g,onVariableChange:m,targetType:p,onTargetTypeChange:f,typeOfAdvancedOption:4,onAdvancedOptionChange:()=>{},label:"Variable para cantidad:",showAdvancedOptions:!0,placeholder:"-- variable --",showGlobal:!0,showTargetButtons:!0})]})})},Gte=()=>{const[s,e]=d.exports.useState(!1),[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(!1),[o,l]=d.exports.useState(!1),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(0),[m,p]=d.exports.useState(0),{trigger:f=null,setIntParams:T=null}=Ne(),I=()=>{let O=0;s&&(O|=1),t&&(O|=2),i&&(O|=4),o&&(O|=8),T([O,c,u,m])};return d.exports.useEffect(()=>{const O=(f==null?void 0:f.intData)||[],A=O[0]??0;e((A&1)!==0),r((A&2)!==0),n((A&4)!==0),l((A&8)!==0),h(O[1]??0),g(O[2]??0),p(O[3]??0)},[f]),_(Gi,{hasSpecialInput:!0,save:I,requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.conditions")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"height",checked:s,onChange:O=>e(O.target.checked)}),a(C,{children:E("wiredfurni.params.mov.physic.height")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"throughFurni",checked:t,onChange:O=>r(O.target.checked)}),a(C,{children:E("wiredfurni.params.mov.physic.throughFurni")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"throughUser",checked:i,onChange:O=>n(O.target.checked)}),a(C,{children:E("wiredfurni.params.mov.physic.throughUser")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"blockedByFurni",checked:o,onChange:O=>l(O.target.checked)}),a(C,{children:E("wiredfurni.params.mov.physic.blockedByFurni")})]})]}),a("hr",{className:"m-0 bg-dark"}),a(C,{children:"Mover a travs de furnis"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>h(0),className:` icon-neighbor-3 ${c===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>h(1),className:` icon-neighbor-1 ${c===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>h(2),className:` icon-neighbor-5 ${c===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>h(3),className:` icon-neighbor-2 ${c===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>h(4),className:` icon-neighbor-7 ${c===4?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),c!==void 0&&a(C,{style:{textAlign:"center"},children:["Accionador","Seleccionados","Selector","Seal","Todos en la sala"][c]}),a(C,{children:"Bloqueado por furnis"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>g(0),className:` icon-neighbor-3 ${u===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>g(1),className:` icon-neighbor-1 ${u===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>g(2),className:` icon-neighbor-5 ${u===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>g(3),className:` icon-neighbor-2 ${u===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>g(4),className:` icon-neighbor-7 ${u===4?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),u!==void 0&&a(C,{style:{textAlign:"center"},children:["Accionador","Seleccionados","Selector","Seal","Todos en la sala"][u]}),a(C,{children:"Mover a travs de usuarios"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>p(0),className:` icon-neighbor-3 ${m===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>p(1),className:` icon-neighbor-5 ${m===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>p(2),className:` icon-neighbor-2 ${m===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>p(3),className:` icon-neighbor-6 ${m===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),m!==void 0&&a(C,{style:{textAlign:"center"},children:["Accionador","Selector","Seal","Todos en la sala"][m]})]})},Bte=()=>{const[s,e]=d.exports.useState(50),{trigger:t=null,setIntParams:r=null}=Ne(),i=()=>r([s]);return d.exports.useEffect(()=>{e(t.intData.length>0?t.intData[0]:0)},[t]),_(Gi,{hasSpecialInput:!0,save:i,requiresFurni:0,children:[a(C,{bold:!0,children:E("wiredfurni.params.filter.for")+" "+s+" Furnis"}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[a(Y,{onClick:()=>e(n=>Math.max(1,n-1)),children:"-"}),a(ts,{className:"nitro-slider",min:1,max:100,value:s,onChange:n=>e(n)}),a(Y,{onClick:()=>e(n=>Math.min(100,n+1)),children:"+"})]})]})},Zh=25,Vte=()=>{const{trigger:s=null,setStringParam:e=null}=Ne(),[t,r]=d.exports.useState(""),i=h=>h.replace(/\r/g,""),n=h=>{const u=i(h),g=u.split(`
`);return g.length<=Zh?u:g.slice(0,Zh).join(`
`)};d.exports.useEffect(()=>{const h=(s==null?void 0:s.stringData)||"";r(n(h))},[s]);const o=h=>{r(n(h.target.value))},l=()=>e(t),c=d.exports.useMemo(()=>t.length?t.split(`
`).length:0,[t]);return a(Gi,{hasSpecialInput:!0,save:l,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:"Mapa de textos conectados"}),_(C,{small:!0,children:["Escribe hasta ",Zh," lneas usando el formato ",a("b",{children:"numero=texto"}),". Cada nmero corresponde al valor que recibir el addon de variable."]}),a("textarea",{className:"form-control form-control-sm",rows:8,spellCheck:!1,value:t,onChange:o}),_(M,{children:[_(C,{small:!0,children:[c," / ",Zh," lneas"]}),a(C,{small:!0,children:"Ejemplo: 1=Hola mundo"})]})]})})},VR="aquiloqueponga",nm=", ",ed=[{value:0,label:"Usuario Accionador",icon:"icon-neighbor-0"},{value:1,label:"Usuario de Selector",icon:"icon-neighbor-5"},{value:2,label:"Usuario de Senal",icon:"icon-neighbor-2"}],Hte=()=>{const{simpleAlert:s=null}=$t(),{trigger:e=null,setIntParams:t=null,setStringParam:r=null}=Ne(),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(0),[c,h]=d.exports.useState(nm),[u,g]=d.exports.useState(0);d.exports.useEffect(()=>{if(!e)return;const O=(e.stringData||"").split(on),A=O[0]||"",N=O[1]||nm;n(p(A)),h(N.slice(0,5));const P=e.intData||[];l(P[0]===1?1:0),g(ed.some(y=>y.value===P[1])?P[1]:0)},[e]);const m=O=>{s?s(O):alert(O)},p=O=>{if(!O)return"";let A=O.trim();return A.startsWith("$(")&&(A=A.slice(2)),A.endsWith(")")&&(A=A.slice(0,-1)),A.trim()},f=()=>{const O=p(i);if(!O.length){m("Debes definir un identificador (solo la palabra, sin $( ) ).");return}const A=(c||"").slice(0,5);if(o===1&&A.trim().length===0){m("El delimitador debe tener entre 1 y 5 caracteres.");return}const N=`$(${O})`;r(`${N}${on}${A}`),t([o,u])},T=d.exports.useMemo(()=>i&&i.length?`$(${i})`:`$(${VR})`,[i]),I=d.exports.useMemo(()=>{var O;return((O=ed.find(A=>A.value===u))==null?void 0:O.label)||ed[0].label},[u]);return a(Gi,{hasSpecialInput:!0,save:f,requiresFurni:0,children:_(v,{gap:1,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:"Identificador a reemplazar"}),a("input",{className:"form-control form-control-sm",type:"text",value:i,onChange:O=>n(O.target.value),placeholder:VR})]}),_(C,{children:["Escribe solo la palabra. Se insertar como ",a("span",{style:{color:"rgb(133, 133, 17)",fontWeight:600},children:T})," en el texto del wired."]}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Formato de salida"}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputSingle",name:"wfTextOutputMode",checked:o===0,onChange:()=>l(0)}),a(C,{children:"Unico"})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputMultiple",name:"wfTextOutputMode",checked:o===1,onChange:()=>l(1)}),a(C,{children:"Multiples"})]}),o===1&&_(v,{gap:0,children:[a(C,{small:!0,children:"Delimitador (1 a 5 caracteres)"}),a("input",{className:"form-control form-control-sm",type:"text",maxLength:5,value:c,onChange:O=>h(O.target.value),placeholder:nm})]})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Obtener entidad"}),a("div",{className:"align-advancedoptionsone",children:a("div",{className:"button-group",children:ed.map(O=>{const A=u===O.value;return a("button",{onClick:()=>g(O.value),className:`${O.icon} ${A?"button-icons-selector-general-selected":"button-icons-selector-general"}`},O.value)})})}),a(C,{style:{textAlign:"center"},children:I})]})]})})},HR="variable",td=", ",am=5,Qa=1,Vo=1,WR=0,ru=1,jR=2,YR=3,Wte=-1,iu=2,sd=0,rd=1,jte=()=>{const{simpleAlert:s=null}=$t(),{trigger:e=null,setIntParams:t=null,setStringParam:r=null}=Ne(),[i,n]=d.exports.useState(""),[o,l]=d.exports.useState(""),[c,h]=d.exports.useState(ru),[u,g]=d.exports.useState(0),[m,p]=d.exports.useState(0),[f,T]=d.exports.useState(td),[I,O]=d.exports.useState(0),[A,N]=d.exports.useState(iu),P=L=>{switch(L){case WR:case ru:case jR:case YR:return L;default:return ru}},y=(L,B)=>L===ru?B===1||B===2?B:0:L===WR||L===YR?B!=null&&B>=3&&B<=6?B:5:Wte;d.exports.useEffect(()=>{if(!e)return;const L=(e.stringData||"").split(on),B=L[0]||"",V=L[1]||td,q=L[2]||"";n(x(B)),T((V||td).slice(0,am)),l(q);const Z=e.intData||[],H=X=>X===iu||X===sd||X===rd?X:X==null?iu:X===1?rd:sd;if(Z.length>=5){const X=P(Z[0]);h(X),p(Z[1]===Qa?Qa:0),O(Z[2]===Vo?Vo:0),N(H(Z[3])),g(y(X,Z[4]));return}h(ru),p(Z[0]===Qa?Qa:0),O(Z[2]===Vo?Vo:0),N(H(Z[3]))},[e]);const D=L=>{s?s(L):alert(L)},x=L=>{if(!L)return"";let B=L.trim();return B.startsWith("$(")&&(B=B.slice(2)),B.endsWith(")")&&(B=B.slice(0,-1)),B.trim()},w=()=>{const L=x(i);if(!L.length){D("Debes definir un identificador (solo la palabra, sin $( ) ).");return}if(!o.length){D("Selecciona una variable.");return}const B=(f||"").slice(0,am);if(m===Qa&&B.trim().length===0){D("El delimitador debe tener entre 1 y 5 caracteres.");return}const q=[`$(${L})`,B,o].join(on);r(q),t([c,m,I,A,y(c,u)])},k=L=>{const B=P(L);h(B),g(V=>y(B,V))},F=d.exports.useMemo(()=>i&&i.length?`$(${i})`:`$(${HR})`,[i]);return a(Gi,{hasSpecialInput:!0,save:w,requiresFurni:0,children:_(v,{gap:1,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:"Identificador a reemplazar"}),a("input",{className:"form-control form-control-sm",type:"text",value:i,onChange:L=>n(L.target.value),placeholder:HR})]}),_(C,{children:["Escribe solo la palabra. Se insertar como ",a("span",{style:{color:"rgb(133, 133, 17)",fontWeight:600},children:F})," en el texto del wired."]}),a(v,{gap:1,children:a(Cr,{selectedVariable:o,onVariableChange:l,targetType:c,onTargetTypeChange:k,typeOfAdvancedOption:u,onAdvancedOptionChange:L=>g(y(c,L)),showAdvancedOptions:c!==jR,showGlobal:!0,showTargetButtons:!0,placeholder:"-- variable --"})}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Formato del valor"}),_(v,{gap:1,children:[_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableNumeric",name:"wfTextOutputVariableFormat",checked:I===0,onChange:()=>O(0)}),a(C,{children:"Valor numerico"})]}),I!==Vo&&_(v,{gap:1,style:{marginLeft:"1.5rem"},children:[_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableSelectionOrder",name:"wfTextOutputVariableOrder",checked:A===iu,onChange:()=>N(iu)}),a(C,{children:"Orden de seleccin"})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableAsc",name:"wfTextOutputVariableOrder",checked:A===sd,onChange:()=>N(sd)}),a(C,{children:"Creciente"})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableDesc",name:"wfTextOutputVariableOrder",checked:A===rd,onChange:()=>N(rd)}),a(C,{children:"Descendente"})]})]})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableText",name:"wfTextOutputVariableFormat",checked:I===Vo,onChange:()=>O(Vo)}),a(C,{children:"Texto conectado"})]})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Cantidad de resultados"}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableSingle",name:"wfTextOutputVariableMode",checked:m===0,onChange:()=>p(0)}),a(C,{children:"Unico"})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",id:"wfTextOutputVariableMultiple",name:"wfTextOutputVariableMode",checked:m===Qa,onChange:()=>p(Qa)}),a(C,{children:"Multiples"})]}),m===Qa&&_(v,{gap:0,children:[a(C,{small:!0,children:"Delimitador (1 a 5 caracteres)"}),a("input",{className:"form-control form-control-sm",type:"text",maxLength:am,value:f,onChange:L=>T(L.target.value),placeholder:td})]})]})]})})},Yte=s=>{switch(s){case Os.ANIMATION_TIME:return a(Dte,{});case Os.CANCEL_ANIMATION:return a(Pte,{});case Os.CARRY_USERS:return a(Lte,{});case Os.MOVEMENT_PHYSICS:return a(Gte,{});case Os.FURNI_VARIABLE:return a(Ute,{});case Os.USER_VARIABLE:return a(xte,{});case Os.GLOBAL_VARIABLE:return a(wte,{});case Os.FURNI_FILTER_BY_VAR:return a(Fte,{});case Os.USERS_FILTER_BY_VAR:return a(kte,{});case Os.USER_FILTER:return a(Bte,{});case Os.VARIABLE_TEXT:return a(Vte,{});case Os.TEXT_OUTPUT_USERNAME:return a(Hte,{});case Os.TEXT_OUTPUT_VARIABLE:return a(jte,{})}return null},Qs=s=>{const{requiresFurni:e=Se.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:r=!1,children:i=null,allOrOne:n=!1,allOrOneFor:o,customAllOrOneTexts:l=null}=s,{trigger:c=null,furniOptions:h=0,setFurniOptions:u=null,furniType:g=0,setFurniType:m=null,userOptions:p=0,setUserOptions:f=null,userType:T=0,setUserType:I=null,allOrOneOptions:O=0,setAllOrOneOptions:A=null,allOrOneType:N=0,setAllOrOneType:P=null}=Ne();return d.exports.useEffect(()=>{u(c==null?void 0:c.furniOptions),m(c==null?void 0:c.furniType),f(c==null?void 0:c.userOptions),I(c==null?void 0:c.userType),A(c==null?void 0:c.allOrOneOptions),P(c==null?void 0:c.allOrOneType)},[c,u,m,f,I,A,P]),_(bh,{wiredType:"condition",requiresFurni:e,hasSpecialInput:r,save:()=>t&&t(),children:[i,(n||O===1)&&_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1].map(D=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggle",checked:N===D,onChange:()=>P(D)}),a(C,{children:l?l[D]:E((()=>({0:"wired.params.allorone.players.",1:"wired.params.allorone.furnis.",2:"wired.params.allorone.condition.type."})[s.allOrOneFor]||"wired.params.allorone.players.")()+D)})]},D))]}),h===1&&_(v,{children:[a(C,{bold:!0,children:"Furni"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>m(0),className:` icon-neighbor-1 ${g===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>m(1),className:` icon-neighbor-5 ${g===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>m(2),className:` icon-neighbor-3 ${g===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>m(3),className:` icon-neighbor-2 ${g===3?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),g!==void 0&&a(C,{style:{textAlign:"center"},children:["Seleccionados","Selector","Usar Item Desencadenante","Items de Seal"][g]})]}),p===1&&_(v,{children:[a(C,{bold:!0,children:"Users"}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>I(0),className:` icon-neighbor-0 ${T===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>I(1),className:` icon-neighbor-5 ${T===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>I(2),className:` icon-neighbor-2 ${T===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),T!==void 0&&a(C,{style:{textAlign:"center"},children:["Usuario Accionador","Usuario de Selector","Usuario de Seal","Usar Items de Seal"][T]})]})]})},zte=s=>{const e=[0,1,2],t=[0,1],[r,i]=d.exports.useState(0),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(""),{trigger:h=null,setIntParams:u=null,setStringParam:g=null}=Ne(),m=()=>{u([r,n]),g(n===1&&l||"")};return d.exports.useEffect(()=>{const p=h;if(!p)return;const f=p.intData||[];i(f.length>0?f[0]:0),o(f.length>1?f[1]:0),c(typeof p.stringData=="string"?p.stringData:"")},[h]),_(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,allOrOne:!0,allOrOneFor:0,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.entitytype")}),e.map(p=>_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"selectedType",id:`selectedType${p}`,checked:r===p,onChange:()=>i(p)}),a(C,{children:E(`wiredfurni.params.entitytype.${p}`)})]},p))]}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.activator")}),t.map(p=>_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"selectedActivator",id:`selectedActivator${p}`,checked:n===p,onChange:()=>o(p)}),a(C,{children:E(`wiredfurni.params.entityactivator.${p}`)})]},p)),n===1&&a(M,{gap:1,alignItems:"center",children:a("input",{className:"form-control",type:"text",placeholder:E("wiredfurni.params.username.placeholder")||"Nombre de usuario",value:l,onChange:p=>c(p.target.value)})})]}),a("hr",{className:"m-0 bg-dark"})]})},Kte=[2,5,7,8,9,10,27],qte=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.handitem")}),a("select",{className:"form-select form-select-sm",value:e,onChange:o=>t(parseInt(o.target.value)),children:Kte.map(o=>a("option",{value:o,children:E(`handitem${o}`)},o))})]})})},Xte=s=>a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Qte=s=>a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),$te=[1,2,3,4],Jte=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.team")}),$te.map(o=>_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${o}`,checked:e===o,onChange:l=>t(o)}),a(C,{children:E(`wiredfurni.params.team.${o}`)})]},o))]})})},Zte=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.badgecode")}),a("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:o=>t(o.target.value)})]})})},ese=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t((r==null?void 0:r.intData[0])??0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.tooltip.effectid")}),a("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:o=>t(parseInt(o.target.value))})]})})},tse=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(""),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>{let c=0,h=0;const u=new Date(e),g=new Date(r);u&&g&&(c=u.getTime()/1e3,h=g.getTime()/1e3),o([c,h])};return d.exports.useEffect(()=>{if(n.intData.length>=2){let c=new Date,h=new Date;n.intData[0]>0&&(c=new Date(n.intData[0]*1e3)),n.intData[1]>0&&(h=new Date(n.intData[1]*1e3)),t(yT(c)),i(yT(h))}},[n]),_(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.startdate")}),a("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>t(c.target.value)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.enddate")}),a("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:c=>i(c.target.value)})]})]})},sse=s=>a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null,allOrOne:!0,allOrOneFor:1}),rse=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.requireall")}),[0,1].map(o=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:e===o,onChange:l=>t(o)}),a(C,{children:E("wiredfurni.params.requireall."+o)})]},o))]})})},ise=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.not_requireall")}),[0,1].map(o=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${o}`,checked:e===o,onChange:l=>t(o)}),a(C,{children:E(`wiredfurni.params.not_requireall.${o}`)})]},o))]})})},nse=s=>a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null,allOrOne:!0,allOrOneFor:2}),ase=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(0),{trigger:h=null,setIntParams:u=null}=Ne(),g=()=>u([e,r,n,l]),m=()=>W(new PE(h.id));return d.exports.useEffect(()=>{t(h.getBoolean(0)?1:0),i(h.getBoolean(1)?1:0),o(h.getBoolean(2)?1:0),c(h.getBoolean(3)?1:0)},[h]),_(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:g,allOrOne:!0,allOrOneFor:2,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.conditions")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:p=>t(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.state")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:p=>i(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.direction")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!n,onChange:p=>o(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.position")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"heightFlag",checked:!!l,onChange:p=>c(p.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.condition.height")})]})]}),a("hr",{className:"m-0 bg-dark"}),a(v,{children:a(Y,{onClick:m,children:"Apply Snapshot Now"})})]})},ose=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),[n,o]=d.exports.useState("0.00"),{trigger:l=null,setIntParams:c=null}=Ne(),h=()=>c([e,Math.round(r*100)]);d.exports.useEffect(()=>{if(l&&l.intData.length>0){const g=l.intData[1]/100;i(g),o(g.toFixed(2)),t(l.intData[0])}},[l]),d.exports.useEffect(()=>{o(r.toFixed(2))},[r]);const u=()=>{const g=parseFloat(n);if(!isNaN(g)){const m=Math.max(0,Math.min(40,g));i(m)}};return _(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:h,allOrOne:!0,allOrOneFor:2,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1,2].map(g=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggleHeight",checked:e===g,onChange:()=>t(g)}),a(C,{children:E("wired.params.height.mode."+g)})]},g))]}),a("hr",{className:"m-0 bg-dark"}),_(M,{alignItems:"center",justifyContent:"between",children:[a(C,{bold:!0,children:E("wiredfurni.params.filter.for")}),_(M,{gap:1,children:[a("input",{type:"text",value:n,onChange:g=>o(g.target.value),onBlur:u,onKeyPress:g=>g.key==="Enter"&&u(),style:{width:"80px",textAlign:"center"}}),a(C,{children:"m"})]})]}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"10px 0"},children:[a(Y,{onClick:()=>i(g=>Number(Math.max(0,g-.01).toFixed(2))),children:" - "}),a(ts,{className:"nitro-slider",min:0,max:40,step:.01,value:r,onChange:g=>i(Number(g.toFixed(2))),renderThumb:(g,m)=>a("div",{...g,children:m.valueNow.toFixed(2)})}),a(Y,{onClick:()=>i(g=>Number(Math.min(40,g+.01).toFixed(2))),children:" + "})]})]})},lse=()=>{const{trigger:s=null,setStringParam:e=null}=Ne(),[t,r]=d.exports.useState([]),[i,n]=d.exports.useState(""),o=globalThis;o.__wiredRoomVarsCache||(o.__wiredRoomVarsCache={list:null}),d.exports.useEffect(()=>{o.__wiredRoomVarsCache.list?r(o.__wiredRoomVarsCache.list):W(new eg)},[]),d.exports.useEffect(()=>{s&&n(s.stringData||"")},[s==null?void 0:s.id]),j(Z_,h=>{const g=h.getParser().vars||[];o.__wiredRoomVarsCache.list;const p=(T=>T.map(I=>`${I.name}|${I.hasValue?"1":"0"}|${I.permanent?"1":"0"}|${I.availability}`).join("#"))(g),f=o.__wiredRoomVarsCache.sig||"";p!==f&&(o.__wiredRoomVarsCache.list=g,o.__wiredRoomVarsCache.sig=p,r(g),i&&(g.find(I=>I.name===i)||n("")))});const l=d.exports.useMemo(()=>(t.length>500?t.slice(0,500):t).map(g=>a("option",{value:g.name,children:g.name},g.name)),[t]),c=()=>e(i||"");return a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:c,allOrOne:!0,allOrOneFor:1,children:_(v,{gap:1,children:[a(C,{bold:!0,children:"Variable a comprobar"}),_("select",{className:"form-select",value:i,onChange:h=>n(h.target.value),children:[a("option",{value:"",children:"-- Selecciona variable --"}),l,t.length>500&&_("option",{disabled:!0,children:["... (",t.length-500," ms ocultas)"]})]}),!i&&a(C,{small:!0,children:"Selecciona una variable creada con el addon de variable."})]})})},cse=["Todas las variables corresponden","Cualquiera de las variables corresponde"],zR=s=>s===1||s===2?s:0,om=s=>s===1||s===2?0:4,id=(s,e)=>s===1?[0,1,2].includes(e)?e:0:s===2?0:[3,4,5,6].includes(e)?e:4,tU=({negated:s})=>{const{trigger:e=null,setStringParam:t=null,setIntParams:r=null,setAllOrOneOptions:i=null}=Ne(),[n,o]=d.exports.useState(""),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(om(0));d.exports.useEffect(()=>{const f=e;if(!f){o(""),c(0),u(om(0)),i&&i(1);return}o(f.stringData||"");const T=f.intData&&f.intData.length>0?f.intData[0]:0,I=zR(T);c(I);const O=f.intData&&f.intData.length>1?f.intData[1]:om(I),A=id(I,O);u(A),i&&(!f.allOrOneOptions||f.allOrOneOptions===0)&&i(1)},[e==null?void 0:e.id,i]);const g=f=>{const T=zR(f);c(T),u(I=>id(T,I)),o("")},m=d.exports.useMemo(()=>s?"La condicin se cumple si los objetivos seleccionados NO tienen la variable indicada.":"La condicin se cumple si los objetivos seleccionados tienen la variable indicada.",[s]),p=()=>{t&&t(n||""),r&&r([l,id(l,h)])};return a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:p,allOrOne:!0,allOrOneFor:2,customAllOrOneTexts:cse,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:n,onVariableChange:o,targetType:l,onTargetTypeChange:g,typeOfAdvancedOption:h,onAdvancedOptionChange:f=>u(id(l,f)),label:"Variable a comprobar:",showAdvancedOptions:l!==2,placeholder:"-- Selecciona variable --",showGlobal:!0}),a(C,{small:!0,children:m}),!n&&a(C,{small:!0,children:"Selecciona una variable para guardar la configuracin."})]})})},use=()=>a(tU,{negated:!1}),hse=()=>a(tU,{negated:!0}),dse=s=>{const e=[0,1,2],[t,r]=d.exports.useState(0),[i,n]=d.exports.useState(50),[o,l]=d.exports.useState("first"),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(8),[m,p]=d.exports.useState(11),{trigger:f=null,setIntParams:T=null}=Ne(),I=()=>{T([t,c,i])};d.exports.useEffect(()=>{const N=f;if(!N)return;const P=N.intData||[];r(P.length>0?P[0]:0),h(P.length>1?P[1]:0);const y=f.intData[1];[8,9,10].includes(y)?(l("first"),g(y)):[11,12,13].includes(y)&&(l("second"),p(y)),n(P.length>2?P[2]:0)},[f]);const O=N=>{l(N),h(N==="first"?u:m)},A=N=>{h(N),o==="first"?g(N):p(N)};return _(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:I,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wired_select_mode_u_want")}),e.map(N=>_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"selectedType",id:`selectedType${N}`,checked:t===N,onChange:()=>r(N)}),a(C,{children:E(`wired.params.height.mode.${N}`)})]},N))]}),a("hr",{className:"m-0 bg-dark"}),a(C,{bold:!0,children:E("wiredfurni.params.compare.with")+" "+i}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[a(Y,{onClick:()=>n(N=>Math.max(1,N-1)),children:"-"}),a(ts,{className:"nitro-slider",min:1,max:100,value:i,onChange:N=>n(N)}),a(Y,{onClick:()=>n(N=>Math.min(100,N+1)),children:"+"})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{style:{display:"flex",alignItems:"flex-start"},gap:1,children:[_("div",{className:"container-button-user-furni",children:[a(C,{bold:!0,children:E("wiredfurni.params.select.neighbor.title")}),_(M,{style:{height:"20px"},children:[a("button",{onClick:()=>O("first"),style:{border:o==="first"?"2px solid white":"2px solid rgb(182, 190, 197)",backgroundColor:o==="first"?"#ececec":"rgb(205, 211, 217)",borderTopLeftRadius:"10px"},children:a("div",{className:"icon-furnis-neighbor icon-neighbor-selectfurniuser"})}),a("div",{style:{width:"5px",height:"1px"}}),a("button",{onClick:()=>O("second"),style:{border:o==="second"?"2px solid white":"2px solid rgb(182, 190, 197)",backgroundColor:o==="second"?"#ececec":"rgb(205, 211, 217)",borderBottomRightRadius:"10px"},children:a("div",{className:"icon-users-neighbor icon-neighbor-selectfurniuser"})})]})]}),a(M,{alignItems:"center",gap:1,justifyContent:"center",alignSelf:"center",children:(o==="first"?[8,9,10]:[11,12,13]).map(N=>a("button",{className:`button-icons-selector-general icon-neighbor-${N}`,onClick:()=>A(N),style:{backgroundColor:c===N?"rgb(236, 236, 236)":"#cdd3d9",border:c===N?"2px solid white":"2px solid #b6bec5"}},N))}),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:a(C,{bold:!0,children:E(`wiredfurni.params.textmode.neighbor.${c}`)})})]})]})},_se=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.allowbefore",["seconds"],[$c(e)])}),a(ts,{className:"nitro-slider",min:1,max:1200,value:e,onChange:o=>t(o)})]})})},gse=s=>{const[e,t]=d.exports.useState(-1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.allowafter",["seconds"],[$c(e)])}),a(ts,{className:"nitro-slider",min:1,max:1200,value:e,onChange:o=>t(o)})]})})},mse=s=>{const[e,t]=d.exports.useState(1),[r,i]=d.exports.useState(1),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>o([e,r]);return d.exports.useEffect(()=>{n.intData.length>=2?(t(n.intData[0]),i(n.intData[1])):(t(1),i(1))},[n]),_(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.usercountmin",["value"],[e.toString()])}),a(ts,{className:"nitro-slider",min:1,max:50,value:e,onChange:c=>t(c)})]}),_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.usercountmax",["value"],[r.toString()])}),a(ts,{className:"nitro-slider",min:1,max:50,value:r,onChange:c=>i(c)})]})]})},Wn=0,BI=1,qu=2,ip=0,fse=1,pse=2,Ese=3,np=4,Ise=5,Tse=6,ao=0,Mu=1,Rse=0,Sse=1,Du=2,Ose=3,Cse=4,Ase=5,ap=[{value:Rse,label:"Mayor que",icon:">"},{value:Sse,label:"Mayor o igual",icon:""},{value:Du,label:"Igual",icon:"="},{value:Ose,label:"Menor o igual",icon:""},{value:Cse,label:"Menor que",icon:"<"},{value:Ase,label:"Desigual",icon:""}],Nse=["Todos los objetivos cumplen","Cualquiera de los objetivos cumple"],nd=s=>s===BI||s===qu?s:Wn,Fl=s=>s===BI?ip:s===qu?0:np,$a=(s,e)=>s===BI?[ip,fse,pse].includes(e)?e:ip:s===qu?0:[Ese,np,Ise,Tse].includes(e)?e:np,bse=s=>{const e=ap.map(t=>t.value);return s!=null&&e.includes(s)?s:Du},yse=s=>s===Mu?Mu:ao,vse=s=>{if(!s)return["","",""];const e=s.split(on);return[e[0]||"",e[1]||"",e[2]||""]},Mse=()=>{const{simpleAlert:s=null}=$t(),{trigger:e=null,setStringParam:t=null,setIntParams:r=null,setAllOrOneOptions:i=null}=Ne(),[n,o]=d.exports.useState(""),[l,c]=d.exports.useState(Wn),[h,u]=d.exports.useState(Fl(Wn)),[g,m]=d.exports.useState(Du),[p,f]=d.exports.useState(ao),[T,I]=d.exports.useState(""),[O,A]=d.exports.useState(""),[N,P]=d.exports.useState(Wn),[y,D]=d.exports.useState(Fl(Wn));d.exports.useEffect(()=>{const V=e;if(!V){o(""),A(""),I(""),c(Wn),u(Fl(Wn)),m(Du),f(ao),P(Wn),D(Fl(Wn)),i&&i(1);return}const[q,Z,H]=vse(V.stringData);o(q),A(Z),I(H||"");const X=V.intData&&V.intData.length>0?V.intData[0]:Wn,ee=nd(X);c(ee);const Oe=V.intData&&V.intData.length>1?V.intData[1]:Fl(ee);u($a(ee,Oe));const de=V.intData&&V.intData.length>2?V.intData[2]:Du;m(bse(de));const ve=V.intData&&V.intData.length>3?V.intData[3]:ao;f(yse(ve));const Me=V.intData&&V.intData.length>4?V.intData[4]:ee,ce=nd(Me);P(ce);const ue=V.intData&&V.intData.length>5?V.intData[5]:Fl(ce);D($a(ce,ue)),i&&(!V.allOrOneOptions||V.allOrOneOptions===0)&&i(1)},[e==null?void 0:e.id,i]);const x=V=>{s?s(V):alert(V)},w=V=>{const q=nd(V);c(q),u(Z=>$a(q,Z)),o("")},k=V=>{const q=nd(V);P(q),D(Z=>$a(q,Z)),A("")},F=V=>{const q=V.replace(/[^0-9-]/g,""),Z=q.startsWith("-")?"-"+q.slice(1).replace(/-/g,""):q;I(Z)},L=()=>{if(!n){x("Selecciona la variable principal.");return}if(p===ao){if(T.trim().length===0){x("Define un valor numrico para comparar.");return}}else if(!O){x("Selecciona la variable de referencia.");return}const V=[n,O,T].join(on);t&&t(V),r&&r([l,$a(l,h),g,p,N,$a(N,y)])},B=d.exports.useMemo(()=>{const V=ap.find(q=>q.value===g);return V?V.label:""},[g]);return a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:L,allOrOne:!0,allOrOneFor:2,customAllOrOneTexts:Nse,children:_(v,{gap:1,children:[a(C,{bold:!0,children:"Variable objetivo"}),a(Cr,{selectedVariable:n,onVariableChange:o,targetType:l,onTargetTypeChange:w,typeOfAdvancedOption:h,onAdvancedOptionChange:V=>u($a(l,V)),label:"Variable a evaluar",showAdvancedOptions:l!==qu,placeholder:"-- Selecciona variable --",showGlobal:!0}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Escoge el tipo de comparacin"}),a(M,{gap:1,alignItems:"center",style:{flexWrap:"wrap"},children:ap.map(V=>{const q=g===V.value;return _("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.35rem 0.65rem",borderRadius:"6px",border:`1px solid ${q?"rgb(180, 139, 50)":"rgba(255, 255, 255, 0.2)"}`,backgroundColor:q?"rgba(180, 139, 50, 0.15)":"transparent",cursor:"pointer"},children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarMatchComparison",checked:q,onChange:()=>m(V.value),style:{margin:0}}),a(C,{bold:!0,style:{fontSize:"1.25rem",lineHeight:1},children:V.icon})]},V.value)})})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Origen del valor a comparar"}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarMatchValueSource",checked:p===ao,onChange:()=>f(ao)}),a(C,{children:"Definir valor"})]}),p===ao&&a("input",{className:"form-control form-control-sm",type:"text",value:T,onChange:V=>F(V.target.value),placeholder:"Ej. 10"}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarMatchValueSource",checked:p===Mu,onChange:()=>f(Mu)}),a(C,{children:"A partir de otra variable"})]}),p===Mu&&a(Cr,{selectedVariable:O,onVariableChange:A,targetType:N,onTargetTypeChange:k,typeOfAdvancedOption:y,onAdvancedOptionChange:V=>D($a(N,V)),label:"Variable de referencia",showAdvancedOptions:N!==qu,placeholder:"-- Selecciona variable --",showGlobal:!0,showTargetButtons:!0})]}),_(C,{small:!0,children:["La condicin se cumple cuando el valor de la variable objetivo es ",B.toLowerCase()," que el valor indicado."]})]})})},Jl=0,VI=1,Ng=2,op=0,Dse=1,Pse=2,Lse=3,lp=4,Use=5,xse=6,Zl=0,R_=1,S_=0,ec=1,wse=0,Pu=1,Fse=2,kse=3,Gse=4,Bse=5,Vse=6,sU=[{value:wse,label:"Milisegundos"},{value:Pu,label:"Segundos"},{value:Fse,label:"Minutos"},{value:kse,label:"Horas"},{value:Gse,label:"Dias"},{value:Bse,label:"Meses"},{value:Vse,label:"Anios"}],KR=s=>s===VI||s===Ng?s:Jl,lm=s=>s===VI?op:s===Ng?0:lp,ad=(s,e)=>s===VI?[op,Dse,Pse].includes(e)?e:op:s===Ng?0:[Lse,lp,Use,xse].includes(e)?e:lp,Hse=s=>s===S_?S_:ec,Wse=s=>s===R_?R_:Zl,qR=s=>!s||s<=0?1:s,cm=s=>{const e=sU.map(t=>t.value);return s!=null&&e.includes(s)?s:Pu},jse=()=>{const{simpleAlert:s=null}=$t(),{trigger:e=null,setStringParam:t=null,setIntParams:r=null,setAllOrOneOptions:i=null}=Ne(),[n,o]=d.exports.useState(""),[l,c]=d.exports.useState(Jl),[h,u]=d.exports.useState(lm(Jl)),[g,m]=d.exports.useState(Zl),[p,f]=d.exports.useState(ec),[T,I]=d.exports.useState(1),[O,A]=d.exports.useState(Pu);d.exports.useEffect(()=>{const x=e;if(!x){o(""),c(Jl),u(lm(Jl)),m(Zl),f(ec),I(1),A(Pu),i&&i(1);return}o(x.stringData||"");const w=x.intData||[],k=w.length>0?w[0]:Jl,F=KR(k);c(F);const L=w.length>1?w[1]:lm(F);u(ad(F,L));const B=w.length>2?w[2]:Zl;m(Wse(B));const V=w.length>3?w[3]:ec;f(Hse(V));const q=w.length>4?w[4]:1;I(qR(q));const Z=w.length>5?w[5]:Pu;A(cm(Z)),i&&(!x.allOrOneOptions||x.allOrOneOptions===0)&&i(1)},[e==null?void 0:e.id,i]);const N=x=>{s?s(x):alert(x)},P=x=>{const w=KR(x);c(w),u(k=>ad(w,k)),o("")},y=x=>{const w=x.replace(/[^0-9]/g,"");I(w.length?parseInt(w,10):0)},D=()=>{if(!n){N("Selecciona la variable.");return}if(T<=0){N("La duracin debe ser un nmero mayor a 0.");return}t&&t(n),r&&r([l,ad(l,h),g,p,qR(T),cm(O)])};return a(Qs,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:D,allOrOne:!0,allOrOneFor:2,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:n,onVariableChange:o,targetType:l,onTargetTypeChange:P,typeOfAdvancedOption:h,onAdvancedOptionChange:x=>u(ad(l,x)),showAdvancedOptions:l!==Ng,showGlobal:!0,placeholder:"-- variable --"}),_(v,{gap:.5,children:[a(C,{bold:!0,children:"Comparar valor"}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarAgeSource",checked:g===Zl,onChange:()=>m(Zl)}),a(C,{children:"Fecha de creacin"})]}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarAgeSource",checked:g===R_,onChange:()=>m(R_)}),a(C,{children:"Fecha de ltima modificacin"})]})]}),_(v,{gap:.5,children:[a(C,{bold:!0,children:"Escoge el tipo"}),_(M,{gap:2,children:[_("label",{style:{display:"flex",alignItems:"center",gap:"0.4rem",cursor:"pointer"},children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarAgeComparison",checked:p===S_,onChange:()=>f(S_)}),a(C,{children:"< Menor que"})]}),_("label",{style:{display:"flex",alignItems:"center",gap:"0.4rem",cursor:"pointer"},children:[a("input",{className:"form-check-input",type:"radio",name:"wfVarAgeComparison",checked:p===ec,onChange:()=>f(ec)}),a(C,{children:"> Mayor que"})]})]})]}),_(v,{gap:.5,children:[a(C,{bold:!0,children:"Seleccionar tiempo"}),_(M,{gap:1,alignItems:"center",children:[a("input",{className:"form-control form-control-sm",type:"text",value:T,onChange:x=>y(x.target.value),style:{maxWidth:"6rem"}}),a("select",{className:"form-select form-select-sm",value:O,onChange:x=>A(cm(parseInt(x.target.value,10))),style:{maxWidth:"10rem"},children:sU.map(x=>a("option",{value:x.value,children:x.label},x.value))})]})]})]})})},Yse=s=>{switch(s){case ze.ACTOR_HAS_HANDITEM:return a(qte,{});case ze.ACTOR_IS_GROUP_MEMBER:case ze.NOT_ACTOR_IN_GROUP:return a(Xte,{});case ze.ACTOR_IS_ON_FURNI:case ze.NOT_ACTOR_ON_FURNI:return a(Qte,{});case ze.ACTOR_IS_IN_TEAM:case ze.NOT_ACTOR_IN_TEAM:return a(Jte,{});case ze.ACTOR_IS_WEARING_BADGE:case ze.NOT_ACTOR_WEARS_BADGE:return a(Zte,{});case ze.ACTOR_IS_WEARING_EFFECT:case ze.NOT_ACTOR_WEARING_EFFECT:return a(ese,{});case ze.DATE_RANGE_ACTIVE:return a(tse,{});case ze.FURNIS_HAVE_AVATARS:case ze.FURNI_NOT_HAVE_HABBO:return a(sse,{});case ze.HAS_STACKED_FURNIS:return a(rse,{});case ze.NOT_HAS_STACKED_FURNIS:return a(ise,{});case ze.STUFF_TYPE_MATCHES:case ze.NOT_FURNI_IS_OF_TYPE:return a(nse,{});case ze.STATES_MATCH:case ze.NOT_STATES_MATCH:return a(ase,{});case ze.TIME_ELAPSED_LESS:return a(_se,{});case ze.TIME_ELAPSED_MORE:return a(gse,{});case ze.USER_COUNT_IN:case ze.NOT_USER_COUNT_IN:return a(mse,{});case ze.ACTIVATOR_MATCH:return a(zte,{});case ze.SELECT_QUANTITY:return a(dse,{});case ze.HEIGHT:return a(ose,{});case ze.HAS_VARIABLE:return a(lse,{});case ze.HAS_VAR:return a(use,{});case ze.NEG_HAS_VAR:return a(hse,{});case ze.VAR_VALUE_MATCH:return a(Mse,{});case ze.VAR_AGE_MATCH:return a(jse,{})}return null},Ar=s=>{const{requiresFurni:e=Se.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:r=!1,children:i=null}=s,{trigger:n=null,isFiltered:o=0,setIsFiltered:l=null,isInverted:c=0,setIsInverted:h=null}=Ne();return d.exports.useEffect(()=>{l(n.isFiltered),h(n.isInverted)},[n,l,h]),_(bh,{wiredType:"action",requiresFurni:e,save:t,hasSpecialInput:r,children:[i,a(C,{bold:!0,children:E("wiredfurni.params.select.options")}),_("div",{children:[_(M,{gap:1,children:[a("input",{type:"checkbox",checked:o===1,onChange:u=>l(u.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.filter.selection")})]}),_(M,{gap:1,children:[a("input",{type:"checkbox",checked:c===1,onChange:u=>h(u.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.invert.selection")})]})]})]})},zse=()=>{const[s,e]=d.exports.useState(""),{trigger:t=null,setStringParam:r=null}=Ne(),i=()=>{r(s)};return d.exports.useEffect(()=>{e((t==null?void 0:t.stringData)||"")},[t]),_(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:[a(C,{bold:!0,children:E("wiredfurni.params.write.names")}),a("textarea",{value:s,onChange:n=>e(n.target.value),rows:4,style:{width:"100%",resize:"none"},placeholder:"Escribe los nombres aqu, uno por lnea..."})]})},Kse=()=>{const[s,e]=d.exports.useState(0),[t,r]=d.exports.useState(0),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(0),{trigger:c=null,setIntParams:h=null}=Ne(),u=()=>h([s,t,i,o]);d.exports.useEffect(()=>{var p;((p=c==null?void 0:c.intData)==null?void 0:p.length)>0&&(e(c.intData[0]),r(c.intData[1]),n(c.intData[2]),l(c.intData[3]))},[c]),d.exports.useEffect(()=>{te().areaSelectionManager.setHighlight(s,t,i,o)},[s,t,i,o]),d.exports.useEffect(()=>{const p=(f,T,I,O)=>{e(f),r(T),n(I),l(O)};return te().areaSelectionManager.activate(p,Di.HIGHLIGHT_DARKEN)&&te().areaSelectionManager.setHighlight(s,t,i,o),()=>{te().areaSelectionManager.deactivate()}},[]);const g=()=>{te().areaSelectionManager.startSelecting()},m=()=>{e(0),r(0),n(0),l(0),te().areaSelectionManager.clearHighlight()};return a(Ar,{hasSpecialInput:!0,save:u,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_area_message")}),a(C,{children:E("wiredfurni.params.select.area.description")}),_(M,{gap:1,children:[a(Y,{variant:"primary",onClick:g,style:{flex:1},children:E("wired_select_area_button")}),a(Y,{variant:"danger",onClick:m,style:{flex:1},children:E("wired_clear_area_button")})]})]})})},qse=()=>{const[s,e]=d.exports.useState(0),[t,r]=d.exports.useState(0),[i,n]=d.exports.useState("0.00"),{trigger:o=null,setIntParams:l=null}=Ne(),c=()=>l([s,Math.round(t*100)]);d.exports.useEffect(()=>{if(o&&o.intData.length>0){const u=o.intData[1]/100;r(u),n(u.toFixed(2)),e(o.intData[0])}},[o]),d.exports.useEffect(()=>{n(t.toFixed(2))},[t]);const h=()=>{const u=parseFloat(i);if(!isNaN(u)){const g=Math.max(0,Math.min(40,u));r(g)}};return _(Ar,{hasSpecialInput:!0,save:c,requiresFurni:0,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1,2].map(u=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggle",checked:s===u,onChange:()=>e(u)}),a(C,{children:E("wired.params.height.mode."+u)})]},u))]}),a("hr",{className:"m-0 bg-dark"}),_(M,{alignItems:"center",justifyContent:"between",children:[a(C,{bold:!0,children:E("wiredfurni.params.filter.for")}),_(M,{gap:1,children:[a("input",{type:"text",value:i,onChange:u=>n(u.target.value),onBlur:h,onKeyPress:u=>u.key==="Enter"&&h(),style:{width:"80px",textAlign:"center"}}),a(C,{children:"m"})]})]}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px",margin:"10px 0"},children:[a(Y,{onClick:()=>r(u=>Number(Math.max(0,u-.01).toFixed(2))),children:"-"}),a(ts,{className:"nitro-slider",min:0,max:40,step:.01,value:t,onChange:u=>r(Number(u.toFixed(2))),renderThumb:(u,g)=>a("div",{...u,children:g.valueNow.toFixed(2)})}),a(Y,{onClick:()=>r(u=>Number(Math.min(40,u+.01).toFixed(2))),children:"+"})]})]})},Xse=()=>{const[s,e]=d.exports.useState(0),[t,r]=d.exports.useState(1),[i,n]=d.exports.useState(0),{trigger:o=null,setIntParams:l=null}=Ne(),c=()=>l([s,t,i]);return d.exports.useEffect(()=>{o&&o.intData.length>0&&(e(o.intData[0]),r(o.intData[1]??1),n(o.intData[2]||0))},[o]),_(Ar,{hasSpecialInput:!0,requiresFurni:1,save:c,children:[_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"stateMatch",checked:s===1,onChange:h=>e(h.target.checked?1:0)}),a(C,{children:E("wiredfurni.params.state.correspond")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"checkbox",id:"rotationMatch",checked:i===1,onChange:h=>n(h.target.checked?1:0)}),a(C,{children:"Solo seleccionar si la rotacin coincide"})]}),a("hr",{className:"m-0 bg-dark"}),a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>r(1),className:` icon-neighbor-1 ${t===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(0),className:` icon-neighbor-3 ${t===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(2),className:` icon-neighbor-2 ${t===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),t!==void 0&&a(C,{style:{textAlign:"center"},children:["Item Desencadenante","Seleccionados","Seal"][t]})]})},Qse=()=>{const[s,e]=d.exports.useState(50),{trigger:t=null,setIntParams:r=null}=Ne(),i=()=>r([s]);return d.exports.useEffect(()=>{e(t.intData.length>0?t.intData[0]:0)},[t]),_(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:[a(C,{bold:!0,children:E("wiredfurni.params.filter.for")+" "+s+" Furnis"}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[a(Y,{onClick:()=>e(n=>Math.max(1,n-1)),children:"-"}),a(ts,{className:"nitro-slider",min:1,max:100,value:s,onChange:n=>e(n)}),a(Y,{onClick:()=>e(n=>Math.min(100,n+1)),children:"+"})]})]})},Vi=18,Ur=9,pn=13,ji=13,Ho=Math.floor(pn/2),Wo=Math.floor(ji/2),$se=()=>{const[s,e]=d.exports.useState("paint"),[t,r]=d.exports.useState({x:0,y:0}),[i,n]=d.exports.useState({x:0,y:0}),o=d.exports.useRef(s),l=d.exports.useRef(!1),[c,h]=d.exports.useState(0),{trigger:u=null,setStringParam:g=null,setIntParams:m=null}=Ne(),[p,f]=d.exports.useState("first"),[T,I]=d.exports.useState(!1),[O,A]=d.exports.useState(null),[N,P]=d.exports.useState(null),[y,D]=d.exports.useState(0),[x,w]=d.exports.useState(3),k=d.exports.useRef(null),[F,L]=d.exports.useState(()=>{const H=[];for(let X=0;X<pn;X++){H[X]=[];for(let ee=0;ee<ji;ee++)H[X][ee]={color:"#161616",borderColor:"#343434"}}return H});d.exports.useEffect(()=>{const H=ee=>{ee.key==="Shift"&&I(!0)},X=ee=>{ee.key==="Shift"&&(I(!1),A(null),P(null))};return document.addEventListener("keydown",H),document.addEventListener("keyup",X),()=>{document.removeEventListener("keydown",H),document.removeEventListener("keyup",X)}},[]),d.exports.useEffect(()=>{if(u){if(u.stringData&&u.stringData.length>0){const H=u.stringData.split(",");L(()=>{const X=[];for(let ee=0;ee<pn;ee++){X[ee]=[];for(let Oe=0;Oe<ji;Oe++){const de=H[Oe]?H[Oe][ee]:"x";X[ee][Oe]=de==="o"?{color:"rgb(0,101,255)",borderColor:"#343434"}:{color:"#161616",borderColor:"#343434"}}}return X})}if(u.intData&&u.intData.length>=3){const H=u.intData[0];h(H),[0,1,2].includes(H)?(f("first"),D(H)):[3,4].includes(H)&&(f("second"),w(H));const X={x:u.intData[1],y:u.intData[2]};r(X),n(X)}}},[u]),d.exports.useEffect(()=>{o.current=s},[s]),d.exports.useEffect(()=>{const H=k.current,X=H.getContext("2d");H.width=280,H.height=135;const ee=(pn+ji)*(Vi/2),Oe=(pn+ji)*(Ur/2),de=(H.width-ee)/2,ve=(H.height-Oe)/2,Me=(ce,ue,$,re)=>{const me=ce+Ho,ge=ue+Wo,Ae=(me-ge)*(Vi/2)+de+ee/2,Xe=(me+ge)*(Ur/2)+ve;X.fillStyle=re,X.beginPath(),X.moveTo(Ae,Xe),X.lineTo(Ae+Vi/2,Xe+Ur/2),X.lineTo(Ae,Xe+Ur),X.lineTo(Ae-Vi/2,Xe+Ur/2),X.closePath(),X.fill(),X.fillStyle=$,X.beginPath(),X.moveTo(Ae,Xe),X.lineTo(Ae+Vi/2,Xe+Ur/2),X.lineTo(Ae,Xe+Ur),X.lineTo(Ae-Vi/2,Xe+Ur/2),X.closePath(),X.fill(),t.x===ce&&t.y===ue&&(X.strokeStyle="#ffffff",X.lineWidth=2,X.beginPath(),X.moveTo(Ae,Xe+1),X.lineTo(Ae+Vi/2-1,Xe+Ur/2),X.lineTo(Ae,Xe+Ur-1),X.lineTo(Ae-Vi/2+1,Xe+Ur/2),X.closePath(),X.stroke())};X.clearRect(0,0,H.width,H.height);for(let ce=0;ce<pn;ce++)for(let ue=0;ue<ji;ue++)Me(ce-Ho,ue-Wo,F[ce][ue].color,F[ce][ue].borderColor);if(T&&O&&N){const ce=Math.min(O.x,N.x),ue=Math.max(O.x,N.x),$=Math.min(O.y,N.y),re=Math.max(O.y,N.y);for(let me=ce;me<=ue;me++)for(let ge=$;ge<=re;ge++)Me(me,ge,"rgba(212, 24, 212, 0.5)","#343434")}},[F,t,T,O,N]),d.exports.useEffect(()=>{const H=k.current;if(!H)return;const X=(Me,ce)=>{const ue=H.getContext("2d"),$=(pn+ji)*(Vi/2),re=(pn+ji)*(Ur/2),me=(H.width-$)/2,ge=(H.height-re)/2;for(let Ae=0;Ae<pn;Ae++)for(let Xe=0;Xe<ji;Xe++){const je=(Ae-Xe)*(Vi/2)+me+$/2,se=(Ae+Xe)*(Ur/2)+ge,Te=new Path2D;if(Te.moveTo(je,se),Te.lineTo(je+Vi/2,se+Ur/2),Te.lineTo(je,se+Ur),Te.lineTo(je-Vi/2,se+Ur/2),Te.closePath(),ue.isPointInPath(Te,Me,ce))return{x:Ae-Ho,y:Xe-Wo}}return null},ee=Me=>{const ce=H.getBoundingClientRect(),ue=Me.clientX-ce.left,$=Me.clientY-ce.top,re=X(ue,$);if(re){if(o.current==="select"){r(re),n(re);return}if(l.current=!0,T){A(re),P(re);return}ve(re.x,re.y)}},Oe=Me=>{if(!l.current)return;const ce=H.getBoundingClientRect(),ue=Me.clientX-ce.left,$=Me.clientY-ce.top,re=X(ue,$);if(re){if(T){P(re);return}ve(re.x,re.y)}},de=()=>{if(T&&O&&N){const Me=Math.min(O.x,N.x),ce=Math.max(O.x,N.x),ue=Math.min(O.y,N.y),$=Math.max(O.y,N.y);L(re=>{const me=re.map(ge=>[...ge]);for(let ge=Me+Ho;ge<=ce+Ho;ge++)for(let Ae=ue+Wo;Ae<=$+Wo;Ae++)me[ge][Ae]=o.current==="paint"?{color:"rgb(0,101,255)",borderColor:"#343434"}:{color:"#161616",borderColor:"#343434"};return me}),A(null),P(null)}l.current=!1},ve=(Me,ce)=>{const ue=Me+Ho,$=ce+Wo;L(re=>{const me=re.map(ge=>[...ge]);return me[ue][$]=o.current==="paint"?{color:"rgb(0,101,255)",borderColor:"#343434"}:{color:"#161616",borderColor:"#343434"},me})};return H.addEventListener("mousedown",ee),H.addEventListener("mousemove",Oe),H.addEventListener("mouseup",de),H.addEventListener("mouseleave",de),()=>{H.removeEventListener("mousedown",ee),H.removeEventListener("mousemove",Oe),H.removeEventListener("mouseup",de),H.removeEventListener("mouseleave",de)}},[T,O,N]);const B=()=>{const H=[];for(let X=0;X<ji;X++){const ee=[];for(let Oe=0;Oe<pn;Oe++){const de=F[Oe][X].color==="rgb(0,101,255)";ee.push(de?"o":"x")}H.push(ee.join(""))}g(H.join(",")),m([c,t.x,t.y])},V=H=>{f(H),h(H==="first"?y:x)},q=H=>{h(H),p==="first"?D(H):w(H)},Z=(H,X)=>{if(X===""||X==="-"){n(ce=>({...ce,[H]:X}));return}let ee=parseInt(X,10);if(isNaN(ee))return;const Oe=ji/2-.5;ee<-Oe&&(ee=-Oe),ee>Oe&&(ee=Oe);const de={...i,[H]:ee};n(de);const ve=de.x+Ho,Me=de.y+Wo;ve>=0&&ve<pn&&Me>=0&&Me<ji&&r(de)};return _(Ar,{hasSpecialInput:!0,requiresFurni:1,save:B,children:[_("div",{children:[_("div",{className:"global-neighbor",children:[a("button",{className:"button-add-tile",onClick:()=>e("paint"),style:s==="paint"?{border:"2px solid white",backgroundColor:"#ececec"}:{}}),a("button",{className:"button-remove-tile",onClick:()=>e("erase"),style:s==="erase"?{border:"2px solid white",backgroundColor:"#ececec"}:{}}),a("div",{className:"divisor-buttons-neighbor"}),a("button",{className:"button-select-tile",onClick:()=>e("select"),style:s==="select"?{border:"2px solid white",backgroundColor:"#ececec"}:{}})]}),a("canvas",{ref:k,style:{imageRendering:"pixelated",border:"1px solid #ddd",borderRadius:"8px"}}),_("div",{style:{marginLeft:"20px",display:"flex",gap:"10px",alignItems:"end",justifyContent:"flex-end"},children:[_("div",{children:[a("label",{style:{color:"black",marginRight:"5px"},children:"x:"}),a("input",{type:"text",value:i.x,onChange:H=>Z("x",H.target.value),style:{width:"40px",borderRadius:"4px",border:"1px solid #ddd"}})]}),_("div",{children:[a("label",{style:{color:"black",marginRight:"5px"},children:"y:"}),a("input",{type:"text",value:i.y,onChange:H=>Z("y",H.target.value),style:{width:"40px",borderRadius:"4px",border:"1px solid #ddd"}})]})]})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{style:{display:"flex",alignItems:"flex-start"},gap:1,children:[_("div",{className:"container-button-user-furni",children:[a(C,{bold:!0,children:E("wiredfurni.params.select.neighbor.title")}),_(M,{style:{height:"20px"},children:[a("button",{onClick:()=>V("first"),style:{border:p==="first"?"2px solid white":"2px solid rgb(182, 190, 197)",backgroundColor:p==="first"?"#ececec":"rgb(205, 211, 217)",borderTopLeftRadius:"10px"},children:a("div",{className:"icon-furnis-neighbor icon-neighbor-selectfurniuser"})}),a("div",{style:{width:"5px",height:"1px"}}),a("button",{onClick:()=>V("second"),style:{border:p==="second"?"2px solid white":"2px solid rgb(182, 190, 197)",backgroundColor:p==="second"?"#ececec":"rgb(205, 211, 217)",borderBottomRightRadius:"10px"},children:a("div",{className:"icon-users-neighbor icon-neighbor-selectfurniuser"})})]})]}),a(M,{alignItems:"center",gap:1,justifyContent:"center",alignSelf:"center",children:(p==="first"?[0,1,2]:[3,4]).map(H=>a("button",{className:`button-icons-selector-general icon-neighbor-${H}`,onClick:()=>q(H),style:{backgroundColor:c===H?"rgb(236, 236, 236)":"#cdd3d9",border:c===H?"2px solid white":"2px solid #b6bec5"}},H))}),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:a(C,{bold:!0,children:E(`wiredfurni.params.textmode.neighbor.${c}`)})})]})]})},Jse=()=>{const[s,e]=d.exports.useState(0),{trigger:t=null,setIntParams:r=null}=Ne(),[i,n]=d.exports.useState(1),o=()=>r([s,i]);return d.exports.useEffect(()=>{t&&t.intData.length>0&&(e(t.intData[0]),n(t.intData[1]??1))},[t]),_(Ar,{hasSpecialInput:!0,save:o,requiresFurni:1,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1,2,3].map(l=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggle",checked:s===l,onChange:()=>e(l)}),a(C,{children:E("wired.paramsfurnionfurni.mode."+l)})]},l))]}),a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>n(1),className:` icon-neighbor-1 ${i===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(0),className:` icon-neighbor-3 ${i===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>n(2),className:` icon-neighbor-2 ${i===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),i!==void 0&&a(C,{style:{textAlign:"center"},children:["Usar Item desencadenante","Seleccionados","Seal"][i]})]})},Zse=()=>a(Ar,{hasSpecialInput:!0,save:null,requiresFurni:1}),ere=()=>{const[s,e]=d.exports.useState(""),[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(0),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(""),[m,p]=d.exports.useState(0),[f,T]=d.exports.useState(4),{trigger:I=null,setStringParam:O=null,setIntParams:A=null}=Ne(),N=()=>{O(s+(o===1?"::"+u:"")),A([t?1:0,i,o,c,m,f])};return d.exports.useEffect(()=>{if(I){const y=(I.stringData||"").split("::",2);e(y[0]||""),g(y[1]||""),I.intData.length>0&&(r(I.intData[0]===1),n(I.intData[1]||0),l(I.intData[2]||0),h(I.intData[3]||0),p(I.intData[4]||0),T(I.intData[5]||4))}},[I]),a(Ar,{hasSpecialInput:!0,save:N,requiresFurni:0,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:s,onVariableChange:e,targetType:0,onTargetTypeChange:()=>{},typeOfAdvancedOption:4,onAdvancedOptionChange:()=>{},label:"Variable de furni:",showAdvancedOptions:!1,placeholder:"-- Selecciona variable --",showGlobal:!1,showTargetButtons:!1}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"checkbox",checked:t,onChange:y=>r(y.target.checked)}),a(C,{children:"Seleccionar por valor"})]}),t&&_(J,{children:[a(C,{bold:!0,children:"Escoja el tipo:"}),a(v,{gap:1,children:[{value:0,label:"Mayor que"},{value:1,label:"Mayor o igual"},{value:2,label:"Igual"},{value:3,label:"Menor o igual"},{value:4,label:"Menor que"},{value:5,label:"Desigual"}].map(y=>_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"comparison",value:y.value,checked:i===y.value,onChange:D=>n(parseInt(D.target.value))}),a(C,{children:y.label})]},y.value))}),a(C,{bold:!0,children:"Valor de referencia:"}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"reference",value:0,checked:o===0,onChange:y=>l(parseInt(y.target.value))}),a(C,{children:"Definir valor"})]}),o===0&&a("input",{type:"number",className:"form-control form-control-sm",style:{paddingLeft:"5px"},value:c,onChange:y=>h(parseInt(y.target.value)||0)}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"reference",value:1,checked:o===1,onChange:y=>l(parseInt(y.target.value))}),a(C,{children:"A partir de la variable"})]}),o===1&&a(Cr,{selectedVariable:u,onVariableChange:g,targetType:m,onTargetTypeChange:p,typeOfAdvancedOption:f,onAdvancedOptionChange:T,label:"Variable de referencia:",showAdvancedOptions:!0,placeholder:"-- Selecciona variable --",showGlobal:!0,showTargetButtons:o===1})]})]})})},tre=()=>{const[s,e]=d.exports.useState(50),{trigger:t=null,setIntParams:r=null}=Ne(),i=()=>r([s]);return d.exports.useEffect(()=>{e(t.intData.length>0?t.intData[0]:0)},[t]),_(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:[a(C,{bold:!0,children:E("wiredfurni.params.filter.for")+" "+s+" Usuario"}),_("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[a(Y,{onClick:()=>e(n=>Math.max(1,n-1)),children:"-"}),a(ts,{className:"nitro-slider",min:1,max:100,value:s,onChange:n=>e(n)}),a(Y,{onClick:()=>e(n=>Math.min(100,n+1)),children:"+"})]})]})},sre=()=>{d.exports.useState(0),d.exports.useState(0);const{trigger:s=null,setIntParams:e=null}=Ne(),[t,r]=d.exports.useState(0),i=()=>e([t]);return d.exports.useEffect(()=>{s&&s.intData.length>0&&r(s.intData[0])},[s]),a(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.handitem")}),a("input",{type:"number",className:"form-control form-control-sm",value:t,onChange:n=>r(parseInt(n.target.value)||0),min:0})]})})},rre=()=>{const{trigger:s=null,setIntParams:e=null}=Ne(),[t,r]=d.exports.useState(0),i=()=>e([t]);return d.exports.useEffect(()=>{s&&s.intData.length>0&&r(s.intData[0])},[s]),_(Ar,{hasSpecialInput:!0,save:i,requiresFurni:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>r(0),className:` icon-neighbor-3 ${t===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(1),className:` icon-neighbor-1 ${t===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>r(2),className:` icon-neighbor-2 ${t===2?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),t!==void 0&&a(C,{style:{textAlign:"center"},children:["Usar Item desencadenante","Seleccionados","Seal"][t]})]})},ire=()=>{const{trigger:s=null,setIntParams:e=null}=Ne(),[t,r]=d.exports.useState(0),i=()=>e([t]);return d.exports.useEffect(()=>{s&&s.intData.length>0&&r(s.intData[0])},[s]),a(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1,2,3,4].map(n=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggle",checked:t===n,onChange:()=>r(n)}),a(C,{children:E("wired.params.selector.team."+n)})]},n))]})})},nre=[{value:0,label:"Waving hand"},{value:1,label:"Blowing kiss"},{value:2,label:"Luaghing"},{value:3,label:"Thumbsup "},{value:4,label:"Awake"},{value:5,label:"afk/sleeping"},{value:6,label:"sitted"},{value:7,label:"wake up"},{value:8,label:"layed down"},{value:9,label:"sending signals"},{value:10,label:"dancing"}],are=()=>{const{trigger:s=null,setIntParams:e=null}=Ne(),[t,r]=d.exports.useState(0),i=()=>e([t]);return d.exports.useEffect(()=>{s&&s.intData.length>0&&r(s.intData[0])},[s]),a(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.actions.title")}),a("select",{className:"form-select form-select-sm",value:t,onChange:n=>r(parseInt(n.target.value)),children:nre.map(n=>a("option",{value:n.value,children:n.label},n.value))})]})})},ore=()=>{const{trigger:s=null,setIntParams:e=null}=Ne(),[t,r]=d.exports.useState(0),i=()=>e([t]);return d.exports.useEffect(()=>{s&&s.intData.length>0&&r(s.intData[0])},[s]),a(Ar,{hasSpecialInput:!0,save:i,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1,2].map(n=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggle",checked:t===n,onChange:()=>r(n)}),a(C,{children:E("wired.params.selector.bytype."+n)})]},n))]})})},lre=()=>a(Ar,{hasSpecialInput:!0,save:null,requiresFurni:0}),Hi=18,xr=9,En=13,Yi=13,jo=Math.floor(En/2),Yo=Math.floor(Yi/2),cre=()=>{const[s,e]=d.exports.useState("paint"),[t,r]=d.exports.useState({x:0,y:0}),[i,n]=d.exports.useState({x:0,y:0}),o=d.exports.useRef(s),l=d.exports.useRef(!1),[c,h]=d.exports.useState(0),{trigger:u=null,setStringParam:g=null,setIntParams:m=null}=Ne(),[p,f]=d.exports.useState("first"),[T,I]=d.exports.useState(!1),[O,A]=d.exports.useState(null),[N,P]=d.exports.useState(null),[y,D]=d.exports.useState(0),[x,w]=d.exports.useState(3),k=d.exports.useRef(null),[F,L]=d.exports.useState(()=>{const H=[];for(let X=0;X<En;X++){H[X]=[];for(let ee=0;ee<Yi;ee++)H[X][ee]={color:"#161616",borderColor:"#343434"}}return H});d.exports.useEffect(()=>{const H=ee=>{ee.key==="Shift"&&I(!0)},X=ee=>{ee.key==="Shift"&&(I(!1),A(null),P(null))};return document.addEventListener("keydown",H),document.addEventListener("keyup",X),()=>{document.removeEventListener("keydown",H),document.removeEventListener("keyup",X)}},[]),d.exports.useEffect(()=>{if(u){if(u.stringData&&u.stringData.length>0){const H=u.stringData.split(",");L(()=>{const X=[];for(let ee=0;ee<En;ee++){X[ee]=[];for(let Oe=0;Oe<Yi;Oe++){const de=H[Oe]?H[Oe][ee]:"x";X[ee][Oe]=de==="o"?{color:"rgb(0,101,255)",borderColor:"#343434"}:{color:"#161616",borderColor:"#343434"}}}return X})}if(u.intData&&u.intData.length>=3){const H=u.intData[0];h(H),[0,1,2].includes(H)?(f("first"),D(H)):[3,4].includes(H)&&(f("second"),w(H));const X={x:u.intData[1],y:u.intData[2]};r(X),n(X)}}},[u]),d.exports.useEffect(()=>{o.current=s},[s]),d.exports.useEffect(()=>{const H=k.current,X=H.getContext("2d");H.width=280,H.height=135;const ee=(En+Yi)*(Hi/2),Oe=(En+Yi)*(xr/2),de=(H.width-ee)/2,ve=(H.height-Oe)/2,Me=(ce,ue,$,re)=>{const me=ce+jo,ge=ue+Yo,Ae=(me-ge)*(Hi/2)+de+ee/2,Xe=(me+ge)*(xr/2)+ve;X.fillStyle=re,X.beginPath(),X.moveTo(Ae,Xe),X.lineTo(Ae+Hi/2,Xe+xr/2),X.lineTo(Ae,Xe+xr),X.lineTo(Ae-Hi/2,Xe+xr/2),X.closePath(),X.fill(),X.fillStyle=$,X.beginPath(),X.moveTo(Ae,Xe),X.lineTo(Ae+Hi/2,Xe+xr/2),X.lineTo(Ae,Xe+xr),X.lineTo(Ae-Hi/2,Xe+xr/2),X.closePath(),X.fill(),t.x===ce&&t.y===ue&&(X.strokeStyle="#ffffff",X.lineWidth=2,X.beginPath(),X.moveTo(Ae,Xe+1),X.lineTo(Ae+Hi/2-1,Xe+xr/2),X.lineTo(Ae,Xe+xr-1),X.lineTo(Ae-Hi/2+1,Xe+xr/2),X.closePath(),X.stroke())};X.clearRect(0,0,H.width,H.height);for(let ce=0;ce<En;ce++)for(let ue=0;ue<Yi;ue++)Me(ce-jo,ue-Yo,F[ce][ue].color,F[ce][ue].borderColor);if(T&&O&&N){const ce=Math.min(O.x,N.x),ue=Math.max(O.x,N.x),$=Math.min(O.y,N.y),re=Math.max(O.y,N.y);for(let me=ce;me<=ue;me++)for(let ge=$;ge<=re;ge++)Me(me,ge,"rgba(212, 24, 212, 0.5)","#343434")}},[F,t,T,O,N]),d.exports.useEffect(()=>{const H=k.current;if(!H)return;const X=(Me,ce)=>{const ue=H.getContext("2d"),$=(En+Yi)*(Hi/2),re=(En+Yi)*(xr/2),me=(H.width-$)/2,ge=(H.height-re)/2;for(let Ae=0;Ae<En;Ae++)for(let Xe=0;Xe<Yi;Xe++){const je=(Ae-Xe)*(Hi/2)+me+$/2,se=(Ae+Xe)*(xr/2)+ge,Te=new Path2D;if(Te.moveTo(je,se),Te.lineTo(je+Hi/2,se+xr/2),Te.lineTo(je,se+xr),Te.lineTo(je-Hi/2,se+xr/2),Te.closePath(),ue.isPointInPath(Te,Me,ce))return{x:Ae-jo,y:Xe-Yo}}return null},ee=Me=>{const ce=H.getBoundingClientRect(),ue=Me.clientX-ce.left,$=Me.clientY-ce.top,re=X(ue,$);if(re){if(o.current==="select"){r(re),n(re);return}if(l.current=!0,T){A(re),P(re);return}ve(re.x,re.y)}},Oe=Me=>{if(!l.current)return;const ce=H.getBoundingClientRect(),ue=Me.clientX-ce.left,$=Me.clientY-ce.top,re=X(ue,$);if(re){if(T){P(re);return}ve(re.x,re.y)}},de=()=>{if(T&&O&&N){const Me=Math.min(O.x,N.x),ce=Math.max(O.x,N.x),ue=Math.min(O.y,N.y),$=Math.max(O.y,N.y);L(re=>{const me=re.map(ge=>[...ge]);for(let ge=Me+jo;ge<=ce+jo;ge++)for(let Ae=ue+Yo;Ae<=$+Yo;Ae++)me[ge][Ae]=o.current==="paint"?{color:"rgb(0,101,255)",borderColor:"#343434"}:{color:"#161616",borderColor:"#343434"};return me}),A(null),P(null)}l.current=!1},ve=(Me,ce)=>{const ue=Me+jo,$=ce+Yo;L(re=>{const me=re.map(ge=>[...ge]);return me[ue][$]=o.current==="paint"?{color:"rgb(0,101,255)",borderColor:"#343434"}:{color:"#161616",borderColor:"#343434"},me})};return H.addEventListener("mousedown",ee),H.addEventListener("mousemove",Oe),H.addEventListener("mouseup",de),H.addEventListener("mouseleave",de),()=>{H.removeEventListener("mousedown",ee),H.removeEventListener("mousemove",Oe),H.removeEventListener("mouseup",de),H.removeEventListener("mouseleave",de)}},[T,O,N]);const B=()=>{const H=[];for(let X=0;X<Yi;X++){const ee=[];for(let Oe=0;Oe<En;Oe++){const de=F[Oe][X].color==="rgb(0,101,255)";ee.push(de?"o":"x")}H.push(ee.join(""))}g(H.join(",")),m([c,t.x,t.y])},V=H=>{f(H),h(H==="first"?y:x)},q=H=>{h(H),p==="first"?D(H):w(H)},Z=(H,X)=>{if(X===""||X==="-"){n(ce=>({...ce,[H]:X}));return}let ee=parseInt(X,10);if(isNaN(ee))return;const Oe=Yi/2-.5;ee<-Oe&&(ee=-Oe),ee>Oe&&(ee=Oe);const de={...i,[H]:ee};n(de);const ve=de.x+jo,Me=de.y+Yo;ve>=0&&ve<En&&Me>=0&&Me<Yi&&r(de)};return _(Ar,{hasSpecialInput:!0,requiresFurni:1,save:B,children:[_("div",{children:[_("div",{className:"global-neighbor",children:[a("button",{className:"button-add-tile",onClick:()=>e("paint"),style:s==="paint"?{border:"2px solid white",backgroundColor:"#ececec"}:{}}),a("button",{className:"button-remove-tile",onClick:()=>e("erase"),style:s==="erase"?{border:"2px solid white",backgroundColor:"#ececec"}:{}}),a("div",{className:"divisor-buttons-neighbor"}),a("button",{className:"button-select-tile",onClick:()=>e("select"),style:s==="select"?{border:"2px solid white",backgroundColor:"#ececec"}:{}})]}),a("canvas",{ref:k,style:{imageRendering:"pixelated",border:"1px solid #ddd",borderRadius:"8px"}}),_("div",{style:{marginLeft:"20px",display:"flex",gap:"10px",alignItems:"end",justifyContent:"flex-end"},children:[_("div",{children:[a("label",{style:{color:"black",marginRight:"5px"},children:"x:"}),a("input",{type:"text",value:i.x,onChange:H=>Z("x",H.target.value),style:{width:"40px",borderRadius:"4px",border:"1px solid #ddd"}})]}),_("div",{children:[a("label",{style:{color:"black",marginRight:"5px"},children:"y:"}),a("input",{type:"text",value:i.y,onChange:H=>Z("y",H.target.value),style:{width:"40px",borderRadius:"4px",border:"1px solid #ddd"}})]})]})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{style:{display:"flex",alignItems:"flex-start"},gap:1,children:[_("div",{className:"container-button-user-furni",children:[a(C,{bold:!0,children:E("wiredfurni.params.select.neighbor.title")}),_(M,{style:{height:"20px"},children:[a("button",{onClick:()=>V("first"),style:{border:p==="first"?"2px solid white":"2px solid rgb(182, 190, 197)",backgroundColor:p==="first"?"#ececec":"rgb(205, 211, 217)",borderTopLeftRadius:"10px"},children:a("div",{className:"icon-furnis-neighbor icon-neighbor-selectfurniuser"})}),a("div",{style:{width:"5px",height:"1px"}}),a("button",{onClick:()=>V("second"),style:{border:p==="second"?"2px solid white":"2px solid rgb(182, 190, 197)",backgroundColor:p==="second"?"#ececec":"rgb(205, 211, 217)",borderBottomRightRadius:"10px"},children:a("div",{className:"icon-users-neighbor icon-neighbor-selectfurniuser"})})]})]}),a(M,{alignItems:"center",gap:1,justifyContent:"center",alignSelf:"center",children:(p==="first"?[0,1,2]:[3,4]).map(H=>a("button",{className:`button-icons-selector-general icon-neighbor-${H}`,onClick:()=>q(H),style:{backgroundColor:c===H?"rgb(236, 236, 236)":"#cdd3d9",border:c===H?"2px solid white":"2px solid #b6bec5"}},H))}),a("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:a(C,{bold:!0,children:E(`wiredfurni.params.textmode.neighbor.${c}`)})})]})]})},ure=()=>{const[s,e]=d.exports.useState(""),[t,r]=d.exports.useState(!1),[i,n]=d.exports.useState(0),[o,l]=d.exports.useState(0),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(""),[m,p]=d.exports.useState(0),[f,T]=d.exports.useState(4),{trigger:I=null,setStringParam:O=null,setIntParams:A=null}=Ne(),N=()=>{O(s+(o===1?"::"+u:"")),A([t?1:0,i,o,c,m,f])};return d.exports.useEffect(()=>{if(I){const y=(I.stringData||"").split("::",2);e(y[0]||""),g(y[1]||""),I.intData.length>0&&(r(I.intData[0]===1),n(I.intData[1]||0),l(I.intData[2]||0),h(I.intData[3]||0),p(I.intData[4]||0),T(I.intData[5]||4))}},[I]),a(Ar,{hasSpecialInput:!0,save:N,requiresFurni:0,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:s,onVariableChange:e,targetType:1,onTargetTypeChange:()=>{},typeOfAdvancedOption:4,onAdvancedOptionChange:()=>{},label:"Variable de usuario:",showAdvancedOptions:!1,placeholder:"-- Selecciona variable --",showGlobal:!1,showTargetButtons:!1}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"checkbox",checked:t,onChange:y=>r(y.target.checked)}),a(C,{children:"Seleccionar por valor"})]}),t&&_(J,{children:[a(C,{bold:!0,children:"Escoja el tipo:"}),a(v,{gap:1,children:[{value:0,label:"Mayor que"},{value:1,label:"Mayor o igual"},{value:2,label:"Igual"},{value:3,label:"Menor o igual"},{value:4,label:"Menor que"},{value:5,label:"Desigual"}].map(y=>_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"comparison",value:y.value,checked:i===y.value,onChange:D=>n(parseInt(D.target.value))}),a(C,{children:y.label})]},y.value))}),a(C,{bold:!0,children:"Valor de referencia:"}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"reference",value:0,checked:o===0,onChange:y=>l(parseInt(y.target.value))}),a(C,{children:"Definir valor"})]}),o===0&&a("input",{type:"number",className:"form-control form-control-sm",style:{paddingLeft:"5px"},value:c,onChange:y=>h(parseInt(y.target.value)||0)}),_(M,{gap:1,alignItems:"center",children:[a("input",{type:"radio",name:"reference",value:1,checked:o===1,onChange:y=>l(parseInt(y.target.value))}),a(C,{children:"A partir de la variable"})]}),o===1&&a(Cr,{selectedVariable:u,onVariableChange:g,targetType:m,onTargetTypeChange:p,typeOfAdvancedOption:f,onAdvancedOptionChange:T,label:"Variable de referencia:",showAdvancedOptions:!0,placeholder:"-- Selecciona variable --",showGlobal:!0,showTargetButtons:o===1})]})]})})},hre=s=>{switch(s){case Kt.FURNI_AREA:return a(Kse,{});case Kt.USERS_NEIGHBOR:return a(cre,{});case Kt.FURNI_NEIGHBOR:return a($se,{});case Kt.FURNI_BY_TYPE:return a(Xse,{});case Kt.FURNI_FILTER:return a(Qse,{});case Kt.USER_FILTER:return a(tre,{});case Kt.USER_BY_NAME:return a(zse,{});case Kt.FURNI_BY_HEIGHT:return a(qse,{});case Kt.FURNI_ON_FURNI:return a(Jse,{});case Kt.USER_ON_FURNI:return a(rre,{});case Kt.USER_ON_TEAM:return a(ire,{});case Kt.USER_HAVE_HANDITEM:return a(sre,{});case Kt.FURNI_PICKS:return a(Zse,{});case Kt.USERS_BY_TYPE:return a(ore,{});case Kt.USERS_BY_ACTION:return a(are,{});case Kt.USER_SIGNALS:return a(lre,{});case 16:return a(ere,{});case 17:return a(ure,{})}return null},dr=s=>{const{requiresFurni:e=Se.STUFF_SELECTION_OPTION_NONE,save:t=null,hasSpecialInput:r=!1,children:i=null}=s;return a(bh,{wiredType:"trigger",requiresFurni:e,hasSpecialInput:r,save:()=>t&&t(),children:i})},dre=[{value:0,label:"Waving hand"},{value:1,label:"Blowing kiss"},{value:2,label:"Luaghing"},{value:3,label:"Thumbsup "},{value:4,label:"Awake"},{value:5,label:"afk/sleeping"},{value:6,label:"sitted"},{value:7,label:"wake up"},{value:8,label:"layed down"},{value:9,label:"sending signals"},{value:10,label:"dancing"}],_re=()=>{const{trigger:s=null,setIntParams:e=null}=Ne(),[t,r]=d.exports.useState(0),i=()=>e([t]);return d.exports.useEffect(()=>{s&&s.intData.length>0&&r(s.intData[0])},[s]),a(dr,{hasSpecialInput:!0,save:i,requiresFurni:0,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.actions.title")}),a("select",{className:"form-select form-select-sm",value:t,onChange:n=>r(parseInt(n.target.value)),children:dre.map(n=>a("option",{value:n.value,children:n.label},n.value))})]})})},gre=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(0),{trigger:n=null,setStringParam:o=null}=Ne(),l=()=>o(r===1?e:"");return d.exports.useEffect(()=>{t(n.stringData),i(n.stringData?1:0)},[n]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:l,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.picktriggerer")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:r===0,onChange:c=>i(0)}),a(C,{children:E("wiredfurni.params.anyavatar")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:r===1,onChange:c=>i(1)}),a(C,{children:E("wiredfurni.params.certainavatar")})]}),r===1&&a("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>t(c.target.value)})]})})},mre=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(-1),[n,o]=d.exports.useState(-1),[l,c]=d.exports.useState(-1),{trigger:h=null,setStringParam:u=null,setIntParams:g=null}=Ne(),m=()=>{u(e),g([r,n,l])};return d.exports.useEffect(()=>{t(h.stringData),i(h.intData.length>0?h.intData[0]:0),o(h.intData.length>1?h.intData[1]:0),c(h.intData.length>2?h.intData[2]:0)},[h]),_(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:[l!==2&&_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.whatissaid")}),a("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:p=>t(p.target.value)})]}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("wired_select_mode_u_want")}),[0,1,2].map(p=>_(M,{gap:1,children:[a("input",{type:"radio",name:"wiredToggle",checked:l===p,onChange:()=>c(p)}),a(C,{children:E("wired.params.saysmth."+p)})]},p))]}),a("hr",{className:"m-0 bg-dark"}),a(C,{bold:!0,children:E("wiredfurni.params.select.options")}),_("div",{children:[_(M,{gap:1,children:[a("input",{type:"checkbox",checked:r===1,onChange:p=>i(p.target.checked?1:0)}),a(C,{children:E("Ocultar mensaje de activacin")})]}),_(M,{gap:1,children:[a("input",{type:"checkbox",checked:n===1,onChange:p=>o(p.target.checked?1:0)}),a(C,{children:E("Solamente puede ser accionado por el dueo de la sala")})]})]})]})},fre=s=>a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),pre=s=>{const[e,t]=d.exports.useState(0),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{var o;((o=r==null?void 0:r.intData)==null?void 0:o.length)>0&&t(r.intData[0])},[r]),_(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:n,children:[a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>t(0),className:` icon-neighbor-1 ${e===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>t(1),className:` icon-neighbor-5 ${e===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),e!==void 0&&a(C,{style:{textAlign:"center"},children:["Seleccionados","Selector"][e]})]})},Ere=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:o=>t(o.target.value)})]})})},Ire=s=>{const[e,t]=d.exports.useState(""),{trigger:r=null,setStringParam:i=null}=Ne(),n=()=>i(e);return d.exports.useEffect(()=>{t(r.stringData)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.bot.name")}),a("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:o=>t(o.target.value)})]})})},Tre=s=>{const[e,t]=d.exports.useState(0),{trigger:r=null,setStringParam:i=null,setIntParams:n=null}=Ne(),[o,l]=d.exports.useState(0),[c,h]=d.exports.useState(0),u=()=>{i(""),n([o,c,e])};return d.exports.useEffect(()=>{var g,m,p;((g=r==null?void 0:r.intData)==null?void 0:g.length)>=3?(l(r.intData[0]),h(r.intData[1]),t(r.intData[2])):(l(((m=r==null?void 0:r.intData)==null?void 0:m.length)>0?r.intData[0]:2),h(((p=r==null?void 0:r.intData)==null?void 0:p.length)>1?r.intData[1]:2),t(0))},[r]),_(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.picktriggerer")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:e===0,onChange:()=>t(0)}),a(C,{children:E("wiredfurni.params.anyavatar")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:e===1,onChange:()=>t(1)}),a(C,{children:E("wiredfurni.params.onlyroomowner")})," "]})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("Aplicar acciones en:")}),[0,1].map(g=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"wiredAction",id:`wiredAction${g}`,checked:o===g,onChange:()=>l(g)}),a(C,{children:E("action"+g)})]},g))]}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{bold:!0,children:E("reach")}),[0,1].map(g=>_(M,{gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"wiredReach",id:`wiredReach${g}`,checked:c===g,onChange:()=>h(g)}),a(C,{children:E("reach"+g)})]},g))]})]})},Rre=s=>a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Sre=s=>{const[e,t]=d.exports.useState(""),[r,i]=d.exports.useState(0),{trigger:n=null,setStringParam:o=null,setIntParams:l=null}=Ne(),[c,h]=d.exports.useState(0),[u,g]=d.exports.useState(0),[m,p]=d.exports.useState(1),[f,T]=d.exports.useState(""),I=()=>{l([r,c,u,m]),o(r===1?`${f}|${e}`:f)};return d.exports.useEffect(()=>{const O=n.intData,A=n.stringData||"",N=O.length>0?O[0]:0;if(i(N),h(O.length>1?O[1]:0),g(O.length>2?O[2]:0),p(O.length>3?O[3]:1),N===1&&A.includes("|")){const[P,y]=A.split("|");T(P),t(y)}else T(A),t("")},[n]),_(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:I,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:"Comando (ej: :teleport)"}),a("input",{type:"text",className:"form-control form-control-sm",placeholder:":teleport",value:f,onChange:O=>T(O.target.value)})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Quin puede activar el wired?"}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"userMode",id:"userMode0",checked:r===0,onChange:()=>i(0)}),a(C,{children:"Cualquier usuario"})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"userMode",id:"userMode1",checked:r===1,onChange:()=>i(1)}),a(C,{children:"Usuario especfico"})]}),r===1&&a("input",{type:"text",className:"form-control form-control-sm",placeholder:"Nombre de usuario",value:e,onChange:O=>t(O.target.value)})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{bold:!0,children:"A quin se aplica la accin?"}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"actionTarget",id:"actionTarget0",checked:c===0,onChange:()=>h(0)}),a(C,{children:"Jugador seleccionado"})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"actionTarget",id:"actionTarget1",checked:c===1,onChange:()=>h(1)}),a(C,{children:"Ejecutor del comando"})]})]}),a("hr",{className:"m-0 bg-dark"}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Distancia de ejecucin"}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"distanceMode",id:"distanceMode0",checked:u===0,onChange:()=>g(0)}),a(C,{children:"Cualquier distancia"})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"distanceMode",id:"distanceMode1",checked:u===1,onChange:()=>g(1)}),a(C,{children:"Distancia especfica"})]}),u===1&&_(v,{gap:1,children:[a(C,{children:`Distancia: ${m} casillas`}),a(ts,{className:"nitro-slider",min:1,max:20,value:m,onChange:O=>p(O)})]})]})]})},Ore=s=>{const[e,t]=d.exports.useState(1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.settime",["seconds"],[$c(e)])}),a(ts,{className:"nitro-slider",min:1,max:1200,value:e,onChange:o=>t(o)})]})})},Cre=s=>{const[e,t]=d.exports.useState(1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.setlongtime",["time"],[Or.format(e*5).toString()])}),a(ts,{className:"nitro-slider",min:1,max:120,value:e,onChange:o=>t(o)})]})})},Are=s=>{const[e,t]=d.exports.useState(1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.settime",["seconds"],[$c(e)])}),a(ts,{className:"nitro-slider",min:1,max:60,value:e,onChange:o=>t(o)})]})})},Nre=s=>a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),bre=s=>a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),yre=s=>{const[e,t]=d.exports.useState(0),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>{i([e])};return d.exports.useEffect(()=>{const o=r.intData;t(o.length>0?o[0]:0)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{bold:!0,children:E("wiredfurni.params.picktriggerer")}),[...Array(8)].map((o,l)=>_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:`avatarMode${l}`,checked:e===l,onChange:()=>t(l)}),a(C,{children:E(`wiredfurni.params.option${l}`,["number"],[l.toString()])})]},l))]})})},vre=s=>{const[e,t]=d.exports.useState(1),{trigger:r=null,setIntParams:i=null}=Ne(),n=()=>i([e]);return d.exports.useEffect(()=>{t(r.intData.length>0?r.intData[0]:0)},[r]),a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:n,children:_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("wiredfurni.params.setscore",["points"],[e.toString()])}),a(ts,{className:"nitro-slider",min:1,max:1e3,value:e,onChange:o=>t(o)})]})})},Mre=s=>{const[e,t]=d.exports.useState(0),[r,i]=d.exports.useState(0),{trigger:n=null,setIntParams:o=null}=Ne(),l=()=>o([e,r]);return d.exports.useEffect(()=>{var c;((c=n==null?void 0:n.intData)==null?void 0:c.length)>0&&(t(n.intData[0]),i(n.intData[1]))},[n]),_(J,{children:[_(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:l,children:[_(v,{gap:1,children:[a(C,{gfbold:!0,children:E("Selecciona las opciones:")}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:r===0,onChange:c=>i(0)}),a(C,{children:E("Activa solo en el estado actual")})]}),_(M,{alignItems:"center",gap:1,children:[a("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:r===1,onChange:c=>i(1)}),a(C,{children:E("Activa en todos los estados")})]})]}),a(C,{bold:!0,children:E("wiredfurni.params.select.furni.font")}),a("div",{className:"align-advancedoptionsone",children:_("div",{className:"button-group",children:[a("button",{onClick:()=>t(0),className:` icon-neighbor-1 ${e===0?"button-icons-selector-general-selected":"button-icons-selector-general"}`}),a("button",{onClick:()=>t(1),className:` icon-neighbor-5 ${e===1?"button-icons-selector-general-selected":"button-icons-selector-general"}`})]})}),e!==void 0&&a(C,{style:{textAlign:"center"},children:["Seleccionados","Selector"][e]})]}),";"]})},Dre=s=>a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),Pre=[{bit:1,label:"Creacion de variable"},{bit:2,label:"Valor modificado"},{bit:8,label:"Variable eliminada"}],Lre=[{bit:1<<4,label:"Aumenta (nuevo > antiguo)"},{bit:1<<5,label:"Disminuye (nuevo < antiguo)"},{bit:1<<6,label:"Permanece igual"}],Ure=()=>{const{trigger:s=null,setStringParam:e=null,setIntParams:t=null}=Ne(),[r,i]=d.exports.useState(""),[n,o]=d.exports.useState(0),[l,c]=d.exports.useState(15),[h,u]=d.exports.useState(0);d.exports.useEffect(()=>{if(!s)return;i(s.stringData||"");const p=s.intData.length>0?s.intData[0]:0;o(p);const f=s.intData.length>1?s.intData[1]:15;c(f>0?f:15);const T=s.intData.length>2?s.intData[2]:0;u(T)},[s==null?void 0:s.id]),d.exports.useEffect(()=>{n===3&&i("")},[n]);const g=p=>{c(f=>(f&p)!==0?f&~p:f|p)},m=()=>{e((n===3?"":r)||""),t([n,l,h])};return a(dr,{requiresFurni:Se.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:m,children:_(v,{gap:1,children:[a(Cr,{selectedVariable:r,onVariableChange:i,targetType:n,onTargetTypeChange:o,typeOfAdvancedOption:h,onAdvancedOptionChange:u,label:"Variable objetivo (opcional):",showAdvancedOptions:!1,placeholder:"-- cualquiera --",showInternal:!0}),n===3&&a(C,{small:!0,children:"Para variables de contexto no es necesario seleccionar un nombre: se escucharan todos los eventos del proceso."}),_(v,{gap:1,children:[a(C,{bold:!0,children:"Selecciona los eventos que disparan el trigger:"}),Pre.map(p=>_(M,{gap:1,alignItems:"center",children:[a("input",{type:"checkbox",checked:(l&p.bit)!==0,onChange:()=>g(p.bit)}),a(C,{children:p.label})]},p.bit)),(l&2)!==0&&_("div",{style:{paddingLeft:12},children:[a(C,{small:!0,children:"Filtrar por tipo de cambio:"}),Lre.map(p=>_(M,{gap:1,alignItems:"center",children:[a("input",{type:"checkbox",checked:(l&p.bit)!==0,onChange:()=>g(p.bit)}),a(C,{children:p.label})]},p.bit)),a(C,{small:!0,children:"Si no seleccionas ninguna opcin de cambio concreto, cualquier cambio de valor activar el trigger."})]}),l===0&&a(C,{small:!0,children:"Selecciona al menos un evento para que el trigger pueda activarse."})]})]})})},xre=s=>{switch(s){case Nt.AVATAR_ENTERS_ROOM:return a(gre,{});case Nt.AVATAR_SAYS_SOMETHING:return a(mre,{});case Nt.AVATAR_WALKS_OFF_FURNI:return a(fre,{});case Nt.AVATAR_WALKS_ON_FURNI:return a(pre,{});case Nt.BOT_REACHED_AVATAR:return a(Ere,{});case Nt.BOT_REACHED_STUFF:return a(Ire,{});case Nt.COLLISION:return a(Rre,{});case Nt.EXECUTE_ONCE:return a(Ore,{});case Nt.EXECUTE_PERIODICALLY:return a(Are,{});case Nt.EXECUTE_PERIODICALLY_LONG:return a(Cre,{});case Nt.GAME_ENDS:return a(Nre,{});case Nt.GAME_STARTS:return a(bre,{});case Nt.SCORE_ACHIEVED:return a(vre,{});case Nt.TOGGLE_FURNI:return a(Dre,{});case Nt.STATE_MODIFIED:return a(Mre,{});case Nt.BY_ACTION:return a(_re,{});case Nt.AVATAR_CLICKED:return a(Tre,{});case Nt.COMMAND_EXEC:return a(Sre,{});case Nt.KEYBOARD_INPUT:return a(yre,{});case Nt.VARIABLE_EVENT:return a(Ure,{})}return null},wre=s=>{const{trigger:e=null}=Ne();return e?e instanceof Wp?Mte(e.code):e instanceof Hp?xre(e.code):e instanceof Vp?Yse(e.code):e instanceof Yp?hre(e.code):e instanceof jp?Yte(e.code):null:null},Fre=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(!0);return es(Ve.CREATED,n=>i(!1)),es(Ve.ENDED,n=>i(n.openLandingView)),d.exports.useEffect(()=>{t(!0),fl().connection.onReady()},[]),d.exports.useEffect(()=>{const n={linkReceived:o=>{const l=o.split("/");if(!(l.length<2))switch(l[1]){case"open":if(l.length>2)switch(l[2]){case"credits":break;default:{const c=l[2];an.openHabblet(c)}}return}},eventUrlPrefix:"habblet/"};return xs(n),()=>ws(n)},[]),_(K,{fit:!0,children:[a(Pc,{type:Ys.FADE_IN,inProp:r,timeout:300,children:a(b$,{})}),a(Aee,{isInRoom:!r}),a(eJ,{}),a(See,{}),a(sQ,{}),a(wre,{}),a(s9,{}),a(z8,{}),a(fJ,{}),a(k$,{}),a(tQ,{}),a(bQ,{}),a(jJ,{}),a(Pee,{}),a(Dee,{}),a(jQ,{}),a(c9,{}),a(T$,{}),a(EJ,{}),a(t$,{}),a(s$,{}),a(d9,{}),a(DQ,{}),a(_Q,{}),a(wee,{})]})};Uc.UI_VERSION=WL();const kre=s=>{const[e,t]=d.exports.useState(!1),[r,i]=d.exports.useState(!1),[n,o]=d.exports.useState("Getting Ready"),[l,c]=d.exports.useState(0),[h,u]=d.exports.useState(!0);if(!mt()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");ke.bootstrap()}const g=d.exports.useCallback(async m=>{switch(m.type){case $i.LOADED:mt().localization.init(),c(p=>p+20);return;case $i.FAILED:i(!0),o("Configuration Failed");return;case ke.WEBGL_UNAVAILABLE:i(!0),o("WebGL Required");return;case ke.WEBGL_CONTEXT_LOST:i(!0),o("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case Is.CONNECTION_HANDSHAKING:c(p=>p+20);return;case Is.CONNECTION_HANDSHAKE_FAILED:i(!0),o("Handshake Failed");return;case Is.CONNECTION_AUTHENTICATED:c(p=>p+20),mt().init(),It.available&&It.call("legacyTrack","authentication","authok",[]);return;case Is.CONNECTION_ERROR:i(!0),o("Connection Error");return;case Is.CONNECTION_CLOSED:o("Connection Error"),an.send(-1,"client.init.handshake.fail");return;case lt.ENGINE_INITIALIZED:c(p=>p+20),setTimeout(()=>t(!0),300);return;case uo.LOADED:{const p=Ee("preload.assets.urls"),f=[];if(p&&p.length)for(const I of p)f.push(Ke.interpolate(I));await di().downloadAssets(f)?(fl().init(),c(I=>I+20)):(i(!0),o("Assets Failed"));return}}},[]);return ko(ke.WEBGL_UNAVAILABLE,g),ko(ke.WEBGL_CONTEXT_LOST,g),ko(Is.CONNECTION_HANDSHAKING,g),ko(Is.CONNECTION_HANDSHAKE_FAILED,g),ko(Is.CONNECTION_AUTHENTICATED,g),ko(Is.CONNECTION_ERROR,g),ko(Is.CONNECTION_CLOSED,g),_t(lt.ENGINE_INITIALIZED,g),vX(uo.LOADED,g),DT($i.LOADED,g),DT($i.FAILED,g),d.exports.useEffect(()=>{mt().core.configuration.init();const m=p=>u(!(window.devicePixelRatio%1));return window.addEventListener("resize",m),m(),()=>{window.removeEventListener("resize",m)}},[]),_(K,{fit:!0,overflow:"hidden",className:h&&"image-rendering-pixelated",children:[(!e||r)&&a(bX,{isError:r,message:n,percent:l}),a(Pc,{type:Ys.FADE_IN,inProp:e,children:a(Fre,{})}),a(K,{id:"draggable-windows-container"})]})};YU(document.getElementById("root")).render(a(kre,{}));
